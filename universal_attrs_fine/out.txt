10/11/2024 04:47:35 - INFO - llamafactory.cli - Initializing distributed tasks at: 127.0.0.1:27005
W1011 04:47:37.345000 23186356631232 torch/distributed/run.py:779] 
W1011 04:47:37.345000 23186356631232 torch/distributed/run.py:779] *****************************************
W1011 04:47:37.345000 23186356631232 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1011 04:47:37.345000 23186356631232 torch/distributed/run.py:779] *****************************************
10/11/2024 04:47:43 - WARNING - llamafactory.hparams.parser - We recommend enable `upcast_layernorm` in quantized training.
10/11/2024 04:47:43 - WARNING - llamafactory.hparams.parser - `ddp_find_unused_parameters` needs to be set as False for LoRA in DDP training.
10/11/2024 04:47:43 - INFO - llamafactory.hparams.parser - Process rank: 0, device: cuda:0, n_gpu: 1, distributed training: True, compute dtype: torch.bfloat16
10/11/2024 04:47:43 - WARNING - llamafactory.hparams.parser - We recommend enable `upcast_layernorm` in quantized training.
10/11/2024 04:47:43 - WARNING - llamafactory.hparams.parser - `ddp_find_unused_parameters` needs to be set as False for LoRA in DDP training.
10/11/2024 04:47:43 - INFO - llamafactory.hparams.parser - Process rank: 1, device: cuda:1, n_gpu: 1, distributed training: True, compute dtype: torch.bfloat16
[INFO|configuration_utils.py:672] 2024-10-11 04:47:44,015 >> loading configuration file config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/config.json
[WARNING|modeling_rope_utils.py:379] 2024-10-11 04:47:44,016 >> Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
[INFO|configuration_utils.py:739] 2024-10-11 04:47:44,017 >> Model config Qwen2VLConfig {
  "_name_or_path": "Qwen/Qwen2-VL-7B-Instruct",
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 3584,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 18944,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 28,
  "num_hidden_layers": 28,
  "num_key_value_heads": 4,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.0",
  "use_cache": true,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "in_chans": 3,
    "model_type": "qwen2_vl",
    "spatial_patch_size": 14
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 152064
}

Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
[INFO|tokenization_utils_base.py:2214] 2024-10-11 04:47:44,255 >> loading file vocab.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/vocab.json
[INFO|tokenization_utils_base.py:2214] 2024-10-11 04:47:44,255 >> loading file merges.txt from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/merges.txt
[INFO|tokenization_utils_base.py:2214] 2024-10-11 04:47:44,255 >> loading file tokenizer.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/tokenizer.json
[INFO|tokenization_utils_base.py:2214] 2024-10-11 04:47:44,259 >> loading file added_tokens.json from cache at None
[INFO|tokenization_utils_base.py:2214] 2024-10-11 04:47:44,259 >> loading file special_tokens_map.json from cache at None
[INFO|tokenization_utils_base.py:2214] 2024-10-11 04:47:44,259 >> loading file tokenizer_config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/tokenizer_config.json
[INFO|tokenization_utils_base.py:2478] 2024-10-11 04:47:44,548 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|image_processing_base.py:375] 2024-10-11 04:47:45,668 >> loading configuration file preprocessor_config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/preprocessor_config.json
[INFO|image_processing_base.py:375] 2024-10-11 04:47:46,003 >> loading configuration file preprocessor_config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/preprocessor_config.json
[INFO|image_processing_base.py:429] 2024-10-11 04:47:46,003 >> Image processor Qwen2VLImageProcessor {
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "max_pixels": 12845056,
    "min_pixels": 3136
  },
  "temporal_patch_size": 2
}

[INFO|tokenization_utils_base.py:2214] 2024-10-11 04:47:46,241 >> loading file vocab.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/vocab.json
[INFO|tokenization_utils_base.py:2214] 2024-10-11 04:47:46,241 >> loading file merges.txt from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/merges.txt
[INFO|tokenization_utils_base.py:2214] 2024-10-11 04:47:46,241 >> loading file tokenizer.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/tokenizer.json
[INFO|tokenization_utils_base.py:2214] 2024-10-11 04:47:46,241 >> loading file added_tokens.json from cache at None
[INFO|tokenization_utils_base.py:2214] 2024-10-11 04:47:46,241 >> loading file special_tokens_map.json from cache at None
[INFO|tokenization_utils_base.py:2214] 2024-10-11 04:47:46,241 >> loading file tokenizer_config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/tokenizer_config.json
[INFO|tokenization_utils_base.py:2478] 2024-10-11 04:47:46,541 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|processing_utils.py:744] 2024-10-11 04:47:48,365 >> Processor Qwen2VLProcessor:
- image_processor: Qwen2VLImageProcessor {
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "max_pixels": 12845056,
    "min_pixels": 3136
  },
  "temporal_patch_size": 2
}

- tokenizer: Qwen2TokenizerFast(name_or_path='Qwen/Qwen2-VL-7B-Instruct', vocab_size=151643, model_max_length=32768, is_fast=True, padding_side='left', truncation_side='right', special_tokens={'eos_token': '<|im_end|>', 'pad_token': '<|endoftext|>', 'additional_special_tokens': ['<|im_start|>', '<|im_end|>', '<|object_ref_start|>', '<|object_ref_end|>', '<|box_start|>', '<|box_end|>', '<|quad_start|>', '<|quad_end|>', '<|vision_start|>', '<|vision_end|>', '<|vision_pad|>', '<|image_pad|>', '<|video_pad|>']}, clean_up_tokenization_spaces=False),  added_tokens_decoder={
	151643: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151644: AddedToken("<|im_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151645: AddedToken("<|im_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151646: AddedToken("<|object_ref_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151647: AddedToken("<|object_ref_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151648: AddedToken("<|box_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151649: AddedToken("<|box_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151650: AddedToken("<|quad_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151651: AddedToken("<|quad_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151652: AddedToken("<|vision_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151653: AddedToken("<|vision_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151654: AddedToken("<|vision_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151655: AddedToken("<|image_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151656: AddedToken("<|video_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}

{
  "processor_class": "Qwen2VLProcessor"
}

10/11/2024 04:47:48 - INFO - llamafactory.data.template - Replace eos token: <|im_end|>
10/11/2024 04:47:48 - INFO - llamafactory.data.loader - Loading dataset universal_attrs_10k.json...
10/11/2024 04:47:48 - INFO - llamafactory.data.template - Replace eos token: <|im_end|>
Generating train split: 0 examples [00:00, ? examples/s]Generating train split: 11566 examples [00:00, 170007.57 examples/s]
Converting format of dataset (num_proc=16):   0%|          | 0/11566 [00:00<?, ? examples/s]Converting format of dataset (num_proc=16):   4%|▎         | 421/11566 [00:00<00:05, 2128.65 examples/s]Converting format of dataset (num_proc=16):  72%|███████▏  | 8272/11566 [00:00<00:00, 29253.67 examples/s]Converting format of dataset (num_proc=16): 100%|██████████| 11566/11566 [00:00<00:00, 25920.48 examples/s]
10/11/2024 04:47:51 - INFO - llamafactory.data.loader - Loading dataset universal_attrs_10k.json...
Running tokenizer on dataset (num_proc=16):   0%|          | 0/11566 [00:00<?, ? examples/s]Running tokenizer on dataset (num_proc=16):   6%|▋         | 723/11566 [00:29<07:16, 24.84 examples/s]Running tokenizer on dataset (num_proc=16):  13%|█▎        | 1446/11566 [00:35<03:41, 45.72 examples/s]Running tokenizer on dataset (num_proc=16):  19%|█▊        | 2168/11566 [00:37<02:03, 75.86 examples/s]Running tokenizer on dataset (num_proc=16):  31%|███       | 3613/11566 [00:37<00:46, 171.67 examples/s]Running tokenizer on dataset (num_proc=16):  37%|███▋      | 4336/11566 [00:38<00:31, 226.78 examples/s]Running tokenizer on dataset (num_proc=16):  44%|████▎     | 5059/11566 [00:39<00:21, 297.74 examples/s]Running tokenizer on dataset (num_proc=16):  50%|████▉     | 5782/11566 [00:40<00:16, 353.59 examples/s]Running tokenizer on dataset (num_proc=16):  62%|██████▏   | 7228/11566 [00:40<00:07, 611.45 examples/s]Running tokenizer on dataset (num_proc=16):  69%|██████▊   | 7951/11566 [00:40<00:04, 739.17 examples/s]Running tokenizer on dataset (num_proc=16):  75%|███████▍  | 8674/11566 [00:41<00:03, 943.01 examples/s]Running tokenizer on dataset (num_proc=16):  81%|████████  | 9397/11566 [00:41<00:01, 1154.54 examples/s]Running tokenizer on dataset (num_proc=16):  87%|████████▋ | 10120/11566 [00:41<00:01, 1422.30 examples/s]Running tokenizer on dataset (num_proc=16):  94%|█████████▎| 10843/11566 [00:42<00:00, 1449.43 examples/s]Running tokenizer on dataset (num_proc=16): 100%|██████████| 11566/11566 [00:42<00:00, 1209.09 examples/s]Running tokenizer on dataset (num_proc=16): 100%|██████████| 11566/11566 [00:42<00:00, 269.12 examples/s] 
training example:
input_ids:
[151644, 8948, 198, 2610, 525, 264, 10950, 17847, 13, 151645, 198, 151644, 872, 198, 151652, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151655, 151653, 2082, 55856, 419, 42923, 285, 2168, 323, 10542, 25, 1894, 11, 5383, 11, 1173, 8734, 21260, 1819, 151645, 198, 151644, 77091, 198, 34571, 11, 1638, 11, 1638, 151645]
inputs:
<|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
<|vision_start|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|image_pad|><|vision_end|>Analyze this Kurtis image and identify: color, pattern, print_or_pattern_type<|im_end|>
<|im_start|>assistant
grey, default, default<|im_end|>
label_ids:
[-100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, 34571, 11, 1638, 11, 1638, 151645]
labels:
grey, default, default<|im_end|>
[INFO|configuration_utils.py:672] 2024-10-11 04:48:34,982 >> loading configuration file config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/config.json
[WARNING|modeling_rope_utils.py:379] 2024-10-11 04:48:34,983 >> Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
[INFO|configuration_utils.py:739] 2024-10-11 04:48:34,984 >> Model config Qwen2VLConfig {
  "_name_or_path": "Qwen/Qwen2-VL-7B-Instruct",
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 3584,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 18944,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 28,
  "num_hidden_layers": 28,
  "num_key_value_heads": 4,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.0",
  "use_cache": true,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "in_chans": 3,
    "model_type": "qwen2_vl",
    "spatial_patch_size": 14
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 152064
}

10/11/2024 04:48:34 - INFO - llamafactory.model.model_utils.quantization - Quantizing model to 8 bit with bitsandbytes.
Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
10/11/2024 04:48:35 - INFO - llamafactory.model.model_utils.quantization - Quantizing model to 8 bit with bitsandbytes.
[INFO|modeling_utils.py:3726] 2024-10-11 04:48:38,900 >> loading weights file model.safetensors from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/model.safetensors.index.json
Downloading shards:   0%|          | 0/5 [00:00<?, ?it/s]Downloading shards:   0%|          | 0/5 [00:00<?, ?it/s]Downloading shards:  20%|██        | 1/5 [00:37<02:29, 37.32s/it]Downloading shards:  20%|██        | 1/5 [00:37<02:29, 37.32s/it]Downloading shards:  40%|████      | 2/5 [01:13<01:50, 36.77s/it]Downloading shards:  40%|████      | 2/5 [01:13<01:50, 36.76s/it]Downloading shards:  60%|██████    | 3/5 [01:50<01:13, 36.89s/it]Downloading shards:  60%|██████    | 3/5 [01:50<01:13, 36.90s/it]Downloading shards:  80%|████████  | 4/5 [02:27<00:36, 36.98s/it]Downloading shards:  80%|████████  | 4/5 [02:27<00:36, 37.00s/it]Downloading shards: 100%|██████████| 5/5 [02:38<00:00, 27.45s/it]Downloading shards: 100%|██████████| 5/5 [02:38<00:00, 31.68s/it]
Downloading shards: 100%|██████████| 5/5 [02:38<00:00, 27.45s/it]Downloading shards: 100%|██████████| 5/5 [02:38<00:00, 31.69s/it]
[INFO|modeling_utils.py:1622] 2024-10-11 04:51:17,342 >> Instantiating Qwen2VLForConditionalGeneration model under default dtype torch.bfloat16.
[INFO|configuration_utils.py:1099] 2024-10-11 04:51:17,344 >> Generate config GenerationConfig {
  "bos_token_id": 151643,
  "eos_token_id": 151645
}

[WARNING|logging.py:328] 2024-10-11 04:51:17,410 >> `Qwen2VLRotaryEmbedding` can now be fully parameterized by passing the model config through the `config` argument. All other arguments will be removed in v4.46
`Qwen2VLRotaryEmbedding` can now be fully parameterized by passing the model config through the `config` argument. All other arguments will be removed in v4.46
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:07<00:31,  7.97s/it]Loading checkpoint shards:  20%|██        | 1/5 [00:08<00:32,  8.17s/it]Loading checkpoint shards:  40%|████      | 2/5 [00:17<00:27,  9.03s/it]Loading checkpoint shards:  40%|████      | 2/5 [00:17<00:27,  9.12s/it]Loading checkpoint shards:  60%|██████    | 3/5 [00:27<00:19,  9.50s/it]Loading checkpoint shards:  60%|██████    | 3/5 [00:27<00:18,  9.48s/it]Loading checkpoint shards:  80%|████████  | 4/5 [00:37<00:09,  9.64s/it]Loading checkpoint shards:  80%|████████  | 4/5 [00:37<00:09,  9.68s/it]Loading checkpoint shards: 100%|██████████| 5/5 [00:39<00:00,  6.83s/it]Loading checkpoint shards: 100%|██████████| 5/5 [00:39<00:00,  7.90s/it]
Loading checkpoint shards: 100%|██████████| 5/5 [00:39<00:00,  6.85s/it]Loading checkpoint shards: 100%|██████████| 5/5 [00:39<00:00,  7.94s/it]
[INFO|modeling_utils.py:4568] 2024-10-11 04:51:57,366 >> All model checkpoint weights were used when initializing Qwen2VLForConditionalGeneration.

[INFO|modeling_utils.py:4576] 2024-10-11 04:51:57,366 >> All the weights of Qwen2VLForConditionalGeneration were initialized from the model checkpoint at Qwen/Qwen2-VL-7B-Instruct.
If your task is similar to the task the model of the checkpoint was trained on, you can already use Qwen2VLForConditionalGeneration for predictions without further training.
[INFO|configuration_utils.py:1054] 2024-10-11 04:51:57,962 >> loading configuration file generation_config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/generation_config.json
[INFO|configuration_utils.py:1099] 2024-10-11 04:51:57,962 >> Generate config GenerationConfig {
  "bos_token_id": 151643,
  "do_sample": true,
  "eos_token_id": [
    151645,
    151643
  ],
  "pad_token_id": 151643,
  "temperature": 0.01,
  "top_k": 1,
  "top_p": 0.001
}

10/11/2024 04:51:58 - INFO - llamafactory.model.model_utils.checkpointing - Gradient checkpointing enabled.
10/11/2024 04:51:58 - INFO - llamafactory.model.model_utils.visual - Casting multimodal projector outputs in torch.bfloat16.
10/11/2024 04:51:58 - INFO - llamafactory.model.model_utils.attention - Using torch SDPA for faster training and inference.
10/11/2024 04:51:58 - INFO - llamafactory.model.adapter - Upcasting trainable params to float32.
10/11/2024 04:51:58 - INFO - llamafactory.model.adapter - Fine-tuning method: LoRA
10/11/2024 04:51:58 - INFO - llamafactory.model.model_utils.misc - Found linear modules: up_proj,gate_proj,down_proj,o_proj,q_proj,k_proj,v_proj
10/11/2024 04:51:58 - INFO - llamafactory.model.model_utils.checkpointing - Gradient checkpointing enabled.
10/11/2024 04:51:58 - INFO - llamafactory.model.model_utils.visual - Casting multimodal projector outputs in torch.bfloat16.
10/11/2024 04:51:58 - INFO - llamafactory.model.model_utils.attention - Using torch SDPA for faster training and inference.
10/11/2024 04:51:58 - INFO - llamafactory.model.adapter - Upcasting trainable params to float32.
10/11/2024 04:51:58 - INFO - llamafactory.model.adapter - Fine-tuning method: LoRA
10/11/2024 04:51:58 - INFO - llamafactory.model.model_utils.misc - Found linear modules: o_proj,v_proj,down_proj,up_proj,k_proj,gate_proj,q_proj
10/11/2024 04:51:58 - INFO - llamafactory.model.loader - trainable params: 20,185,088 || all params: 8,311,560,704 || trainable%: 0.2429
10/11/2024 04:51:58 - INFO - llamafactory.model.loader - trainable params: 20,185,088 || all params: 8,311,560,704 || trainable%: 0.2429
Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[INFO|trainer.py:667] 2024-10-11 04:51:58,850 >> Using auto half precision backend
[INFO|trainer.py:2243] 2024-10-11 04:52:02,761 >> ***** Running training *****
[INFO|trainer.py:2244] 2024-10-11 04:52:02,761 >>   Num examples = 10,409
[INFO|trainer.py:2245] 2024-10-11 04:52:02,761 >>   Num Epochs = 10
[INFO|trainer.py:2246] 2024-10-11 04:52:02,761 >>   Instantaneous batch size per device = 4
[INFO|trainer.py:2249] 2024-10-11 04:52:02,761 >>   Total train batch size (w. parallel, distributed & accumulation) = 32
[INFO|trainer.py:2250] 2024-10-11 04:52:02,761 >>   Gradient Accumulation steps = 4
[INFO|trainer.py:2251] 2024-10-11 04:52:02,761 >>   Total optimization steps = 3,250
[INFO|trainer.py:2252] 2024-10-11 04:52:02,771 >>   Number of trainable parameters = 20,185,088
  0%|          | 0/3250 [00:00<?, ?it/s]/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
  0%|          | 1/3250 [00:16<14:57:23, 16.57s/it]  0%|          | 2/3250 [00:26<11:26:56, 12.69s/it]  0%|          | 3/3250 [00:36<10:30:05, 11.64s/it]  0%|          | 4/3250 [00:47<10:05:09, 11.19s/it]  0%|          | 5/3250 [00:57<9:51:13, 10.93s/it]                                                   {'loss': 10.7695, 'grad_norm': 116.6077651977539, 'learning_rate': 0.005, 'epoch': 0.02, 'num_input_tokens_seen': 56672}
  0%|          | 5/3250 [00:57<9:51:13, 10.93s/it]  0%|          | 6/3250 [01:08<9:38:38, 10.70s/it]  0%|          | 7/3250 [01:17<9:19:47, 10.36s/it]  0%|          | 8/3250 [01:27<9:06:16, 10.11s/it]  0%|          | 9/3250 [01:37<9:01:39, 10.03s/it]  0%|          | 10/3250 [01:46<8:51:55,  9.85s/it]                                                   {'loss': 13.3382, 'grad_norm': 95.61307525634766, 'learning_rate': 0.005, 'epoch': 0.03, 'num_input_tokens_seen': 113376}
  0%|          | 10/3250 [01:46<8:51:55,  9.85s/it]  0%|          | 11/3250 [01:56<8:53:11,  9.88s/it]  0%|          | 12/3250 [02:07<9:02:40, 10.06s/it]  0%|          | 13/3250 [02:17<9:08:49, 10.17s/it]  0%|          | 14/3250 [02:27<9:00:34, 10.02s/it]  0%|          | 15/3250 [02:37<9:04:15, 10.09s/it]                                                   {'loss': 20.7681, 'grad_norm': 145.9158935546875, 'learning_rate': 0.005, 'epoch': 0.05, 'num_input_tokens_seen': 170240}
  0%|          | 15/3250 [02:37<9:04:15, 10.09s/it]  0%|          | 16/3250 [02:47<9:02:17, 10.06s/it]  1%|          | 17/3250 [02:57<8:59:48, 10.02s/it]  1%|          | 18/3250 [03:07<8:56:05,  9.95s/it]  1%|          | 19/3250 [03:17<8:58:29, 10.00s/it]  1%|          | 20/3250 [03:27<9:02:50, 10.08s/it]                                                   {'loss': 19.5138, 'grad_norm': 67.67560577392578, 'learning_rate': 0.005, 'epoch': 0.06, 'num_input_tokens_seen': 227040}
  1%|          | 20/3250 [03:27<9:02:50, 10.08s/it]  1%|          | 21/3250 [03:37<9:04:07, 10.11s/it]  1%|          | 22/3250 [03:48<9:07:48, 10.18s/it]  1%|          | 23/3250 [03:58<9:11:43, 10.26s/it]  1%|          | 24/3250 [04:09<9:16:14, 10.35s/it]  1%|          | 25/3250 [04:19<9:20:32, 10.43s/it]                                                   {'loss': 11.2371, 'grad_norm': 39.6180305480957, 'learning_rate': 0.005, 'epoch': 0.08, 'num_input_tokens_seen': 284640}
  1%|          | 25/3250 [04:19<9:20:32, 10.43s/it]  1%|          | 26/3250 [04:30<9:22:59, 10.48s/it]  1%|          | 27/3250 [04:40<9:26:05, 10.54s/it]  1%|          | 28/3250 [04:51<9:24:46, 10.52s/it]  1%|          | 29/3250 [05:01<9:21:51, 10.47s/it]  1%|          | 30/3250 [05:12<9:23:58, 10.51s/it]                                                   {'loss': 5.3193, 'grad_norm': 17.828929901123047, 'learning_rate': 0.005, 'epoch': 0.09, 'num_input_tokens_seen': 341088}
  1%|          | 30/3250 [05:12<9:23:58, 10.51s/it]  1%|          | 31/3250 [05:22<9:24:11, 10.52s/it]  1%|          | 32/3250 [05:33<9:20:28, 10.45s/it]  1%|          | 33/3250 [05:43<9:19:24, 10.43s/it]  1%|          | 34/3250 [05:54<9:25:10, 10.54s/it]  1%|          | 35/3250 [06:05<9:27:51, 10.60s/it]                                                   {'loss': 4.6512, 'grad_norm': 17.613988876342773, 'learning_rate': 0.005, 'epoch': 0.11, 'num_input_tokens_seen': 397440}
  1%|          | 35/3250 [06:05<9:27:51, 10.60s/it]  1%|          | 36/3250 [06:15<9:27:51, 10.60s/it]  1%|          | 37/3250 [06:26<9:29:32, 10.64s/it]  1%|          | 38/3250 [06:37<9:29:14, 10.63s/it]  1%|          | 39/3250 [06:47<9:31:13, 10.67s/it]  1%|          | 40/3250 [06:58<9:30:22, 10.66s/it]                                                   {'loss': 4.0546, 'grad_norm': 11.064258575439453, 'learning_rate': 0.005, 'epoch': 0.12, 'num_input_tokens_seen': 454848}
  1%|          | 40/3250 [06:58<9:30:22, 10.66s/it]  1%|▏         | 41/3250 [07:09<9:35:07, 10.75s/it]  1%|▏         | 42/3250 [07:20<9:35:25, 10.76s/it]  1%|▏         | 43/3250 [07:30<9:24:20, 10.56s/it]  1%|▏         | 44/3250 [07:41<9:27:22, 10.62s/it]  1%|▏         | 45/3250 [07:51<9:30:49, 10.69s/it]                                                   {'loss': 3.7901, 'grad_norm': 5.204559803009033, 'learning_rate': 0.005, 'epoch': 0.14, 'num_input_tokens_seen': 511936}
  1%|▏         | 45/3250 [07:51<9:30:49, 10.69s/it]  1%|▏         | 46/3250 [08:02<9:31:37, 10.70s/it]  1%|▏         | 47/3250 [08:13<9:34:48, 10.77s/it]  1%|▏         | 48/3250 [08:24<9:37:17, 10.82s/it]  2%|▏         | 49/3250 [08:35<9:37:55, 10.83s/it]  2%|▏         | 50/3250 [08:46<9:36:57, 10.82s/it]                                                   {'loss': 3.9504, 'grad_norm': 13.575431823730469, 'learning_rate': 0.005, 'epoch': 0.15, 'num_input_tokens_seen': 568768}
  2%|▏         | 50/3250 [08:46<9:36:57, 10.82s/it]  2%|▏         | 51/3250 [08:57<9:40:56, 10.90s/it]  2%|▏         | 52/3250 [09:08<9:42:10, 10.92s/it]  2%|▏         | 53/3250 [09:19<9:45:05, 10.98s/it]  2%|▏         | 54/3250 [09:30<9:45:25, 10.99s/it]  2%|▏         | 55/3250 [09:41<9:44:29, 10.98s/it]                                                   {'loss': 3.3375, 'grad_norm': 8.421527862548828, 'learning_rate': 0.005, 'epoch': 0.17, 'num_input_tokens_seen': 626304}
  2%|▏         | 55/3250 [09:41<9:44:29, 10.98s/it]  2%|▏         | 56/3250 [09:52<9:42:10, 10.94s/it]  2%|▏         | 57/3250 [10:02<9:36:59, 10.84s/it]  2%|▏         | 58/3250 [10:13<9:37:28, 10.85s/it]  2%|▏         | 59/3250 [10:24<9:31:48, 10.75s/it]  2%|▏         | 60/3250 [10:34<9:25:50, 10.64s/it]                                                   {'loss': 3.247, 'grad_norm': 12.59050464630127, 'learning_rate': 0.005, 'epoch': 0.18, 'num_input_tokens_seen': 680672}
  2%|▏         | 60/3250 [10:34<9:25:50, 10.64s/it]  2%|▏         | 61/3250 [10:45<9:27:27, 10.68s/it]  2%|▏         | 62/3250 [10:56<9:33:28, 10.79s/it]  2%|▏         | 63/3250 [11:07<9:36:33, 10.85s/it]  2%|▏         | 64/3250 [11:18<9:38:03, 10.89s/it]  2%|▏         | 65/3250 [11:28<9:32:35, 10.79s/it]                                                   {'loss': 3.0617, 'grad_norm': 6.906523704528809, 'learning_rate': 0.005, 'epoch': 0.2, 'num_input_tokens_seen': 737664}
  2%|▏         | 65/3250 [11:28<9:32:35, 10.79s/it]  2%|▏         | 66/3250 [11:39<9:33:16, 10.80s/it]  2%|▏         | 67/3250 [11:50<9:34:59, 10.84s/it]  2%|▏         | 68/3250 [12:01<9:35:21, 10.85s/it]  2%|▏         | 69/3250 [12:12<9:39:48, 10.94s/it]  2%|▏         | 70/3250 [12:23<9:39:37, 10.94s/it]                                                   {'loss': 3.065, 'grad_norm': 4.677854537963867, 'learning_rate': 0.005, 'epoch': 0.22, 'num_input_tokens_seen': 794688}
  2%|▏         | 70/3250 [12:23<9:39:37, 10.94s/it]  2%|▏         | 71/3250 [12:34<9:35:02, 10.85s/it]  2%|▏         | 72/3250 [12:45<9:36:07, 10.88s/it]  2%|▏         | 73/3250 [12:55<9:28:08, 10.73s/it]  2%|▏         | 74/3250 [13:06<9:31:29, 10.80s/it]  2%|▏         | 75/3250 [13:17<9:35:21, 10.87s/it]                                                   {'loss': 2.9851, 'grad_norm': 8.47925090789795, 'learning_rate': 0.005, 'epoch': 0.23, 'num_input_tokens_seen': 850368}
  2%|▏         | 75/3250 [13:17<9:35:21, 10.87s/it]  2%|▏         | 76/3250 [13:28<9:35:15, 10.87s/it]  2%|▏         | 77/3250 [13:39<9:33:43, 10.85s/it]  2%|▏         | 78/3250 [13:50<9:36:58, 10.91s/it]  2%|▏         | 79/3250 [14:01<9:40:39, 10.99s/it]  2%|▏         | 80/3250 [14:12<9:39:46, 10.97s/it]                                                   {'loss': 2.9587, 'grad_norm': 8.839674949645996, 'learning_rate': 0.005, 'epoch': 0.25, 'num_input_tokens_seen': 907456}
  2%|▏         | 80/3250 [14:12<9:39:46, 10.97s/it]  2%|▏         | 81/3250 [14:23<9:40:12, 10.99s/it]  3%|▎         | 82/3250 [14:34<9:37:58, 10.95s/it]  3%|▎         | 83/3250 [14:45<9:38:20, 10.96s/it]  3%|▎         | 84/3250 [14:56<9:35:54, 10.91s/it]  3%|▎         | 85/3250 [15:07<9:37:12, 10.94s/it]                                                   {'loss': 2.8763, 'grad_norm': 9.573548316955566, 'learning_rate': 0.005, 'epoch': 0.26, 'num_input_tokens_seen': 964288}
  3%|▎         | 85/3250 [15:07<9:37:12, 10.94s/it]  3%|▎         | 86/3250 [15:18<9:37:50, 10.96s/it]  3%|▎         | 87/3250 [15:28<9:36:05, 10.93s/it]  3%|▎         | 88/3250 [15:39<9:34:50, 10.91s/it]  3%|▎         | 89/3250 [15:50<9:37:03, 10.95s/it]  3%|▎         | 90/3250 [16:02<9:40:49, 11.03s/it]                                                   {'loss': 2.8497, 'grad_norm': 4.668139934539795, 'learning_rate': 0.005, 'epoch': 0.28, 'num_input_tokens_seen': 1022336}
  3%|▎         | 90/3250 [16:02<9:40:49, 11.03s/it]  3%|▎         | 91/3250 [16:13<9:42:09, 11.06s/it]  3%|▎         | 92/3250 [16:23<9:33:41, 10.90s/it]  3%|▎         | 93/3250 [16:34<9:33:19, 10.90s/it]  3%|▎         | 94/3250 [16:45<9:33:13, 10.90s/it]  3%|▎         | 95/3250 [16:56<9:32:31, 10.89s/it]                                                   {'loss': 2.8563, 'grad_norm': 3.0966525077819824, 'learning_rate': 0.005, 'epoch': 0.29, 'num_input_tokens_seen': 1080064}
  3%|▎         | 95/3250 [16:56<9:32:31, 10.89s/it]  3%|▎         | 96/3250 [17:07<9:34:22, 10.93s/it]  3%|▎         | 97/3250 [17:17<9:27:18, 10.80s/it]  3%|▎         | 98/3250 [17:28<9:16:37, 10.60s/it]  3%|▎         | 99/3250 [17:38<9:17:43, 10.62s/it]  3%|▎         | 100/3250 [17:49<9:12:45, 10.53s/it]                                                    {'loss': 2.8412, 'grad_norm': 6.509673595428467, 'learning_rate': 0.005, 'epoch': 0.31, 'num_input_tokens_seen': 1136544}
  3%|▎         | 100/3250 [17:49<9:12:45, 10.53s/it][INFO|trainer.py:4021] 2024-10-11 05:09:52,132 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-10-11 05:09:52,132 >>   Num examples = 1157
[INFO|trainer.py:4026] 2024-10-11 05:09:52,132 >>   Batch size = 4

  0%|          | 0/145 [00:00<?, ?it/s][A
  1%|▏         | 2/145 [00:01<01:32,  1.55it/s][A
  2%|▏         | 3/145 [00:02<02:14,  1.06it/s][A
  3%|▎         | 4/145 [00:03<02:30,  1.07s/it][A
  3%|▎         | 5/145 [00:05<02:34,  1.10s/it][A
  4%|▍         | 6/145 [00:06<02:43,  1.18s/it][A
  5%|▍         | 7/145 [00:07<02:48,  1.22s/it][A
  6%|▌         | 8/145 [00:08<02:46,  1.21s/it][A
  6%|▌         | 9/145 [00:10<02:45,  1.22s/it][A
  7%|▋         | 10/145 [00:11<02:47,  1.24s/it][A
  8%|▊         | 11/145 [00:12<02:48,  1.26s/it][A
  8%|▊         | 12/145 [00:14<02:50,  1.28s/it][A
  9%|▉         | 13/145 [00:15<02:52,  1.30s/it][A
 10%|▉         | 14/145 [00:16<02:53,  1.32s/it][A
 10%|█         | 15/145 [00:18<02:49,  1.31s/it][A
 11%|█         | 16/145 [00:19<02:47,  1.30s/it][A
 12%|█▏        | 17/145 [00:20<02:46,  1.30s/it][A
 12%|█▏        | 18/145 [00:21<02:45,  1.31s/it][A
 13%|█▎        | 19/145 [00:23<02:45,  1.31s/it][A
 14%|█▍        | 20/145 [00:24<02:43,  1.31s/it][A
 14%|█▍        | 21/145 [00:25<02:39,  1.28s/it][A
 15%|█▌        | 22/145 [00:27<02:36,  1.28s/it][A
 16%|█▌        | 23/145 [00:28<02:34,  1.27s/it][A
 17%|█▋        | 24/145 [00:29<02:34,  1.28s/it][A
 17%|█▋        | 25/145 [00:30<02:33,  1.28s/it][A
 18%|█▊        | 26/145 [00:32<02:31,  1.27s/it][A
 19%|█▊        | 27/145 [00:33<02:31,  1.28s/it][A
 19%|█▉        | 28/145 [00:34<02:29,  1.27s/it][A
 20%|██        | 29/145 [00:36<02:28,  1.28s/it][A
 21%|██        | 30/145 [00:37<02:22,  1.24s/it][A
 21%|██▏       | 31/145 [00:38<02:23,  1.26s/it][A
 22%|██▏       | 32/145 [00:39<02:22,  1.26s/it][A
 23%|██▎       | 33/145 [00:41<02:22,  1.27s/it][A
 23%|██▎       | 34/145 [00:42<02:21,  1.28s/it][A
 24%|██▍       | 35/145 [00:43<02:20,  1.28s/it][A
 25%|██▍       | 36/145 [00:44<02:19,  1.28s/it][A
 26%|██▌       | 37/145 [00:46<02:21,  1.31s/it][A
 26%|██▌       | 38/145 [00:47<02:20,  1.32s/it][A
 27%|██▋       | 39/145 [00:48<02:18,  1.31s/it][A
 28%|██▊       | 40/145 [00:50<02:16,  1.30s/it][A
 28%|██▊       | 41/145 [00:51<02:17,  1.32s/it][A
 29%|██▉       | 42/145 [00:52<02:15,  1.32s/it][A
 30%|██▉       | 43/145 [00:54<02:12,  1.30s/it][A
 30%|███       | 44/145 [00:55<02:14,  1.33s/it][A
 31%|███       | 45/145 [00:56<02:14,  1.34s/it][A
 32%|███▏      | 46/145 [00:58<02:10,  1.32s/it][A
 32%|███▏      | 47/145 [00:59<02:06,  1.30s/it][A
 33%|███▎      | 48/145 [01:00<02:06,  1.31s/it][A
 34%|███▍      | 49/145 [01:02<02:06,  1.31s/it][A
 34%|███▍      | 50/145 [01:03<02:05,  1.32s/it][A
 35%|███▌      | 51/145 [01:04<02:03,  1.32s/it][A
 36%|███▌      | 52/145 [01:06<02:02,  1.32s/it][A
 37%|███▋      | 53/145 [01:07<02:00,  1.31s/it][A
 37%|███▋      | 54/145 [01:08<02:00,  1.32s/it][A
 38%|███▊      | 55/145 [01:09<01:58,  1.31s/it][A
 39%|███▊      | 56/145 [01:11<01:56,  1.31s/it][A
 39%|███▉      | 57/145 [01:12<01:53,  1.29s/it][A
 40%|████      | 58/145 [01:13<01:52,  1.29s/it][A
 41%|████      | 59/145 [01:15<01:53,  1.32s/it][A
 41%|████▏     | 60/145 [01:16<01:50,  1.30s/it][A
 42%|████▏     | 61/145 [01:17<01:49,  1.30s/it][A
 43%|████▎     | 62/145 [01:18<01:45,  1.28s/it][A
 43%|████▎     | 63/145 [01:20<01:46,  1.30s/it][A
 44%|████▍     | 64/145 [01:21<01:45,  1.30s/it][A
 45%|████▍     | 65/145 [01:22<01:44,  1.31s/it][A
 46%|████▌     | 66/145 [01:24<01:43,  1.31s/it][A
 46%|████▌     | 67/145 [01:25<01:40,  1.29s/it][A
 47%|████▋     | 68/145 [01:26<01:42,  1.33s/it][A
 48%|████▊     | 69/145 [01:28<01:41,  1.33s/it][A
 48%|████▊     | 70/145 [01:29<01:35,  1.28s/it][A
 49%|████▉     | 71/145 [01:30<01:34,  1.27s/it][A
 50%|████▉     | 72/145 [01:32<01:34,  1.29s/it][A
 50%|█████     | 73/145 [01:33<01:34,  1.32s/it][A
 51%|█████     | 74/145 [01:34<01:33,  1.32s/it][A
 52%|█████▏    | 75/145 [01:36<01:33,  1.33s/it][A
 52%|█████▏    | 76/145 [01:37<01:30,  1.32s/it][A
 53%|█████▎    | 77/145 [01:38<01:27,  1.28s/it][A
 54%|█████▍    | 78/145 [01:39<01:26,  1.28s/it][A
 54%|█████▍    | 79/145 [01:41<01:23,  1.27s/it][A
 55%|█████▌    | 80/145 [01:42<01:22,  1.26s/it][A
 56%|█████▌    | 81/145 [01:43<01:19,  1.24s/it][A
 57%|█████▋    | 82/145 [01:44<01:19,  1.26s/it][A
 57%|█████▋    | 83/145 [01:46<01:18,  1.27s/it][A
 58%|█████▊    | 84/145 [01:47<01:18,  1.29s/it][A
 59%|█████▊    | 85/145 [01:48<01:15,  1.25s/it][A
 59%|█████▉    | 86/145 [01:49<01:15,  1.28s/it][A
 60%|██████    | 87/145 [01:51<01:15,  1.31s/it][A
 61%|██████    | 88/145 [01:52<01:13,  1.29s/it][A
 61%|██████▏   | 89/145 [01:53<01:12,  1.29s/it][A
 62%|██████▏   | 90/145 [01:55<01:11,  1.31s/it][A
 63%|██████▎   | 91/145 [01:56<01:10,  1.30s/it][A
 63%|██████▎   | 92/145 [01:57<01:08,  1.30s/it][A
 64%|██████▍   | 93/145 [01:59<01:06,  1.27s/it][A
 65%|██████▍   | 94/145 [02:00<01:04,  1.27s/it][A
 66%|██████▌   | 95/145 [02:01<01:03,  1.28s/it][A
 66%|██████▌   | 96/145 [02:02<01:02,  1.28s/it][A
 67%|██████▋   | 97/145 [02:04<01:02,  1.30s/it][A
 68%|██████▊   | 98/145 [02:05<01:02,  1.33s/it][A
 68%|██████▊   | 99/145 [02:06<00:59,  1.30s/it][A
 69%|██████▉   | 100/145 [02:08<00:58,  1.31s/it][A
 70%|██████▉   | 101/145 [02:09<00:58,  1.32s/it][A
 70%|███████   | 102/145 [02:10<00:56,  1.31s/it][A
 71%|███████   | 103/145 [02:12<00:55,  1.31s/it][A
 72%|███████▏  | 104/145 [02:13<00:53,  1.31s/it][A
 72%|███████▏  | 105/145 [02:14<00:52,  1.32s/it][A
 73%|███████▎  | 106/145 [02:16<00:51,  1.31s/it][A
 74%|███████▍  | 107/145 [02:17<00:48,  1.27s/it][A
 74%|███████▍  | 108/145 [02:18<00:45,  1.24s/it][A
 75%|███████▌  | 109/145 [02:19<00:45,  1.27s/it][A
 76%|███████▌  | 110/145 [02:21<00:45,  1.29s/it][A
 77%|███████▋  | 111/145 [02:22<00:42,  1.26s/it][A
 77%|███████▋  | 112/145 [02:23<00:42,  1.29s/it][A
 78%|███████▊  | 113/145 [02:24<00:41,  1.30s/it][A
 79%|███████▊  | 114/145 [02:26<00:40,  1.31s/it][A
 79%|███████▉  | 115/145 [02:27<00:39,  1.31s/it][A
 80%|████████  | 116/145 [02:28<00:36,  1.28s/it][A
 81%|████████  | 117/145 [02:30<00:35,  1.28s/it][A
 81%|████████▏ | 118/145 [02:31<00:34,  1.27s/it][A
 82%|████████▏ | 119/145 [02:32<00:32,  1.23s/it][A
 83%|████████▎ | 120/145 [02:33<00:30,  1.22s/it][A
 83%|████████▎ | 121/145 [02:34<00:29,  1.22s/it][A
 84%|████████▍ | 122/145 [02:36<00:28,  1.24s/it][A
 85%|████████▍ | 123/145 [02:37<00:27,  1.25s/it][A
 86%|████████▌ | 124/145 [02:38<00:25,  1.24s/it][A
 86%|████████▌ | 125/145 [02:40<00:26,  1.30s/it][A
 87%|████████▋ | 126/145 [02:41<00:24,  1.28s/it][A
 88%|████████▊ | 127/145 [02:42<00:22,  1.27s/it][A
 88%|████████▊ | 128/145 [02:43<00:22,  1.30s/it][A
 89%|████████▉ | 129/145 [02:45<00:20,  1.29s/it][A
 90%|████████▉ | 130/145 [02:46<00:19,  1.33s/it][A
 90%|█████████ | 131/145 [02:47<00:17,  1.28s/it][A
 91%|█████████ | 132/145 [02:49<00:17,  1.31s/it][A
 92%|█████████▏| 133/145 [02:50<00:15,  1.28s/it][A
 92%|█████████▏| 134/145 [02:51<00:14,  1.32s/it][A
 93%|█████████▎| 135/145 [02:53<00:13,  1.31s/it][A
 94%|█████████▍| 136/145 [02:54<00:11,  1.31s/it][A
 94%|█████████▍| 137/145 [02:55<00:10,  1.30s/it][A
 95%|█████████▌| 138/145 [02:56<00:09,  1.31s/it][A
 96%|█████████▌| 139/145 [02:58<00:07,  1.30s/it][A
 97%|█████████▋| 140/145 [02:59<00:06,  1.31s/it][A
 97%|█████████▋| 141/145 [03:00<00:05,  1.31s/it][A
 98%|█████████▊| 142/145 [03:02<00:03,  1.30s/it][A
 99%|█████████▊| 143/145 [03:03<00:02,  1.29s/it][A
 99%|█████████▉| 144/145 [03:04<00:01,  1.30s/it][A
100%|██████████| 145/145 [03:06<00:00,  1.28s/it][A
                                                 [A                                                    {'eval_loss': 2.8437366485595703, 'eval_runtime': 187.4538, 'eval_samples_per_second': 6.172, 'eval_steps_per_second': 0.774, 'epoch': 0.31, 'num_input_tokens_seen': 1136544}

100%|██████████| 145/145 [03:06<00:00,  1.28s/it][A  3%|▎         | 100/3250 [20:56<9:12:45, 10.53s/it]
                                                 [A[INFO|trainer.py:3705] 2024-10-11 05:12:59,588 >> Saving model checkpoint to /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-100
[INFO|configuration_utils.py:672] 2024-10-11 05:13:00,643 >> loading configuration file config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/config.json
[WARNING|modeling_rope_utils.py:379] 2024-10-11 05:13:00,643 >> Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
[INFO|configuration_utils.py:739] 2024-10-11 05:13:00,645 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 3584,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 18944,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 28,
  "num_hidden_layers": 28,
  "num_key_value_heads": 4,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.0",
  "use_cache": true,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "in_chans": 3,
    "model_type": "qwen2_vl",
    "spatial_patch_size": 14
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 152064
}

[INFO|tokenization_utils_base.py:2649] 2024-10-11 05:13:00,708 >> tokenizer config file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-100/tokenizer_config.json
[INFO|tokenization_utils_base.py:2658] 2024-10-11 05:13:00,709 >> Special tokens file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-100/special_tokens_map.json
[INFO|image_processing_base.py:258] 2024-10-11 05:13:01,062 >> Image processor saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-100/preprocessor_config.json
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
  3%|▎         | 101/3250 [21:08<58:42:54, 67.12s/it]  3%|▎         | 102/3250 [21:19<44:03:29, 50.38s/it]  3%|▎         | 103/3250 [21:30<33:43:40, 38.58s/it]  3%|▎         | 104/3250 [21:41<26:27:38, 30.28s/it]  3%|▎         | 105/3250 [21:52<21:21:37, 24.45s/it]                                                     {'loss': 3.1067, 'grad_norm': 8.803512573242188, 'learning_rate': 0.005, 'epoch': 0.32, 'num_input_tokens_seen': 1194176}
  3%|▎         | 105/3250 [21:52<21:21:37, 24.45s/it]  3%|▎         | 106/3250 [22:03<17:52:11, 20.46s/it]  3%|▎         | 107/3250 [22:14<15:22:09, 17.60s/it]  3%|▎         | 108/3250 [22:25<13:38:18, 15.63s/it]  3%|▎         | 109/3250 [22:35<12:18:37, 14.11s/it]  3%|▎         | 110/3250 [22:46<11:29:35, 13.18s/it]                                                     {'loss': 2.8665, 'grad_norm': 4.48238468170166, 'learning_rate': 0.005, 'epoch': 0.34, 'num_input_tokens_seen': 1250976}
  3%|▎         | 110/3250 [22:46<11:29:35, 13.18s/it]  3%|▎         | 111/3250 [22:57<10:54:21, 12.51s/it]  3%|▎         | 112/3250 [23:08<10:29:09, 12.03s/it]  3%|▎         | 113/3250 [23:19<10:10:45, 11.68s/it]  4%|▎         | 114/3250 [23:30<9:59:43, 11.47s/it]   4%|▎         | 115/3250 [23:41<9:53:40, 11.36s/it]                                                    {'loss': 3.0051, 'grad_norm': 4.715595245361328, 'learning_rate': 0.005, 'epoch': 0.35, 'num_input_tokens_seen': 1308096}
  4%|▎         | 115/3250 [23:41<9:53:40, 11.36s/it]  4%|▎         | 116/3250 [23:52<9:50:26, 11.30s/it]  4%|▎         | 117/3250 [24:03<9:43:50, 11.18s/it]  4%|▎         | 118/3250 [24:14<9:36:58, 11.05s/it]  4%|▎         | 119/3250 [24:25<9:36:33, 11.05s/it]  4%|▎         | 120/3250 [24:36<9:37:41, 11.07s/it]                                                    {'loss': 3.0607, 'grad_norm': 7.2046027183532715, 'learning_rate': 0.005, 'epoch': 0.37, 'num_input_tokens_seen': 1365344}
  4%|▎         | 120/3250 [24:36<9:37:41, 11.07s/it]  4%|▎         | 121/3250 [24:47<9:27:27, 10.88s/it]  4%|▍         | 122/3250 [24:57<9:19:04, 10.72s/it]  4%|▍         | 123/3250 [25:07<9:12:55, 10.61s/it]  4%|▍         | 124/3250 [25:18<9:04:28, 10.45s/it]  4%|▍         | 125/3250 [25:28<9:02:53, 10.42s/it]                                                    {'loss': 3.0122, 'grad_norm': 11.572406768798828, 'learning_rate': 0.005, 'epoch': 0.38, 'num_input_tokens_seen': 1422496}
  4%|▍         | 125/3250 [25:28<9:02:53, 10.42s/it]  4%|▍         | 126/3250 [25:38<9:04:16, 10.45s/it]  4%|▍         | 127/3250 [25:49<9:02:19, 10.42s/it]  4%|▍         | 128/3250 [25:59<8:56:26, 10.31s/it]  4%|▍         | 129/3250 [26:09<8:58:33, 10.35s/it]  4%|▍         | 130/3250 [26:19<8:53:43, 10.26s/it]                                                    {'loss': 3.0606, 'grad_norm': 4.764122486114502, 'learning_rate': 0.005, 'epoch': 0.4, 'num_input_tokens_seen': 1478752}
  4%|▍         | 130/3250 [26:19<8:53:43, 10.26s/it]  4%|▍         | 131/3250 [26:30<8:57:25, 10.34s/it]  4%|▍         | 132/3250 [26:40<9:00:19, 10.40s/it]  4%|▍         | 133/3250 [26:51<9:02:52, 10.45s/it]  4%|▍         | 134/3250 [27:02<9:12:11, 10.63s/it]  4%|▍         | 135/3250 [27:13<9:13:42, 10.67s/it]                                                    {'loss': 2.9843, 'grad_norm': 5.653224945068359, 'learning_rate': 0.005, 'epoch': 0.41, 'num_input_tokens_seen': 1536224}
  4%|▍         | 135/3250 [27:13<9:13:42, 10.67s/it]  4%|▍         | 136/3250 [27:24<9:18:25, 10.76s/it]  4%|▍         | 137/3250 [27:34<9:18:11, 10.76s/it]  4%|▍         | 138/3250 [27:45<9:18:47, 10.77s/it]  4%|▍         | 139/3250 [27:56<9:23:09, 10.86s/it]  4%|▍         | 140/3250 [28:07<9:21:35, 10.83s/it]                                                    {'loss': 2.8556, 'grad_norm': 7.586131572723389, 'learning_rate': 0.005, 'epoch': 0.43, 'num_input_tokens_seen': 1592192}
  4%|▍         | 140/3250 [28:07<9:21:35, 10.83s/it]  4%|▍         | 141/3250 [28:18<9:20:28, 10.82s/it]  4%|▍         | 142/3250 [28:29<9:18:46, 10.79s/it]  4%|▍         | 143/3250 [28:39<9:20:03, 10.82s/it]  4%|▍         | 144/3250 [28:50<9:21:53, 10.85s/it]  4%|▍         | 145/3250 [29:01<9:22:19, 10.87s/it]                                                    {'loss': 3.0398, 'grad_norm': 5.533646106719971, 'learning_rate': 0.005, 'epoch': 0.45, 'num_input_tokens_seen': 1648320}
  4%|▍         | 145/3250 [29:01<9:22:19, 10.87s/it]  4%|▍         | 146/3250 [29:12<9:23:10, 10.89s/it]  5%|▍         | 147/3250 [29:23<9:19:22, 10.82s/it]  5%|▍         | 148/3250 [29:34<9:21:29, 10.86s/it]  5%|▍         | 149/3250 [29:45<9:24:03, 10.91s/it]  5%|▍         | 150/3250 [29:56<9:26:46, 10.97s/it]                                                    {'loss': 3.0126, 'grad_norm': 6.522375583648682, 'learning_rate': 0.005, 'epoch': 0.46, 'num_input_tokens_seen': 1704224}
  5%|▍         | 150/3250 [29:56<9:26:46, 10.97s/it]  5%|▍         | 151/3250 [30:07<9:27:41, 10.99s/it]  5%|▍         | 152/3250 [30:18<9:29:05, 11.02s/it]  5%|▍         | 153/3250 [30:29<9:27:07, 10.99s/it]  5%|▍         | 154/3250 [30:40<9:23:03, 10.91s/it]  5%|▍         | 155/3250 [30:50<9:18:12, 10.82s/it]                                                    {'loss': 2.8169, 'grad_norm': 9.012950897216797, 'learning_rate': 0.005, 'epoch': 0.48, 'num_input_tokens_seen': 1760224}
  5%|▍         | 155/3250 [30:50<9:18:12, 10.82s/it]  5%|▍         | 156/3250 [31:01<9:20:13, 10.86s/it]  5%|▍         | 157/3250 [31:12<9:19:25, 10.85s/it]  5%|▍         | 158/3250 [31:23<9:23:05, 10.93s/it]  5%|▍         | 159/3250 [31:35<9:27:44, 11.02s/it]  5%|▍         | 160/3250 [31:46<9:30:02, 11.07s/it]                                                    {'loss': 2.9, 'grad_norm': 6.513717174530029, 'learning_rate': 0.005, 'epoch': 0.49, 'num_input_tokens_seen': 1818208}
  5%|▍         | 160/3250 [31:46<9:30:02, 11.07s/it]  5%|▍         | 161/3250 [31:57<9:26:45, 11.01s/it]  5%|▍         | 162/3250 [32:08<9:27:09, 11.02s/it]  5%|▌         | 163/3250 [32:18<9:24:06, 10.96s/it]  5%|▌         | 164/3250 [32:29<9:20:49, 10.90s/it]  5%|▌         | 165/3250 [32:40<9:21:35, 10.92s/it]                                                    {'loss': 2.9493, 'grad_norm': 4.649696350097656, 'learning_rate': 0.005, 'epoch': 0.51, 'num_input_tokens_seen': 1875104}
  5%|▌         | 165/3250 [32:40<9:21:35, 10.92s/it]  5%|▌         | 166/3250 [32:51<9:22:41, 10.95s/it]  5%|▌         | 167/3250 [33:02<9:24:08, 10.98s/it]  5%|▌         | 168/3250 [33:13<9:20:33, 10.91s/it]  5%|▌         | 169/3250 [33:24<9:22:40, 10.96s/it]  5%|▌         | 170/3250 [33:35<9:22:09, 10.95s/it]                                                    {'loss': 3.0453, 'grad_norm': 8.24931812286377, 'learning_rate': 0.005, 'epoch': 0.52, 'num_input_tokens_seen': 1931808}
  5%|▌         | 170/3250 [33:35<9:22:09, 10.95s/it]  5%|▌         | 171/3250 [33:46<9:24:16, 11.00s/it]  5%|▌         | 172/3250 [33:57<9:25:30, 11.02s/it]  5%|▌         | 173/3250 [34:08<9:26:47, 11.05s/it]  5%|▌         | 174/3250 [34:19<9:26:38, 11.05s/it]  5%|▌         | 175/3250 [34:30<9:21:31, 10.96s/it]                                                    {'loss': 2.954, 'grad_norm': 4.442239761352539, 'learning_rate': 0.005, 'epoch': 0.54, 'num_input_tokens_seen': 1988224}
  5%|▌         | 175/3250 [34:30<9:21:31, 10.96s/it]  5%|▌         | 176/3250 [34:41<9:23:44, 11.00s/it]  5%|▌         | 177/3250 [34:52<9:27:01, 11.07s/it]  5%|▌         | 178/3250 [35:03<9:25:59, 11.05s/it]  6%|▌         | 179/3250 [35:14<9:23:03, 11.00s/it]  6%|▌         | 180/3250 [35:25<9:21:08, 10.97s/it]                                                    {'loss': 2.9278, 'grad_norm': 4.113048076629639, 'learning_rate': 0.005, 'epoch': 0.55, 'num_input_tokens_seen': 2043616}
  6%|▌         | 180/3250 [35:25<9:21:08, 10.97s/it]  6%|▌         | 181/3250 [35:36<9:20:59, 10.97s/it]  6%|▌         | 182/3250 [35:47<9:19:06, 10.93s/it]  6%|▌         | 183/3250 [35:58<9:17:35, 10.91s/it]  6%|▌         | 184/3250 [36:09<9:14:44, 10.86s/it]  6%|▌         | 185/3250 [36:19<9:09:21, 10.75s/it]                                                    {'loss': 2.8525, 'grad_norm': 3.010993003845215, 'learning_rate': 0.005, 'epoch': 0.57, 'num_input_tokens_seen': 2099232}
  6%|▌         | 185/3250 [36:19<9:09:21, 10.75s/it]  6%|▌         | 186/3250 [36:30<9:06:34, 10.70s/it]  6%|▌         | 187/3250 [36:40<9:05:48, 10.69s/it]  6%|▌         | 188/3250 [36:51<9:05:03, 10.68s/it]  6%|▌         | 189/3250 [37:02<9:09:34, 10.77s/it]  6%|▌         | 190/3250 [37:13<9:10:35, 10.80s/it]                                                    {'loss': 2.8193, 'grad_norm': 4.550062656402588, 'learning_rate': 0.005, 'epoch': 0.58, 'num_input_tokens_seen': 2155520}
  6%|▌         | 190/3250 [37:13<9:10:35, 10.80s/it]  6%|▌         | 191/3250 [37:24<9:11:11, 10.81s/it]  6%|▌         | 192/3250 [37:35<9:12:58, 10.85s/it]  6%|▌         | 193/3250 [37:46<9:16:15, 10.92s/it]  6%|▌         | 194/3250 [37:57<9:14:25, 10.89s/it]  6%|▌         | 195/3250 [38:08<9:16:49, 10.94s/it]                                                    {'loss': 2.8263, 'grad_norm': 3.7905426025390625, 'learning_rate': 0.005, 'epoch': 0.6, 'num_input_tokens_seen': 2212320}
  6%|▌         | 195/3250 [38:08<9:16:49, 10.94s/it]  6%|▌         | 196/3250 [38:18<9:15:22, 10.91s/it]  6%|▌         | 197/3250 [38:29<9:16:48, 10.94s/it]  6%|▌         | 198/3250 [38:40<9:15:43, 10.93s/it]  6%|▌         | 199/3250 [38:52<9:20:31, 11.02s/it]  6%|▌         | 200/3250 [39:03<9:20:48, 11.03s/it]                                                    {'loss': 2.8785, 'grad_norm': 1.9157682657241821, 'learning_rate': 0.005, 'epoch': 0.61, 'num_input_tokens_seen': 2268384}
  6%|▌         | 200/3250 [39:03<9:20:48, 11.03s/it][INFO|trainer.py:4021] 2024-10-11 05:31:06,276 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-10-11 05:31:06,277 >>   Num examples = 1157
[INFO|trainer.py:4026] 2024-10-11 05:31:06,277 >>   Batch size = 4

  0%|          | 0/145 [00:00<?, ?it/s][A
  1%|▏         | 2/145 [00:01<01:41,  1.41it/s][A
  2%|▏         | 3/145 [00:02<02:25,  1.03s/it][A
  3%|▎         | 4/145 [00:04<02:44,  1.17s/it][A
  3%|▎         | 5/145 [00:05<02:50,  1.22s/it][A
  4%|▍         | 6/145 [00:07<02:59,  1.29s/it][A
  5%|▍         | 7/145 [00:08<03:05,  1.34s/it][A
  6%|▌         | 8/145 [00:09<03:04,  1.34s/it][A
  6%|▌         | 9/145 [00:11<03:03,  1.35s/it][A
  7%|▋         | 10/145 [00:12<03:04,  1.37s/it][A
  8%|▊         | 11/145 [00:14<03:05,  1.39s/it][A
  8%|▊         | 12/145 [00:15<03:07,  1.41s/it][A
  9%|▉         | 13/145 [00:16<03:08,  1.43s/it][A
 10%|▉         | 14/145 [00:18<03:09,  1.45s/it][A
 10%|█         | 15/145 [00:19<03:06,  1.43s/it][A
 11%|█         | 16/145 [00:21<03:03,  1.42s/it][A
 12%|█▏        | 17/145 [00:22<03:02,  1.42s/it][A
 12%|█▏        | 18/145 [00:24<03:01,  1.43s/it][A
 13%|█▎        | 19/145 [00:25<03:00,  1.43s/it][A
 14%|█▍        | 20/145 [00:27<02:59,  1.43s/it][A
 14%|█▍        | 21/145 [00:28<02:55,  1.41s/it][A
 15%|█▌        | 22/145 [00:29<02:52,  1.40s/it][A
 16%|█▌        | 23/145 [00:31<02:50,  1.40s/it][A
 17%|█▋        | 24/145 [00:32<02:50,  1.41s/it][A
 17%|█▋        | 25/145 [00:34<02:49,  1.41s/it][A
 18%|█▊        | 26/145 [00:35<02:46,  1.40s/it][A
 19%|█▊        | 27/145 [00:36<02:46,  1.41s/it][A
 19%|█▉        | 28/145 [00:38<02:43,  1.40s/it][A
 20%|██        | 29/145 [00:39<02:42,  1.40s/it][A
 21%|██        | 30/145 [00:40<02:37,  1.37s/it][A
 21%|██▏       | 31/145 [00:42<02:38,  1.39s/it][A
 22%|██▏       | 32/145 [00:43<02:37,  1.39s/it][A
 23%|██▎       | 33/145 [00:45<02:37,  1.40s/it][A
 23%|██▎       | 34/145 [00:46<02:36,  1.41s/it][A
 24%|██▍       | 35/145 [00:48<02:35,  1.41s/it][A
 25%|██▍       | 36/145 [00:49<02:33,  1.41s/it][A
 26%|██▌       | 37/145 [00:50<02:35,  1.44s/it][A
 26%|██▌       | 38/145 [00:52<02:34,  1.44s/it][A
 27%|██▋       | 39/145 [00:53<02:31,  1.43s/it][A
 28%|██▊       | 40/145 [00:55<02:30,  1.43s/it][A
 28%|██▊       | 41/145 [00:56<02:30,  1.45s/it][A
 29%|██▉       | 42/145 [00:58<02:29,  1.45s/it][A
 30%|██▉       | 43/145 [00:59<02:25,  1.43s/it][A
 30%|███       | 44/145 [01:01<02:27,  1.46s/it][A
 31%|███       | 45/145 [01:02<02:26,  1.47s/it][A
 32%|███▏      | 46/145 [01:03<02:22,  1.44s/it][A
 32%|███▏      | 47/145 [01:05<02:19,  1.42s/it][A
 33%|███▎      | 48/145 [01:06<02:18,  1.43s/it][A
 34%|███▍      | 49/145 [01:08<02:18,  1.44s/it][A
 34%|███▍      | 50/145 [01:09<02:17,  1.45s/it][A
 35%|███▌      | 51/145 [01:11<02:15,  1.44s/it][A
 36%|███▌      | 52/145 [01:12<02:13,  1.44s/it][A
 37%|███▋      | 53/145 [01:13<02:12,  1.44s/it][A
 37%|███▋      | 54/145 [01:15<02:11,  1.44s/it][A
 38%|███▊      | 55/145 [01:16<02:08,  1.43s/it][A
 39%|███▊      | 56/145 [01:18<02:07,  1.43s/it][A
 39%|███▉      | 57/145 [01:19<02:04,  1.42s/it][A
 40%|████      | 58/145 [01:21<02:02,  1.41s/it][A
 41%|████      | 59/145 [01:22<02:03,  1.44s/it][A
 41%|████▏     | 60/145 [01:23<02:01,  1.43s/it][A
 42%|████▏     | 61/145 [01:25<01:59,  1.42s/it][A
 43%|████▎     | 62/145 [01:26<01:56,  1.41s/it][A
 43%|████▎     | 63/145 [01:28<01:57,  1.43s/it][A
 44%|████▍     | 64/145 [01:29<01:55,  1.43s/it][A
 45%|████▍     | 65/145 [01:31<01:54,  1.44s/it][A
 46%|████▌     | 66/145 [01:32<01:53,  1.43s/it][A
 46%|████▌     | 67/145 [01:33<01:50,  1.42s/it][A
 47%|████▋     | 68/145 [01:35<01:51,  1.44s/it][A
 48%|████▊     | 69/145 [01:36<01:50,  1.45s/it][A
 48%|████▊     | 70/145 [01:38<01:45,  1.40s/it][A
 49%|████▉     | 71/145 [01:39<01:43,  1.40s/it][A
 50%|████▉     | 72/145 [01:41<01:43,  1.41s/it][A
 50%|█████     | 73/145 [01:42<01:43,  1.44s/it][A
 51%|█████     | 74/145 [01:43<01:42,  1.44s/it][A
 52%|█████▏    | 75/145 [01:45<01:41,  1.45s/it][A
 52%|█████▏    | 76/145 [01:46<01:39,  1.44s/it][A
 53%|█████▎    | 77/145 [01:48<01:35,  1.41s/it][A
 54%|█████▍    | 78/145 [01:49<01:34,  1.41s/it][A
 54%|█████▍    | 79/145 [01:50<01:31,  1.39s/it][A
 55%|█████▌    | 80/145 [01:52<01:30,  1.39s/it][A
 56%|█████▌    | 81/145 [01:53<01:27,  1.37s/it][A
 57%|█████▋    | 82/145 [01:55<01:27,  1.39s/it][A
 57%|█████▋    | 83/145 [01:56<01:27,  1.41s/it][A
 58%|█████▊    | 84/145 [01:57<01:26,  1.42s/it][A
 59%|█████▊    | 85/145 [01:59<01:23,  1.39s/it][A
 59%|█████▉    | 86/145 [02:00<01:23,  1.41s/it][A
 60%|██████    | 87/145 [02:02<01:23,  1.43s/it][A
 61%|██████    | 88/145 [02:03<01:20,  1.41s/it][A
 61%|██████▏   | 89/145 [02:05<01:19,  1.42s/it][A
 62%|██████▏   | 90/145 [02:06<01:18,  1.43s/it][A
 63%|██████▎   | 91/145 [02:07<01:16,  1.42s/it][A
 63%|██████▎   | 92/145 [02:09<01:15,  1.42s/it][A
 64%|██████▍   | 93/145 [02:10<01:13,  1.40s/it][A
 65%|██████▍   | 94/145 [02:12<01:11,  1.40s/it][A
 66%|██████▌   | 95/145 [02:13<01:10,  1.41s/it][A
 66%|██████▌   | 96/145 [02:14<01:09,  1.41s/it][A
 67%|██████▋   | 97/145 [02:16<01:08,  1.42s/it][A
 68%|██████▊   | 98/145 [02:17<01:08,  1.45s/it][A
 68%|██████▊   | 99/145 [02:19<01:05,  1.43s/it][A
 69%|██████▉   | 100/145 [02:20<01:04,  1.43s/it][A
 70%|██████▉   | 101/145 [02:22<01:03,  1.44s/it][A
 70%|███████   | 102/145 [02:23<01:01,  1.43s/it][A
 71%|███████   | 103/145 [02:25<01:00,  1.43s/it][A
 72%|███████▏  | 104/145 [02:26<00:58,  1.44s/it][A
 72%|███████▏  | 105/145 [02:27<00:57,  1.44s/it][A
 73%|███████▎  | 106/145 [02:29<00:55,  1.43s/it][A
 74%|███████▍  | 107/145 [02:30<00:52,  1.39s/it][A
 74%|███████▍  | 108/145 [02:31<00:50,  1.37s/it][A
 75%|███████▌  | 109/145 [02:33<00:50,  1.39s/it][A
 76%|███████▌  | 110/145 [02:34<00:49,  1.42s/it][A
 77%|███████▋  | 111/145 [02:36<00:47,  1.38s/it][A
 77%|███████▋  | 112/145 [02:37<00:46,  1.41s/it][A
 78%|███████▊  | 113/145 [02:39<00:45,  1.43s/it][A
 79%|███████▊  | 114/145 [02:40<00:44,  1.44s/it][A
 79%|███████▉  | 115/145 [02:41<00:42,  1.43s/it][A
 80%|████████  | 116/145 [02:43<00:40,  1.41s/it][A
 81%|████████  | 117/145 [02:44<00:39,  1.41s/it][A
 81%|████████▏ | 118/145 [02:46<00:37,  1.40s/it][A
 82%|████████▏ | 119/145 [02:47<00:35,  1.36s/it][A
 83%|████████▎ | 120/145 [02:48<00:33,  1.35s/it][A
 83%|████████▎ | 121/145 [02:50<00:32,  1.35s/it][A
 84%|████████▍ | 122/145 [02:51<00:31,  1.37s/it][A
 85%|████████▍ | 123/145 [02:52<00:30,  1.38s/it][A
 86%|████████▌ | 124/145 [02:54<00:28,  1.37s/it][A
 86%|████████▌ | 125/145 [02:55<00:28,  1.43s/it][A
 87%|████████▋ | 126/145 [02:57<00:26,  1.41s/it][A
 88%|████████▊ | 127/145 [02:58<00:25,  1.40s/it][A
 88%|████████▊ | 128/145 [03:00<00:24,  1.43s/it][A
 89%|████████▉ | 129/145 [03:01<00:22,  1.43s/it][A
 90%|████████▉ | 130/145 [03:02<00:21,  1.45s/it][A
 90%|█████████ | 131/145 [03:04<00:19,  1.41s/it][A
 91%|█████████ | 132/145 [03:05<00:18,  1.43s/it][A
 92%|█████████▏| 133/145 [03:07<00:16,  1.40s/it][A
 92%|█████████▏| 134/145 [03:08<00:15,  1.44s/it][A
 93%|█████████▎| 135/145 [03:10<00:14,  1.43s/it][A
 94%|█████████▍| 136/145 [03:11<00:12,  1.43s/it][A
 94%|█████████▍| 137/145 [03:12<00:11,  1.42s/it][A
 95%|█████████▌| 138/145 [03:14<00:10,  1.43s/it][A
 96%|█████████▌| 139/145 [03:15<00:08,  1.43s/it][A
 97%|█████████▋| 140/145 [03:17<00:07,  1.43s/it][A
 97%|█████████▋| 141/145 [03:18<00:05,  1.43s/it][A
 98%|█████████▊| 142/145 [03:19<00:04,  1.42s/it][A
 99%|█████████▊| 143/145 [03:21<00:02,  1.41s/it][A
 99%|█████████▉| 144/145 [03:22<00:01,  1.42s/it][A
100%|██████████| 145/145 [03:24<00:00,  1.39s/it][A
                                                 [A                                                    {'eval_loss': 2.7824525833129883, 'eval_runtime': 205.7474, 'eval_samples_per_second': 5.623, 'eval_steps_per_second': 0.705, 'epoch': 0.61, 'num_input_tokens_seen': 2268384}

100%|██████████| 145/145 [03:24<00:00,  1.39s/it][A  6%|▌         | 200/3250 [42:28<9:20:48, 11.03s/it]
                                                 [A[INFO|trainer.py:3705] 2024-10-11 05:34:32,026 >> Saving model checkpoint to /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-200
[INFO|configuration_utils.py:672] 2024-10-11 05:34:32,859 >> loading configuration file config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/config.json
[WARNING|modeling_rope_utils.py:379] 2024-10-11 05:34:32,859 >> Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
[INFO|configuration_utils.py:739] 2024-10-11 05:34:32,862 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 3584,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 18944,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 28,
  "num_hidden_layers": 28,
  "num_key_value_heads": 4,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.0",
  "use_cache": true,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "in_chans": 3,
    "model_type": "qwen2_vl",
    "spatial_patch_size": 14
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 152064
}

[INFO|tokenization_utils_base.py:2649] 2024-10-11 05:34:34,372 >> tokenizer config file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-200/tokenizer_config.json
[INFO|tokenization_utils_base.py:2658] 2024-10-11 05:34:34,372 >> Special tokens file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-200/special_tokens_map.json
[INFO|image_processing_base.py:258] 2024-10-11 05:34:34,857 >> Image processor saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-200/preprocessor_config.json
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
  6%|▌         | 201/3250 [42:42<62:21:26, 73.63s/it]  6%|▌         | 202/3250 [42:54<46:28:42, 54.90s/it]  6%|▌         | 203/3250 [43:05<35:20:05, 41.75s/it]  6%|▋         | 204/3250 [43:15<27:26:36, 32.43s/it]  6%|▋         | 205/3250 [43:26<22:00:23, 26.02s/it]                                                     {'loss': 2.7281, 'grad_norm': 3.255547523498535, 'learning_rate': 0.005, 'epoch': 0.63, 'num_input_tokens_seen': 2326528}
  6%|▋         | 205/3250 [43:26<22:00:23, 26.02s/it]  6%|▋         | 206/3250 [43:37<18:09:03, 21.47s/it]  6%|▋         | 207/3250 [43:48<15:31:50, 18.37s/it]  6%|▋         | 208/3250 [43:59<13:36:48, 16.11s/it]  6%|▋         | 209/3250 [44:10<12:17:58, 14.56s/it]  6%|▋         | 210/3250 [44:21<11:20:46, 13.44s/it]                                                     {'loss': 2.8131, 'grad_norm': 6.1548848152160645, 'learning_rate': 0.005, 'epoch': 0.65, 'num_input_tokens_seen': 2382944}
  6%|▋         | 210/3250 [44:21<11:20:46, 13.44s/it]  6%|▋         | 211/3250 [44:32<10:43:56, 12.71s/it]  7%|▋         | 212/3250 [44:43<10:15:01, 12.15s/it]  7%|▋         | 213/3250 [44:54<10:00:38, 11.87s/it]  7%|▋         | 214/3250 [45:05<9:49:45, 11.66s/it]   7%|▋         | 215/3250 [45:16<9:40:55, 11.48s/it]                                                    {'loss': 2.866, 'grad_norm': 6.376820087432861, 'learning_rate': 0.005, 'epoch': 0.66, 'num_input_tokens_seen': 2440416}
  7%|▋         | 215/3250 [45:16<9:40:55, 11.48s/it]  7%|▋         | 216/3250 [45:27<9:36:51, 11.41s/it]  7%|▋         | 217/3250 [45:39<9:32:54, 11.33s/it]  7%|▋         | 218/3250 [45:50<9:26:33, 11.21s/it]  7%|▋         | 219/3250 [46:01<9:24:48, 11.18s/it]  7%|▋         | 220/3250 [46:12<9:24:55, 11.19s/it]                                                    {'loss': 2.7842, 'grad_norm': 3.0852739810943604, 'learning_rate': 0.005, 'epoch': 0.68, 'num_input_tokens_seen': 2497440}
  7%|▋         | 220/3250 [46:12<9:24:55, 11.19s/it]  7%|▋         | 221/3250 [46:23<9:21:24, 11.12s/it]  7%|▋         | 222/3250 [46:34<9:16:04, 11.02s/it]  7%|▋         | 223/3250 [46:45<9:17:49, 11.06s/it]  7%|▋         | 224/3250 [46:56<9:18:23, 11.07s/it]  7%|▋         | 225/3250 [47:07<9:16:18, 11.03s/it]                                                    {'loss': 2.864, 'grad_norm': 2.3806397914886475, 'learning_rate': 0.005, 'epoch': 0.69, 'num_input_tokens_seen': 2553088}
  7%|▋         | 225/3250 [47:07<9:16:18, 11.03s/it]  7%|▋         | 226/3250 [47:18<9:19:18, 11.10s/it]  7%|▋         | 227/3250 [47:29<9:17:19, 11.06s/it]  7%|▋         | 228/3250 [47:40<9:17:18, 11.06s/it]  7%|▋         | 229/3250 [47:51<9:15:26, 11.03s/it]  7%|▋         | 230/3250 [48:02<9:17:17, 11.07s/it]                                                    {'loss': 2.7819, 'grad_norm': 6.105291843414307, 'learning_rate': 0.005, 'epoch': 0.71, 'num_input_tokens_seen': 2611072}
  7%|▋         | 230/3250 [48:02<9:17:17, 11.07s/it]  7%|▋         | 231/3250 [48:13<9:18:14, 11.09s/it]  7%|▋         | 232/3250 [48:24<9:13:18, 11.00s/it]  7%|▋         | 233/3250 [48:35<9:15:13, 11.04s/it]  7%|▋         | 234/3250 [48:46<9:13:05, 11.00s/it]  7%|▋         | 235/3250 [48:57<9:12:35, 11.00s/it]                                                    {'loss': 2.8162, 'grad_norm': 1.8649842739105225, 'learning_rate': 0.005, 'epoch': 0.72, 'num_input_tokens_seen': 2668544}
  7%|▋         | 235/3250 [48:57<9:12:35, 11.00s/it]  7%|▋         | 236/3250 [49:08<9:11:38, 10.98s/it]  7%|▋         | 237/3250 [49:19<9:06:39, 10.89s/it]  7%|▋         | 238/3250 [49:30<9:06:50, 10.89s/it]  7%|▋         | 239/3250 [49:41<9:07:49, 10.92s/it]  7%|▋         | 240/3250 [49:52<9:09:07, 10.95s/it]                                                    {'loss': 2.7381, 'grad_norm': 2.5908026695251465, 'learning_rate': 0.005, 'epoch': 0.74, 'num_input_tokens_seen': 2725280}
  7%|▋         | 240/3250 [49:52<9:09:07, 10.95s/it]  7%|▋         | 241/3250 [50:02<9:02:20, 10.81s/it]  7%|▋         | 242/3250 [50:13<9:04:28, 10.86s/it]  7%|▋         | 243/3250 [50:24<9:05:44, 10.89s/it]  8%|▊         | 244/3250 [50:35<9:06:10, 10.90s/it]  8%|▊         | 245/3250 [50:46<9:06:56, 10.92s/it]                                                    {'loss': 2.8675, 'grad_norm': 3.964433431625366, 'learning_rate': 0.005, 'epoch': 0.75, 'num_input_tokens_seen': 2781024}
  8%|▊         | 245/3250 [50:46<9:06:56, 10.92s/it]  8%|▊         | 246/3250 [50:57<9:07:59, 10.95s/it]  8%|▊         | 247/3250 [51:08<9:04:51, 10.89s/it]  8%|▊         | 248/3250 [51:19<9:02:56, 10.85s/it]  8%|▊         | 249/3250 [51:29<9:02:31, 10.85s/it]  8%|▊         | 250/3250 [51:40<8:54:20, 10.69s/it]                                                    {'loss': 2.841, 'grad_norm': 4.65540075302124, 'learning_rate': 0.005, 'epoch': 0.77, 'num_input_tokens_seen': 2835648}
  8%|▊         | 250/3250 [51:40<8:54:20, 10.69s/it]  8%|▊         | 251/3250 [51:51<8:58:00, 10.76s/it]  8%|▊         | 252/3250 [52:02<9:05:00, 10.91s/it]  8%|▊         | 253/3250 [52:13<9:14:46, 11.11s/it]  8%|▊         | 254/3250 [52:24<9:13:10, 11.08s/it]  8%|▊         | 255/3250 [52:35<9:06:25, 10.95s/it]                                                    {'loss': 3.0084, 'grad_norm': 3.218156576156616, 'learning_rate': 0.005, 'epoch': 0.78, 'num_input_tokens_seen': 2893152}
  8%|▊         | 255/3250 [52:35<9:06:25, 10.95s/it]  8%|▊         | 256/3250 [52:46<9:10:30, 11.03s/it]  8%|▊         | 257/3250 [52:57<9:09:19, 11.01s/it]  8%|▊         | 258/3250 [53:08<9:02:08, 10.87s/it]  8%|▊         | 259/3250 [53:19<9:04:38, 10.93s/it]  8%|▊         | 260/3250 [53:30<9:04:17, 10.92s/it]                                                    {'loss': 2.9639, 'grad_norm': 3.5813751220703125, 'learning_rate': 0.005, 'epoch': 0.8, 'num_input_tokens_seen': 2948256}
  8%|▊         | 260/3250 [53:30<9:04:17, 10.92s/it]  8%|▊         | 261/3250 [53:41<9:05:13, 10.94s/it]  8%|▊         | 262/3250 [53:53<9:16:12, 11.17s/it]  8%|▊         | 263/3250 [54:03<8:59:09, 10.83s/it]  8%|▊         | 264/3250 [54:13<8:59:34, 10.84s/it]  8%|▊         | 265/3250 [54:25<9:03:06, 10.92s/it]                                                    {'loss': 10.7318, 'grad_norm': 5.272208213806152, 'learning_rate': 0.005, 'epoch': 0.81, 'num_input_tokens_seen': 3004608}
  8%|▊         | 265/3250 [54:25<9:03:06, 10.92s/it]  8%|▊         | 266/3250 [54:35<9:02:04, 10.90s/it]  8%|▊         | 267/3250 [54:46<9:02:42, 10.92s/it]  8%|▊         | 268/3250 [54:57<9:04:59, 10.97s/it]  8%|▊         | 269/3250 [55:08<9:05:20, 10.98s/it]  8%|▊         | 270/3250 [55:20<9:06:58, 11.01s/it]                                                    {'loss': 3.9697, 'grad_norm': 7.699127674102783, 'learning_rate': 0.005, 'epoch': 0.83, 'num_input_tokens_seen': 3061344}
  8%|▊         | 270/3250 [55:20<9:06:58, 11.01s/it]  8%|▊         | 271/3250 [55:30<9:01:26, 10.91s/it]  8%|▊         | 272/3250 [55:41<9:02:58, 10.94s/it]  8%|▊         | 273/3250 [55:52<9:04:28, 10.97s/it]  8%|▊         | 274/3250 [56:04<9:09:03, 11.07s/it]  8%|▊         | 275/3250 [56:15<9:13:50, 11.17s/it]                                                    {'loss': 3.2023, 'grad_norm': 5.952910423278809, 'learning_rate': 0.005, 'epoch': 0.84, 'num_input_tokens_seen': 3117440}
  8%|▊         | 275/3250 [56:15<9:13:50, 11.17s/it]  8%|▊         | 276/3250 [56:26<9:16:07, 11.22s/it]  9%|▊         | 277/3250 [56:38<9:17:25, 11.25s/it]  9%|▊         | 278/3250 [56:49<9:17:48, 11.26s/it]  9%|▊         | 279/3250 [57:00<9:12:36, 11.16s/it]  9%|▊         | 280/3250 [57:11<9:10:48, 11.13s/it]                                                    {'loss': 3.1107, 'grad_norm': 3.477289915084839, 'learning_rate': 0.005, 'epoch': 0.86, 'num_input_tokens_seen': 3174496}
  9%|▊         | 280/3250 [57:11<9:10:48, 11.13s/it]  9%|▊         | 281/3250 [57:22<9:15:44, 11.23s/it]  9%|▊         | 282/3250 [57:33<9:13:52, 11.20s/it]  9%|▊         | 283/3250 [57:44<9:09:05, 11.10s/it]  9%|▊         | 284/3250 [57:55<9:09:39, 11.12s/it]  9%|▉         | 285/3250 [58:07<9:12:52, 11.19s/it]                                                    {'loss': 3.0205, 'grad_norm': 7.841935634613037, 'learning_rate': 0.005, 'epoch': 0.88, 'num_input_tokens_seen': 3232288}
  9%|▉         | 285/3250 [58:07<9:12:52, 11.19s/it]  9%|▉         | 286/3250 [58:18<9:11:19, 11.16s/it]  9%|▉         | 287/3250 [58:29<9:10:06, 11.14s/it]  9%|▉         | 288/3250 [58:41<9:15:13, 11.25s/it]  9%|▉         | 289/3250 [58:52<9:11:33, 11.18s/it]  9%|▉         | 290/3250 [59:03<9:13:05, 11.21s/it]                                                    {'loss': 2.8452, 'grad_norm': 4.709122657775879, 'learning_rate': 0.005, 'epoch': 0.89, 'num_input_tokens_seen': 3289024}
  9%|▉         | 290/3250 [59:03<9:13:05, 11.21s/it]  9%|▉         | 291/3250 [59:14<9:14:39, 11.25s/it]  9%|▉         | 292/3250 [59:25<9:14:53, 11.26s/it]  9%|▉         | 293/3250 [59:36<9:11:41, 11.19s/it]  9%|▉         | 294/3250 [59:47<9:08:37, 11.14s/it]  9%|▉         | 295/3250 [59:59<9:07:36, 11.12s/it]                                                    {'loss': 2.8896, 'grad_norm': 4.997106075286865, 'learning_rate': 0.005, 'epoch': 0.91, 'num_input_tokens_seen': 3344384}
  9%|▉         | 295/3250 [59:59<9:07:36, 11.12s/it]  9%|▉         | 296/3250 [1:00:10<9:13:34, 11.24s/it]  9%|▉         | 297/3250 [1:00:21<9:13:52, 11.25s/it]  9%|▉         | 298/3250 [1:00:33<9:17:00, 11.32s/it]  9%|▉         | 299/3250 [1:00:44<9:20:03, 11.39s/it]  9%|▉         | 300/3250 [1:00:56<9:17:13, 11.33s/it]                                                      {'loss': 2.959, 'grad_norm': 5.997200965881348, 'learning_rate': 0.005, 'epoch': 0.92, 'num_input_tokens_seen': 3402016}
  9%|▉         | 300/3250 [1:00:56<9:17:13, 11.33s/it][INFO|trainer.py:4021] 2024-10-11 05:52:59,210 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-10-11 05:52:59,211 >>   Num examples = 1157
[INFO|trainer.py:4026] 2024-10-11 05:52:59,211 >>   Batch size = 4

  0%|          | 0/145 [00:00<?, ?it/s][A
  1%|▏         | 2/145 [00:01<01:44,  1.37it/s][A
  2%|▏         | 3/145 [00:02<02:29,  1.06s/it][A
  3%|▎         | 4/145 [00:04<02:49,  1.20s/it][A
  3%|▎         | 5/145 [00:05<02:55,  1.25s/it][A
  4%|▍         | 6/145 [00:07<03:05,  1.33s/it][A
  5%|▍         | 7/145 [00:08<03:11,  1.39s/it][A
  6%|▌         | 8/145 [00:10<03:09,  1.38s/it][A
  6%|▌         | 9/145 [00:11<03:08,  1.39s/it][A
  7%|▋         | 10/145 [00:12<03:09,  1.41s/it][A
  8%|▊         | 11/145 [00:14<03:10,  1.42s/it][A
  8%|▊         | 12/145 [00:15<03:12,  1.45s/it][A
  9%|▉         | 13/145 [00:17<03:13,  1.47s/it][A
 10%|▉         | 14/145 [00:18<03:14,  1.49s/it][A
 10%|█         | 15/145 [00:20<03:11,  1.47s/it][A
 11%|█         | 16/145 [00:21<03:08,  1.46s/it][A
 12%|█▏        | 17/145 [00:23<03:07,  1.47s/it][A
 12%|█▏        | 18/145 [00:24<03:07,  1.47s/it][A
 13%|█▎        | 19/145 [00:26<03:06,  1.48s/it][A
 14%|█▍        | 20/145 [00:27<03:04,  1.48s/it][A
 14%|█▍        | 21/145 [00:29<03:00,  1.46s/it][A
 15%|█▌        | 22/145 [00:30<02:58,  1.45s/it][A
 16%|█▌        | 23/145 [00:32<02:56,  1.44s/it][A
 17%|█▋        | 24/145 [00:33<02:55,  1.45s/it][A
 17%|█▋        | 25/145 [00:35<02:54,  1.45s/it][A
 18%|█▊        | 26/145 [00:36<02:52,  1.45s/it][A
 19%|█▊        | 27/145 [00:37<02:51,  1.45s/it][A
 19%|█▉        | 28/145 [00:39<02:49,  1.44s/it][A
 20%|██        | 29/145 [00:40<02:47,  1.44s/it][A
 21%|██        | 30/145 [00:42<02:42,  1.41s/it][A
 21%|██▏       | 31/145 [00:43<02:43,  1.43s/it][A
 22%|██▏       | 32/145 [00:45<02:42,  1.44s/it][A
 23%|██▎       | 33/145 [00:46<02:42,  1.45s/it][A
 23%|██▎       | 34/145 [00:47<02:41,  1.45s/it][A
 24%|██▍       | 35/145 [00:49<02:40,  1.46s/it][A
 25%|██▍       | 36/145 [00:50<02:38,  1.45s/it][A
 26%|██▌       | 37/145 [00:52<02:40,  1.49s/it][A
 26%|██▌       | 38/145 [00:53<02:38,  1.49s/it][A
 27%|██▋       | 39/145 [00:55<02:36,  1.48s/it][A
 28%|██▊       | 40/145 [00:56<02:34,  1.47s/it][A
 28%|██▊       | 41/145 [00:58<02:35,  1.49s/it][A
 29%|██▉       | 42/145 [00:59<02:33,  1.49s/it][A
 30%|██▉       | 43/145 [01:01<02:30,  1.47s/it][A
 30%|███       | 44/145 [01:02<02:31,  1.50s/it][A
 31%|███       | 45/145 [01:04<02:31,  1.51s/it][A
 32%|███▏      | 46/145 [01:05<02:27,  1.49s/it][A
 32%|███▏      | 47/145 [01:07<02:23,  1.47s/it][A
 33%|███▎      | 48/145 [01:08<02:22,  1.47s/it][A
 34%|███▍      | 49/145 [01:10<02:22,  1.48s/it][A
 34%|███▍      | 50/145 [01:11<02:21,  1.49s/it][A
 35%|███▌      | 51/145 [01:13<02:20,  1.49s/it][A
 36%|███▌      | 52/145 [01:14<02:18,  1.49s/it][A
 37%|███▋      | 53/145 [01:16<02:16,  1.48s/it][A
 37%|███▋      | 54/145 [01:17<02:15,  1.49s/it][A
 38%|███▊      | 55/145 [01:19<02:12,  1.48s/it][A
 39%|███▊      | 56/145 [01:20<02:11,  1.48s/it][A
 39%|███▉      | 57/145 [01:22<02:09,  1.47s/it][A
 40%|████      | 58/145 [01:23<02:06,  1.46s/it][A
 41%|████      | 59/145 [01:25<02:07,  1.48s/it][A
 41%|████▏     | 60/145 [01:26<02:05,  1.47s/it][A
 42%|████▏     | 61/145 [01:27<02:03,  1.47s/it][A
 43%|████▎     | 62/145 [01:29<02:00,  1.45s/it][A
 43%|████▎     | 63/145 [01:30<02:00,  1.47s/it][A
 44%|████▍     | 64/145 [01:32<01:58,  1.47s/it][A
 45%|████▍     | 65/145 [01:33<01:58,  1.48s/it][A
 46%|████▌     | 66/145 [01:35<01:56,  1.48s/it][A
 46%|████▌     | 67/145 [01:36<01:54,  1.46s/it][A
 47%|████▋     | 68/145 [01:38<01:54,  1.49s/it][A
 48%|████▊     | 69/145 [01:39<01:53,  1.50s/it][A
 48%|████▊     | 70/145 [01:41<01:48,  1.45s/it][A
 49%|████▉     | 71/145 [01:42<01:46,  1.44s/it][A
 50%|████▉     | 72/145 [01:44<01:46,  1.46s/it][A
 50%|█████     | 73/145 [01:45<01:46,  1.48s/it][A
 51%|█████     | 74/145 [01:47<01:45,  1.49s/it][A
 52%|█████▏    | 75/145 [01:48<01:44,  1.49s/it][A
 52%|█████▏    | 76/145 [01:50<01:42,  1.48s/it][A
 53%|█████▎    | 77/145 [01:51<01:38,  1.45s/it][A
 54%|█████▍    | 78/145 [01:52<01:37,  1.45s/it][A
 54%|█████▍    | 79/145 [01:54<01:34,  1.44s/it][A
 55%|█████▌    | 80/145 [01:55<01:33,  1.44s/it][A
 56%|█████▌    | 81/145 [01:57<01:30,  1.42s/it][A
 57%|█████▋    | 82/145 [01:58<01:30,  1.44s/it][A
 57%|█████▋    | 83/145 [02:00<01:29,  1.45s/it][A
 58%|█████▊    | 84/145 [02:01<01:28,  1.46s/it][A
 59%|█████▊    | 85/145 [02:02<01:25,  1.43s/it][A
 59%|█████▉    | 86/145 [02:04<01:25,  1.45s/it][A
 60%|██████    | 87/145 [02:05<01:25,  1.48s/it][A
 61%|██████    | 88/145 [02:07<01:22,  1.45s/it][A
 61%|██████▏   | 89/145 [02:08<01:21,  1.46s/it][A
 62%|██████▏   | 90/145 [02:10<01:21,  1.47s/it][A
 63%|██████▎   | 91/145 [02:11<01:19,  1.47s/it][A
 63%|██████▎   | 92/145 [02:13<01:17,  1.47s/it][A
 64%|██████▍   | 93/145 [02:14<01:15,  1.45s/it][A
 65%|██████▍   | 94/145 [02:16<01:13,  1.44s/it][A
 66%|██████▌   | 95/145 [02:17<01:12,  1.45s/it][A
 66%|██████▌   | 96/145 [02:19<01:11,  1.45s/it][A
 67%|██████▋   | 97/145 [02:20<01:10,  1.46s/it][A
 68%|██████▊   | 98/145 [02:22<01:10,  1.50s/it][A
 68%|██████▊   | 99/145 [02:23<01:07,  1.47s/it][A
 69%|██████▉   | 100/145 [02:25<01:06,  1.48s/it][A
 70%|██████▉   | 101/145 [02:26<01:05,  1.49s/it][A
 70%|███████   | 102/145 [02:28<01:03,  1.48s/it][A
 71%|███████   | 103/145 [02:29<01:02,  1.48s/it][A
 72%|███████▏  | 104/145 [02:30<01:00,  1.49s/it][A
 72%|███████▏  | 105/145 [02:32<00:59,  1.49s/it][A
 73%|███████▎  | 106/145 [02:33<00:57,  1.48s/it][A
 74%|███████▍  | 107/145 [02:35<00:54,  1.44s/it][A
 74%|███████▍  | 108/145 [02:36<00:52,  1.41s/it][A
 75%|███████▌  | 109/145 [02:38<00:51,  1.44s/it][A
 76%|███████▌  | 110/145 [02:39<00:50,  1.45s/it][A
 77%|███████▋  | 111/145 [02:40<00:48,  1.42s/it][A
 77%|███████▋  | 112/145 [02:42<00:47,  1.45s/it][A
 78%|███████▊  | 113/145 [02:43<00:46,  1.47s/it][A
 79%|███████▊  | 114/145 [02:45<00:45,  1.48s/it][A
 79%|███████▉  | 115/145 [02:46<00:44,  1.48s/it][A
 80%|████████  | 116/145 [02:48<00:41,  1.45s/it][A
 81%|████████  | 117/145 [02:49<00:40,  1.45s/it][A
 81%|████████▏ | 118/145 [02:51<00:38,  1.44s/it][A
 82%|████████▏ | 119/145 [02:52<00:36,  1.41s/it][A
 83%|████████▎ | 120/145 [02:53<00:34,  1.39s/it][A
 83%|████████▎ | 121/145 [02:55<00:33,  1.39s/it][A
 84%|████████▍ | 122/145 [02:56<00:32,  1.40s/it][A
 85%|████████▍ | 123/145 [02:58<00:31,  1.42s/it][A
 86%|████████▌ | 124/145 [02:59<00:29,  1.41s/it][A
 86%|████████▌ | 125/145 [03:01<00:29,  1.47s/it][A
 87%|████████▋ | 126/145 [03:02<00:27,  1.45s/it][A
 88%|████████▊ | 127/145 [03:04<00:25,  1.44s/it][A
 88%|████████▊ | 128/145 [03:05<00:25,  1.47s/it][A
 89%|████████▉ | 129/145 [03:06<00:23,  1.47s/it][A
 90%|████████▉ | 130/145 [03:08<00:22,  1.49s/it][A
 90%|█████████ | 131/145 [03:09<00:20,  1.45s/it][A
 91%|█████████ | 132/145 [03:11<00:19,  1.47s/it][A
 92%|█████████▏| 133/145 [03:12<00:17,  1.44s/it][A
 92%|█████████▏| 134/145 [03:14<00:16,  1.48s/it][A
 93%|█████████▎| 135/145 [03:15<00:14,  1.48s/it][A
 94%|█████████▍| 136/145 [03:17<00:13,  1.47s/it][A
 94%|█████████▍| 137/145 [03:18<00:11,  1.46s/it][A
 95%|█████████▌| 138/145 [03:20<00:10,  1.48s/it][A
 96%|█████████▌| 139/145 [03:21<00:08,  1.47s/it][A
 97%|█████████▋| 140/145 [03:23<00:07,  1.47s/it][A
 97%|█████████▋| 141/145 [03:24<00:05,  1.48s/it][A
 98%|█████████▊| 142/145 [03:26<00:04,  1.46s/it][A
 99%|█████████▊| 143/145 [03:27<00:02,  1.45s/it][A
 99%|█████████▉| 144/145 [03:29<00:01,  1.47s/it][A
100%|██████████| 145/145 [03:30<00:00,  1.44s/it][A
                                                 [A                                                      {'eval_loss': 2.8722012042999268, 'eval_runtime': 212.0135, 'eval_samples_per_second': 5.457, 'eval_steps_per_second': 0.684, 'epoch': 0.92, 'num_input_tokens_seen': 3402016}

100%|██████████| 145/145 [03:30<00:00,  1.44s/it][A  9%|▉         | 300/3250 [1:04:28<9:17:13, 11.33s/it]
                                                 [A[INFO|trainer.py:3705] 2024-10-11 05:56:31,226 >> Saving model checkpoint to /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-300
[INFO|configuration_utils.py:672] 2024-10-11 05:56:32,236 >> loading configuration file config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/config.json
[WARNING|modeling_rope_utils.py:379] 2024-10-11 05:56:32,236 >> Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
[INFO|configuration_utils.py:739] 2024-10-11 05:56:32,238 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 3584,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 18944,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 28,
  "num_hidden_layers": 28,
  "num_key_value_heads": 4,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.0",
  "use_cache": true,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "in_chans": 3,
    "model_type": "qwen2_vl",
    "spatial_patch_size": 14
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 152064
}

[INFO|tokenization_utils_base.py:2649] 2024-10-11 05:56:32,322 >> tokenizer config file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-300/tokenizer_config.json
[INFO|tokenization_utils_base.py:2658] 2024-10-11 05:56:32,322 >> Special tokens file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-300/special_tokens_map.json
[INFO|image_processing_base.py:258] 2024-10-11 05:56:32,828 >> Image processor saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-300/preprocessor_config.json
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
  9%|▉         | 301/3250 [1:04:40<61:45:18, 75.39s/it]  9%|▉         | 302/3250 [1:04:52<45:58:15, 56.14s/it]  9%|▉         | 303/3250 [1:05:03<34:57:42, 42.71s/it]  9%|▉         | 304/3250 [1:05:14<27:15:54, 33.32s/it]  9%|▉         | 305/3250 [1:05:26<21:49:58, 26.69s/it]                                                       {'loss': 2.9119, 'grad_norm': 6.05417013168335, 'learning_rate': 0.005, 'epoch': 0.94, 'num_input_tokens_seen': 3458880}
  9%|▉         | 305/3250 [1:05:26<21:49:58, 26.69s/it]  9%|▉         | 306/3250 [1:05:37<17:59:37, 22.00s/it]  9%|▉         | 307/3250 [1:05:48<15:21:19, 18.78s/it]  9%|▉         | 308/3250 [1:05:59<13:29:17, 16.50s/it] 10%|▉         | 309/3250 [1:06:11<12:13:30, 14.96s/it] 10%|▉         | 310/3250 [1:06:22<11:21:36, 13.91s/it]                                                       {'loss': 2.9565, 'grad_norm': 3.438490629196167, 'learning_rate': 0.005, 'epoch': 0.95, 'num_input_tokens_seen': 3515840}
 10%|▉         | 310/3250 [1:06:22<11:21:36, 13.91s/it] 10%|▉         | 311/3250 [1:06:33<10:42:14, 13.11s/it] 10%|▉         | 312/3250 [1:06:44<10:11:57, 12.50s/it] 10%|▉         | 313/3250 [1:06:56<9:54:08, 12.14s/it]  10%|▉         | 314/3250 [1:07:07<9:37:38, 11.80s/it] 10%|▉         | 315/3250 [1:07:17<9:22:11, 11.49s/it]                                                      {'loss': 2.8379, 'grad_norm': 8.020529747009277, 'learning_rate': 0.005, 'epoch': 0.97, 'num_input_tokens_seen': 3572768}
 10%|▉         | 315/3250 [1:07:17<9:22:11, 11.49s/it] 10%|▉         | 316/3250 [1:07:28<9:14:24, 11.34s/it] 10%|▉         | 317/3250 [1:07:39<9:07:26, 11.20s/it] 10%|▉         | 318/3250 [1:07:50<8:59:33, 11.04s/it] 10%|▉         | 319/3250 [1:08:01<8:53:21, 10.92s/it] 10%|▉         | 320/3250 [1:08:11<8:52:32, 10.91s/it]                                                      {'loss': 2.8309, 'grad_norm': 5.202187538146973, 'learning_rate': 0.005, 'epoch': 0.98, 'num_input_tokens_seen': 3629728}
 10%|▉         | 320/3250 [1:08:11<8:52:32, 10.91s/it] 10%|▉         | 321/3250 [1:08:22<8:49:18, 10.84s/it] 10%|▉         | 322/3250 [1:08:33<8:48:19, 10.83s/it] 10%|▉         | 323/3250 [1:08:43<8:40:36, 10.67s/it] 10%|▉         | 324/3250 [1:08:54<8:40:42, 10.68s/it] 10%|█         | 325/3250 [1:09:05<8:44:54, 10.77s/it]                                                      {'loss': 2.783, 'grad_norm': 3.904841423034668, 'learning_rate': 0.005, 'epoch': 1.0, 'num_input_tokens_seen': 3685920}
 10%|█         | 325/3250 [1:09:05<8:44:54, 10.77s/it] 10%|█         | 326/3250 [1:09:16<8:44:25, 10.76s/it] 10%|█         | 327/3250 [1:09:27<8:48:55, 10.86s/it] 10%|█         | 328/3250 [1:09:37<8:45:19, 10.79s/it] 10%|█         | 329/3250 [1:09:48<8:43:40, 10.76s/it] 10%|█         | 330/3250 [1:09:59<8:43:31, 10.76s/it]                                                      {'loss': 2.9367, 'grad_norm': 5.096987724304199, 'learning_rate': 0.005, 'epoch': 1.01, 'num_input_tokens_seen': 3741600}
 10%|█         | 330/3250 [1:09:59<8:43:31, 10.76s/it] 10%|█         | 331/3250 [1:10:10<8:43:02, 10.75s/it] 10%|█         | 332/3250 [1:10:20<8:42:11, 10.74s/it] 10%|█         | 333/3250 [1:10:31<8:37:39, 10.65s/it] 10%|█         | 334/3250 [1:10:42<8:40:10, 10.70s/it] 10%|█         | 335/3250 [1:10:52<8:42:22, 10.75s/it]                                                      {'loss': 2.8058, 'grad_norm': 5.702160835266113, 'learning_rate': 0.005, 'epoch': 1.03, 'num_input_tokens_seen': 3797760}
 10%|█         | 335/3250 [1:10:52<8:42:22, 10.75s/it] 10%|█         | 336/3250 [1:11:03<8:46:10, 10.83s/it] 10%|█         | 337/3250 [1:11:14<8:44:22, 10.80s/it] 10%|█         | 338/3250 [1:11:25<8:46:50, 10.86s/it] 10%|█         | 339/3250 [1:11:36<8:40:27, 10.73s/it] 10%|█         | 340/3250 [1:11:46<8:42:51, 10.78s/it]                                                      {'loss': 2.9707, 'grad_norm': 2.0657668113708496, 'learning_rate': 0.005, 'epoch': 1.04, 'num_input_tokens_seen': 3855104}
 10%|█         | 340/3250 [1:11:46<8:42:51, 10.78s/it] 10%|█         | 341/3250 [1:11:57<8:41:34, 10.76s/it] 11%|█         | 342/3250 [1:12:08<8:40:39, 10.74s/it] 11%|█         | 343/3250 [1:12:18<8:38:18, 10.70s/it] 11%|█         | 344/3250 [1:12:29<8:42:09, 10.78s/it] 11%|█         | 345/3250 [1:12:40<8:43:42, 10.82s/it]                                                      {'loss': 2.9003, 'grad_norm': 5.96263313293457, 'learning_rate': 0.005, 'epoch': 1.06, 'num_input_tokens_seen': 3912352}
 11%|█         | 345/3250 [1:12:40<8:43:42, 10.82s/it] 11%|█         | 346/3250 [1:12:51<8:41:29, 10.77s/it] 11%|█         | 347/3250 [1:13:02<8:39:35, 10.74s/it] 11%|█         | 348/3250 [1:13:12<8:37:56, 10.71s/it] 11%|█         | 349/3250 [1:13:23<8:36:16, 10.68s/it] 11%|█         | 350/3250 [1:13:34<8:36:14, 10.68s/it]                                                      {'loss': 2.8028, 'grad_norm': 4.081557273864746, 'learning_rate': 0.005, 'epoch': 1.08, 'num_input_tokens_seen': 3968832}
 11%|█         | 350/3250 [1:13:34<8:36:14, 10.68s/it] 11%|█         | 351/3250 [1:13:44<8:34:23, 10.65s/it] 11%|█         | 352/3250 [1:13:55<8:37:00, 10.70s/it] 11%|█         | 353/3250 [1:14:06<8:38:30, 10.74s/it] 11%|█         | 354/3250 [1:14:17<8:49:41, 10.97s/it] 11%|█         | 355/3250 [1:14:29<8:57:29, 11.14s/it]                                                      {'loss': 2.8874, 'grad_norm': 4.614131927490234, 'learning_rate': 0.005, 'epoch': 1.09, 'num_input_tokens_seen': 4026720}
 11%|█         | 355/3250 [1:14:29<8:57:29, 11.14s/it] 11%|█         | 356/3250 [1:14:40<8:53:16, 11.06s/it] 11%|█         | 357/3250 [1:14:51<8:57:16, 11.14s/it] 11%|█         | 358/3250 [1:15:02<8:56:07, 11.12s/it] 11%|█         | 359/3250 [1:15:14<9:00:19, 11.21s/it] 11%|█         | 360/3250 [1:15:25<9:00:15, 11.22s/it]                                                      {'loss': 2.8287, 'grad_norm': 6.236418724060059, 'learning_rate': 0.005, 'epoch': 1.11, 'num_input_tokens_seen': 4083040}
 11%|█         | 360/3250 [1:15:25<9:00:15, 11.22s/it] 11%|█         | 361/3250 [1:15:36<9:02:13, 11.26s/it] 11%|█         | 362/3250 [1:15:47<9:01:14, 11.24s/it] 11%|█         | 363/3250 [1:15:59<9:01:58, 11.26s/it] 11%|█         | 364/3250 [1:16:10<9:03:36, 11.30s/it] 11%|█         | 365/3250 [1:16:21<9:03:37, 11.31s/it]                                                      {'loss': 2.8221, 'grad_norm': 4.0664896965026855, 'learning_rate': 0.005, 'epoch': 1.12, 'num_input_tokens_seen': 4140448}
 11%|█         | 365/3250 [1:16:21<9:03:37, 11.31s/it] 11%|█▏        | 366/3250 [1:16:33<9:03:43, 11.31s/it] 11%|█▏        | 367/3250 [1:16:44<9:03:24, 11.31s/it] 11%|█▏        | 368/3250 [1:16:55<9:04:12, 11.33s/it] 11%|█▏        | 369/3250 [1:17:07<9:02:41, 11.30s/it] 11%|█▏        | 370/3250 [1:17:18<9:02:54, 11.31s/it]                                                      {'loss': 2.9179, 'grad_norm': 3.3263168334960938, 'learning_rate': 0.005, 'epoch': 1.14, 'num_input_tokens_seen': 4197600}
 11%|█▏        | 370/3250 [1:17:18<9:02:54, 11.31s/it] 11%|█▏        | 371/3250 [1:17:29<9:04:19, 11.34s/it] 11%|█▏        | 372/3250 [1:17:41<9:07:38, 11.42s/it] 11%|█▏        | 373/3250 [1:17:52<9:03:17, 11.33s/it] 12%|█▏        | 374/3250 [1:18:03<9:02:34, 11.32s/it] 12%|█▏        | 375/3250 [1:18:15<9:01:15, 11.30s/it]                                                      {'loss': 2.8889, 'grad_norm': 5.786472797393799, 'learning_rate': 0.005, 'epoch': 1.15, 'num_input_tokens_seen': 4254304}
 12%|█▏        | 375/3250 [1:18:15<9:01:15, 11.30s/it] 12%|█▏        | 376/3250 [1:18:26<9:02:42, 11.33s/it] 12%|█▏        | 377/3250 [1:18:37<9:01:57, 11.32s/it] 12%|█▏        | 378/3250 [1:18:49<9:02:40, 11.34s/it] 12%|█▏        | 379/3250 [1:19:00<9:03:08, 11.35s/it] 12%|█▏        | 380/3250 [1:19:12<9:04:47, 11.39s/it]                                                      {'loss': 2.8283, 'grad_norm': 5.990976333618164, 'learning_rate': 0.005, 'epoch': 1.17, 'num_input_tokens_seen': 4312032}
 12%|█▏        | 380/3250 [1:19:12<9:04:47, 11.39s/it] 12%|█▏        | 381/3250 [1:19:23<9:02:20, 11.34s/it] 12%|█▏        | 382/3250 [1:19:34<9:03:40, 11.37s/it] 12%|█▏        | 383/3250 [1:19:46<9:05:26, 11.41s/it] 12%|█▏        | 384/3250 [1:19:57<9:03:19, 11.37s/it] 12%|█▏        | 385/3250 [1:20:08<9:02:40, 11.37s/it]                                                      {'loss': 2.8796, 'grad_norm': 4.110696792602539, 'learning_rate': 0.005, 'epoch': 1.18, 'num_input_tokens_seen': 4368928}
 12%|█▏        | 385/3250 [1:20:08<9:02:40, 11.37s/it] 12%|█▏        | 386/3250 [1:20:20<9:01:03, 11.33s/it] 12%|█▏        | 387/3250 [1:20:31<9:03:50, 11.40s/it] 12%|█▏        | 388/3250 [1:20:42<9:00:16, 11.33s/it] 12%|█▏        | 389/3250 [1:20:54<9:00:28, 11.33s/it] 12%|█▏        | 390/3250 [1:21:05<8:58:27, 11.30s/it]                                                      {'loss': 2.7962, 'grad_norm': 4.909804821014404, 'learning_rate': 0.005, 'epoch': 1.2, 'num_input_tokens_seen': 4425984}
 12%|█▏        | 390/3250 [1:21:05<8:58:27, 11.30s/it] 12%|█▏        | 391/3250 [1:21:16<8:51:41, 11.16s/it] 12%|█▏        | 392/3250 [1:21:27<8:55:42, 11.25s/it] 12%|█▏        | 393/3250 [1:21:38<8:54:47, 11.23s/it] 12%|█▏        | 394/3250 [1:21:50<8:55:13, 11.24s/it] 12%|█▏        | 395/3250 [1:22:01<8:54:28, 11.23s/it]                                                      {'loss': 2.9626, 'grad_norm': 3.2525389194488525, 'learning_rate': 0.005, 'epoch': 1.21, 'num_input_tokens_seen': 4482080}
 12%|█▏        | 395/3250 [1:22:01<8:54:28, 11.23s/it] 12%|█▏        | 396/3250 [1:22:12<8:51:43, 11.18s/it] 12%|█▏        | 397/3250 [1:22:23<8:49:49, 11.14s/it] 12%|█▏        | 398/3250 [1:22:34<8:53:56, 11.23s/it] 12%|█▏        | 399/3250 [1:22:46<8:54:13, 11.24s/it] 12%|█▏        | 400/3250 [1:22:57<8:57:43, 11.32s/it]                                                      {'loss': 2.8041, 'grad_norm': 2.6430513858795166, 'learning_rate': 0.005, 'epoch': 1.23, 'num_input_tokens_seen': 4538016}
 12%|█▏        | 400/3250 [1:22:57<8:57:43, 11.32s/it][INFO|trainer.py:4021] 2024-10-11 06:15:00,827 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-10-11 06:15:00,827 >>   Num examples = 1157
[INFO|trainer.py:4026] 2024-10-11 06:15:00,827 >>   Batch size = 4

  0%|          | 0/145 [00:00<?, ?it/s][A
  1%|▏         | 2/145 [00:01<01:44,  1.37it/s][A
  2%|▏         | 3/145 [00:02<02:30,  1.06s/it][A
  3%|▎         | 4/145 [00:04<02:49,  1.20s/it][A
  3%|▎         | 5/145 [00:05<02:55,  1.25s/it][A
  4%|▍         | 6/145 [00:07<03:04,  1.33s/it][A
  5%|▍         | 7/145 [00:08<03:11,  1.39s/it][A
  6%|▌         | 8/145 [00:10<03:09,  1.38s/it][A
  6%|▌         | 9/145 [00:11<03:08,  1.39s/it][A
  7%|▋         | 10/145 [00:12<03:10,  1.41s/it][A
  8%|▊         | 11/145 [00:14<03:11,  1.43s/it][A
  8%|▊         | 12/145 [00:15<03:13,  1.45s/it][A
  9%|▉         | 13/145 [00:17<03:14,  1.47s/it][A
 10%|▉         | 14/145 [00:19<03:15,  1.49s/it][A
 10%|█         | 15/145 [00:20<03:11,  1.47s/it][A
 11%|█         | 16/145 [00:21<03:09,  1.47s/it][A
 12%|█▏        | 17/145 [00:23<03:07,  1.47s/it][A
 12%|█▏        | 18/145 [00:24<03:07,  1.47s/it][A
 13%|█▎        | 19/145 [00:26<03:06,  1.48s/it][A
 14%|█▍        | 20/145 [00:27<03:04,  1.48s/it][A
 14%|█▍        | 21/145 [00:29<03:00,  1.46s/it][A
 15%|█▌        | 22/145 [00:30<02:57,  1.45s/it][A
 16%|█▌        | 23/145 [00:32<02:55,  1.44s/it][A
 17%|█▋        | 24/145 [00:33<02:55,  1.45s/it][A
 17%|█▋        | 25/145 [00:35<02:54,  1.45s/it][A
 18%|█▊        | 26/145 [00:36<02:51,  1.45s/it][A
 19%|█▊        | 27/145 [00:37<02:51,  1.45s/it][A
 19%|█▉        | 28/145 [00:39<02:48,  1.44s/it][A
 20%|██        | 29/145 [00:40<02:47,  1.44s/it][A
 21%|██        | 30/145 [00:42<02:42,  1.41s/it][A
 21%|██▏       | 31/145 [00:43<02:43,  1.43s/it][A
 22%|██▏       | 32/145 [00:45<02:42,  1.44s/it][A
 23%|██▎       | 33/145 [00:46<02:41,  1.45s/it][A
 23%|██▎       | 34/145 [00:47<02:41,  1.45s/it][A
 24%|██▍       | 35/145 [00:49<02:40,  1.46s/it][A
 25%|██▍       | 36/145 [00:50<02:38,  1.45s/it][A
 26%|██▌       | 37/145 [00:52<02:40,  1.49s/it][A
 26%|██▌       | 38/145 [00:53<02:39,  1.49s/it][A
 27%|██▋       | 39/145 [00:55<02:36,  1.48s/it][A
 28%|██▊       | 40/145 [00:56<02:34,  1.47s/it][A
 28%|██▊       | 41/145 [00:58<02:35,  1.49s/it][A
 29%|██▉       | 42/145 [00:59<02:33,  1.49s/it][A
 30%|██▉       | 43/145 [01:01<02:30,  1.48s/it][A
 30%|███       | 44/145 [01:02<02:31,  1.50s/it][A
 31%|███       | 45/145 [01:04<02:31,  1.51s/it][A
 32%|███▏      | 46/145 [01:05<02:27,  1.49s/it][A
 32%|███▏      | 47/145 [01:07<02:23,  1.47s/it][A
 33%|███▎      | 48/145 [01:08<02:22,  1.47s/it][A
 34%|███▍      | 49/145 [01:10<02:22,  1.48s/it][A
 34%|███▍      | 50/145 [01:11<02:21,  1.49s/it][A
 35%|███▌      | 51/145 [01:13<02:19,  1.49s/it][A
 36%|███▌      | 52/145 [01:14<02:18,  1.48s/it][A
 37%|███▋      | 53/145 [01:16<02:16,  1.48s/it][A
 37%|███▋      | 54/145 [01:17<02:15,  1.49s/it][A
 38%|███▊      | 55/145 [01:19<02:12,  1.48s/it][A
 39%|███▊      | 56/145 [01:20<02:11,  1.47s/it][A
 39%|███▉      | 57/145 [01:22<02:08,  1.46s/it][A
 40%|████      | 58/145 [01:23<02:06,  1.45s/it][A
 41%|████      | 59/145 [01:25<02:07,  1.48s/it][A
 41%|████▏     | 60/145 [01:26<02:05,  1.47s/it][A
 42%|████▏     | 61/145 [01:27<02:03,  1.47s/it][A
 43%|████▎     | 62/145 [01:29<02:00,  1.45s/it][A
 43%|████▎     | 63/145 [01:30<02:00,  1.47s/it][A
 44%|████▍     | 64/145 [01:32<01:58,  1.47s/it][A
 45%|████▍     | 65/145 [01:33<01:58,  1.48s/it][A
 46%|████▌     | 66/145 [01:35<01:56,  1.47s/it][A
 46%|████▌     | 67/145 [01:36<01:54,  1.46s/it][A
 47%|████▋     | 68/145 [01:38<01:54,  1.49s/it][A
 48%|████▊     | 69/145 [01:39<01:53,  1.50s/it][A
 48%|████▊     | 70/145 [01:41<01:48,  1.45s/it][A
 49%|████▉     | 71/145 [01:42<01:46,  1.44s/it][A
 50%|████▉     | 72/145 [01:44<01:46,  1.46s/it][A
 50%|█████     | 73/145 [01:45<01:46,  1.48s/it][A
 51%|█████     | 74/145 [01:47<01:45,  1.49s/it][A
 52%|█████▏    | 75/145 [01:48<01:44,  1.49s/it][A
 52%|█████▏    | 76/145 [01:50<01:42,  1.48s/it][A
 53%|█████▎    | 77/145 [01:51<01:38,  1.45s/it][A
 54%|█████▍    | 78/145 [01:52<01:37,  1.46s/it][A
 54%|█████▍    | 79/145 [01:54<01:35,  1.44s/it][A
 55%|█████▌    | 80/145 [01:55<01:33,  1.44s/it][A
 56%|█████▌    | 81/145 [01:57<01:30,  1.42s/it][A
 57%|█████▋    | 82/145 [01:58<01:30,  1.44s/it][A
 57%|█████▋    | 83/145 [02:00<01:29,  1.45s/it][A
 58%|█████▊    | 84/145 [02:01<01:29,  1.46s/it][A
 59%|█████▊    | 85/145 [02:02<01:26,  1.44s/it][A
 59%|█████▉    | 86/145 [02:04<01:25,  1.45s/it][A
 60%|██████    | 87/145 [02:05<01:25,  1.48s/it][A
 61%|██████    | 88/145 [02:07<01:23,  1.46s/it][A
 61%|██████▏   | 89/145 [02:08<01:21,  1.46s/it][A
 62%|██████▏   | 90/145 [02:10<01:21,  1.47s/it][A
 63%|██████▎   | 91/145 [02:11<01:19,  1.47s/it][A
 63%|██████▎   | 92/145 [02:13<01:17,  1.46s/it][A
 64%|██████▍   | 93/145 [02:14<01:15,  1.45s/it][A
 65%|██████▍   | 94/145 [02:16<01:13,  1.44s/it][A
 66%|██████▌   | 95/145 [02:17<01:12,  1.44s/it][A
 66%|██████▌   | 96/145 [02:19<01:11,  1.45s/it][A
 67%|██████▋   | 97/145 [02:20<01:10,  1.46s/it][A
 68%|██████▊   | 98/145 [02:22<01:10,  1.49s/it][A
 68%|██████▊   | 99/145 [02:23<01:07,  1.47s/it][A
 69%|██████▉   | 100/145 [02:24<01:06,  1.48s/it][A
 70%|██████▉   | 101/145 [02:26<01:05,  1.49s/it][A
 70%|███████   | 102/145 [02:27<01:03,  1.48s/it][A
 71%|███████   | 103/145 [02:29<01:01,  1.48s/it][A
 72%|███████▏  | 104/145 [02:30<01:00,  1.48s/it][A
 72%|███████▏  | 105/145 [02:32<00:59,  1.48s/it][A
 73%|███████▎  | 106/145 [02:33<00:57,  1.48s/it][A
 74%|███████▍  | 107/145 [02:35<00:54,  1.43s/it][A
 74%|███████▍  | 108/145 [02:36<00:52,  1.41s/it][A
 75%|███████▌  | 109/145 [02:38<00:51,  1.43s/it][A
 76%|███████▌  | 110/145 [02:39<00:50,  1.45s/it][A
 77%|███████▋  | 111/145 [02:40<00:48,  1.42s/it][A
 77%|███████▋  | 112/145 [02:42<00:47,  1.45s/it][A
 78%|███████▊  | 113/145 [02:43<00:46,  1.47s/it][A
 79%|███████▊  | 114/145 [02:45<00:45,  1.48s/it][A
 79%|███████▉  | 115/145 [02:46<00:44,  1.47s/it][A
 80%|████████  | 116/145 [02:48<00:41,  1.45s/it][A
 81%|████████  | 117/145 [02:49<00:40,  1.45s/it][A
 81%|████████▏ | 118/145 [02:51<00:38,  1.44s/it][A
 82%|████████▏ | 119/145 [02:52<00:36,  1.41s/it][A
 83%|████████▎ | 120/145 [02:53<00:34,  1.39s/it][A
 83%|████████▎ | 121/145 [02:55<00:33,  1.39s/it][A
 84%|████████▍ | 122/145 [02:56<00:32,  1.41s/it][A
 85%|████████▍ | 123/145 [02:58<00:31,  1.42s/it][A
 86%|████████▌ | 124/145 [02:59<00:29,  1.41s/it][A
 86%|████████▌ | 125/145 [03:01<00:29,  1.47s/it][A
 87%|████████▋ | 126/145 [03:02<00:27,  1.45s/it][A
 88%|████████▊ | 127/145 [03:03<00:25,  1.44s/it][A
 88%|████████▊ | 128/145 [03:05<00:25,  1.47s/it][A
 89%|████████▉ | 129/145 [03:06<00:23,  1.47s/it][A
 90%|████████▉ | 130/145 [03:08<00:22,  1.50s/it][A
 90%|█████████ | 131/145 [03:09<00:20,  1.45s/it][A
 91%|█████████ | 132/145 [03:11<00:19,  1.47s/it][A
 92%|█████████▏| 133/145 [03:12<00:17,  1.44s/it][A
 92%|█████████▏| 134/145 [03:14<00:16,  1.47s/it][A
 93%|█████████▎| 135/145 [03:15<00:14,  1.48s/it][A
 94%|█████████▍| 136/145 [03:17<00:13,  1.47s/it][A
 94%|█████████▍| 137/145 [03:18<00:11,  1.46s/it][A
 95%|█████████▌| 138/145 [03:20<00:10,  1.47s/it][A
 96%|█████████▌| 139/145 [03:21<00:08,  1.47s/it][A
 97%|█████████▋| 140/145 [03:23<00:07,  1.47s/it][A
 97%|█████████▋| 141/145 [03:24<00:05,  1.48s/it][A
 98%|█████████▊| 142/145 [03:26<00:04,  1.46s/it][A
 99%|█████████▊| 143/145 [03:27<00:02,  1.46s/it][A
 99%|█████████▉| 144/145 [03:28<00:01,  1.47s/it][A
100%|██████████| 145/145 [03:30<00:00,  1.44s/it][A
                                                 [A                                                      {'eval_loss': 2.8965282440185547, 'eval_runtime': 211.9287, 'eval_samples_per_second': 5.459, 'eval_steps_per_second': 0.684, 'epoch': 1.23, 'num_input_tokens_seen': 4538016}

100%|██████████| 145/145 [03:30<00:00,  1.44s/it][A 12%|█▏        | 400/3250 [1:26:29<8:57:43, 11.32s/it]
                                                 [A[INFO|trainer.py:3705] 2024-10-11 06:18:32,758 >> Saving model checkpoint to /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-400
[INFO|configuration_utils.py:672] 2024-10-11 06:18:34,565 >> loading configuration file config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/config.json
[WARNING|modeling_rope_utils.py:379] 2024-10-11 06:18:34,566 >> Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
[INFO|configuration_utils.py:739] 2024-10-11 06:18:34,568 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 3584,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 18944,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 28,
  "num_hidden_layers": 28,
  "num_key_value_heads": 4,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.0",
  "use_cache": true,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "in_chans": 3,
    "model_type": "qwen2_vl",
    "spatial_patch_size": 14
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 152064
}

[INFO|tokenization_utils_base.py:2649] 2024-10-11 06:18:34,646 >> tokenizer config file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-400/tokenizer_config.json
[INFO|tokenization_utils_base.py:2658] 2024-10-11 06:18:34,646 >> Special tokens file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-400/special_tokens_map.json
[INFO|image_processing_base.py:258] 2024-10-11 06:18:35,154 >> Image processor saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-400/preprocessor_config.json
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 12%|█▏        | 401/3250 [1:26:43<59:49:45, 75.60s/it] 12%|█▏        | 402/3250 [1:26:54<44:34:28, 56.34s/it] 12%|█▏        | 403/3250 [1:27:06<33:56:03, 42.91s/it] 12%|█▏        | 404/3250 [1:27:17<26:23:07, 33.38s/it] 12%|█▏        | 405/3250 [1:27:28<21:11:50, 26.82s/it]                                                       {'loss': 2.871, 'grad_norm': 5.103928565979004, 'learning_rate': 0.005, 'epoch': 1.24, 'num_input_tokens_seen': 4595424}
 12%|█▏        | 405/3250 [1:27:28<21:11:50, 26.82s/it] 12%|█▏        | 406/3250 [1:27:40<17:31:03, 22.17s/it] 13%|█▎        | 407/3250 [1:27:51<14:58:38, 18.97s/it] 13%|█▎        | 408/3250 [1:28:03<13:13:06, 16.74s/it] 13%|█▎        | 409/3250 [1:28:14<11:54:00, 15.08s/it] 13%|█▎        | 410/3250 [1:28:25<11:02:33, 14.00s/it]                                                       {'loss': 2.8492, 'grad_norm': 2.228360891342163, 'learning_rate': 0.005, 'epoch': 1.26, 'num_input_tokens_seen': 4652448}
 13%|█▎        | 410/3250 [1:28:25<11:02:33, 14.00s/it] 13%|█▎        | 411/3250 [1:28:37<10:25:47, 13.23s/it] 13%|█▎        | 412/3250 [1:28:48<9:59:18, 12.67s/it]  13%|█▎        | 413/3250 [1:28:59<9:36:30, 12.19s/it] 13%|█▎        | 414/3250 [1:29:11<9:26:00, 11.97s/it] 13%|█▎        | 415/3250 [1:29:22<9:13:44, 11.72s/it]                                                      {'loss': 2.7924, 'grad_norm': 1.89191472530365, 'learning_rate': 0.005, 'epoch': 1.27, 'num_input_tokens_seen': 4708960}
 13%|█▎        | 415/3250 [1:29:22<9:13:44, 11.72s/it] 13%|█▎        | 416/3250 [1:29:33<9:10:33, 11.66s/it] 13%|█▎        | 417/3250 [1:29:45<9:04:24, 11.53s/it] 13%|█▎        | 418/3250 [1:29:56<9:02:22, 11.49s/it] 13%|█▎        | 419/3250 [1:30:07<8:57:12, 11.39s/it] 13%|█▎        | 420/3250 [1:30:18<8:54:29, 11.33s/it]                                                      {'loss': 2.8342, 'grad_norm': 1.790557861328125, 'learning_rate': 0.005, 'epoch': 1.29, 'num_input_tokens_seen': 4765504}
 13%|█▎        | 420/3250 [1:30:18<8:54:29, 11.33s/it] 13%|█▎        | 421/3250 [1:30:30<8:52:56, 11.30s/it] 13%|█▎        | 422/3250 [1:30:41<8:52:29, 11.30s/it] 13%|█▎        | 423/3250 [1:30:52<8:53:51, 11.33s/it] 13%|█▎        | 424/3250 [1:31:04<8:54:50, 11.36s/it] 13%|█▎        | 425/3250 [1:31:15<8:54:40, 11.36s/it]                                                      {'loss': 2.6762, 'grad_norm': 1.5629661083221436, 'learning_rate': 0.005, 'epoch': 1.31, 'num_input_tokens_seen': 4822656}
 13%|█▎        | 425/3250 [1:31:15<8:54:40, 11.36s/it] 13%|█▎        | 426/3250 [1:31:27<8:56:09, 11.39s/it] 13%|█▎        | 427/3250 [1:31:38<8:57:37, 11.43s/it] 13%|█▎        | 428/3250 [1:31:49<8:55:08, 11.38s/it] 13%|█▎        | 429/3250 [1:32:01<8:55:32, 11.39s/it] 13%|█▎        | 430/3250 [1:32:12<8:57:15, 11.43s/it]                                                      {'loss': 2.5852, 'grad_norm': 3.5897388458251953, 'learning_rate': 0.005, 'epoch': 1.32, 'num_input_tokens_seen': 4880608}
 13%|█▎        | 430/3250 [1:32:12<8:57:15, 11.43s/it] 13%|█▎        | 431/3250 [1:32:24<8:56:08, 11.41s/it] 13%|█▎        | 432/3250 [1:32:35<8:54:50, 11.39s/it] 13%|█▎        | 433/3250 [1:32:47<9:01:54, 11.54s/it] 13%|█▎        | 434/3250 [1:32:59<9:13:43, 11.80s/it] 13%|█▎        | 435/3250 [1:33:11<9:10:01, 11.72s/it]                                                      {'loss': 2.3807, 'grad_norm': 8.545207023620605, 'learning_rate': 0.005, 'epoch': 1.34, 'num_input_tokens_seen': 4936128}
 13%|█▎        | 435/3250 [1:33:11<9:10:01, 11.72s/it] 13%|█▎        | 436/3250 [1:33:23<9:16:54, 11.87s/it] 13%|█▎        | 437/3250 [1:33:35<9:16:35, 11.87s/it] 13%|█▎        | 438/3250 [1:33:48<9:25:53, 12.07s/it] 14%|█▎        | 439/3250 [1:34:00<9:30:35, 12.18s/it] 14%|█▎        | 440/3250 [1:34:12<9:30:48, 12.19s/it]                                                      {'loss': 2.7536, 'grad_norm': 4.34515905380249, 'learning_rate': 0.005, 'epoch': 1.35, 'num_input_tokens_seen': 4993248}
 14%|█▎        | 440/3250 [1:34:12<9:30:48, 12.19s/it] 14%|█▎        | 441/3250 [1:34:25<9:35:56, 12.30s/it] 14%|█▎        | 442/3250 [1:34:37<9:33:00, 12.24s/it] 14%|█▎        | 443/3250 [1:34:49<9:36:44, 12.33s/it] 14%|█▎        | 444/3250 [1:35:01<9:32:00, 12.23s/it] 14%|█▎        | 445/3250 [1:35:13<9:27:32, 12.14s/it]                                                      {'loss': 3.0454, 'grad_norm': 12.56766128540039, 'learning_rate': 0.005, 'epoch': 1.37, 'num_input_tokens_seen': 5049728}
 14%|█▎        | 445/3250 [1:35:13<9:27:32, 12.14s/it] 14%|█▎        | 446/3250 [1:35:25<9:25:26, 12.10s/it] 14%|█▍        | 447/3250 [1:35:37<9:16:52, 11.92s/it] 14%|█▍        | 448/3250 [1:35:49<9:16:25, 11.91s/it] 14%|█▍        | 449/3250 [1:36:00<9:14:18, 11.87s/it] 14%|█▍        | 450/3250 [1:36:12<9:11:50, 11.83s/it]                                                      {'loss': 2.579, 'grad_norm': 1.828765630722046, 'learning_rate': 0.005, 'epoch': 1.38, 'num_input_tokens_seen': 5106816}
 14%|█▍        | 450/3250 [1:36:12<9:11:50, 11.83s/it] 14%|█▍        | 451/3250 [1:36:24<9:06:28, 11.71s/it] 14%|█▍        | 452/3250 [1:36:35<9:03:18, 11.65s/it] 14%|█▍        | 453/3250 [1:36:46<8:57:23, 11.53s/it] 14%|█▍        | 454/3250 [1:36:58<8:57:31, 11.54s/it] 14%|█▍        | 455/3250 [1:37:10<8:59:20, 11.58s/it]                                                      {'loss': 2.5317, 'grad_norm': 4.11485481262207, 'learning_rate': 0.005, 'epoch': 1.4, 'num_input_tokens_seen': 5163232}
 14%|█▍        | 455/3250 [1:37:10<8:59:20, 11.58s/it] 14%|█▍        | 456/3250 [1:37:21<9:00:41, 11.61s/it] 14%|█▍        | 457/3250 [1:37:33<9:01:19, 11.63s/it] 14%|█▍        | 458/3250 [1:37:45<9:00:29, 11.62s/it] 14%|█▍        | 459/3250 [1:37:56<8:57:33, 11.56s/it] 14%|█▍        | 460/3250 [1:38:08<8:59:05, 11.59s/it]                                                      {'loss': 2.3823, 'grad_norm': 2.505568742752075, 'learning_rate': 0.005, 'epoch': 1.41, 'num_input_tokens_seen': 5220736}
 14%|█▍        | 460/3250 [1:38:08<8:59:05, 11.59s/it] 14%|█▍        | 461/3250 [1:38:19<9:00:31, 11.63s/it] 14%|█▍        | 462/3250 [1:38:31<8:54:13, 11.50s/it] 14%|█▍        | 463/3250 [1:38:42<8:57:39, 11.58s/it] 14%|█▍        | 464/3250 [1:38:54<8:58:45, 11.60s/it] 14%|█▍        | 465/3250 [1:39:06<9:00:37, 11.65s/it]                                                      {'loss': 2.367, 'grad_norm': 1.4829663038253784, 'learning_rate': 0.005, 'epoch': 1.43, 'num_input_tokens_seen': 5277312}
 14%|█▍        | 465/3250 [1:39:06<9:00:37, 11.65s/it] 14%|█▍        | 466/3250 [1:39:17<9:00:26, 11.65s/it] 14%|█▍        | 467/3250 [1:39:29<9:01:24, 11.67s/it] 14%|█▍        | 468/3250 [1:39:40<8:57:01, 11.58s/it] 14%|█▍        | 469/3250 [1:39:52<9:02:02, 11.69s/it] 14%|█▍        | 470/3250 [1:40:04<9:03:35, 11.73s/it]                                                      {'loss': 2.3256, 'grad_norm': 2.938584089279175, 'learning_rate': 0.005, 'epoch': 1.44, 'num_input_tokens_seen': 5333664}
 14%|█▍        | 470/3250 [1:40:04<9:03:35, 11.73s/it] 14%|█▍        | 471/3250 [1:40:16<9:04:21, 11.75s/it] 15%|█▍        | 472/3250 [1:40:28<9:08:04, 11.84s/it] 15%|█▍        | 473/3250 [1:40:40<9:05:25, 11.78s/it] 15%|█▍        | 474/3250 [1:40:51<9:04:35, 11.77s/it] 15%|█▍        | 475/3250 [1:41:03<9:03:37, 11.75s/it]                                                      {'loss': 2.2997, 'grad_norm': 2.284574508666992, 'learning_rate': 0.005, 'epoch': 1.46, 'num_input_tokens_seen': 5390464}
 15%|█▍        | 475/3250 [1:41:03<9:03:37, 11.75s/it] 15%|█▍        | 476/3250 [1:41:15<9:06:13, 11.81s/it] 15%|█▍        | 477/3250 [1:41:27<9:04:58, 11.79s/it] 15%|█▍        | 478/3250 [1:41:39<9:04:57, 11.80s/it] 15%|█▍        | 479/3250 [1:41:50<9:04:33, 11.79s/it] 15%|█▍        | 480/3250 [1:42:02<9:03:06, 11.76s/it]                                                      {'loss': 2.3189, 'grad_norm': 2.1025466918945312, 'learning_rate': 0.005, 'epoch': 1.47, 'num_input_tokens_seen': 5448928}
 15%|█▍        | 480/3250 [1:42:02<9:03:06, 11.76s/it] 15%|█▍        | 481/3250 [1:42:14<9:00:43, 11.72s/it] 15%|█▍        | 482/3250 [1:42:25<8:55:05, 11.60s/it] 15%|█▍        | 483/3250 [1:42:37<8:57:22, 11.65s/it] 15%|█▍        | 484/3250 [1:42:49<8:57:12, 11.65s/it] 15%|█▍        | 485/3250 [1:43:00<8:55:06, 11.61s/it]                                                      {'loss': 2.315, 'grad_norm': 2.356096029281616, 'learning_rate': 0.005, 'epoch': 1.49, 'num_input_tokens_seen': 5505152}
 15%|█▍        | 485/3250 [1:43:00<8:55:06, 11.61s/it] 15%|█▍        | 486/3250 [1:43:11<8:50:32, 11.52s/it] 15%|█▍        | 487/3250 [1:43:23<8:51:20, 11.54s/it] 15%|█▌        | 488/3250 [1:43:35<8:53:20, 11.59s/it] 15%|█▌        | 489/3250 [1:43:46<8:48:54, 11.49s/it] 15%|█▌        | 490/3250 [1:43:58<8:50:58, 11.54s/it]                                                      {'loss': 2.361, 'grad_norm': 1.4640672206878662, 'learning_rate': 0.005, 'epoch': 1.51, 'num_input_tokens_seen': 5560032}
 15%|█▌        | 490/3250 [1:43:58<8:50:58, 11.54s/it] 15%|█▌        | 491/3250 [1:44:09<8:50:46, 11.54s/it] 15%|█▌        | 492/3250 [1:44:20<8:45:36, 11.43s/it] 15%|█▌        | 493/3250 [1:44:32<8:48:03, 11.49s/it] 15%|█▌        | 494/3250 [1:44:44<8:52:46, 11.60s/it] 15%|█▌        | 495/3250 [1:44:56<8:54:42, 11.65s/it]                                                      {'loss': 2.4101, 'grad_norm': 2.3433477878570557, 'learning_rate': 0.005, 'epoch': 1.52, 'num_input_tokens_seen': 5615680}
 15%|█▌        | 495/3250 [1:44:56<8:54:42, 11.65s/it] 15%|█▌        | 496/3250 [1:45:07<8:56:16, 11.68s/it] 15%|█▌        | 497/3250 [1:45:19<8:53:55, 11.64s/it] 15%|█▌        | 498/3250 [1:45:31<8:55:36, 11.68s/it] 15%|█▌        | 499/3250 [1:45:42<8:55:59, 11.69s/it] 15%|█▌        | 500/3250 [1:45:54<8:56:36, 11.71s/it]                                                      {'loss': 2.3393, 'grad_norm': 3.565561056137085, 'learning_rate': 0.005, 'epoch': 1.54, 'num_input_tokens_seen': 5672864}
 15%|█▌        | 500/3250 [1:45:54<8:56:36, 11.71s/it][INFO|trainer.py:4021] 2024-10-11 06:37:57,678 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-10-11 06:37:57,679 >>   Num examples = 1157
[INFO|trainer.py:4026] 2024-10-11 06:37:57,679 >>   Batch size = 4

  0%|          | 0/145 [00:00<?, ?it/s][A
  1%|▏         | 2/145 [00:01<01:47,  1.33it/s][A
  2%|▏         | 3/145 [00:03<02:34,  1.09s/it][A
  3%|▎         | 4/145 [00:04<02:54,  1.24s/it][A
  3%|▎         | 5/145 [00:05<03:00,  1.29s/it][A
  4%|▍         | 6/145 [00:07<03:10,  1.37s/it][A
  5%|▍         | 7/145 [00:09<03:16,  1.42s/it][A
  6%|▌         | 8/145 [00:10<03:14,  1.42s/it][A
  6%|▌         | 9/145 [00:11<03:14,  1.43s/it][A
  7%|▋         | 10/145 [00:13<03:15,  1.45s/it][A
  8%|▊         | 11/145 [00:14<03:16,  1.47s/it][A
  8%|▊         | 12/145 [00:16<03:19,  1.50s/it][A
  9%|▉         | 13/145 [00:17<03:20,  1.52s/it][A
 10%|▉         | 14/145 [00:19<03:20,  1.53s/it][A
 10%|█         | 15/145 [00:21<03:17,  1.52s/it][A
 11%|█         | 16/145 [00:22<03:14,  1.51s/it][A
 12%|█▏        | 17/145 [00:24<03:13,  1.51s/it][A
 12%|█▏        | 18/145 [00:25<03:12,  1.52s/it][A
 13%|█▎        | 19/145 [00:27<03:11,  1.52s/it][A
 14%|█▍        | 20/145 [00:28<03:09,  1.52s/it][A
 14%|█▍        | 21/145 [00:30<03:05,  1.50s/it][A
 15%|█▌        | 22/145 [00:31<03:02,  1.49s/it][A
 16%|█▌        | 23/145 [00:33<03:01,  1.48s/it][A
 17%|█▋        | 24/145 [00:34<03:00,  1.49s/it][A
 17%|█▋        | 25/145 [00:36<02:58,  1.49s/it][A
 18%|█▊        | 26/145 [00:37<02:56,  1.48s/it][A
 19%|█▊        | 27/145 [00:39<02:56,  1.49s/it][A
 19%|█▉        | 28/145 [00:40<02:53,  1.49s/it][A
 20%|██        | 29/145 [00:41<02:52,  1.49s/it][A
 21%|██        | 30/145 [00:43<02:47,  1.45s/it][A
 21%|██▏       | 31/145 [00:44<02:47,  1.47s/it][A
 22%|██▏       | 32/145 [00:46<02:47,  1.48s/it][A
 23%|██▎       | 33/145 [00:47<02:46,  1.49s/it][A
 23%|██▎       | 34/145 [00:49<02:45,  1.49s/it][A
 24%|██▍       | 35/145 [00:50<02:45,  1.50s/it][A
 25%|██▍       | 36/145 [00:52<02:43,  1.50s/it][A
 26%|██▌       | 37/145 [00:53<02:45,  1.53s/it][A
 26%|██▌       | 38/145 [00:55<02:43,  1.53s/it][A
 27%|██▋       | 39/145 [00:57<02:41,  1.52s/it][A
 28%|██▊       | 40/145 [00:58<02:39,  1.52s/it][A
 28%|██▊       | 41/145 [01:00<02:39,  1.54s/it][A
 29%|██▉       | 42/145 [01:01<02:37,  1.53s/it][A
 30%|██▉       | 43/145 [01:03<02:34,  1.51s/it][A
 30%|███       | 44/145 [01:04<02:35,  1.54s/it][A
 31%|███       | 45/145 [01:06<02:35,  1.55s/it][A
 32%|███▏      | 46/145 [01:07<02:31,  1.53s/it][A
 32%|███▏      | 47/145 [01:09<02:27,  1.51s/it][A
 33%|███▎      | 48/145 [01:10<02:27,  1.52s/it][A
 34%|███▍      | 49/145 [01:12<02:26,  1.53s/it][A
 34%|███▍      | 50/145 [01:13<02:25,  1.53s/it][A
 35%|███▌      | 51/145 [01:15<02:24,  1.53s/it][A
 36%|███▌      | 52/145 [01:16<02:22,  1.53s/it][A
 37%|███▋      | 53/145 [01:18<02:20,  1.53s/it][A
 37%|███▋      | 54/145 [01:19<02:19,  1.54s/it][A
 38%|███▊      | 55/145 [01:21<02:17,  1.53s/it][A
 39%|███▊      | 56/145 [01:23<02:17,  1.54s/it][A
 39%|███▉      | 57/145 [01:24<02:13,  1.52s/it][A
 40%|████      | 58/145 [01:26<02:11,  1.51s/it][A
 41%|████      | 59/145 [01:27<02:11,  1.53s/it][A
 41%|████▏     | 60/145 [01:29<02:09,  1.52s/it][A
 42%|████▏     | 61/145 [01:30<02:07,  1.51s/it][A
 43%|████▎     | 62/145 [01:32<02:04,  1.50s/it][A
 43%|████▎     | 63/145 [01:33<02:04,  1.52s/it][A
 44%|████▍     | 64/145 [01:35<02:02,  1.52s/it][A
 45%|████▍     | 65/145 [01:36<02:01,  1.52s/it][A
 46%|████▌     | 66/145 [01:38<02:00,  1.52s/it][A
 46%|████▌     | 67/145 [01:39<01:57,  1.51s/it][A
 47%|████▋     | 68/145 [01:41<01:58,  1.54s/it][A
 48%|████▊     | 69/145 [01:42<01:57,  1.54s/it][A
 48%|████▊     | 70/145 [01:44<01:51,  1.49s/it][A
 49%|████▉     | 71/145 [01:45<01:49,  1.49s/it][A
 50%|████▉     | 72/145 [01:47<01:49,  1.50s/it][A
 50%|█████     | 73/145 [01:48<01:49,  1.53s/it][A
 51%|█████     | 74/145 [01:50<01:48,  1.53s/it][A
 52%|█████▏    | 75/145 [01:51<01:47,  1.53s/it][A
 52%|█████▏    | 76/145 [01:53<01:45,  1.52s/it][A
 53%|█████▎    | 77/145 [01:54<01:41,  1.50s/it][A
 54%|█████▍    | 78/145 [01:56<01:40,  1.50s/it][A
 54%|█████▍    | 79/145 [01:57<01:37,  1.48s/it][A
 55%|█████▌    | 80/145 [01:59<01:36,  1.48s/it][A
 56%|█████▌    | 81/145 [02:00<01:33,  1.46s/it][A
 57%|█████▋    | 82/145 [02:02<01:33,  1.48s/it][A
 57%|█████▋    | 83/145 [02:03<01:32,  1.49s/it][A
 58%|█████▊    | 84/145 [02:05<01:31,  1.50s/it][A
 59%|█████▊    | 85/145 [02:06<01:28,  1.47s/it][A
 59%|█████▉    | 86/145 [02:08<01:28,  1.49s/it][A
 60%|██████    | 87/145 [02:09<01:28,  1.52s/it][A
 61%|██████    | 88/145 [02:11<01:25,  1.50s/it][A
 61%|██████▏   | 89/145 [02:12<01:24,  1.51s/it][A
 62%|██████▏   | 90/145 [02:14<01:23,  1.52s/it][A
 63%|██████▎   | 91/145 [02:15<01:21,  1.51s/it][A
 63%|██████▎   | 92/145 [02:17<01:20,  1.51s/it][A
 64%|██████▍   | 93/145 [02:18<01:17,  1.49s/it][A
 65%|██████▍   | 94/145 [02:20<01:15,  1.49s/it][A
 66%|██████▌   | 95/145 [02:21<01:14,  1.49s/it][A
 66%|██████▌   | 96/145 [02:23<01:13,  1.50s/it][A
 67%|██████▋   | 97/145 [02:24<01:12,  1.51s/it][A
 68%|██████▊   | 98/145 [02:26<01:12,  1.54s/it][A
 68%|██████▊   | 99/145 [02:27<01:09,  1.51s/it][A
 69%|██████▉   | 100/145 [02:29<01:08,  1.52s/it][A
 70%|██████▉   | 101/145 [02:30<01:07,  1.53s/it][A
 70%|███████   | 102/145 [02:32<01:05,  1.52s/it][A
 71%|███████   | 103/145 [02:33<01:03,  1.52s/it][A
 72%|███████▏  | 104/145 [02:35<01:02,  1.53s/it][A
 72%|███████▏  | 105/145 [02:36<01:00,  1.52s/it][A
 73%|███████▎  | 106/145 [02:38<00:59,  1.52s/it][A
 74%|███████▍  | 107/145 [02:39<00:55,  1.47s/it][A
 74%|███████▍  | 108/145 [02:41<00:53,  1.45s/it][A
 75%|███████▌  | 109/145 [02:42<00:53,  1.48s/it][A
 76%|███████▌  | 110/145 [02:44<00:52,  1.50s/it][A
 77%|███████▋  | 111/145 [02:45<00:49,  1.46s/it][A
 77%|███████▋  | 112/145 [02:47<00:49,  1.49s/it][A
 78%|███████▊  | 113/145 [02:48<00:48,  1.51s/it][A
 79%|███████▊  | 114/145 [02:50<00:46,  1.52s/it][A
 79%|███████▉  | 115/145 [02:51<00:45,  1.51s/it][A
 80%|████████  | 116/145 [02:53<00:43,  1.49s/it][A
 81%|████████  | 117/145 [02:54<00:41,  1.49s/it][A
 81%|████████▏ | 118/145 [02:56<00:39,  1.48s/it][A
 82%|████████▏ | 119/145 [02:57<00:37,  1.45s/it][A
 83%|████████▎ | 120/145 [02:59<00:35,  1.43s/it][A
 83%|████████▎ | 121/145 [03:00<00:34,  1.43s/it][A
 84%|████████▍ | 122/145 [03:01<00:33,  1.45s/it][A
 85%|████████▍ | 123/145 [03:03<00:32,  1.46s/it][A
 86%|████████▌ | 124/145 [03:04<00:30,  1.45s/it][A
 86%|████████▌ | 125/145 [03:06<00:30,  1.51s/it][A
 87%|████████▋ | 126/145 [03:07<00:28,  1.49s/it][A
 88%|████████▊ | 127/145 [03:09<00:26,  1.48s/it][A
 88%|████████▊ | 128/145 [03:10<00:25,  1.52s/it][A
 89%|████████▉ | 129/145 [03:12<00:24,  1.51s/it][A
 90%|████████▉ | 130/145 [03:14<00:23,  1.54s/it][A
 90%|█████████ | 131/145 [03:15<00:20,  1.49s/it][A
 91%|█████████ | 132/145 [03:17<00:19,  1.51s/it][A
 92%|█████████▏| 133/145 [03:18<00:17,  1.48s/it][A
 92%|█████████▏| 134/145 [03:20<00:16,  1.52s/it][A
 93%|█████████▎| 135/145 [03:21<00:15,  1.52s/it][A
 94%|█████████▍| 136/145 [03:23<00:13,  1.51s/it][A
 94%|█████████▍| 137/145 [03:24<00:12,  1.51s/it][A
 95%|█████████▌| 138/145 [03:26<00:10,  1.52s/it][A
 96%|█████████▌| 139/145 [03:27<00:09,  1.51s/it][A
 97%|█████████▋| 140/145 [03:29<00:07,  1.52s/it][A
 97%|█████████▋| 141/145 [03:30<00:06,  1.52s/it][A
 98%|█████████▊| 142/145 [03:32<00:04,  1.50s/it][A
 99%|█████████▊| 143/145 [03:33<00:02,  1.50s/it][A
 99%|█████████▉| 144/145 [03:35<00:01,  1.51s/it][A
100%|██████████| 145/145 [03:36<00:00,  1.48s/it][A
                                                 [A                                                      {'eval_loss': 2.394115924835205, 'eval_runtime': 218.2273, 'eval_samples_per_second': 5.302, 'eval_steps_per_second': 0.664, 'epoch': 1.54, 'num_input_tokens_seen': 5672864}

100%|██████████| 145/145 [03:36<00:00,  1.48s/it][A 15%|█▌        | 500/3250 [1:49:32<8:56:36, 11.71s/it]
                                                 [A[INFO|trainer.py:3705] 2024-10-11 06:41:35,908 >> Saving model checkpoint to /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-500
[INFO|configuration_utils.py:672] 2024-10-11 06:41:36,497 >> loading configuration file config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/config.json
[WARNING|modeling_rope_utils.py:379] 2024-10-11 06:41:36,498 >> Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
[INFO|configuration_utils.py:739] 2024-10-11 06:41:36,500 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 3584,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 18944,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 28,
  "num_hidden_layers": 28,
  "num_key_value_heads": 4,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.0",
  "use_cache": true,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "in_chans": 3,
    "model_type": "qwen2_vl",
    "spatial_patch_size": 14
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 152064
}

[INFO|tokenization_utils_base.py:2649] 2024-10-11 06:41:36,581 >> tokenizer config file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-500/tokenizer_config.json
[INFO|tokenization_utils_base.py:2658] 2024-10-11 06:41:36,581 >> Special tokens file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-500/special_tokens_map.json
[INFO|image_processing_base.py:258] 2024-10-11 06:41:37,076 >> Image processor saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-500/preprocessor_config.json
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 15%|█▌        | 501/3250 [1:49:45<59:14:00, 77.57s/it] 15%|█▌        | 502/3250 [1:49:57<44:07:09, 57.80s/it] 15%|█▌        | 503/3250 [1:50:09<33:33:06, 43.97s/it] 16%|█▌        | 504/3250 [1:50:20<26:02:39, 34.14s/it] 16%|█▌        | 505/3250 [1:50:32<20:54:15, 27.42s/it]                                                       {'loss': 2.3323, 'grad_norm': 1.127685308456421, 'learning_rate': 0.005, 'epoch': 1.55, 'num_input_tokens_seen': 5730272}
 16%|█▌        | 505/3250 [1:50:32<20:54:15, 27.42s/it] 16%|█▌        | 506/3250 [1:50:43<17:13:55, 22.61s/it] 16%|█▌        | 507/3250 [1:50:55<14:43:50, 19.33s/it] 16%|█▌        | 508/3250 [1:51:07<13:00:42, 17.08s/it] 16%|█▌        | 509/3250 [1:51:18<11:50:01, 15.54s/it] 16%|█▌        | 510/3250 [1:51:30<10:59:29, 14.44s/it]                                                       {'loss': 2.3036, 'grad_norm': 1.2445205450057983, 'learning_rate': 0.005, 'epoch': 1.57, 'num_input_tokens_seen': 5787712}
 16%|█▌        | 510/3250 [1:51:30<10:59:29, 14.44s/it] 16%|█▌        | 511/3250 [1:51:42<10:17:56, 13.54s/it] 16%|█▌        | 512/3250 [1:51:54<9:55:12, 13.04s/it]  16%|█▌        | 513/3250 [1:52:06<9:43:09, 12.78s/it] 16%|█▌        | 514/3250 [1:52:18<9:29:11, 12.48s/it] 16%|█▌        | 515/3250 [1:52:29<9:20:03, 12.29s/it]                                                      {'loss': 2.2764, 'grad_norm': 1.9103258848190308, 'learning_rate': 0.005, 'epoch': 1.58, 'num_input_tokens_seen': 5844576}
 16%|█▌        | 515/3250 [1:52:29<9:20:03, 12.29s/it] 16%|█▌        | 516/3250 [1:52:41<9:12:12, 12.12s/it] 16%|█▌        | 517/3250 [1:52:52<8:59:27, 11.84s/it] 16%|█▌        | 518/3250 [1:53:04<8:52:07, 11.69s/it] 16%|█▌        | 519/3250 [1:53:15<8:52:55, 11.71s/it] 16%|█▌        | 520/3250 [1:53:27<8:45:35, 11.55s/it]                                                      {'loss': 2.1762, 'grad_norm': 1.8920544385910034, 'learning_rate': 0.005, 'epoch': 1.6, 'num_input_tokens_seen': 5899360}
 16%|█▌        | 520/3250 [1:53:27<8:45:35, 11.55s/it] 16%|█▌        | 521/3250 [1:53:39<8:49:56, 11.65s/it] 16%|█▌        | 522/3250 [1:53:50<8:54:07, 11.75s/it] 16%|█▌        | 523/3250 [1:54:02<8:51:23, 11.69s/it] 16%|█▌        | 524/3250 [1:54:14<8:49:52, 11.66s/it] 16%|█▌        | 525/3250 [1:54:25<8:51:39, 11.71s/it]                                                      {'loss': 2.4876, 'grad_norm': 4.415011882781982, 'learning_rate': 0.005, 'epoch': 1.61, 'num_input_tokens_seen': 5956864}
 16%|█▌        | 525/3250 [1:54:25<8:51:39, 11.71s/it] 16%|█▌        | 526/3250 [1:54:37<8:51:23, 11.70s/it] 16%|█▌        | 527/3250 [1:54:49<8:52:54, 11.74s/it] 16%|█▌        | 528/3250 [1:55:01<8:52:10, 11.73s/it] 16%|█▋        | 529/3250 [1:55:12<8:51:37, 11.72s/it] 16%|█▋        | 530/3250 [1:55:24<8:43:45, 11.55s/it]                                                      {'loss': 2.4529, 'grad_norm': 1.5043898820877075, 'learning_rate': 0.005, 'epoch': 1.63, 'num_input_tokens_seen': 6013984}
 16%|█▋        | 530/3250 [1:55:24<8:43:45, 11.55s/it] 16%|█▋        | 531/3250 [1:55:35<8:44:50, 11.58s/it] 16%|█▋        | 532/3250 [1:55:47<8:45:38, 11.60s/it] 16%|█▋        | 533/3250 [1:55:58<8:45:55, 11.61s/it] 16%|█▋        | 534/3250 [1:56:10<8:43:47, 11.57s/it] 16%|█▋        | 535/3250 [1:56:22<8:45:30, 11.61s/it]                                                      {'loss': 2.3661, 'grad_norm': 1.9883772134780884, 'learning_rate': 0.005, 'epoch': 1.64, 'num_input_tokens_seen': 6071392}
 16%|█▋        | 535/3250 [1:56:22<8:45:30, 11.61s/it] 16%|█▋        | 536/3250 [1:56:33<8:41:10, 11.52s/it] 17%|█▋        | 537/3250 [1:56:44<8:39:32, 11.49s/it] 17%|█▋        | 538/3250 [1:56:56<8:39:56, 11.50s/it] 17%|█▋        | 539/3250 [1:57:07<8:39:50, 11.51s/it] 17%|█▋        | 540/3250 [1:57:19<8:33:58, 11.38s/it]                                                      {'loss': 2.2825, 'grad_norm': 0.808058500289917, 'learning_rate': 0.005, 'epoch': 1.66, 'num_input_tokens_seen': 6126912}
 17%|█▋        | 540/3250 [1:57:19<8:33:58, 11.38s/it] 17%|█▋        | 541/3250 [1:57:30<8:37:45, 11.47s/it] 17%|█▋        | 542/3250 [1:57:42<8:42:11, 11.57s/it] 17%|█▋        | 543/3250 [1:57:54<8:47:17, 11.69s/it] 17%|█▋        | 544/3250 [1:58:06<8:47:34, 11.70s/it] 17%|█▋        | 545/3250 [1:58:17<8:43:29, 11.61s/it]                                                      {'loss': 2.2289, 'grad_norm': 1.5708613395690918, 'learning_rate': 0.005, 'epoch': 1.67, 'num_input_tokens_seen': 6184704}
 17%|█▋        | 545/3250 [1:58:17<8:43:29, 11.61s/it] 17%|█▋        | 546/3250 [1:58:28<8:38:12, 11.50s/it] 17%|█▋        | 547/3250 [1:58:40<8:35:21, 11.44s/it] 17%|█▋        | 548/3250 [1:58:51<8:38:42, 11.52s/it] 17%|█▋        | 549/3250 [1:59:03<8:38:01, 11.51s/it] 17%|█▋        | 550/3250 [1:59:14<8:38:02, 11.51s/it]                                                      {'loss': 2.1898, 'grad_norm': 1.3113431930541992, 'learning_rate': 0.005, 'epoch': 1.69, 'num_input_tokens_seen': 6240896}
 17%|█▋        | 550/3250 [1:59:14<8:38:02, 11.51s/it] 17%|█▋        | 551/3250 [1:59:26<8:37:40, 11.51s/it] 17%|█▋        | 552/3250 [1:59:37<8:35:13, 11.46s/it] 17%|█▋        | 553/3250 [1:59:49<8:35:22, 11.47s/it] 17%|█▋        | 554/3250 [2:00:01<8:41:09, 11.60s/it] 17%|█▋        | 555/3250 [2:00:12<8:40:02, 11.58s/it]                                                      {'loss': 2.1583, 'grad_norm': 2.0212905406951904, 'learning_rate': 0.005, 'epoch': 1.71, 'num_input_tokens_seen': 6297280}
 17%|█▋        | 555/3250 [2:00:12<8:40:02, 11.58s/it] 17%|█▋        | 556/3250 [2:00:23<8:36:37, 11.51s/it] 17%|█▋        | 557/3250 [2:00:35<8:37:49, 11.54s/it] 17%|█▋        | 558/3250 [2:00:47<8:37:36, 11.54s/it] 17%|█▋        | 559/3250 [2:00:58<8:36:17, 11.51s/it] 17%|█▋        | 560/3250 [2:01:10<8:39:54, 11.60s/it]                                                      {'loss': 2.214, 'grad_norm': 1.3696880340576172, 'learning_rate': 0.005, 'epoch': 1.72, 'num_input_tokens_seen': 6353472}
 17%|█▋        | 560/3250 [2:01:10<8:39:54, 11.60s/it] 17%|█▋        | 561/3250 [2:01:22<8:41:54, 11.65s/it] 17%|█▋        | 562/3250 [2:01:33<8:38:59, 11.58s/it] 17%|█▋        | 563/3250 [2:01:45<8:39:15, 11.59s/it] 17%|█▋        | 564/3250 [2:01:56<8:38:17, 11.58s/it] 17%|█▋        | 565/3250 [2:02:08<8:37:33, 11.57s/it]                                                      {'loss': 2.1485, 'grad_norm': 1.2310775518417358, 'learning_rate': 0.005, 'epoch': 1.74, 'num_input_tokens_seen': 6409664}
 17%|█▋        | 565/3250 [2:02:08<8:37:33, 11.57s/it] 17%|█▋        | 566/3250 [2:02:19<8:37:28, 11.57s/it] 17%|█▋        | 567/3250 [2:02:31<8:40:02, 11.63s/it] 17%|█▋        | 568/3250 [2:02:43<8:39:26, 11.62s/it] 18%|█▊        | 569/3250 [2:02:54<8:35:00, 11.53s/it] 18%|█▊        | 570/3250 [2:03:06<8:40:20, 11.65s/it]                                                      {'loss': 2.1615, 'grad_norm': 2.706286907196045, 'learning_rate': 0.005, 'epoch': 1.75, 'num_input_tokens_seen': 6466304}
 18%|█▊        | 570/3250 [2:03:06<8:40:20, 11.65s/it] 18%|█▊        | 571/3250 [2:03:18<8:42:08, 11.69s/it] 18%|█▊        | 572/3250 [2:03:29<8:40:27, 11.66s/it] 18%|█▊        | 573/3250 [2:03:41<8:39:22, 11.64s/it] 18%|█▊        | 574/3250 [2:03:53<8:41:12, 11.69s/it] 18%|█▊        | 575/3250 [2:04:04<8:39:30, 11.65s/it]                                                      {'loss': 2.1561, 'grad_norm': 5.583892345428467, 'learning_rate': 0.005, 'epoch': 1.77, 'num_input_tokens_seen': 6523072}
 18%|█▊        | 575/3250 [2:04:04<8:39:30, 11.65s/it] 18%|█▊        | 576/3250 [2:04:16<8:41:15, 11.70s/it] 18%|█▊        | 577/3250 [2:04:28<8:41:45, 11.71s/it] 18%|█▊        | 578/3250 [2:04:40<8:42:55, 11.74s/it] 18%|█▊        | 579/3250 [2:04:51<8:42:34, 11.74s/it] 18%|█▊        | 580/3250 [2:05:03<8:44:41, 11.79s/it]                                                      {'loss': 2.212, 'grad_norm': 1.4013645648956299, 'learning_rate': 0.005, 'epoch': 1.78, 'num_input_tokens_seen': 6580768}
 18%|█▊        | 580/3250 [2:05:03<8:44:41, 11.79s/it] 18%|█▊        | 581/3250 [2:05:15<8:38:56, 11.67s/it] 18%|█▊        | 582/3250 [2:05:26<8:40:56, 11.72s/it] 18%|█▊        | 583/3250 [2:05:38<8:40:54, 11.72s/it] 18%|█▊        | 584/3250 [2:05:50<8:39:35, 11.69s/it] 18%|█▊        | 585/3250 [2:06:01<8:34:08, 11.58s/it]                                                      {'loss': 2.2168, 'grad_norm': 1.1833029985427856, 'learning_rate': 0.005, 'epoch': 1.8, 'num_input_tokens_seen': 6637280}
 18%|█▊        | 585/3250 [2:06:01<8:34:08, 11.58s/it] 18%|█▊        | 586/3250 [2:06:12<8:27:40, 11.43s/it] 18%|█▊        | 587/3250 [2:06:24<8:29:47, 11.49s/it] 18%|█▊        | 588/3250 [2:06:36<8:32:17, 11.55s/it] 18%|█▊        | 589/3250 [2:06:47<8:35:24, 11.62s/it] 18%|█▊        | 590/3250 [2:06:59<8:33:01, 11.57s/it]                                                      {'loss': 2.1519, 'grad_norm': 1.587683916091919, 'learning_rate': 0.005, 'epoch': 1.81, 'num_input_tokens_seen': 6693216}
 18%|█▊        | 590/3250 [2:06:59<8:33:01, 11.57s/it] 18%|█▊        | 591/3250 [2:07:10<8:32:31, 11.57s/it] 18%|█▊        | 592/3250 [2:07:22<8:30:25, 11.52s/it] 18%|█▊        | 593/3250 [2:07:33<8:29:57, 11.52s/it] 18%|█▊        | 594/3250 [2:07:45<8:30:17, 11.53s/it] 18%|█▊        | 595/3250 [2:07:57<8:32:05, 11.57s/it]                                                      {'loss': 2.0982, 'grad_norm': 1.0052567720413208, 'learning_rate': 0.005, 'epoch': 1.83, 'num_input_tokens_seen': 6748672}
 18%|█▊        | 595/3250 [2:07:57<8:32:05, 11.57s/it] 18%|█▊        | 596/3250 [2:08:08<8:30:17, 11.54s/it] 18%|█▊        | 597/3250 [2:08:19<8:28:45, 11.51s/it] 18%|█▊        | 598/3250 [2:08:31<8:29:49, 11.53s/it] 18%|█▊        | 599/3250 [2:08:43<8:31:54, 11.59s/it] 18%|█▊        | 600/3250 [2:08:55<8:35:34, 11.67s/it]                                                      {'loss': 2.0755, 'grad_norm': 1.2307021617889404, 'learning_rate': 0.005, 'epoch': 1.84, 'num_input_tokens_seen': 6804704}
 18%|█▊        | 600/3250 [2:08:55<8:35:34, 11.67s/it][INFO|trainer.py:4021] 2024-10-11 07:00:58,193 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-10-11 07:00:58,193 >>   Num examples = 1157
[INFO|trainer.py:4026] 2024-10-11 07:00:58,193 >>   Batch size = 4

  0%|          | 0/145 [00:00<?, ?it/s][A
  1%|▏         | 2/145 [00:01<01:47,  1.33it/s][A
  2%|▏         | 3/145 [00:03<02:34,  1.09s/it][A
  3%|▎         | 4/145 [00:04<02:54,  1.24s/it][A
  3%|▎         | 5/145 [00:05<03:00,  1.29s/it][A
  4%|▍         | 6/145 [00:07<03:10,  1.37s/it][A
  5%|▍         | 7/145 [00:09<03:16,  1.43s/it][A
  6%|▌         | 8/145 [00:10<03:14,  1.42s/it][A
  6%|▌         | 9/145 [00:11<03:14,  1.43s/it][A
  7%|▋         | 10/145 [00:13<03:15,  1.45s/it][A
  8%|▊         | 11/145 [00:14<03:16,  1.47s/it][A
  8%|▊         | 12/145 [00:16<03:18,  1.49s/it][A
  9%|▉         | 13/145 [00:17<03:19,  1.51s/it][A
 10%|▉         | 14/145 [00:19<03:19,  1.53s/it][A
 10%|█         | 15/145 [00:21<03:16,  1.51s/it][A
 11%|█         | 16/145 [00:22<03:14,  1.51s/it][A
 12%|█▏        | 17/145 [00:24<03:13,  1.51s/it][A
 12%|█▏        | 18/145 [00:25<03:12,  1.51s/it][A
 13%|█▎        | 19/145 [00:27<03:11,  1.52s/it][A
 14%|█▍        | 20/145 [00:28<03:09,  1.52s/it][A
 14%|█▍        | 21/145 [00:30<03:05,  1.50s/it][A
 15%|█▌        | 22/145 [00:31<03:03,  1.49s/it][A
 16%|█▌        | 23/145 [00:33<03:01,  1.49s/it][A
 17%|█▋        | 24/145 [00:34<03:00,  1.49s/it][A
 17%|█▋        | 25/145 [00:35<02:59,  1.49s/it][A
 18%|█▊        | 26/145 [00:37<02:59,  1.51s/it][A
 19%|█▊        | 27/145 [00:39<02:58,  1.51s/it][A
 19%|█▉        | 28/145 [00:40<02:55,  1.50s/it][A
 20%|██        | 29/145 [00:42<02:53,  1.49s/it][A
 21%|██        | 30/145 [00:43<02:47,  1.46s/it][A
 21%|██▏       | 31/145 [00:44<02:48,  1.48s/it][A
 22%|██▏       | 32/145 [00:46<02:47,  1.49s/it][A
 23%|██▎       | 33/145 [00:47<02:47,  1.49s/it][A
 23%|██▎       | 34/145 [00:49<02:46,  1.50s/it][A
 24%|██▍       | 35/145 [00:50<02:45,  1.50s/it][A
 25%|██▍       | 36/145 [00:52<02:43,  1.50s/it][A
 26%|██▌       | 37/145 [00:54<02:45,  1.53s/it][A
 26%|██▌       | 38/145 [00:55<02:43,  1.53s/it][A
 27%|██▋       | 39/145 [00:57<02:41,  1.52s/it][A
 28%|██▊       | 40/145 [00:58<02:39,  1.52s/it][A
 28%|██▊       | 41/145 [01:00<02:39,  1.54s/it][A
 29%|██▉       | 42/145 [01:01<02:38,  1.53s/it][A
 30%|██▉       | 43/145 [01:03<02:34,  1.52s/it][A
 30%|███       | 44/145 [01:04<02:35,  1.54s/it][A
 31%|███       | 45/145 [01:06<02:35,  1.56s/it][A
 32%|███▏      | 46/145 [01:07<02:31,  1.53s/it][A
 32%|███▏      | 47/145 [01:09<02:27,  1.51s/it][A
 33%|███▎      | 48/145 [01:10<02:27,  1.52s/it][A
 34%|███▍      | 49/145 [01:12<02:26,  1.53s/it][A
 34%|███▍      | 50/145 [01:13<02:25,  1.54s/it][A
 35%|███▌      | 51/145 [01:15<02:24,  1.54s/it][A
 36%|███▌      | 52/145 [01:17<02:22,  1.53s/it][A
 37%|███▋      | 53/145 [01:18<02:21,  1.53s/it][A
 37%|███▋      | 54/145 [01:20<02:20,  1.54s/it][A
 38%|███▊      | 55/145 [01:21<02:17,  1.53s/it][A
 39%|███▊      | 56/145 [01:23<02:15,  1.52s/it][A
 39%|███▉      | 57/145 [01:24<02:13,  1.51s/it][A
 40%|████      | 58/145 [01:26<02:10,  1.50s/it][A
 41%|████      | 59/145 [01:27<02:11,  1.53s/it][A
 41%|████▏     | 60/145 [01:29<02:09,  1.52s/it][A
 42%|████▏     | 61/145 [01:30<02:07,  1.51s/it][A
 43%|████▎     | 62/145 [01:32<02:04,  1.50s/it][A
 43%|████▎     | 63/145 [01:33<02:04,  1.52s/it][A
 44%|████▍     | 64/145 [01:35<02:02,  1.52s/it][A
 45%|████▍     | 65/145 [01:36<02:01,  1.52s/it][A
 46%|████▌     | 66/145 [01:38<02:00,  1.52s/it][A
 46%|████▌     | 67/145 [01:39<01:57,  1.51s/it][A
 47%|████▋     | 68/145 [01:41<01:58,  1.53s/it][A
 48%|████▊     | 69/145 [01:42<01:57,  1.54s/it][A
 48%|████▊     | 70/145 [01:44<01:51,  1.49s/it][A
 49%|████▉     | 71/145 [01:45<01:49,  1.49s/it][A
 50%|████▉     | 72/145 [01:47<01:49,  1.50s/it][A
 50%|█████     | 73/145 [01:48<01:49,  1.53s/it][A
 51%|█████     | 74/145 [01:50<01:48,  1.53s/it][A
 52%|█████▏    | 75/145 [01:51<01:47,  1.53s/it][A
 52%|█████▏    | 76/145 [01:53<01:45,  1.52s/it][A
 53%|█████▎    | 77/145 [01:54<01:41,  1.50s/it][A
 54%|█████▍    | 78/145 [01:56<01:40,  1.50s/it][A
 54%|█████▍    | 79/145 [01:57<01:37,  1.48s/it][A
 55%|█████▌    | 80/145 [01:59<01:36,  1.48s/it][A
 56%|█████▌    | 81/145 [02:00<01:33,  1.46s/it][A
 57%|█████▋    | 82/145 [02:02<01:33,  1.48s/it][A
 57%|█████▋    | 83/145 [02:03<01:32,  1.49s/it][A
 58%|█████▊    | 84/145 [02:05<01:31,  1.50s/it][A
 59%|█████▊    | 85/145 [02:06<01:28,  1.48s/it][A
 59%|█████▉    | 86/145 [02:08<01:28,  1.49s/it][A
 60%|██████    | 87/145 [02:09<01:28,  1.52s/it][A
 61%|██████    | 88/145 [02:11<01:25,  1.50s/it][A
 61%|██████▏   | 89/145 [02:12<01:24,  1.50s/it][A
 62%|██████▏   | 90/145 [02:14<01:23,  1.51s/it][A
 63%|██████▎   | 91/145 [02:15<01:21,  1.51s/it][A
 63%|██████▎   | 92/145 [02:17<01:19,  1.51s/it][A
 64%|██████▍   | 93/145 [02:18<01:17,  1.49s/it][A
 65%|██████▍   | 94/145 [02:20<01:15,  1.49s/it][A
 66%|██████▌   | 95/145 [02:21<01:14,  1.49s/it][A
 66%|██████▌   | 96/145 [02:23<01:13,  1.50s/it][A
 67%|██████▋   | 97/145 [02:24<01:12,  1.51s/it][A
 68%|██████▊   | 98/145 [02:26<01:12,  1.54s/it][A
 68%|██████▊   | 99/145 [02:27<01:09,  1.52s/it][A
 69%|██████▉   | 100/145 [02:29<01:08,  1.52s/it][A
 70%|██████▉   | 101/145 [02:30<01:07,  1.53s/it][A
 70%|███████   | 102/145 [02:32<01:05,  1.53s/it][A
 71%|███████   | 103/145 [02:34<01:03,  1.52s/it][A
 72%|███████▏  | 104/145 [02:35<01:02,  1.53s/it][A
 72%|███████▏  | 105/145 [02:37<01:01,  1.53s/it][A
 73%|███████▎  | 106/145 [02:38<00:59,  1.52s/it][A
 74%|███████▍  | 107/145 [02:39<00:56,  1.48s/it][A
 74%|███████▍  | 108/145 [02:41<00:53,  1.45s/it][A
 75%|███████▌  | 109/145 [02:42<00:53,  1.47s/it][A
 76%|███████▌  | 110/145 [02:44<00:52,  1.50s/it][A
 77%|███████▋  | 111/145 [02:45<00:49,  1.47s/it][A
 77%|███████▋  | 112/145 [02:47<00:49,  1.50s/it][A
 78%|███████▊  | 113/145 [02:48<00:48,  1.51s/it][A
 79%|███████▊  | 114/145 [02:50<00:47,  1.52s/it][A
 79%|███████▉  | 115/145 [02:51<00:45,  1.52s/it][A
 80%|████████  | 116/145 [02:53<00:43,  1.49s/it][A
 81%|████████  | 117/145 [02:54<00:41,  1.49s/it][A
 81%|████████▏ | 118/145 [02:56<00:40,  1.49s/it][A
 82%|████████▏ | 119/145 [02:57<00:37,  1.45s/it][A
 83%|████████▎ | 120/145 [02:59<00:35,  1.44s/it][A
 83%|████████▎ | 121/145 [03:00<00:34,  1.44s/it][A
 84%|████████▍ | 122/145 [03:02<00:33,  1.45s/it][A
 85%|████████▍ | 123/145 [03:03<00:32,  1.47s/it][A
 86%|████████▌ | 124/145 [03:05<00:30,  1.46s/it][A
 86%|████████▌ | 125/145 [03:06<00:30,  1.52s/it][A
 87%|████████▋ | 126/145 [03:08<00:28,  1.50s/it][A
 88%|████████▊ | 127/145 [03:09<00:26,  1.49s/it][A
 88%|████████▊ | 128/145 [03:11<00:25,  1.52s/it][A
 89%|████████▉ | 129/145 [03:12<00:24,  1.51s/it][A
 90%|████████▉ | 130/145 [03:14<00:23,  1.54s/it][A
 90%|█████████ | 131/145 [03:15<00:20,  1.50s/it][A
 91%|█████████ | 132/145 [03:17<00:19,  1.51s/it][A
 92%|█████████▏| 133/145 [03:18<00:17,  1.48s/it][A
 92%|█████████▏| 134/145 [03:20<00:16,  1.52s/it][A
 93%|█████████▎| 135/145 [03:21<00:15,  1.52s/it][A
 94%|█████████▍| 136/145 [03:23<00:13,  1.52s/it][A
 94%|█████████▍| 137/145 [03:24<00:12,  1.51s/it][A
 95%|█████████▌| 138/145 [03:26<00:10,  1.52s/it][A
 96%|█████████▌| 139/145 [03:27<00:09,  1.51s/it][A
 97%|█████████▋| 140/145 [03:29<00:07,  1.54s/it][A
 97%|█████████▋| 141/145 [03:30<00:06,  1.54s/it][A
 98%|█████████▊| 142/145 [03:32<00:04,  1.52s/it][A
 99%|█████████▊| 143/145 [03:33<00:03,  1.51s/it][A
 99%|█████████▉| 144/145 [03:35<00:01,  1.52s/it][A
100%|██████████| 145/145 [03:36<00:00,  1.48s/it][A
                                                 [A                                                      {'eval_loss': 2.05326247215271, 'eval_runtime': 218.533, 'eval_samples_per_second': 5.294, 'eval_steps_per_second': 0.664, 'epoch': 1.84, 'num_input_tokens_seen': 6804704}

100%|██████████| 145/145 [03:36<00:00,  1.48s/it][A 18%|█▊        | 600/3250 [2:12:33<8:35:34, 11.67s/it]
                                                 [A[INFO|trainer.py:3705] 2024-10-11 07:04:36,729 >> Saving model checkpoint to /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-600
[INFO|configuration_utils.py:672] 2024-10-11 07:04:38,143 >> loading configuration file config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/config.json
[WARNING|modeling_rope_utils.py:379] 2024-10-11 07:04:38,143 >> Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
[INFO|configuration_utils.py:739] 2024-10-11 07:04:38,146 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 3584,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 18944,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 28,
  "num_hidden_layers": 28,
  "num_key_value_heads": 4,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.0",
  "use_cache": true,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "in_chans": 3,
    "model_type": "qwen2_vl",
    "spatial_patch_size": 14
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 152064
}

[INFO|tokenization_utils_base.py:2649] 2024-10-11 07:04:38,224 >> tokenizer config file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-600/tokenizer_config.json
[INFO|tokenization_utils_base.py:2658] 2024-10-11 07:04:38,224 >> Special tokens file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-600/special_tokens_map.json
[INFO|image_processing_base.py:258] 2024-10-11 07:04:38,722 >> Image processor saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-600/preprocessor_config.json
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 18%|█▊        | 601/3250 [2:12:47<57:19:18, 77.90s/it] 19%|█▊        | 602/3250 [2:12:59<42:42:23, 58.06s/it] 19%|█▊        | 603/3250 [2:13:11<32:28:44, 44.17s/it] 19%|█▊        | 604/3250 [2:13:22<25:21:02, 34.49s/it] 19%|█▊        | 605/3250 [2:13:34<20:18:09, 27.63s/it]                                                       {'loss': 2.0434, 'grad_norm': 2.1057307720184326, 'learning_rate': 0.005, 'epoch': 1.86, 'num_input_tokens_seen': 6862144}
 19%|█▊        | 605/3250 [2:13:34<20:18:09, 27.63s/it] 19%|█▊        | 606/3250 [2:13:46<16:47:49, 22.87s/it] 19%|█▊        | 607/3250 [2:13:57<14:16:36, 19.45s/it] 19%|█▊        | 608/3250 [2:14:09<12:33:22, 17.11s/it] 19%|█▊        | 609/3250 [2:14:20<11:17:34, 15.39s/it] 19%|█▉        | 610/3250 [2:14:32<10:31:59, 14.36s/it]                                                       {'loss': 2.0291, 'grad_norm': 1.5396029949188232, 'learning_rate': 0.005, 'epoch': 1.87, 'num_input_tokens_seen': 6918944}
 19%|█▉        | 610/3250 [2:14:32<10:31:59, 14.36s/it] 19%|█▉        | 611/3250 [2:14:44<9:55:00, 13.53s/it]  19%|█▉        | 612/3250 [2:14:56<9:31:54, 13.01s/it] 19%|█▉        | 613/3250 [2:15:07<9:14:15, 12.61s/it] 19%|█▉        | 614/3250 [2:15:19<8:59:03, 12.27s/it] 19%|█▉        | 615/3250 [2:15:31<8:51:59, 12.11s/it]                                                      {'loss': 1.9837, 'grad_norm': 1.3467826843261719, 'learning_rate': 0.005, 'epoch': 1.89, 'num_input_tokens_seen': 6976288}
 19%|█▉        | 615/3250 [2:15:31<8:51:59, 12.11s/it] 19%|█▉        | 616/3250 [2:15:42<8:45:12, 11.96s/it] 19%|█▉        | 617/3250 [2:15:54<8:41:39, 11.89s/it] 19%|█▉        | 618/3250 [2:16:06<8:39:43, 11.85s/it] 19%|█▉        | 619/3250 [2:16:17<8:35:52, 11.76s/it] 19%|█▉        | 620/3250 [2:16:29<8:31:50, 11.68s/it]                                                      {'loss': 2.2974, 'grad_norm': 1.9617911577224731, 'learning_rate': 0.005, 'epoch': 1.9, 'num_input_tokens_seen': 7032256}
 19%|█▉        | 620/3250 [2:16:29<8:31:50, 11.68s/it] 19%|█▉        | 621/3250 [2:16:40<8:32:29, 11.70s/it] 19%|█▉        | 622/3250 [2:16:52<8:28:45, 11.62s/it] 19%|█▉        | 623/3250 [2:17:03<8:28:42, 11.62s/it] 19%|█▉        | 624/3250 [2:17:15<8:28:03, 11.61s/it] 19%|█▉        | 625/3250 [2:17:27<8:30:34, 11.67s/it]                                                      {'loss': 2.2135, 'grad_norm': 2.400735855102539, 'learning_rate': 0.005, 'epoch': 1.92, 'num_input_tokens_seen': 7088544}
 19%|█▉        | 625/3250 [2:17:27<8:30:34, 11.67s/it] 19%|█▉        | 626/3250 [2:17:38<8:26:42, 11.59s/it] 19%|█▉        | 627/3250 [2:17:50<8:24:09, 11.53s/it] 19%|█▉        | 628/3250 [2:18:01<8:26:33, 11.59s/it] 19%|█▉        | 629/3250 [2:18:13<8:21:52, 11.49s/it] 19%|█▉        | 630/3250 [2:18:24<8:24:09, 11.55s/it]                                                      {'loss': 2.1363, 'grad_norm': 0.9585006237030029, 'learning_rate': 0.005, 'epoch': 1.94, 'num_input_tokens_seen': 7144544}
 19%|█▉        | 630/3250 [2:18:24<8:24:09, 11.55s/it] 19%|█▉        | 631/3250 [2:18:36<8:27:08, 11.62s/it] 19%|█▉        | 632/3250 [2:18:48<8:24:09, 11.55s/it] 19%|█▉        | 633/3250 [2:18:59<8:24:27, 11.57s/it] 20%|█▉        | 634/3250 [2:19:11<8:28:31, 11.66s/it] 20%|█▉        | 635/3250 [2:19:23<8:26:03, 11.61s/it]                                                      {'loss': 2.0727, 'grad_norm': 1.8263837099075317, 'learning_rate': 0.005, 'epoch': 1.95, 'num_input_tokens_seen': 7201568}
 20%|█▉        | 635/3250 [2:19:23<8:26:03, 11.61s/it] 20%|█▉        | 636/3250 [2:19:34<8:22:47, 11.54s/it] 20%|█▉        | 637/3250 [2:19:45<8:21:18, 11.51s/it] 20%|█▉        | 638/3250 [2:19:56<8:15:01, 11.37s/it] 20%|█▉        | 639/3250 [2:20:08<8:13:46, 11.35s/it] 20%|█▉        | 640/3250 [2:20:19<8:12:59, 11.33s/it]                                                      {'loss': 2.0539, 'grad_norm': 1.0405880212783813, 'learning_rate': 0.005, 'epoch': 1.97, 'num_input_tokens_seen': 7256672}
 20%|█▉        | 640/3250 [2:20:19<8:12:59, 11.33s/it] 20%|█▉        | 641/3250 [2:20:30<8:12:16, 11.32s/it] 20%|█▉        | 642/3250 [2:20:42<8:15:05, 11.39s/it] 20%|█▉        | 643/3250 [2:20:53<8:13:07, 11.35s/it] 20%|█▉        | 644/3250 [2:21:05<8:16:48, 11.44s/it] 20%|█▉        | 645/3250 [2:21:16<8:18:42, 11.49s/it]                                                      {'loss': 2.0253, 'grad_norm': 1.6088789701461792, 'learning_rate': 0.005, 'epoch': 1.98, 'num_input_tokens_seen': 7312256}
 20%|█▉        | 645/3250 [2:21:16<8:18:42, 11.49s/it] 20%|█▉        | 646/3250 [2:21:28<8:18:16, 11.48s/it] 20%|█▉        | 647/3250 [2:21:39<8:13:53, 11.38s/it] 20%|█▉        | 648/3250 [2:21:50<8:14:03, 11.39s/it] 20%|█▉        | 649/3250 [2:22:02<8:18:16, 11.49s/it] 20%|██        | 650/3250 [2:22:14<8:17:28, 11.48s/it]                                                      {'loss': 2.0225, 'grad_norm': 1.2932876348495483, 'learning_rate': 0.005, 'epoch': 2.0, 'num_input_tokens_seen': 7368416}
 20%|██        | 650/3250 [2:22:14<8:17:28, 11.48s/it] 20%|██        | 651/3250 [2:22:25<8:15:44, 11.44s/it] 20%|██        | 652/3250 [2:22:37<8:18:18, 11.51s/it] 20%|██        | 653/3250 [2:22:48<8:18:01, 11.51s/it] 20%|██        | 654/3250 [2:22:59<8:13:43, 11.41s/it] 20%|██        | 655/3250 [2:23:11<8:12:12, 11.38s/it]                                                      {'loss': 1.93, 'grad_norm': 2.002288579940796, 'learning_rate': 0.005, 'epoch': 2.01, 'num_input_tokens_seen': 7424896}
 20%|██        | 655/3250 [2:23:11<8:12:12, 11.38s/it] 20%|██        | 656/3250 [2:23:22<8:10:20, 11.34s/it] 20%|██        | 657/3250 [2:23:34<8:15:25, 11.46s/it] 20%|██        | 658/3250 [2:23:45<8:21:03, 11.60s/it] 20%|██        | 659/3250 [2:23:57<8:18:23, 11.54s/it] 20%|██        | 660/3250 [2:24:08<8:14:22, 11.45s/it]                                                      {'loss': 2.0783, 'grad_norm': 1.266249418258667, 'learning_rate': 0.005, 'epoch': 2.03, 'num_input_tokens_seen': 7481632}
 20%|██        | 660/3250 [2:24:08<8:14:22, 11.45s/it] 20%|██        | 661/3250 [2:24:19<8:10:10, 11.36s/it] 20%|██        | 662/3250 [2:24:31<8:10:13, 11.37s/it] 20%|██        | 663/3250 [2:24:42<8:09:47, 11.36s/it] 20%|██        | 664/3250 [2:24:53<8:08:05, 11.32s/it] 20%|██        | 665/3250 [2:25:05<8:11:55, 11.42s/it]                                                      {'loss': 1.9424, 'grad_norm': 1.2506366968154907, 'learning_rate': 0.005, 'epoch': 2.04, 'num_input_tokens_seen': 7537120}
 20%|██        | 665/3250 [2:25:05<8:11:55, 11.42s/it] 20%|██        | 666/3250 [2:25:16<8:13:28, 11.46s/it] 21%|██        | 667/3250 [2:25:28<8:13:49, 11.47s/it] 21%|██        | 668/3250 [2:25:39<8:12:20, 11.44s/it] 21%|██        | 669/3250 [2:25:50<8:08:06, 11.35s/it] 21%|██        | 670/3250 [2:26:02<8:09:06, 11.37s/it]                                                      {'loss': 2.0011, 'grad_norm': 1.3898793458938599, 'learning_rate': 0.005, 'epoch': 2.06, 'num_input_tokens_seen': 7593216}
 21%|██        | 670/3250 [2:26:02<8:09:06, 11.37s/it] 21%|██        | 671/3250 [2:26:13<8:09:34, 11.39s/it] 21%|██        | 672/3250 [2:26:25<8:08:21, 11.37s/it] 21%|██        | 673/3250 [2:26:36<8:08:12, 11.37s/it] 21%|██        | 674/3250 [2:26:47<8:05:36, 11.31s/it] 21%|██        | 675/3250 [2:26:58<8:05:44, 11.32s/it]                                                      {'loss': 2.1173, 'grad_norm': 1.1253528594970703, 'learning_rate': 0.005, 'epoch': 2.07, 'num_input_tokens_seen': 7649760}
 21%|██        | 675/3250 [2:26:58<8:05:44, 11.32s/it] 21%|██        | 676/3250 [2:27:10<8:07:07, 11.36s/it] 21%|██        | 677/3250 [2:27:21<8:05:25, 11.32s/it] 21%|██        | 678/3250 [2:27:33<8:07:36, 11.38s/it] 21%|██        | 679/3250 [2:27:44<8:09:07, 11.41s/it] 21%|██        | 680/3250 [2:27:56<8:10:12, 11.44s/it]                                                      {'loss': 2.0565, 'grad_norm': 3.921004056930542, 'learning_rate': 0.005, 'epoch': 2.09, 'num_input_tokens_seen': 7706048}
 21%|██        | 680/3250 [2:27:56<8:10:12, 11.44s/it] 21%|██        | 681/3250 [2:28:07<8:11:21, 11.48s/it] 21%|██        | 682/3250 [2:28:18<8:07:38, 11.39s/it] 21%|██        | 683/3250 [2:28:30<8:10:45, 11.47s/it] 21%|██        | 684/3250 [2:28:42<8:11:25, 11.49s/it] 21%|██        | 685/3250 [2:28:53<8:09:31, 11.45s/it]                                                      {'loss': 2.0952, 'grad_norm': 1.6612300872802734, 'learning_rate': 0.005, 'epoch': 2.1, 'num_input_tokens_seen': 7763008}
 21%|██        | 685/3250 [2:28:53<8:09:31, 11.45s/it] 21%|██        | 686/3250 [2:29:04<8:10:02, 11.47s/it] 21%|██        | 687/3250 [2:29:16<8:13:17, 11.55s/it] 21%|██        | 688/3250 [2:29:28<8:10:38, 11.49s/it] 21%|██        | 689/3250 [2:29:39<8:08:55, 11.45s/it] 21%|██        | 690/3250 [2:29:50<8:10:07, 11.49s/it]                                                      {'loss': 2.1564, 'grad_norm': 3.011301040649414, 'learning_rate': 0.005, 'epoch': 2.12, 'num_input_tokens_seen': 7820896}
 21%|██        | 690/3250 [2:29:51<8:10:07, 11.49s/it] 21%|██▏       | 691/3250 [2:30:02<8:06:34, 11.41s/it] 21%|██▏       | 692/3250 [2:30:13<8:02:38, 11.32s/it] 21%|██▏       | 693/3250 [2:30:24<8:02:24, 11.32s/it] 21%|██▏       | 694/3250 [2:30:36<8:04:21, 11.37s/it] 21%|██▏       | 695/3250 [2:30:47<8:09:42, 11.50s/it]                                                      {'loss': 2.0803, 'grad_norm': 1.9661237001419067, 'learning_rate': 0.005, 'epoch': 2.14, 'num_input_tokens_seen': 7876608}
 21%|██▏       | 695/3250 [2:30:47<8:09:42, 11.50s/it] 21%|██▏       | 696/3250 [2:30:59<8:08:15, 11.47s/it] 21%|██▏       | 697/3250 [2:31:10<8:09:30, 11.50s/it] 21%|██▏       | 698/3250 [2:31:22<8:07:51, 11.47s/it] 22%|██▏       | 699/3250 [2:31:33<8:07:39, 11.47s/it] 22%|██▏       | 700/3250 [2:31:45<8:11:38, 11.57s/it]                                                      {'loss': 2.1386, 'grad_norm': 1.1510460376739502, 'learning_rate': 0.005, 'epoch': 2.15, 'num_input_tokens_seen': 7934976}
 22%|██▏       | 700/3250 [2:31:45<8:11:38, 11.57s/it][INFO|trainer.py:4021] 2024-10-11 07:23:48,707 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-10-11 07:23:48,708 >>   Num examples = 1157
[INFO|trainer.py:4026] 2024-10-11 07:23:48,708 >>   Batch size = 4

  0%|          | 0/145 [00:00<?, ?it/s][A
  1%|▏         | 2/145 [00:01<01:46,  1.34it/s][A
  2%|▏         | 3/145 [00:03<02:34,  1.09s/it][A
  3%|▎         | 4/145 [00:04<02:53,  1.23s/it][A
  3%|▎         | 5/145 [00:05<02:59,  1.28s/it][A
  4%|▍         | 6/145 [00:07<03:09,  1.37s/it][A
  5%|▍         | 7/145 [00:08<03:16,  1.42s/it][A
  6%|▌         | 8/145 [00:10<03:15,  1.42s/it][A
  6%|▌         | 9/145 [00:11<03:14,  1.43s/it][A
  7%|▋         | 10/145 [00:13<03:16,  1.45s/it][A
  8%|▊         | 11/145 [00:14<03:16,  1.47s/it][A
  8%|▊         | 12/145 [00:16<03:18,  1.49s/it][A
  9%|▉         | 13/145 [00:18<03:22,  1.54s/it][A
 10%|▉         | 14/145 [00:19<03:22,  1.55s/it][A
 10%|█         | 15/145 [00:21<03:18,  1.53s/it][A
 11%|█         | 16/145 [00:22<03:15,  1.52s/it][A
 12%|█▏        | 17/145 [00:24<03:14,  1.52s/it][A
 12%|█▏        | 18/145 [00:25<03:13,  1.52s/it][A
 13%|█▎        | 19/145 [00:27<03:12,  1.53s/it][A
 14%|█▍        | 20/145 [00:28<03:10,  1.53s/it][A
 14%|█▍        | 21/145 [00:30<03:06,  1.50s/it][A
 15%|█▌        | 22/145 [00:31<03:03,  1.49s/it][A
 16%|█▌        | 23/145 [00:33<03:01,  1.49s/it][A
 17%|█▋        | 24/145 [00:34<03:01,  1.50s/it][A
 17%|█▋        | 25/145 [00:36<02:59,  1.50s/it][A
 18%|█▊        | 26/145 [00:37<02:57,  1.49s/it][A
 19%|█▊        | 27/145 [00:39<02:56,  1.50s/it][A
 19%|█▉        | 28/145 [00:40<02:54,  1.49s/it][A
 20%|██        | 29/145 [00:42<02:52,  1.49s/it][A
 21%|██        | 30/145 [00:43<02:47,  1.45s/it][A
 21%|██▏       | 31/145 [00:44<02:47,  1.47s/it][A
 22%|██▏       | 32/145 [00:46<02:47,  1.48s/it][A
 23%|██▎       | 33/145 [00:47<02:46,  1.49s/it][A
 23%|██▎       | 34/145 [00:49<02:45,  1.49s/it][A
 24%|██▍       | 35/145 [00:50<02:45,  1.50s/it][A
 25%|██▍       | 36/145 [00:52<02:43,  1.50s/it][A
 26%|██▌       | 37/145 [00:54<02:45,  1.53s/it][A
 26%|██▌       | 38/145 [00:55<02:43,  1.53s/it][A
 27%|██▋       | 39/145 [00:57<02:41,  1.52s/it][A
 28%|██▊       | 40/145 [00:58<02:39,  1.52s/it][A
 28%|██▊       | 41/145 [01:00<02:39,  1.54s/it][A
 29%|██▉       | 42/145 [01:01<02:37,  1.53s/it][A
 30%|██▉       | 43/145 [01:03<02:34,  1.52s/it][A
 30%|███       | 44/145 [01:04<02:35,  1.54s/it][A
 31%|███       | 45/145 [01:06<02:35,  1.55s/it][A
 32%|███▏      | 46/145 [01:07<02:31,  1.53s/it][A
 32%|███▏      | 47/145 [01:09<02:27,  1.51s/it][A
 33%|███▎      | 48/145 [01:10<02:26,  1.51s/it][A
 34%|███▍      | 49/145 [01:12<02:27,  1.54s/it][A
 34%|███▍      | 50/145 [01:14<02:26,  1.54s/it][A
 35%|███▌      | 51/145 [01:15<02:24,  1.54s/it][A
 36%|███▌      | 52/145 [01:17<02:22,  1.53s/it][A
 37%|███▋      | 53/145 [01:18<02:21,  1.53s/it][A
 37%|███▋      | 54/145 [01:20<02:20,  1.54s/it][A
 38%|███▊      | 55/145 [01:21<02:17,  1.53s/it][A
 39%|███▊      | 56/145 [01:23<02:15,  1.52s/it][A
 39%|███▉      | 57/145 [01:24<02:12,  1.51s/it][A
 40%|████      | 58/145 [01:26<02:10,  1.50s/it][A
 41%|████      | 59/145 [01:27<02:11,  1.53s/it][A
 41%|████▏     | 60/145 [01:29<02:08,  1.51s/it][A
 42%|████▏     | 61/145 [01:30<02:06,  1.51s/it][A
 43%|████▎     | 62/145 [01:32<02:04,  1.50s/it][A
 43%|████▎     | 63/145 [01:33<02:04,  1.52s/it][A
 44%|████▍     | 64/145 [01:35<02:02,  1.52s/it][A
 45%|████▍     | 65/145 [01:36<02:01,  1.52s/it][A
 46%|████▌     | 66/145 [01:38<02:00,  1.52s/it][A
 46%|████▌     | 67/145 [01:39<01:57,  1.51s/it][A
 47%|████▋     | 68/145 [01:41<01:58,  1.53s/it][A
 48%|████▊     | 69/145 [01:42<01:56,  1.54s/it][A
 48%|████▊     | 70/145 [01:44<01:51,  1.49s/it][A
 49%|████▉     | 71/145 [01:45<01:50,  1.49s/it][A
 50%|████▉     | 72/145 [01:47<01:49,  1.51s/it][A
 50%|█████     | 73/145 [01:48<01:50,  1.53s/it][A
 51%|█████     | 74/145 [01:50<01:49,  1.54s/it][A
 52%|█████▏    | 75/145 [01:52<01:47,  1.54s/it][A
 52%|█████▏    | 76/145 [01:53<01:45,  1.53s/it][A
 53%|█████▎    | 77/145 [01:54<01:42,  1.50s/it][A
 54%|█████▍    | 78/145 [01:56<01:40,  1.50s/it][A
 54%|█████▍    | 79/145 [01:57<01:38,  1.49s/it][A
 55%|█████▌    | 80/145 [01:59<01:36,  1.48s/it][A
 56%|█████▌    | 81/145 [02:00<01:33,  1.46s/it][A
 57%|█████▋    | 82/145 [02:02<01:33,  1.48s/it][A
 57%|█████▋    | 83/145 [02:03<01:32,  1.49s/it][A
 58%|█████▊    | 84/145 [02:05<01:31,  1.50s/it][A
 59%|█████▊    | 85/145 [02:06<01:28,  1.48s/it][A
 59%|█████▉    | 86/145 [02:08<01:28,  1.50s/it][A
 60%|██████    | 87/145 [02:09<01:28,  1.52s/it][A
 61%|██████    | 88/145 [02:11<01:25,  1.50s/it][A
 61%|██████▏   | 89/145 [02:12<01:24,  1.51s/it][A
 62%|██████▏   | 90/145 [02:14<01:23,  1.52s/it][A
 63%|██████▎   | 91/145 [02:15<01:21,  1.51s/it][A
 63%|██████▎   | 92/145 [02:17<01:19,  1.51s/it][A
 64%|██████▍   | 93/145 [02:18<01:17,  1.49s/it][A
 65%|██████▍   | 94/145 [02:20<01:15,  1.49s/it][A
 66%|██████▌   | 95/145 [02:21<01:14,  1.49s/it][A
 66%|██████▌   | 96/145 [02:23<01:13,  1.50s/it][A
 67%|██████▋   | 97/145 [02:24<01:12,  1.51s/it][A
 68%|██████▊   | 98/145 [02:26<01:12,  1.54s/it][A
 68%|██████▊   | 99/145 [02:27<01:09,  1.51s/it][A
 69%|██████▉   | 100/145 [02:29<01:08,  1.52s/it][A
 70%|██████▉   | 101/145 [02:31<01:07,  1.53s/it][A
 70%|███████   | 102/145 [02:32<01:05,  1.52s/it][A
 71%|███████   | 103/145 [02:34<01:03,  1.52s/it][A
 72%|███████▏  | 104/145 [02:35<01:02,  1.52s/it][A
 72%|███████▏  | 105/145 [02:37<01:00,  1.52s/it][A
 73%|███████▎  | 106/145 [02:38<00:59,  1.51s/it][A
 74%|███████▍  | 107/145 [02:39<00:55,  1.47s/it][A
 74%|███████▍  | 108/145 [02:41<00:53,  1.45s/it][A
 75%|███████▌  | 109/145 [02:42<00:53,  1.47s/it][A
 76%|███████▌  | 110/145 [02:44<00:52,  1.50s/it][A
 77%|███████▋  | 111/145 [02:45<00:49,  1.46s/it][A
 77%|███████▋  | 112/145 [02:47<00:49,  1.49s/it][A
 78%|███████▊  | 113/145 [02:48<00:48,  1.51s/it][A
 79%|███████▊  | 114/145 [02:50<00:47,  1.52s/it][A
 79%|███████▉  | 115/145 [02:51<00:45,  1.52s/it][A
 80%|████████  | 116/145 [02:53<00:43,  1.49s/it][A
 81%|████████  | 117/145 [02:54<00:41,  1.48s/it][A
 81%|████████▏ | 118/145 [02:56<00:39,  1.48s/it][A
 82%|████████▏ | 119/145 [02:57<00:37,  1.44s/it][A
 83%|████████▎ | 120/145 [02:59<00:35,  1.43s/it][A
 83%|████████▎ | 121/145 [03:00<00:34,  1.43s/it][A
 84%|████████▍ | 122/145 [03:02<00:33,  1.45s/it][A
 85%|████████▍ | 123/145 [03:03<00:32,  1.47s/it][A
 86%|████████▌ | 124/145 [03:04<00:30,  1.46s/it][A
 86%|████████▌ | 125/145 [03:06<00:30,  1.51s/it][A
 87%|████████▋ | 126/145 [03:08<00:28,  1.49s/it][A
 88%|████████▊ | 127/145 [03:09<00:26,  1.49s/it][A
 88%|████████▊ | 128/145 [03:11<00:25,  1.51s/it][A
 89%|████████▉ | 129/145 [03:12<00:24,  1.51s/it][A
 90%|████████▉ | 130/145 [03:14<00:23,  1.53s/it][A
 90%|█████████ | 131/145 [03:15<00:20,  1.49s/it][A
 91%|█████████ | 132/145 [03:17<00:19,  1.51s/it][A
 92%|█████████▏| 133/145 [03:18<00:17,  1.48s/it][A
 92%|█████████▏| 134/145 [03:20<00:16,  1.52s/it][A
 93%|█████████▎| 135/145 [03:21<00:15,  1.52s/it][A
 94%|█████████▍| 136/145 [03:23<00:13,  1.51s/it][A
 94%|█████████▍| 137/145 [03:24<00:12,  1.50s/it][A
 95%|█████████▌| 138/145 [03:26<00:10,  1.51s/it][A
 96%|█████████▌| 139/145 [03:27<00:09,  1.51s/it][A
 97%|█████████▋| 140/145 [03:29<00:07,  1.52s/it][A
 97%|█████████▋| 141/145 [03:30<00:06,  1.52s/it][A
 98%|█████████▊| 142/145 [03:32<00:04,  1.50s/it][A
 99%|█████████▊| 143/145 [03:33<00:02,  1.50s/it][A
 99%|█████████▉| 144/145 [03:35<00:01,  1.51s/it][A
100%|██████████| 145/145 [03:36<00:00,  1.48s/it][A
                                                 [A                                                      {'eval_loss': 2.0619139671325684, 'eval_runtime': 218.3172, 'eval_samples_per_second': 5.3, 'eval_steps_per_second': 0.664, 'epoch': 2.15, 'num_input_tokens_seen': 7934976}

100%|██████████| 145/145 [03:36<00:00,  1.48s/it][A 22%|██▏       | 700/3250 [2:35:23<8:11:38, 11.57s/it]
                                                 [A[INFO|trainer.py:3705] 2024-10-11 07:27:27,027 >> Saving model checkpoint to /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-700
[INFO|configuration_utils.py:672] 2024-10-11 07:27:28,456 >> loading configuration file config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/config.json
[WARNING|modeling_rope_utils.py:379] 2024-10-11 07:27:28,456 >> Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
[INFO|configuration_utils.py:739] 2024-10-11 07:27:28,459 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 3584,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 18944,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 28,
  "num_hidden_layers": 28,
  "num_key_value_heads": 4,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.0",
  "use_cache": true,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "in_chans": 3,
    "model_type": "qwen2_vl",
    "spatial_patch_size": 14
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 152064
}

[INFO|tokenization_utils_base.py:2649] 2024-10-11 07:27:28,535 >> tokenizer config file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-700/tokenizer_config.json
[INFO|tokenization_utils_base.py:2658] 2024-10-11 07:27:28,536 >> Special tokens file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-700/special_tokens_map.json
[INFO|image_processing_base.py:258] 2024-10-11 07:27:29,038 >> Image processor saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-700/preprocessor_config.json
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 22%|██▏       | 701/3250 [2:35:37<54:53:44, 77.53s/it] 22%|██▏       | 702/3250 [2:35:48<40:48:00, 57.65s/it] 22%|██▏       | 703/3250 [2:35:59<30:59:26, 43.80s/it] 22%|██▏       | 704/3250 [2:36:11<24:04:36, 34.04s/it] 22%|██▏       | 705/3250 [2:36:22<19:12:55, 27.18s/it]                                                       {'loss': 2.1251, 'grad_norm': 9.302000999450684, 'learning_rate': 0.005, 'epoch': 2.17, 'num_input_tokens_seen': 7990880}
 22%|██▏       | 705/3250 [2:36:22<19:12:55, 27.18s/it] 22%|██▏       | 706/3250 [2:36:33<15:52:42, 22.47s/it] 22%|██▏       | 707/3250 [2:36:45<13:32:38, 19.17s/it] 22%|██▏       | 708/3250 [2:36:56<11:55:47, 16.90s/it] 22%|██▏       | 709/3250 [2:37:08<10:45:24, 15.24s/it] 22%|██▏       | 710/3250 [2:37:19<9:59:33, 14.16s/it]                                                       {'loss': 2.2899, 'grad_norm': 1.2959729433059692, 'learning_rate': 0.005, 'epoch': 2.18, 'num_input_tokens_seen': 8047840}
 22%|██▏       | 710/3250 [2:37:19<9:59:33, 14.16s/it] 22%|██▏       | 711/3250 [2:37:31<9:25:46, 13.37s/it] 22%|██▏       | 712/3250 [2:37:42<8:52:19, 12.58s/it] 22%|██▏       | 713/3250 [2:37:53<8:38:38, 12.27s/it] 22%|██▏       | 714/3250 [2:38:04<8:26:10, 11.98s/it] 22%|██▏       | 715/3250 [2:38:16<8:18:33, 11.80s/it]                                                      {'loss': 2.4059, 'grad_norm': 2.702125310897827, 'learning_rate': 0.005, 'epoch': 2.2, 'num_input_tokens_seen': 8104032}
 22%|██▏       | 715/3250 [2:38:16<8:18:33, 11.80s/it] 22%|██▏       | 716/3250 [2:38:27<8:14:57, 11.72s/it] 22%|██▏       | 717/3250 [2:38:39<8:09:26, 11.59s/it] 22%|██▏       | 718/3250 [2:38:50<8:06:56, 11.54s/it] 22%|██▏       | 719/3250 [2:39:01<8:02:04, 11.43s/it] 22%|██▏       | 720/3250 [2:39:12<7:59:53, 11.38s/it]                                                      {'loss': 2.2971, 'grad_norm': 2.3943958282470703, 'learning_rate': 0.005, 'epoch': 2.21, 'num_input_tokens_seen': 8161248}
 22%|██▏       | 720/3250 [2:39:12<7:59:53, 11.38s/it] 22%|██▏       | 721/3250 [2:39:24<8:04:39, 11.50s/it] 22%|██▏       | 722/3250 [2:39:36<8:04:15, 11.49s/it] 22%|██▏       | 723/3250 [2:39:47<8:01:30, 11.43s/it] 22%|██▏       | 724/3250 [2:39:58<7:57:49, 11.35s/it] 22%|██▏       | 725/3250 [2:40:10<7:57:55, 11.36s/it]                                                      {'loss': 2.17, 'grad_norm': 1.3010352849960327, 'learning_rate': 0.005, 'epoch': 2.23, 'num_input_tokens_seen': 8218464}
 22%|██▏       | 725/3250 [2:40:10<7:57:55, 11.36s/it] 22%|██▏       | 726/3250 [2:40:21<7:57:10, 11.34s/it] 22%|██▏       | 727/3250 [2:40:32<7:59:30, 11.40s/it] 22%|██▏       | 728/3250 [2:40:44<8:01:43, 11.46s/it] 22%|██▏       | 729/3250 [2:40:56<8:03:00, 11.50s/it] 22%|██▏       | 730/3250 [2:41:07<8:02:35, 11.49s/it]                                                      {'loss': 2.1167, 'grad_norm': 3.789292573928833, 'learning_rate': 0.005, 'epoch': 2.24, 'num_input_tokens_seen': 8276000}
 22%|██▏       | 730/3250 [2:41:07<8:02:35, 11.49s/it] 22%|██▏       | 731/3250 [2:41:18<8:00:10, 11.44s/it] 23%|██▎       | 732/3250 [2:41:30<7:59:05, 11.42s/it] 23%|██▎       | 733/3250 [2:41:41<7:59:07, 11.42s/it] 23%|██▎       | 734/3250 [2:41:53<7:59:53, 11.44s/it] 23%|██▎       | 735/3250 [2:42:04<7:55:38, 11.35s/it]                                                      {'loss': 2.2893, 'grad_norm': 1.736363172531128, 'learning_rate': 0.005, 'epoch': 2.26, 'num_input_tokens_seen': 8332320}
 23%|██▎       | 735/3250 [2:42:04<7:55:38, 11.35s/it] 23%|██▎       | 736/3250 [2:42:15<7:54:01, 11.31s/it] 23%|██▎       | 737/3250 [2:42:26<7:54:53, 11.34s/it] 23%|██▎       | 738/3250 [2:42:38<7:52:47, 11.29s/it] 23%|██▎       | 739/3250 [2:42:49<7:54:14, 11.33s/it] 23%|██▎       | 740/3250 [2:43:00<7:55:43, 11.37s/it]                                                      {'loss': 2.1944, 'grad_norm': 2.132777690887451, 'learning_rate': 0.005, 'epoch': 2.27, 'num_input_tokens_seen': 8389984}
 23%|██▎       | 740/3250 [2:43:00<7:55:43, 11.37s/it] 23%|██▎       | 741/3250 [2:43:12<7:52:25, 11.30s/it] 23%|██▎       | 742/3250 [2:43:23<7:50:25, 11.25s/it] 23%|██▎       | 743/3250 [2:43:34<7:51:00, 11.27s/it] 23%|██▎       | 744/3250 [2:43:45<7:49:34, 11.24s/it] 23%|██▎       | 745/3250 [2:43:56<7:47:17, 11.19s/it]                                                      {'loss': 2.3076, 'grad_norm': 1.377102255821228, 'learning_rate': 0.005, 'epoch': 2.29, 'num_input_tokens_seen': 8445280}
 23%|██▎       | 745/3250 [2:43:56<7:47:17, 11.19s/it] 23%|██▎       | 746/3250 [2:44:08<7:48:06, 11.22s/it] 23%|██▎       | 747/3250 [2:44:19<7:52:00, 11.31s/it] 23%|██▎       | 748/3250 [2:44:31<7:55:17, 11.40s/it] 23%|██▎       | 749/3250 [2:44:42<7:51:20, 11.31s/it] 23%|██▎       | 750/3250 [2:44:53<7:54:33, 11.39s/it]                                                      {'loss': 2.1931, 'grad_norm': 1.0271254777908325, 'learning_rate': 0.005, 'epoch': 2.3, 'num_input_tokens_seen': 8502240}
 23%|██▎       | 750/3250 [2:44:53<7:54:33, 11.39s/it] 23%|██▎       | 751/3250 [2:45:05<7:55:13, 11.41s/it] 23%|██▎       | 752/3250 [2:45:16<7:55:55, 11.43s/it] 23%|██▎       | 753/3250 [2:45:28<7:57:03, 11.46s/it] 23%|██▎       | 754/3250 [2:45:39<7:53:17, 11.38s/it] 23%|██▎       | 755/3250 [2:45:50<7:52:23, 11.36s/it]                                                      {'loss': 2.1594, 'grad_norm': 1.711378812789917, 'learning_rate': 0.005, 'epoch': 2.32, 'num_input_tokens_seen': 8560000}
 23%|██▎       | 755/3250 [2:45:50<7:52:23, 11.36s/it] 23%|██▎       | 756/3250 [2:46:02<7:51:43, 11.35s/it] 23%|██▎       | 757/3250 [2:46:13<7:51:37, 11.35s/it] 23%|██▎       | 758/3250 [2:46:25<7:55:58, 11.46s/it] 23%|██▎       | 759/3250 [2:46:36<7:55:11, 11.45s/it] 23%|██▎       | 760/3250 [2:46:48<7:55:47, 11.46s/it]                                                      {'loss': 2.2091, 'grad_norm': 1.3305773735046387, 'learning_rate': 0.005, 'epoch': 2.33, 'num_input_tokens_seen': 8617056}
 23%|██▎       | 760/3250 [2:46:48<7:55:47, 11.46s/it] 23%|██▎       | 761/3250 [2:46:59<7:57:24, 11.51s/it] 23%|██▎       | 762/3250 [2:47:11<7:55:07, 11.46s/it] 23%|██▎       | 763/3250 [2:47:22<7:54:34, 11.45s/it] 24%|██▎       | 764/3250 [2:47:33<7:52:42, 11.41s/it] 24%|██▎       | 765/3250 [2:47:45<7:53:59, 11.44s/it]                                                      {'loss': 2.1081, 'grad_norm': 1.1968027353286743, 'learning_rate': 0.005, 'epoch': 2.35, 'num_input_tokens_seen': 8674112}
 24%|██▎       | 765/3250 [2:47:45<7:53:59, 11.44s/it] 24%|██▎       | 766/3250 [2:47:56<7:55:15, 11.48s/it] 24%|██▎       | 767/3250 [2:48:08<7:56:16, 11.51s/it] 24%|██▎       | 768/3250 [2:48:19<7:54:36, 11.47s/it] 24%|██▎       | 769/3250 [2:48:31<8:01:40, 11.65s/it] 24%|██▎       | 770/3250 [2:48:43<7:58:13, 11.57s/it]                                                      {'loss': 2.1471, 'grad_norm': 0.9248445630073547, 'learning_rate': 0.005, 'epoch': 2.37, 'num_input_tokens_seen': 8731680}
 24%|██▎       | 770/3250 [2:48:43<7:58:13, 11.57s/it] 24%|██▎       | 771/3250 [2:48:54<7:56:27, 11.53s/it] 24%|██▍       | 772/3250 [2:49:06<7:53:32, 11.47s/it] 24%|██▍       | 773/3250 [2:49:17<7:53:36, 11.47s/it] 24%|██▍       | 774/3250 [2:49:29<7:52:25, 11.45s/it] 24%|██▍       | 775/3250 [2:49:40<7:52:20, 11.45s/it]                                                      {'loss': 2.1018, 'grad_norm': 0.8716819882392883, 'learning_rate': 0.005, 'epoch': 2.38, 'num_input_tokens_seen': 8788928}
 24%|██▍       | 775/3250 [2:49:40<7:52:20, 11.45s/it] 24%|██▍       | 776/3250 [2:49:52<7:53:18, 11.48s/it] 24%|██▍       | 777/3250 [2:50:03<7:52:22, 11.46s/it] 24%|██▍       | 778/3250 [2:50:14<7:51:10, 11.44s/it] 24%|██▍       | 779/3250 [2:50:26<7:52:31, 11.47s/it] 24%|██▍       | 780/3250 [2:50:37<7:53:21, 11.50s/it]                                                      {'loss': 2.2312, 'grad_norm': 1.0053811073303223, 'learning_rate': 0.005, 'epoch': 2.4, 'num_input_tokens_seen': 8846496}
 24%|██▍       | 780/3250 [2:50:37<7:53:21, 11.50s/it] 24%|██▍       | 781/3250 [2:50:49<7:52:56, 11.49s/it] 24%|██▍       | 782/3250 [2:51:00<7:48:07, 11.38s/it] 24%|██▍       | 783/3250 [2:51:12<7:51:51, 11.48s/it] 24%|██▍       | 784/3250 [2:51:23<7:49:25, 11.42s/it] 24%|██▍       | 785/3250 [2:51:34<7:45:21, 11.33s/it]                                                      {'loss': 2.1844, 'grad_norm': 0.7145873308181763, 'learning_rate': 0.005, 'epoch': 2.41, 'num_input_tokens_seen': 8902688}
 24%|██▍       | 785/3250 [2:51:34<7:45:21, 11.33s/it] 24%|██▍       | 786/3250 [2:51:46<7:46:11, 11.35s/it] 24%|██▍       | 787/3250 [2:51:57<7:46:17, 11.36s/it] 24%|██▍       | 788/3250 [2:52:08<7:44:18, 11.32s/it] 24%|██▍       | 789/3250 [2:52:19<7:42:57, 11.29s/it] 24%|██▍       | 790/3250 [2:52:31<7:47:04, 11.39s/it]                                                      {'loss': 2.1209, 'grad_norm': 1.0238460302352905, 'learning_rate': 0.005, 'epoch': 2.43, 'num_input_tokens_seen': 8960128}
 24%|██▍       | 790/3250 [2:52:31<7:47:04, 11.39s/it] 24%|██▍       | 791/3250 [2:52:42<7:39:54, 11.22s/it] 24%|██▍       | 792/3250 [2:52:53<7:42:14, 11.28s/it] 24%|██▍       | 793/3250 [2:53:05<7:43:32, 11.32s/it] 24%|██▍       | 794/3250 [2:53:16<7:43:24, 11.32s/it] 24%|██▍       | 795/3250 [2:53:28<7:46:31, 11.40s/it]                                                      {'loss': 2.2054, 'grad_norm': 1.1997228860855103, 'learning_rate': 0.005, 'epoch': 2.44, 'num_input_tokens_seen': 9015776}
 24%|██▍       | 795/3250 [2:53:28<7:46:31, 11.40s/it] 24%|██▍       | 796/3250 [2:53:39<7:43:11, 11.32s/it] 25%|██▍       | 797/3250 [2:53:50<7:40:21, 11.26s/it] 25%|██▍       | 798/3250 [2:54:01<7:38:44, 11.23s/it] 25%|██▍       | 799/3250 [2:54:12<7:35:24, 11.15s/it] 25%|██▍       | 800/3250 [2:54:23<7:35:50, 11.16s/it]                                                      {'loss': 2.2238, 'grad_norm': 0.6215670704841614, 'learning_rate': 0.005, 'epoch': 2.46, 'num_input_tokens_seen': 9070752}
 25%|██▍       | 800/3250 [2:54:23<7:35:50, 11.16s/it][INFO|trainer.py:4021] 2024-10-11 07:46:26,741 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-10-11 07:46:26,742 >>   Num examples = 1157
[INFO|trainer.py:4026] 2024-10-11 07:46:26,742 >>   Batch size = 4

  0%|          | 0/145 [00:00<?, ?it/s][A
  1%|▏         | 2/145 [00:01<01:46,  1.34it/s][A
  2%|▏         | 3/145 [00:03<02:33,  1.08s/it][A
  3%|▎         | 4/145 [00:04<02:53,  1.23s/it][A
  3%|▎         | 5/145 [00:05<02:59,  1.28s/it][A
  4%|▍         | 6/145 [00:07<03:09,  1.36s/it][A
  5%|▍         | 7/145 [00:08<03:15,  1.42s/it][A
  6%|▌         | 8/145 [00:10<03:13,  1.41s/it][A
  6%|▌         | 9/145 [00:11<03:13,  1.42s/it][A
  7%|▋         | 10/145 [00:13<03:14,  1.44s/it][A
  8%|▊         | 11/145 [00:14<03:15,  1.46s/it][A
  8%|▊         | 12/145 [00:16<03:17,  1.49s/it][A
  9%|▉         | 13/145 [00:17<03:18,  1.50s/it][A
 10%|▉         | 14/145 [00:19<03:19,  1.52s/it][A
 10%|█         | 15/145 [00:20<03:16,  1.51s/it][A
 11%|█         | 16/145 [00:22<03:13,  1.50s/it][A
 12%|█▏        | 17/145 [00:23<03:12,  1.50s/it][A
 12%|█▏        | 18/145 [00:25<03:11,  1.51s/it][A
 13%|█▎        | 19/145 [00:26<03:10,  1.51s/it][A
 14%|█▍        | 20/145 [00:28<03:09,  1.51s/it][A
 14%|█▍        | 21/145 [00:29<03:05,  1.49s/it][A
 15%|█▌        | 22/145 [00:31<03:02,  1.48s/it][A
 16%|█▌        | 23/145 [00:32<03:00,  1.48s/it][A
 17%|█▋        | 24/145 [00:34<02:59,  1.49s/it][A
 17%|█▋        | 25/145 [00:35<02:58,  1.49s/it][A
 18%|█▊        | 26/145 [00:37<02:56,  1.48s/it][A
 19%|█▊        | 27/145 [00:38<02:56,  1.49s/it][A
 19%|█▉        | 28/145 [00:40<02:53,  1.49s/it][A
 20%|██        | 29/145 [00:41<02:52,  1.48s/it][A
 21%|██        | 30/145 [00:43<02:46,  1.45s/it][A
 21%|██▏       | 31/145 [00:44<02:47,  1.47s/it][A
 22%|██▏       | 32/145 [00:46<02:46,  1.47s/it][A
 23%|██▎       | 33/145 [00:47<02:46,  1.48s/it][A
 23%|██▎       | 34/145 [00:49<02:45,  1.49s/it][A
 24%|██▍       | 35/145 [00:50<02:44,  1.49s/it][A
 25%|██▍       | 36/145 [00:52<02:42,  1.49s/it][A
 26%|██▌       | 37/145 [00:53<02:44,  1.52s/it][A
 26%|██▌       | 38/145 [00:55<02:43,  1.52s/it][A
 27%|██▋       | 39/145 [00:56<02:40,  1.51s/it][A
 28%|██▊       | 40/145 [00:58<02:38,  1.51s/it][A
 28%|██▊       | 41/145 [00:59<02:39,  1.53s/it][A
 29%|██▉       | 42/145 [01:01<02:37,  1.53s/it][A
 30%|██▉       | 43/145 [01:02<02:33,  1.51s/it][A
 30%|███       | 44/145 [01:04<02:34,  1.53s/it][A
 31%|███       | 45/145 [01:05<02:34,  1.55s/it][A
 32%|███▏      | 46/145 [01:07<02:30,  1.52s/it][A
 32%|███▏      | 47/145 [01:08<02:26,  1.50s/it][A
 33%|███▎      | 48/145 [01:10<02:26,  1.51s/it][A
 34%|███▍      | 49/145 [01:11<02:25,  1.52s/it][A
 34%|███▍      | 50/145 [01:13<02:25,  1.53s/it][A
 35%|███▌      | 51/145 [01:15<02:23,  1.53s/it][A
 36%|███▌      | 52/145 [01:16<02:21,  1.53s/it][A
 37%|███▋      | 53/145 [01:18<02:20,  1.52s/it][A
 37%|███▋      | 54/145 [01:19<02:18,  1.53s/it][A
 38%|███▊      | 55/145 [01:21<02:16,  1.52s/it][A
 39%|███▊      | 56/145 [01:22<02:14,  1.52s/it][A
 39%|███▉      | 57/145 [01:24<02:12,  1.50s/it][A
 40%|████      | 58/145 [01:25<02:10,  1.50s/it][A
 41%|████      | 59/145 [01:27<02:11,  1.52s/it][A
 41%|████▏     | 60/145 [01:28<02:08,  1.51s/it][A
 42%|████▏     | 61/145 [01:30<02:06,  1.51s/it][A
 43%|████▎     | 62/145 [01:31<02:03,  1.49s/it][A
 43%|████▎     | 63/145 [01:33<02:03,  1.51s/it][A
 44%|████▍     | 64/145 [01:34<02:01,  1.51s/it][A
 45%|████▍     | 65/145 [01:36<02:01,  1.51s/it][A
 46%|████▌     | 66/145 [01:37<01:59,  1.51s/it][A
 46%|████▌     | 67/145 [01:39<01:57,  1.50s/it][A
 47%|████▋     | 68/145 [01:40<01:57,  1.53s/it][A
 48%|████▊     | 69/145 [01:42<01:56,  1.53s/it][A
 48%|████▊     | 70/145 [01:43<01:51,  1.49s/it][A
 49%|████▉     | 71/145 [01:45<01:49,  1.48s/it][A
 50%|████▉     | 72/145 [01:46<01:49,  1.49s/it][A
 50%|█████     | 73/145 [01:48<01:49,  1.52s/it][A
 51%|█████     | 74/145 [01:49<01:48,  1.52s/it][A
 52%|█████▏    | 75/145 [01:51<01:46,  1.53s/it][A
 52%|█████▏    | 76/145 [01:52<01:44,  1.52s/it][A
 53%|█████▎    | 77/145 [01:54<01:41,  1.49s/it][A
 54%|█████▍    | 78/145 [01:55<01:39,  1.49s/it][A
 54%|█████▍    | 79/145 [01:57<01:37,  1.48s/it][A
 55%|█████▌    | 80/145 [01:58<01:35,  1.47s/it][A
 56%|█████▌    | 81/145 [02:00<01:32,  1.45s/it][A
 57%|█████▋    | 82/145 [02:01<01:32,  1.47s/it][A
 57%|█████▋    | 83/145 [02:03<01:32,  1.49s/it][A
 58%|█████▊    | 84/145 [02:04<01:31,  1.50s/it][A
 59%|█████▊    | 85/145 [02:06<01:28,  1.47s/it][A
 59%|█████▉    | 86/145 [02:07<01:28,  1.50s/it][A
 60%|██████    | 87/145 [02:09<01:28,  1.52s/it][A
 61%|██████    | 88/145 [02:10<01:25,  1.49s/it][A
 61%|██████▏   | 89/145 [02:12<01:24,  1.50s/it][A
 62%|██████▏   | 90/145 [02:13<01:23,  1.51s/it][A
 63%|██████▎   | 91/145 [02:15<01:21,  1.51s/it][A
 63%|██████▎   | 92/145 [02:16<01:19,  1.50s/it][A
 64%|██████▍   | 93/145 [02:18<01:17,  1.48s/it][A
 65%|██████▍   | 94/145 [02:19<01:15,  1.48s/it][A
 66%|██████▌   | 95/145 [02:21<01:14,  1.48s/it][A
 66%|██████▌   | 96/145 [02:22<01:13,  1.49s/it][A
 67%|██████▋   | 97/145 [02:24<01:12,  1.50s/it][A
 68%|██████▊   | 98/145 [02:25<01:11,  1.53s/it][A
 68%|██████▊   | 99/145 [02:27<01:09,  1.50s/it][A
 69%|██████▉   | 100/145 [02:28<01:08,  1.51s/it][A
 70%|██████▉   | 101/145 [02:30<01:06,  1.52s/it][A
 70%|███████   | 102/145 [02:31<01:05,  1.52s/it][A
 71%|███████   | 103/145 [02:33<01:03,  1.51s/it][A
 72%|███████▏  | 104/145 [02:34<01:02,  1.52s/it][A
 72%|███████▏  | 105/145 [02:36<01:00,  1.52s/it][A
 73%|███████▎  | 106/145 [02:37<00:59,  1.52s/it][A
 74%|███████▍  | 107/145 [02:39<00:55,  1.47s/it][A
 74%|███████▍  | 108/145 [02:40<00:53,  1.45s/it][A
 75%|███████▌  | 109/145 [02:42<00:53,  1.47s/it][A
 76%|███████▌  | 110/145 [02:43<00:52,  1.49s/it][A
 77%|███████▋  | 111/145 [02:44<00:49,  1.46s/it][A
 77%|███████▋  | 112/145 [02:46<00:49,  1.49s/it][A
 78%|███████▊  | 113/145 [02:48<00:48,  1.51s/it][A
 79%|███████▊  | 114/145 [02:49<00:46,  1.52s/it][A
 79%|███████▉  | 115/145 [02:51<00:45,  1.51s/it][A
 80%|████████  | 116/145 [02:52<00:42,  1.48s/it][A
 81%|████████  | 117/145 [02:53<00:41,  1.48s/it][A
 81%|████████▏ | 118/145 [02:55<00:39,  1.48s/it][A
 82%|████████▏ | 119/145 [02:56<00:37,  1.44s/it][A
 83%|████████▎ | 120/145 [02:58<00:35,  1.43s/it][A
 83%|████████▎ | 121/145 [02:59<00:34,  1.43s/it][A
 84%|████████▍ | 122/145 [03:01<00:33,  1.44s/it][A
 85%|████████▍ | 123/145 [03:02<00:32,  1.46s/it][A
 86%|████████▌ | 124/145 [03:04<00:30,  1.45s/it][A
 86%|████████▌ | 125/145 [03:05<00:30,  1.51s/it][A
 87%|████████▋ | 126/145 [03:07<00:28,  1.49s/it][A
 88%|████████▊ | 127/145 [03:08<00:26,  1.48s/it][A
 88%|████████▊ | 128/145 [03:10<00:25,  1.51s/it][A
 89%|████████▉ | 129/145 [03:11<00:24,  1.51s/it][A
 90%|████████▉ | 130/145 [03:13<00:22,  1.53s/it][A
 90%|█████████ | 131/145 [03:14<00:20,  1.49s/it][A
 91%|█████████ | 132/145 [03:16<00:19,  1.50s/it][A
 92%|█████████▏| 133/145 [03:17<00:17,  1.48s/it][A
 92%|█████████▏| 134/145 [03:19<00:16,  1.51s/it][A
 93%|█████████▎| 135/145 [03:20<00:15,  1.51s/it][A
 94%|█████████▍| 136/145 [03:22<00:13,  1.51s/it][A
 94%|█████████▍| 137/145 [03:23<00:11,  1.50s/it][A
 95%|█████████▌| 138/145 [03:25<00:10,  1.51s/it][A
 96%|█████████▌| 139/145 [03:26<00:09,  1.50s/it][A
 97%|█████████▋| 140/145 [03:28<00:07,  1.51s/it][A
 97%|█████████▋| 141/145 [03:29<00:06,  1.51s/it][A
 98%|█████████▊| 142/145 [03:31<00:04,  1.50s/it][A
 99%|█████████▊| 143/145 [03:32<00:02,  1.49s/it][A
 99%|█████████▉| 144/145 [03:34<00:01,  1.50s/it][A
100%|██████████| 145/145 [03:35<00:00,  1.47s/it][A
                                                 [A                                                      {'eval_loss': 2.218425989151001, 'eval_runtime': 217.2595, 'eval_samples_per_second': 5.325, 'eval_steps_per_second': 0.667, 'epoch': 2.46, 'num_input_tokens_seen': 9070752}

100%|██████████| 145/145 [03:35<00:00,  1.47s/it][A 25%|██▍       | 800/3250 [2:58:00<7:35:50, 11.16s/it]
                                                 [A[INFO|trainer.py:3705] 2024-10-11 07:50:04,003 >> Saving model checkpoint to /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-800
[INFO|configuration_utils.py:672] 2024-10-11 07:50:05,034 >> loading configuration file config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/config.json
[WARNING|modeling_rope_utils.py:379] 2024-10-11 07:50:05,034 >> Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
[INFO|configuration_utils.py:739] 2024-10-11 07:50:05,037 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 3584,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 18944,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 28,
  "num_hidden_layers": 28,
  "num_key_value_heads": 4,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.0",
  "use_cache": true,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "in_chans": 3,
    "model_type": "qwen2_vl",
    "spatial_patch_size": 14
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 152064
}

[INFO|tokenization_utils_base.py:2649] 2024-10-11 07:50:05,115 >> tokenizer config file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-800/tokenizer_config.json
[INFO|tokenization_utils_base.py:2658] 2024-10-11 07:50:05,115 >> Special tokens file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-800/special_tokens_map.json
[INFO|image_processing_base.py:258] 2024-10-11 07:50:05,612 >> Image processor saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-800/preprocessor_config.json
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 25%|██▍       | 801/3250 [2:58:13<52:19:34, 76.92s/it] 25%|██▍       | 802/3250 [2:58:25<38:56:33, 57.27s/it] 25%|██▍       | 803/3250 [2:58:36<29:33:21, 43.48s/it] 25%|██▍       | 804/3250 [2:58:47<22:58:54, 33.82s/it] 25%|██▍       | 805/3250 [2:58:59<18:24:09, 27.10s/it]                                                       {'loss': 2.2439, 'grad_norm': 1.0900465250015259, 'learning_rate': 0.005, 'epoch': 2.47, 'num_input_tokens_seen': 9127648}
 25%|██▍       | 805/3250 [2:58:59<18:24:09, 27.10s/it] 25%|██▍       | 806/3250 [2:59:11<15:14:34, 22.45s/it] 25%|██▍       | 807/3250 [2:59:22<12:54:58, 19.03s/it] 25%|██▍       | 808/3250 [2:59:33<11:22:04, 16.76s/it] 25%|██▍       | 809/3250 [2:59:44<10:14:44, 15.11s/it] 25%|██▍       | 810/3250 [2:59:56<9:29:22, 14.00s/it]                                                       {'loss': 2.1854, 'grad_norm': 2.022904872894287, 'learning_rate': 0.005, 'epoch': 2.49, 'num_input_tokens_seen': 9183744}
 25%|██▍       | 810/3250 [2:59:56<9:29:22, 14.00s/it] 25%|██▍       | 811/3250 [3:00:07<8:55:38, 13.18s/it] 25%|██▍       | 812/3250 [3:00:18<8:33:53, 12.65s/it] 25%|██▌       | 813/3250 [3:00:30<8:20:40, 12.33s/it] 25%|██▌       | 814/3250 [3:00:41<8:05:49, 11.97s/it] 25%|██▌       | 815/3250 [3:00:53<8:06:01, 11.98s/it]                                                      {'loss': 2.1568, 'grad_norm': 1.2064521312713623, 'learning_rate': 0.005, 'epoch': 2.5, 'num_input_tokens_seen': 9239936}
 25%|██▌       | 815/3250 [3:00:53<8:06:01, 11.98s/it] 25%|██▌       | 816/3250 [3:01:04<7:58:41, 11.80s/it] 25%|██▌       | 817/3250 [3:01:16<7:54:24, 11.70s/it] 25%|██▌       | 818/3250 [3:01:27<7:43:57, 11.45s/it] 25%|██▌       | 819/3250 [3:01:38<7:42:28, 11.41s/it] 25%|██▌       | 820/3250 [3:01:50<7:43:37, 11.45s/it]                                                      {'loss': 2.1251, 'grad_norm': 1.3773300647735596, 'learning_rate': 0.005, 'epoch': 2.52, 'num_input_tokens_seen': 9296928}
 25%|██▌       | 820/3250 [3:01:50<7:43:37, 11.45s/it] 25%|██▌       | 821/3250 [3:02:01<7:43:24, 11.45s/it] 25%|██▌       | 822/3250 [3:02:12<7:40:57, 11.39s/it] 25%|██▌       | 823/3250 [3:02:24<7:41:19, 11.41s/it] 25%|██▌       | 824/3250 [3:02:35<7:42:32, 11.44s/it] 25%|██▌       | 825/3250 [3:02:47<7:43:47, 11.48s/it]                                                      {'loss': 2.1265, 'grad_norm': 1.0407085418701172, 'learning_rate': 0.005, 'epoch': 2.53, 'num_input_tokens_seen': 9354048}
 25%|██▌       | 825/3250 [3:02:47<7:43:47, 11.48s/it] 25%|██▌       | 826/3250 [3:02:58<7:44:46, 11.50s/it] 25%|██▌       | 827/3250 [3:03:10<7:43:40, 11.48s/it] 25%|██▌       | 828/3250 [3:03:21<7:39:48, 11.39s/it] 26%|██▌       | 829/3250 [3:03:32<7:37:47, 11.35s/it] 26%|██▌       | 830/3250 [3:03:44<7:37:15, 11.34s/it]                                                      {'loss': 2.0575, 'grad_norm': 0.8921152949333191, 'learning_rate': 0.005, 'epoch': 2.55, 'num_input_tokens_seen': 9409984}
 26%|██▌       | 830/3250 [3:03:44<7:37:15, 11.34s/it] 26%|██▌       | 831/3250 [3:03:55<7:36:20, 11.32s/it] 26%|██▌       | 832/3250 [3:04:06<7:39:40, 11.41s/it] 26%|██▌       | 833/3250 [3:04:18<7:39:40, 11.41s/it] 26%|██▌       | 834/3250 [3:04:29<7:37:39, 11.37s/it] 26%|██▌       | 835/3250 [3:04:41<7:39:06, 11.41s/it]                                                      {'loss': 2.1183, 'grad_norm': 6.752548694610596, 'learning_rate': 0.005, 'epoch': 2.57, 'num_input_tokens_seen': 9468000}
 26%|██▌       | 835/3250 [3:04:41<7:39:06, 11.41s/it] 26%|██▌       | 836/3250 [3:04:52<7:39:10, 11.41s/it] 26%|██▌       | 837/3250 [3:05:03<7:32:45, 11.26s/it] 26%|██▌       | 838/3250 [3:05:14<7:32:19, 11.25s/it] 26%|██▌       | 839/3250 [3:05:26<7:34:02, 11.30s/it] 26%|██▌       | 840/3250 [3:05:37<7:33:03, 11.28s/it]                                                      {'loss': 2.168, 'grad_norm': 1.8483017683029175, 'learning_rate': 0.005, 'epoch': 2.58, 'num_input_tokens_seen': 9523968}
 26%|██▌       | 840/3250 [3:05:37<7:33:03, 11.28s/it] 26%|██▌       | 841/3250 [3:05:48<7:35:09, 11.34s/it] 26%|██▌       | 842/3250 [3:06:00<7:33:41, 11.30s/it] 26%|██▌       | 843/3250 [3:06:11<7:35:27, 11.35s/it] 26%|██▌       | 844/3250 [3:06:22<7:32:41, 11.29s/it] 26%|██▌       | 845/3250 [3:06:34<7:36:58, 11.40s/it]                                                      {'loss': 2.1801, 'grad_norm': 3.6370999813079834, 'learning_rate': 0.005, 'epoch': 2.6, 'num_input_tokens_seen': 9581312}
 26%|██▌       | 845/3250 [3:06:34<7:36:58, 11.40s/it] 26%|██▌       | 846/3250 [3:06:45<7:37:40, 11.42s/it] 26%|██▌       | 847/3250 [3:06:57<7:38:45, 11.45s/it] 26%|██▌       | 848/3250 [3:07:08<7:35:14, 11.37s/it] 26%|██▌       | 849/3250 [3:07:19<7:35:50, 11.39s/it] 26%|██▌       | 850/3250 [3:07:31<7:36:32, 11.41s/it]                                                      {'loss': 2.1916, 'grad_norm': 1.6042087078094482, 'learning_rate': 0.005, 'epoch': 2.61, 'num_input_tokens_seen': 9638432}
 26%|██▌       | 850/3250 [3:07:31<7:36:32, 11.41s/it] 26%|██▌       | 851/3250 [3:07:42<7:32:40, 11.32s/it] 26%|██▌       | 852/3250 [3:07:54<7:35:41, 11.40s/it] 26%|██▌       | 853/3250 [3:08:05<7:31:43, 11.31s/it] 26%|██▋       | 854/3250 [3:08:16<7:32:20, 11.33s/it] 26%|██▋       | 855/3250 [3:08:28<7:35:49, 11.42s/it]                                                      {'loss': 2.1983, 'grad_norm': 0.802245557308197, 'learning_rate': 0.005, 'epoch': 2.63, 'num_input_tokens_seen': 9694144}
 26%|██▋       | 855/3250 [3:08:28<7:35:49, 11.42s/it] 26%|██▋       | 856/3250 [3:08:39<7:33:49, 11.37s/it] 26%|██▋       | 857/3250 [3:08:50<7:33:17, 11.37s/it] 26%|██▋       | 858/3250 [3:09:01<7:27:55, 11.24s/it] 26%|██▋       | 859/3250 [3:09:13<7:32:37, 11.36s/it] 26%|██▋       | 860/3250 [3:09:24<7:33:53, 11.39s/it]                                                      {'loss': 2.4163, 'grad_norm': 2.639547109603882, 'learning_rate': 0.005, 'epoch': 2.64, 'num_input_tokens_seen': 9749920}
 26%|██▋       | 860/3250 [3:09:24<7:33:53, 11.39s/it] 26%|██▋       | 861/3250 [3:09:36<7:33:33, 11.39s/it] 27%|██▋       | 862/3250 [3:09:47<7:35:40, 11.45s/it] 27%|██▋       | 863/3250 [3:09:59<7:35:22, 11.45s/it] 27%|██▋       | 864/3250 [3:10:11<7:42:41, 11.64s/it] 27%|██▋       | 865/3250 [3:10:22<7:40:11, 11.58s/it]                                                      {'loss': 2.5097, 'grad_norm': 2.065250873565674, 'learning_rate': 0.005, 'epoch': 2.66, 'num_input_tokens_seen': 9806976}
 27%|██▋       | 865/3250 [3:10:22<7:40:11, 11.58s/it] 27%|██▋       | 866/3250 [3:10:34<7:39:27, 11.56s/it] 27%|██▋       | 867/3250 [3:10:45<7:38:05, 11.53s/it] 27%|██▋       | 868/3250 [3:10:57<7:38:00, 11.54s/it] 27%|██▋       | 869/3250 [3:11:09<7:39:26, 11.58s/it] 27%|██▋       | 870/3250 [3:11:20<7:36:28, 11.51s/it]                                                      {'loss': 2.2753, 'grad_norm': 1.313762903213501, 'learning_rate': 0.005, 'epoch': 2.67, 'num_input_tokens_seen': 9864640}
 27%|██▋       | 870/3250 [3:11:20<7:36:28, 11.51s/it] 27%|██▋       | 871/3250 [3:11:31<7:36:13, 11.51s/it] 27%|██▋       | 872/3250 [3:11:43<7:38:51, 11.58s/it] 27%|██▋       | 873/3250 [3:11:55<7:37:51, 11.56s/it] 27%|██▋       | 874/3250 [3:12:06<7:37:24, 11.55s/it] 27%|██▋       | 875/3250 [3:12:18<7:36:11, 11.52s/it]                                                      {'loss': 2.291, 'grad_norm': 1.9604191780090332, 'learning_rate': 0.005, 'epoch': 2.69, 'num_input_tokens_seen': 9922112}
 27%|██▋       | 875/3250 [3:12:18<7:36:11, 11.52s/it] 27%|██▋       | 876/3250 [3:12:29<7:35:23, 11.51s/it] 27%|██▋       | 877/3250 [3:12:41<7:35:45, 11.52s/it] 27%|██▋       | 878/3250 [3:12:52<7:34:33, 11.50s/it] 27%|██▋       | 879/3250 [3:13:04<7:33:54, 11.49s/it] 27%|██▋       | 880/3250 [3:13:15<7:35:07, 11.52s/it]                                                      {'loss': 2.2481, 'grad_norm': 1.1531623601913452, 'learning_rate': 0.005, 'epoch': 2.7, 'num_input_tokens_seen': 9979168}
 27%|██▋       | 880/3250 [3:13:15<7:35:07, 11.52s/it] 27%|██▋       | 881/3250 [3:13:27<7:35:37, 11.54s/it] 27%|██▋       | 882/3250 [3:13:38<7:37:43, 11.60s/it] 27%|██▋       | 883/3250 [3:13:50<7:34:14, 11.51s/it] 27%|██▋       | 884/3250 [3:14:01<7:31:46, 11.46s/it] 27%|██▋       | 885/3250 [3:14:12<7:29:53, 11.41s/it]                                                      {'loss': 2.2768, 'grad_norm': 1.2169749736785889, 'learning_rate': 0.005, 'epoch': 2.72, 'num_input_tokens_seen': 10035296}
 27%|██▋       | 885/3250 [3:14:12<7:29:53, 11.41s/it] 27%|██▋       | 886/3250 [3:14:24<7:30:07, 11.42s/it] 27%|██▋       | 887/3250 [3:14:36<7:33:35, 11.52s/it] 27%|██▋       | 888/3250 [3:14:47<7:33:44, 11.53s/it] 27%|██▋       | 889/3250 [3:14:59<7:34:24, 11.55s/it] 27%|██▋       | 890/3250 [3:15:11<7:37:33, 11.63s/it]                                                      {'loss': 2.3262, 'grad_norm': 1.509938359260559, 'learning_rate': 0.005, 'epoch': 2.73, 'num_input_tokens_seen': 10092992}
 27%|██▋       | 890/3250 [3:15:11<7:37:33, 11.63s/it] 27%|██▋       | 891/3250 [3:15:22<7:34:22, 11.56s/it] 27%|██▋       | 892/3250 [3:15:34<7:34:42, 11.57s/it] 27%|██▋       | 893/3250 [3:15:45<7:33:51, 11.55s/it] 28%|██▊       | 894/3250 [3:15:56<7:31:59, 11.51s/it] 28%|██▊       | 895/3250 [3:16:08<7:32:09, 11.52s/it]                                                      {'loss': 2.2161, 'grad_norm': 1.2423604726791382, 'learning_rate': 0.005, 'epoch': 2.75, 'num_input_tokens_seen': 10150560}
 28%|██▊       | 895/3250 [3:16:08<7:32:09, 11.52s/it] 28%|██▊       | 896/3250 [3:16:19<7:30:22, 11.48s/it] 28%|██▊       | 897/3250 [3:16:31<7:32:39, 11.54s/it] 28%|██▊       | 898/3250 [3:16:43<7:32:25, 11.54s/it] 28%|██▊       | 899/3250 [3:16:54<7:31:30, 11.52s/it] 28%|██▊       | 900/3250 [3:17:05<7:28:36, 11.45s/it]                                                      {'loss': 2.2554, 'grad_norm': 1.3865164518356323, 'learning_rate': 0.005, 'epoch': 2.76, 'num_input_tokens_seen': 10206656}
 28%|██▊       | 900/3250 [3:17:05<7:28:36, 11.45s/it][INFO|trainer.py:4021] 2024-10-11 08:09:09,034 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-10-11 08:09:09,035 >>   Num examples = 1157
[INFO|trainer.py:4026] 2024-10-11 08:09:09,035 >>   Batch size = 4

  0%|          | 0/145 [00:00<?, ?it/s][A
  1%|▏         | 2/145 [00:01<01:50,  1.30it/s][A
  2%|▏         | 3/145 [00:03<02:37,  1.11s/it][A
  3%|▎         | 4/145 [00:04<02:58,  1.27s/it][A
  3%|▎         | 5/145 [00:06<03:04,  1.31s/it][A
  4%|▍         | 6/145 [00:07<03:13,  1.39s/it][A
  5%|▍         | 7/145 [00:09<03:20,  1.45s/it][A
  6%|▌         | 8/145 [00:10<03:19,  1.45s/it][A
  6%|▌         | 9/145 [00:12<03:18,  1.46s/it][A
  7%|▋         | 10/145 [00:13<03:20,  1.48s/it][A
  8%|▊         | 11/145 [00:15<03:20,  1.50s/it][A
  8%|▊         | 12/145 [00:16<03:22,  1.52s/it][A
  9%|▉         | 13/145 [00:18<03:23,  1.54s/it][A
 10%|▉         | 14/145 [00:19<03:24,  1.56s/it][A
 10%|█         | 15/145 [00:21<03:21,  1.55s/it][A
 11%|█         | 16/145 [00:22<03:18,  1.54s/it][A
 12%|█▏        | 17/145 [00:24<03:17,  1.54s/it][A
 12%|█▏        | 18/145 [00:26<03:16,  1.55s/it][A
 13%|█▎        | 19/145 [00:27<03:15,  1.55s/it][A
 14%|█▍        | 20/145 [00:29<03:13,  1.55s/it][A
 14%|█▍        | 21/145 [00:30<03:09,  1.53s/it][A
 15%|█▌        | 22/145 [00:32<03:06,  1.52s/it][A
 16%|█▌        | 23/145 [00:33<03:05,  1.52s/it][A
 17%|█▋        | 24/145 [00:35<03:04,  1.52s/it][A
 17%|█▋        | 25/145 [00:36<03:02,  1.52s/it][A
 18%|█▊        | 26/145 [00:38<03:00,  1.52s/it][A
 19%|█▊        | 27/145 [00:39<03:00,  1.53s/it][A
 19%|█▉        | 28/145 [00:41<02:58,  1.52s/it][A
 20%|██        | 29/145 [00:42<02:56,  1.52s/it][A
 21%|██        | 30/145 [00:44<02:50,  1.48s/it][A
 21%|██▏       | 31/145 [00:45<02:51,  1.50s/it][A
 22%|██▏       | 32/145 [00:47<02:50,  1.51s/it][A
 23%|██▎       | 33/145 [00:48<02:50,  1.52s/it][A
 23%|██▎       | 34/145 [00:50<02:48,  1.52s/it][A
 24%|██▍       | 35/145 [00:51<02:48,  1.53s/it][A
 25%|██▍       | 36/145 [00:53<02:45,  1.52s/it][A
 26%|██▌       | 37/145 [00:55<02:48,  1.56s/it][A
 26%|██▌       | 38/145 [00:56<02:46,  1.56s/it][A
 27%|██▋       | 39/145 [00:58<02:44,  1.55s/it][A
 28%|██▊       | 40/145 [00:59<02:42,  1.55s/it][A
 28%|██▊       | 41/145 [01:01<02:42,  1.57s/it][A
 29%|██▉       | 42/145 [01:02<02:40,  1.56s/it][A
 30%|██▉       | 43/145 [01:04<02:37,  1.54s/it][A
 30%|███       | 44/145 [01:05<02:38,  1.57s/it][A
 31%|███       | 45/145 [01:07<02:38,  1.58s/it][A
 32%|███▏      | 46/145 [01:09<02:34,  1.56s/it][A
 32%|███▏      | 47/145 [01:10<02:30,  1.54s/it][A
 33%|███▎      | 48/145 [01:12<02:29,  1.54s/it][A
 34%|███▍      | 49/145 [01:13<02:29,  1.55s/it][A
 34%|███▍      | 50/145 [01:15<02:28,  1.56s/it][A
 35%|███▌      | 51/145 [01:16<02:26,  1.56s/it][A
 36%|███▌      | 52/145 [01:18<02:24,  1.56s/it][A
 37%|███▋      | 53/145 [01:19<02:23,  1.56s/it][A
 37%|███▋      | 54/145 [01:21<02:22,  1.57s/it][A
 38%|███▊      | 55/145 [01:23<02:19,  1.56s/it][A
 39%|███▊      | 56/145 [01:24<02:17,  1.55s/it][A
 39%|███▉      | 57/145 [01:26<02:15,  1.54s/it][A
 40%|████      | 58/145 [01:27<02:13,  1.53s/it][A
 41%|████      | 59/145 [01:29<02:14,  1.56s/it][A
 41%|████▏     | 60/145 [01:30<02:11,  1.55s/it][A
 42%|████▏     | 61/145 [01:32<02:09,  1.54s/it][A
 43%|████▎     | 62/145 [01:33<02:06,  1.52s/it][A
 43%|████▎     | 63/145 [01:35<02:06,  1.54s/it][A
 44%|████▍     | 64/145 [01:36<02:04,  1.54s/it][A
 45%|████▍     | 65/145 [01:38<02:04,  1.55s/it][A
 46%|████▌     | 66/145 [01:40<02:02,  1.55s/it][A
 46%|████▌     | 67/145 [01:41<02:00,  1.54s/it][A
 47%|████▋     | 68/145 [01:43<02:00,  1.56s/it][A
 48%|████▊     | 69/145 [01:44<01:59,  1.57s/it][A
 48%|████▊     | 70/145 [01:46<01:53,  1.52s/it][A
 49%|████▉     | 71/145 [01:47<01:52,  1.52s/it][A
 50%|████▉     | 72/145 [01:49<01:51,  1.53s/it][A
 50%|█████     | 73/145 [01:50<01:51,  1.55s/it][A
 51%|█████     | 74/145 [01:52<01:50,  1.56s/it][A
 52%|█████▏    | 75/145 [01:54<01:49,  1.56s/it][A
 52%|█████▏    | 76/145 [01:55<01:47,  1.55s/it][A
 53%|█████▎    | 77/145 [01:56<01:43,  1.53s/it][A
 54%|█████▍    | 78/145 [01:58<01:42,  1.53s/it][A
 54%|█████▍    | 79/145 [02:00<01:40,  1.52s/it][A
 55%|█████▌    | 80/145 [02:01<01:38,  1.51s/it][A
 56%|█████▌    | 81/145 [02:02<01:35,  1.49s/it][A
 57%|█████▋    | 82/145 [02:04<01:35,  1.51s/it][A
 57%|█████▋    | 83/145 [02:06<01:34,  1.52s/it][A
 58%|█████▊    | 84/145 [02:07<01:33,  1.54s/it][A
 59%|█████▊    | 85/145 [02:09<01:30,  1.51s/it][A
 59%|█████▉    | 86/145 [02:10<01:30,  1.53s/it][A
 60%|██████    | 87/145 [02:12<01:29,  1.55s/it][A
 61%|██████    | 88/145 [02:13<01:27,  1.53s/it][A
 61%|██████▏   | 89/145 [02:15<01:26,  1.54s/it][A
 62%|██████▏   | 90/145 [02:16<01:25,  1.55s/it][A
 63%|██████▎   | 91/145 [02:18<01:23,  1.54s/it][A
 63%|██████▎   | 92/145 [02:19<01:21,  1.54s/it][A
 64%|██████▍   | 93/145 [02:21<01:19,  1.52s/it][A
 65%|██████▍   | 94/145 [02:22<01:17,  1.51s/it][A
 66%|██████▌   | 95/145 [02:24<01:15,  1.52s/it][A
 66%|██████▌   | 96/145 [02:25<01:14,  1.52s/it][A
 67%|██████▋   | 97/145 [02:27<01:13,  1.53s/it][A
 68%|██████▊   | 98/145 [02:29<01:13,  1.57s/it][A
 68%|██████▊   | 99/145 [02:30<01:11,  1.55s/it][A
 69%|██████▉   | 100/145 [02:32<01:09,  1.55s/it][A
 70%|██████▉   | 101/145 [02:33<01:08,  1.56s/it][A
 70%|███████   | 102/145 [02:35<01:06,  1.55s/it][A
 71%|███████   | 103/145 [02:36<01:05,  1.55s/it][A
 72%|███████▏  | 104/145 [02:38<01:03,  1.55s/it][A
 72%|███████▏  | 105/145 [02:39<01:01,  1.55s/it][A
 73%|███████▎  | 106/145 [02:41<01:00,  1.55s/it][A
 74%|███████▍  | 107/145 [02:42<00:57,  1.50s/it][A
 74%|███████▍  | 108/145 [02:44<00:54,  1.48s/it][A
 75%|███████▌  | 109/145 [02:45<00:54,  1.50s/it][A
 76%|███████▌  | 110/145 [02:47<00:53,  1.53s/it][A
 77%|███████▋  | 111/145 [02:48<00:50,  1.50s/it][A
 77%|███████▋  | 112/145 [02:50<00:50,  1.52s/it][A
 78%|███████▊  | 113/145 [02:52<00:49,  1.54s/it][A
 79%|███████▊  | 114/145 [02:53<00:48,  1.55s/it][A
 79%|███████▉  | 115/145 [02:55<00:46,  1.55s/it][A
 80%|████████  | 116/145 [02:56<00:43,  1.52s/it][A
 81%|████████  | 117/145 [02:58<00:42,  1.52s/it][A
 81%|████████▏ | 118/145 [02:59<00:40,  1.51s/it][A
 82%|████████▏ | 119/145 [03:01<00:38,  1.48s/it][A
 83%|████████▎ | 120/145 [03:02<00:36,  1.47s/it][A
 83%|████████▎ | 121/145 [03:04<00:35,  1.47s/it][A
 84%|████████▍ | 122/145 [03:05<00:34,  1.48s/it][A
 85%|████████▍ | 123/145 [03:07<00:32,  1.49s/it][A
 86%|████████▌ | 124/145 [03:08<00:31,  1.48s/it][A
 86%|████████▌ | 125/145 [03:10<00:30,  1.54s/it][A
 87%|████████▋ | 126/145 [03:11<00:28,  1.52s/it][A
 88%|████████▊ | 127/145 [03:13<00:27,  1.52s/it][A
 88%|████████▊ | 128/145 [03:14<00:26,  1.55s/it][A
 89%|████████▉ | 129/145 [03:16<00:24,  1.54s/it][A
 90%|████████▉ | 130/145 [03:17<00:23,  1.57s/it][A
 90%|█████████ | 131/145 [03:19<00:21,  1.53s/it][A
 91%|█████████ | 132/145 [03:20<00:20,  1.54s/it][A
 92%|█████████▏| 133/145 [03:22<00:18,  1.51s/it][A
 92%|█████████▏| 134/145 [03:24<00:17,  1.55s/it][A
 93%|█████████▎| 135/145 [03:25<00:15,  1.55s/it][A
 94%|█████████▍| 136/145 [03:27<00:13,  1.54s/it][A
 94%|█████████▍| 137/145 [03:28<00:12,  1.53s/it][A
 95%|█████████▌| 138/145 [03:30<00:10,  1.54s/it][A
 96%|█████████▌| 139/145 [03:31<00:09,  1.54s/it][A
 97%|█████████▋| 140/145 [03:33<00:07,  1.55s/it][A
 97%|█████████▋| 141/145 [03:34<00:06,  1.55s/it][A
 98%|█████████▊| 142/145 [03:36<00:04,  1.53s/it][A
 99%|█████████▊| 143/145 [03:37<00:03,  1.53s/it][A
 99%|█████████▉| 144/145 [03:39<00:01,  1.54s/it][A
100%|██████████| 145/145 [03:40<00:00,  1.50s/it][A
                                                 [A                                                      {'eval_loss': 2.185002088546753, 'eval_runtime': 222.5327, 'eval_samples_per_second': 5.199, 'eval_steps_per_second': 0.652, 'epoch': 2.76, 'num_input_tokens_seen': 10206656}

100%|██████████| 145/145 [03:40<00:00,  1.50s/it][A 28%|██▊       | 900/3250 [3:20:48<7:28:36, 11.45s/it]
                                                 [A[INFO|trainer.py:3705] 2024-10-11 08:12:51,570 >> Saving model checkpoint to /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-900
[INFO|configuration_utils.py:672] 2024-10-11 08:12:52,180 >> loading configuration file config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/config.json
[WARNING|modeling_rope_utils.py:379] 2024-10-11 08:12:52,181 >> Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
[INFO|configuration_utils.py:739] 2024-10-11 08:12:52,183 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 3584,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 18944,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 28,
  "num_hidden_layers": 28,
  "num_key_value_heads": 4,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.0",
  "use_cache": true,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "in_chans": 3,
    "model_type": "qwen2_vl",
    "spatial_patch_size": 14
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 152064
}

[INFO|tokenization_utils_base.py:2649] 2024-10-11 08:12:52,261 >> tokenizer config file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-900/tokenizer_config.json
[INFO|tokenization_utils_base.py:2658] 2024-10-11 08:12:52,261 >> Special tokens file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-900/special_tokens_map.json
[INFO|image_processing_base.py:258] 2024-10-11 08:12:52,759 >> Image processor saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-900/preprocessor_config.json
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 28%|██▊       | 901/3250 [3:21:01<51:16:24, 78.58s/it] 28%|██▊       | 902/3250 [3:21:12<38:11:10, 58.55s/it] 28%|██▊       | 903/3250 [3:21:24<28:58:46, 44.45s/it] 28%|██▊       | 904/3250 [3:21:36<22:33:03, 34.61s/it] 28%|██▊       | 905/3250 [3:21:47<18:02:34, 27.70s/it]                                                       {'loss': 2.0735, 'grad_norm': 4.530517101287842, 'learning_rate': 0.005, 'epoch': 2.78, 'num_input_tokens_seen': 10263168}
 28%|██▊       | 905/3250 [3:21:47<18:02:34, 27.70s/it] 28%|██▊       | 906/3250 [3:21:59<14:53:53, 22.88s/it] 28%|██▊       | 907/3250 [3:22:10<12:41:38, 19.50s/it] 28%|██▊       | 908/3250 [3:22:22<11:10:48, 17.19s/it] 28%|██▊       | 909/3250 [3:22:34<10:02:51, 15.45s/it] 28%|██▊       | 910/3250 [3:22:45<9:18:30, 14.32s/it]                                                       {'loss': 2.1661, 'grad_norm': 0.928785502910614, 'learning_rate': 0.005, 'epoch': 2.8, 'num_input_tokens_seen': 10319424}
 28%|██▊       | 910/3250 [3:22:45<9:18:30, 14.32s/it] 28%|██▊       | 911/3250 [3:22:57<8:48:26, 13.56s/it] 28%|██▊       | 912/3250 [3:23:09<8:25:31, 12.97s/it] 28%|██▊       | 913/3250 [3:23:21<8:12:42, 12.65s/it] 28%|██▊       | 914/3250 [3:23:32<8:00:40, 12.35s/it] 28%|██▊       | 915/3250 [3:23:44<7:52:48, 12.15s/it]                                                      {'loss': 2.0218, 'grad_norm': 0.8725503087043762, 'learning_rate': 0.005, 'epoch': 2.81, 'num_input_tokens_seen': 10377696}
 28%|██▊       | 915/3250 [3:23:44<7:52:48, 12.15s/it] 28%|██▊       | 916/3250 [3:23:55<7:43:01, 11.90s/it] 28%|██▊       | 917/3250 [3:24:07<7:36:55, 11.75s/it] 28%|██▊       | 918/3250 [3:24:18<7:35:13, 11.71s/it] 28%|██▊       | 919/3250 [3:24:30<7:36:16, 11.74s/it] 28%|██▊       | 920/3250 [3:24:42<7:38:53, 11.82s/it]                                                      {'loss': 1.9353, 'grad_norm': 0.6579440832138062, 'learning_rate': 0.005, 'epoch': 2.83, 'num_input_tokens_seen': 10434272}
 28%|██▊       | 920/3250 [3:24:42<7:38:53, 11.82s/it] 28%|██▊       | 921/3250 [3:24:54<7:35:27, 11.73s/it] 28%|██▊       | 922/3250 [3:25:05<7:31:26, 11.63s/it] 28%|██▊       | 923/3250 [3:25:17<7:30:13, 11.61s/it] 28%|██▊       | 924/3250 [3:25:28<7:27:58, 11.56s/it] 28%|██▊       | 925/3250 [3:25:40<7:30:24, 11.62s/it]                                                      {'loss': 2.2325, 'grad_norm': 1.21194589138031, 'learning_rate': 0.005, 'epoch': 2.84, 'num_input_tokens_seen': 10490560}
 28%|██▊       | 925/3250 [3:25:40<7:30:24, 11.62s/it] 28%|██▊       | 926/3250 [3:25:51<7:29:48, 11.61s/it] 29%|██▊       | 927/3250 [3:26:03<7:28:35, 11.59s/it] 29%|██▊       | 928/3250 [3:26:15<7:29:17, 11.61s/it] 29%|██▊       | 929/3250 [3:26:26<7:28:55, 11.61s/it] 29%|██▊       | 930/3250 [3:26:38<7:29:31, 11.63s/it]                                                      {'loss': 2.1891, 'grad_norm': 1.4557732343673706, 'learning_rate': 0.005, 'epoch': 2.86, 'num_input_tokens_seen': 10547296}
 29%|██▊       | 930/3250 [3:26:38<7:29:31, 11.63s/it] 29%|██▊       | 931/3250 [3:26:50<7:30:22, 11.65s/it] 29%|██▊       | 932/3250 [3:27:01<7:31:41, 11.69s/it] 29%|██▊       | 933/3250 [3:27:13<7:32:53, 11.73s/it] 29%|██▊       | 934/3250 [3:27:25<7:31:48, 11.70s/it] 29%|██▉       | 935/3250 [3:27:36<7:31:20, 11.70s/it]                                                      {'loss': 2.0767, 'grad_norm': 0.9422688484191895, 'learning_rate': 0.005, 'epoch': 2.87, 'num_input_tokens_seen': 10604192}
 29%|██▉       | 935/3250 [3:27:36<7:31:20, 11.70s/it] 29%|██▉       | 936/3250 [3:27:48<7:27:46, 11.61s/it] 29%|██▉       | 937/3250 [3:27:59<7:25:29, 11.56s/it] 29%|██▉       | 938/3250 [3:28:11<7:26:24, 11.58s/it] 29%|██▉       | 939/3250 [3:28:23<7:27:25, 11.62s/it] 29%|██▉       | 940/3250 [3:28:34<7:27:00, 11.61s/it]                                                      {'loss': 1.9817, 'grad_norm': 13.511603355407715, 'learning_rate': 0.005, 'epoch': 2.89, 'num_input_tokens_seen': 10660512}
 29%|██▉       | 940/3250 [3:28:34<7:27:00, 11.61s/it] 29%|██▉       | 941/3250 [3:28:46<7:25:48, 11.58s/it] 29%|██▉       | 942/3250 [3:28:57<7:25:09, 11.57s/it] 29%|██▉       | 943/3250 [3:29:09<7:26:41, 11.62s/it] 29%|██▉       | 944/3250 [3:29:21<7:25:45, 11.60s/it] 29%|██▉       | 945/3250 [3:29:32<7:25:58, 11.61s/it]                                                      {'loss': 2.0185, 'grad_norm': 1.984702467918396, 'learning_rate': 0.005, 'epoch': 2.9, 'num_input_tokens_seen': 10717152}
 29%|██▉       | 945/3250 [3:29:32<7:25:58, 11.61s/it] 29%|██▉       | 946/3250 [3:29:44<7:27:30, 11.65s/it] 29%|██▉       | 947/3250 [3:29:55<7:24:14, 11.57s/it] 29%|██▉       | 948/3250 [3:30:07<7:23:45, 11.57s/it] 29%|██▉       | 949/3250 [3:30:18<7:19:40, 11.46s/it] 29%|██▉       | 950/3250 [3:30:30<7:18:40, 11.44s/it]                                                      {'loss': 2.5758, 'grad_norm': 0.8793761730194092, 'learning_rate': 0.005, 'epoch': 2.92, 'num_input_tokens_seen': 10774496}
 29%|██▉       | 950/3250 [3:30:30<7:18:40, 11.44s/it] 29%|██▉       | 951/3250 [3:30:41<7:19:04, 11.46s/it] 29%|██▉       | 952/3250 [3:30:52<7:16:50, 11.41s/it] 29%|██▉       | 953/3250 [3:31:04<7:16:13, 11.39s/it] 29%|██▉       | 954/3250 [3:31:15<7:16:24, 11.40s/it] 29%|██▉       | 955/3250 [3:31:27<7:18:48, 11.47s/it]                                                      {'loss': 2.3803, 'grad_norm': 1.5011687278747559, 'learning_rate': 0.005, 'epoch': 2.93, 'num_input_tokens_seen': 10831264}
 29%|██▉       | 955/3250 [3:31:27<7:18:48, 11.47s/it] 29%|██▉       | 956/3250 [3:31:38<7:18:12, 11.46s/it] 29%|██▉       | 957/3250 [3:31:50<7:16:56, 11.43s/it] 29%|██▉       | 958/3250 [3:32:01<7:15:53, 11.41s/it] 30%|██▉       | 959/3250 [3:32:12<7:16:58, 11.44s/it] 30%|██▉       | 960/3250 [3:32:24<7:13:05, 11.35s/it]                                                      {'loss': 2.1464, 'grad_norm': 1.3844131231307983, 'learning_rate': 0.005, 'epoch': 2.95, 'num_input_tokens_seen': 10887808}
 30%|██▉       | 960/3250 [3:32:24<7:13:05, 11.35s/it] 30%|██▉       | 961/3250 [3:32:35<7:12:11, 11.33s/it] 30%|██▉       | 962/3250 [3:32:46<7:13:57, 11.38s/it] 30%|██▉       | 963/3250 [3:32:58<7:16:02, 11.44s/it] 30%|██▉       | 964/3250 [3:33:09<7:16:58, 11.47s/it] 30%|██▉       | 965/3250 [3:33:21<7:16:08, 11.45s/it]                                                      {'loss': 2.322, 'grad_norm': 1.7752399444580078, 'learning_rate': 0.005, 'epoch': 2.96, 'num_input_tokens_seen': 10944096}
 30%|██▉       | 965/3250 [3:33:21<7:16:08, 11.45s/it] 30%|██▉       | 966/3250 [3:33:33<7:19:09, 11.54s/it] 30%|██▉       | 967/3250 [3:33:44<7:18:58, 11.54s/it] 30%|██▉       | 968/3250 [3:33:55<7:15:31, 11.45s/it] 30%|██▉       | 969/3250 [3:34:06<7:11:19, 11.35s/it] 30%|██▉       | 970/3250 [3:34:18<7:14:51, 11.44s/it]                                                      {'loss': 2.2126, 'grad_norm': 1.8782408237457275, 'learning_rate': 0.005, 'epoch': 2.98, 'num_input_tokens_seen': 11000800}
 30%|██▉       | 970/3250 [3:34:18<7:14:51, 11.44s/it] 30%|██▉       | 971/3250 [3:34:30<7:16:29, 11.49s/it] 30%|██▉       | 972/3250 [3:34:41<7:18:17, 11.54s/it] 30%|██▉       | 973/3250 [3:34:53<7:18:17, 11.55s/it] 30%|██▉       | 974/3250 [3:35:05<7:19:47, 11.59s/it] 30%|███       | 975/3250 [3:35:16<7:21:40, 11.65s/it]                                                      {'loss': 2.2162, 'grad_norm': 1.8885843753814697, 'learning_rate': 0.005, 'epoch': 3.0, 'num_input_tokens_seen': 11058016}
 30%|███       | 975/3250 [3:35:16<7:21:40, 11.65s/it] 30%|███       | 976/3250 [3:35:28<7:17:57, 11.56s/it] 30%|███       | 977/3250 [3:35:39<7:16:40, 11.53s/it] 30%|███       | 978/3250 [3:35:51<7:17:14, 11.55s/it] 30%|███       | 979/3250 [3:36:02<7:17:45, 11.57s/it] 30%|███       | 980/3250 [3:36:14<7:18:54, 11.60s/it]                                                      {'loss': 2.1113, 'grad_norm': 1.6341350078582764, 'learning_rate': 0.005, 'epoch': 3.01, 'num_input_tokens_seen': 11115680}
 30%|███       | 980/3250 [3:36:14<7:18:54, 11.60s/it] 30%|███       | 981/3250 [3:36:26<7:19:56, 11.63s/it] 30%|███       | 982/3250 [3:36:37<7:19:09, 11.62s/it] 30%|███       | 983/3250 [3:36:49<7:16:08, 11.54s/it] 30%|███       | 984/3250 [3:37:00<7:14:42, 11.51s/it] 30%|███       | 985/3250 [3:37:12<7:16:01, 11.55s/it]                                                      {'loss': 2.0469, 'grad_norm': 1.4475680589675903, 'learning_rate': 0.005, 'epoch': 3.03, 'num_input_tokens_seen': 11172512}
 30%|███       | 985/3250 [3:37:12<7:16:01, 11.55s/it] 30%|███       | 986/3250 [3:37:24<7:16:44, 11.57s/it] 30%|███       | 987/3250 [3:37:35<7:19:55, 11.66s/it] 30%|███       | 988/3250 [3:37:47<7:19:30, 11.66s/it] 30%|███       | 989/3250 [3:37:59<7:17:14, 11.60s/it] 30%|███       | 990/3250 [3:38:10<7:18:07, 11.63s/it]                                                      {'loss': 1.9946, 'grad_norm': 1.574425458908081, 'learning_rate': 0.005, 'epoch': 3.04, 'num_input_tokens_seen': 11229888}
 30%|███       | 990/3250 [3:38:10<7:18:07, 11.63s/it] 30%|███       | 991/3250 [3:38:21<7:12:16, 11.48s/it] 31%|███       | 992/3250 [3:38:33<7:11:52, 11.48s/it] 31%|███       | 993/3250 [3:38:44<7:13:31, 11.52s/it] 31%|███       | 994/3250 [3:38:56<7:16:52, 11.62s/it] 31%|███       | 995/3250 [3:39:08<7:16:30, 11.61s/it]                                                      {'loss': 2.0058, 'grad_norm': 0.8935277462005615, 'learning_rate': 0.005, 'epoch': 3.06, 'num_input_tokens_seen': 11286144}
 31%|███       | 995/3250 [3:39:08<7:16:30, 11.61s/it] 31%|███       | 996/3250 [3:39:20<7:16:29, 11.62s/it] 31%|███       | 997/3250 [3:39:31<7:15:22, 11.59s/it] 31%|███       | 998/3250 [3:39:43<7:13:28, 11.55s/it] 31%|███       | 999/3250 [3:39:54<7:10:36, 11.48s/it] 31%|███       | 1000/3250 [3:40:06<7:12:45, 11.54s/it]                                                       {'loss': 1.7999, 'grad_norm': 1.4874353408813477, 'learning_rate': 0.005, 'epoch': 3.07, 'num_input_tokens_seen': 11342560}
 31%|███       | 1000/3250 [3:40:06<7:12:45, 11.54s/it][INFO|trainer.py:4021] 2024-10-11 08:32:09,123 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-10-11 08:32:09,124 >>   Num examples = 1157
[INFO|trainer.py:4026] 2024-10-11 08:32:09,124 >>   Batch size = 4

  0%|          | 0/145 [00:00<?, ?it/s][A
  1%|▏         | 2/145 [00:01<01:49,  1.31it/s][A
  2%|▏         | 3/145 [00:03<02:37,  1.11s/it][A
  3%|▎         | 4/145 [00:04<02:57,  1.26s/it][A
  3%|▎         | 5/145 [00:06<03:03,  1.31s/it][A
  4%|▍         | 6/145 [00:07<03:13,  1.39s/it][A
  5%|▍         | 7/145 [00:09<03:19,  1.44s/it][A
  6%|▌         | 8/145 [00:10<03:17,  1.44s/it][A
  6%|▌         | 9/145 [00:12<03:17,  1.45s/it][A
  7%|▋         | 10/145 [00:13<03:19,  1.48s/it][A
  8%|▊         | 11/145 [00:15<03:19,  1.49s/it][A
  8%|▊         | 12/145 [00:16<03:21,  1.51s/it][A
  9%|▉         | 13/145 [00:18<03:22,  1.53s/it][A
 10%|▉         | 14/145 [00:19<03:23,  1.55s/it][A
 10%|█         | 15/145 [00:21<03:19,  1.54s/it][A
 11%|█         | 16/145 [00:22<03:17,  1.53s/it][A
 12%|█▏        | 17/145 [00:24<03:15,  1.53s/it][A
 12%|█▏        | 18/145 [00:25<03:15,  1.54s/it][A
 13%|█▎        | 19/145 [00:27<03:14,  1.54s/it][A
 14%|█▍        | 20/145 [00:29<03:12,  1.54s/it][A
 14%|█▍        | 21/145 [00:30<03:08,  1.52s/it][A
 15%|█▌        | 22/145 [00:31<03:05,  1.51s/it][A
 16%|█▌        | 23/145 [00:33<03:03,  1.51s/it][A
 17%|█▋        | 24/145 [00:35<03:03,  1.51s/it][A
 17%|█▋        | 25/145 [00:36<03:01,  1.51s/it][A
 18%|█▊        | 26/145 [00:38<02:59,  1.51s/it][A
 19%|█▊        | 27/145 [00:39<02:58,  1.52s/it][A
 19%|█▉        | 28/145 [00:41<02:56,  1.51s/it][A
 20%|██        | 29/145 [00:42<02:54,  1.51s/it][A
 21%|██        | 30/145 [00:43<02:49,  1.47s/it][A
 21%|██▏       | 31/145 [00:45<02:49,  1.49s/it][A
 22%|██▏       | 32/145 [00:46<02:49,  1.50s/it][A
 23%|██▎       | 33/145 [00:48<02:48,  1.51s/it][A
 23%|██▎       | 34/145 [00:50<02:47,  1.51s/it][A
 24%|██▍       | 35/145 [00:51<02:47,  1.52s/it][A
 25%|██▍       | 36/145 [00:53<02:45,  1.52s/it][A
 26%|██▌       | 37/145 [00:54<02:47,  1.55s/it][A
 26%|██▌       | 38/145 [00:56<02:46,  1.55s/it][A
 27%|██▋       | 39/145 [00:57<02:43,  1.54s/it][A
 28%|██▊       | 40/145 [00:59<02:41,  1.54s/it][A
 28%|██▊       | 41/145 [01:00<02:42,  1.56s/it][A
 29%|██▉       | 42/145 [01:02<02:39,  1.55s/it][A
 30%|██▉       | 43/145 [01:03<02:36,  1.53s/it][A
 30%|███       | 44/145 [01:05<02:37,  1.56s/it][A
 31%|███       | 45/145 [01:07<02:37,  1.57s/it][A
 32%|███▏      | 46/145 [01:08<02:33,  1.55s/it][A
 32%|███▏      | 47/145 [01:10<02:29,  1.52s/it][A
 33%|███▎      | 48/145 [01:11<02:28,  1.53s/it][A
 34%|███▍      | 49/145 [01:13<02:28,  1.54s/it][A
 34%|███▍      | 50/145 [01:14<02:27,  1.55s/it][A
 35%|███▌      | 51/145 [01:16<02:25,  1.55s/it][A
 36%|███▌      | 52/145 [01:17<02:23,  1.55s/it][A
 37%|███▋      | 53/145 [01:19<02:21,  1.54s/it][A
 37%|███▋      | 54/145 [01:21<02:20,  1.55s/it][A
 38%|███▊      | 55/145 [01:22<02:18,  1.54s/it][A
 39%|███▊      | 56/145 [01:24<02:16,  1.54s/it][A
 39%|███▉      | 57/145 [01:25<02:14,  1.52s/it][A
 40%|████      | 58/145 [01:27<02:12,  1.52s/it][A
 41%|████      | 59/145 [01:28<02:12,  1.55s/it][A
 41%|████▏     | 60/145 [01:30<02:10,  1.53s/it][A
 42%|████▏     | 61/145 [01:31<02:08,  1.53s/it][A
 43%|████▎     | 62/145 [01:33<02:05,  1.51s/it][A
 43%|████▎     | 63/145 [01:34<02:06,  1.54s/it][A
 44%|████▍     | 64/145 [01:36<02:04,  1.53s/it][A
 45%|████▍     | 65/145 [01:37<02:03,  1.54s/it][A
 46%|████▌     | 66/145 [01:39<02:01,  1.53s/it][A
 46%|████▌     | 67/145 [01:40<01:58,  1.52s/it][A
 47%|████▋     | 68/145 [01:42<01:59,  1.55s/it][A
 48%|████▊     | 69/145 [01:44<01:58,  1.56s/it][A
 48%|████▊     | 70/145 [01:45<01:52,  1.51s/it][A
 49%|████▉     | 71/145 [01:46<01:50,  1.50s/it][A
 50%|████▉     | 72/145 [01:48<01:50,  1.52s/it][A
 50%|█████     | 73/145 [01:50<01:51,  1.54s/it][A
 51%|█████     | 74/145 [01:51<01:50,  1.55s/it][A
 52%|█████▏    | 75/145 [01:53<01:48,  1.55s/it][A
 52%|█████▏    | 76/145 [01:54<01:46,  1.54s/it][A
 53%|█████▎    | 77/145 [01:56<01:42,  1.51s/it][A
 54%|█████▍    | 78/145 [01:57<01:41,  1.51s/it][A
 54%|█████▍    | 79/145 [01:59<01:38,  1.50s/it][A
 55%|█████▌    | 80/145 [02:00<01:37,  1.51s/it][A
 56%|█████▌    | 81/145 [02:02<01:34,  1.48s/it][A
 57%|█████▋    | 82/145 [02:03<01:34,  1.50s/it][A
 57%|█████▋    | 83/145 [02:05<01:33,  1.52s/it][A
 58%|█████▊    | 84/145 [02:06<01:33,  1.53s/it][A
 59%|█████▊    | 85/145 [02:08<01:30,  1.50s/it][A
 59%|█████▉    | 86/145 [02:09<01:29,  1.52s/it][A
 60%|██████    | 87/145 [02:11<01:29,  1.54s/it][A
 61%|██████    | 88/145 [02:12<01:26,  1.52s/it][A
 61%|██████▏   | 89/145 [02:14<01:25,  1.53s/it][A
 62%|██████▏   | 90/145 [02:15<01:24,  1.54s/it][A
 63%|██████▎   | 91/145 [02:17<01:22,  1.53s/it][A
 63%|██████▎   | 92/145 [02:18<01:20,  1.53s/it][A
 64%|██████▍   | 93/145 [02:20<01:18,  1.51s/it][A
 65%|██████▍   | 94/145 [02:21<01:17,  1.51s/it][A
 66%|██████▌   | 95/145 [02:23<01:15,  1.51s/it][A
 66%|██████▌   | 96/145 [02:24<01:14,  1.52s/it][A
 67%|██████▋   | 97/145 [02:26<01:13,  1.53s/it][A
 68%|██████▊   | 98/145 [02:28<01:13,  1.56s/it][A
 68%|██████▊   | 99/145 [02:29<01:10,  1.53s/it][A
 69%|██████▉   | 100/145 [02:31<01:09,  1.54s/it][A
 70%|██████▉   | 101/145 [02:32<01:08,  1.55s/it][A
 70%|███████   | 102/145 [02:34<01:06,  1.54s/it][A
 71%|███████   | 103/145 [02:35<01:04,  1.54s/it][A
 72%|███████▏  | 104/145 [02:37<01:03,  1.54s/it][A
 72%|███████▏  | 105/145 [02:38<01:01,  1.54s/it][A
 73%|███████▎  | 106/145 [02:40<01:00,  1.54s/it][A
 74%|███████▍  | 107/145 [02:41<00:56,  1.49s/it][A
 74%|███████▍  | 108/145 [02:43<00:54,  1.47s/it][A
 75%|███████▌  | 109/145 [02:44<00:53,  1.50s/it][A
 76%|███████▌  | 110/145 [02:46<00:53,  1.52s/it][A
 77%|███████▋  | 111/145 [02:47<00:50,  1.48s/it][A
 77%|███████▋  | 112/145 [02:49<00:49,  1.51s/it][A
 78%|███████▊  | 113/145 [02:50<00:48,  1.53s/it][A
 79%|███████▊  | 114/145 [02:52<00:47,  1.54s/it][A
 79%|███████▉  | 115/145 [02:53<00:46,  1.54s/it][A
 80%|████████  | 116/145 [02:55<00:43,  1.50s/it][A
 81%|████████  | 117/145 [02:56<00:42,  1.50s/it][A
 81%|████████▏ | 118/145 [02:58<00:40,  1.50s/it][A
 82%|████████▏ | 119/145 [02:59<00:38,  1.47s/it][A
 83%|████████▎ | 120/145 [03:01<00:36,  1.45s/it][A
 83%|████████▎ | 121/145 [03:02<00:34,  1.45s/it][A
 84%|████████▍ | 122/145 [03:04<00:33,  1.47s/it][A
 85%|████████▍ | 123/145 [03:05<00:32,  1.48s/it][A
 86%|████████▌ | 124/145 [03:07<00:30,  1.47s/it][A
 86%|████████▌ | 125/145 [03:08<00:30,  1.53s/it][A
 87%|████████▋ | 126/145 [03:10<00:28,  1.51s/it][A
 88%|████████▊ | 127/145 [03:11<00:27,  1.51s/it][A
 88%|████████▊ | 128/145 [03:13<00:26,  1.53s/it][A
 89%|████████▉ | 129/145 [03:14<00:24,  1.53s/it][A
 90%|████████▉ | 130/145 [03:16<00:23,  1.56s/it][A
 90%|█████████ | 131/145 [03:17<00:21,  1.51s/it][A
 91%|█████████ | 132/145 [03:19<00:19,  1.53s/it][A
 92%|█████████▏| 133/145 [03:20<00:17,  1.50s/it][A
 92%|█████████▏| 134/145 [03:22<00:16,  1.53s/it][A
 93%|█████████▎| 135/145 [03:24<00:15,  1.53s/it][A
 94%|█████████▍| 136/145 [03:25<00:13,  1.52s/it][A
 94%|█████████▍| 137/145 [03:27<00:12,  1.52s/it][A
 95%|█████████▌| 138/145 [03:28<00:10,  1.54s/it][A
 96%|█████████▌| 139/145 [03:30<00:09,  1.53s/it][A
 97%|█████████▋| 140/145 [03:31<00:07,  1.53s/it][A
 97%|█████████▋| 141/145 [03:33<00:06,  1.54s/it][A
 98%|█████████▊| 142/145 [03:34<00:04,  1.53s/it][A
 99%|█████████▊| 143/145 [03:36<00:03,  1.52s/it][A
 99%|█████████▉| 144/145 [03:37<00:01,  1.53s/it][A
100%|██████████| 145/145 [03:39<00:00,  1.50s/it][A
                                                 [A                                                       {'eval_loss': 1.984459400177002, 'eval_runtime': 220.9136, 'eval_samples_per_second': 5.237, 'eval_steps_per_second': 0.656, 'epoch': 3.07, 'num_input_tokens_seen': 11342560}

100%|██████████| 145/145 [03:39<00:00,  1.50s/it][A 31%|███       | 1000/3250 [3:43:46<7:12:45, 11.54s/it]
                                                 [A[INFO|trainer.py:3705] 2024-10-11 08:35:50,040 >> Saving model checkpoint to /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1000
[INFO|configuration_utils.py:672] 2024-10-11 08:35:51,478 >> loading configuration file config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/config.json
[WARNING|modeling_rope_utils.py:379] 2024-10-11 08:35:51,478 >> Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
[INFO|configuration_utils.py:739] 2024-10-11 08:35:51,481 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 3584,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 18944,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 28,
  "num_hidden_layers": 28,
  "num_key_value_heads": 4,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.0",
  "use_cache": true,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "in_chans": 3,
    "model_type": "qwen2_vl",
    "spatial_patch_size": 14
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 152064
}

[INFO|tokenization_utils_base.py:2649] 2024-10-11 08:35:51,559 >> tokenizer config file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1000/tokenizer_config.json
[INFO|tokenization_utils_base.py:2658] 2024-10-11 08:35:51,560 >> Special tokens file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1000/special_tokens_map.json
[INFO|image_processing_base.py:258] 2024-10-11 08:35:52,066 >> Image processor saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1000/preprocessor_config.json
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 31%|███       | 1001/3250 [3:44:00<49:01:51, 78.48s/it] 31%|███       | 1002/3250 [3:44:12<36:31:39, 58.50s/it] 31%|███       | 1003/3250 [3:44:23<27:41:11, 44.36s/it] 31%|███       | 1004/3250 [3:44:35<21:28:28, 34.42s/it] 31%|███       | 1005/3250 [3:44:46<17:08:56, 27.50s/it]                                                        {'loss': 1.9596, 'grad_norm': 0.8032941222190857, 'learning_rate': 0.005, 'epoch': 3.09, 'num_input_tokens_seen': 11400000}
 31%|███       | 1005/3250 [3:44:46<17:08:56, 27.50s/it] 31%|███       | 1006/3250 [3:44:58<14:09:28, 22.71s/it] 31%|███       | 1007/3250 [3:45:09<12:01:51, 19.31s/it] 31%|███       | 1008/3250 [3:45:21<10:35:28, 17.01s/it] 31%|███       | 1009/3250 [3:45:32<9:36:25, 15.43s/it]  31%|███       | 1010/3250 [3:45:44<8:50:48, 14.22s/it]                                                       {'loss': 1.9403, 'grad_norm': 1.2358781099319458, 'learning_rate': 0.005, 'epoch': 3.1, 'num_input_tokens_seen': 11456736}
 31%|███       | 1010/3250 [3:45:44<8:50:48, 14.22s/it] 31%|███       | 1011/3250 [3:45:55<8:17:22, 13.33s/it] 31%|███       | 1012/3250 [3:46:06<7:56:36, 12.78s/it] 31%|███       | 1013/3250 [3:46:18<7:38:18, 12.29s/it] 31%|███       | 1014/3250 [3:46:29<7:28:40, 12.04s/it] 31%|███       | 1015/3250 [3:46:41<7:23:37, 11.91s/it]                                                       {'loss': 1.8523, 'grad_norm': 1.011069416999817, 'learning_rate': 0.005, 'epoch': 3.12, 'num_input_tokens_seen': 11513248}
 31%|███       | 1015/3250 [3:46:41<7:23:37, 11.91s/it] 31%|███▏      | 1016/3250 [3:46:52<7:19:55, 11.82s/it] 31%|███▏      | 1017/3250 [3:47:03<7:11:13, 11.59s/it] 31%|███▏      | 1018/3250 [3:47:14<7:04:46, 11.42s/it] 31%|███▏      | 1019/3250 [3:47:26<7:07:32, 11.50s/it] 31%|███▏      | 1020/3250 [3:47:38<7:07:49, 11.51s/it]                                                       {'loss': 1.8604, 'grad_norm': 0.9908726811408997, 'learning_rate': 0.005, 'epoch': 3.13, 'num_input_tokens_seen': 11569536}
 31%|███▏      | 1020/3250 [3:47:38<7:07:49, 11.51s/it] 31%|███▏      | 1021/3250 [3:47:49<7:07:00, 11.49s/it] 31%|███▏      | 1022/3250 [3:48:01<7:09:41, 11.57s/it] 31%|███▏      | 1023/3250 [3:48:12<7:10:10, 11.59s/it] 32%|███▏      | 1024/3250 [3:48:24<7:05:35, 11.47s/it] 32%|███▏      | 1025/3250 [3:48:35<7:09:38, 11.59s/it]                                                       {'loss': 1.8625, 'grad_norm': 1.3337126970291138, 'learning_rate': 0.005, 'epoch': 3.15, 'num_input_tokens_seen': 11626272}
 32%|███▏      | 1025/3250 [3:48:35<7:09:38, 11.59s/it] 32%|███▏      | 1026/3250 [3:48:47<7:11:53, 11.65s/it] 32%|███▏      | 1027/3250 [3:48:59<7:10:06, 11.61s/it] 32%|███▏      | 1028/3250 [3:49:10<7:07:42, 11.55s/it] 32%|███▏      | 1029/3250 [3:49:22<7:08:19, 11.57s/it] 32%|███▏      | 1030/3250 [3:49:33<7:07:13, 11.55s/it]                                                       {'loss': 1.8468, 'grad_norm': 1.282124400138855, 'learning_rate': 0.005, 'epoch': 3.16, 'num_input_tokens_seen': 11683264}
 32%|███▏      | 1030/3250 [3:49:33<7:07:13, 11.55s/it] 32%|███▏      | 1031/3250 [3:49:45<7:06:01, 11.52s/it] 32%|███▏      | 1032/3250 [3:49:56<7:04:14, 11.48s/it] 32%|███▏      | 1033/3250 [3:50:08<7:03:32, 11.46s/it] 32%|███▏      | 1034/3250 [3:50:19<7:04:38, 11.50s/it] 32%|███▏      | 1035/3250 [3:50:31<7:07:56, 11.59s/it]                                                       {'loss': 1.8208, 'grad_norm': 1.3566290140151978, 'learning_rate': 0.005, 'epoch': 3.18, 'num_input_tokens_seen': 11740224}
 32%|███▏      | 1035/3250 [3:50:31<7:07:56, 11.59s/it] 32%|███▏      | 1036/3250 [3:50:43<7:09:08, 11.63s/it] 32%|███▏      | 1037/3250 [3:50:55<7:12:27, 11.73s/it] 32%|███▏      | 1038/3250 [3:51:06<7:13:46, 11.77s/it] 32%|███▏      | 1039/3250 [3:51:18<7:14:30, 11.79s/it] 32%|███▏      | 1040/3250 [3:51:30<7:15:09, 11.81s/it]                                                       {'loss': 2.0511, 'grad_norm': 2.544886827468872, 'learning_rate': 0.005, 'epoch': 3.2, 'num_input_tokens_seen': 11798912}
 32%|███▏      | 1040/3250 [3:51:30<7:15:09, 11.81s/it] 32%|███▏      | 1041/3250 [3:51:42<7:15:54, 11.84s/it] 32%|███▏      | 1042/3250 [3:51:54<7:11:53, 11.74s/it] 32%|███▏      | 1043/3250 [3:52:05<7:07:48, 11.63s/it] 32%|███▏      | 1044/3250 [3:52:17<7:07:52, 11.64s/it] 32%|███▏      | 1045/3250 [3:52:28<7:08:26, 11.66s/it]                                                       {'loss': 2.0388, 'grad_norm': 1.2203861474990845, 'learning_rate': 0.005, 'epoch': 3.21, 'num_input_tokens_seen': 11856032}
 32%|███▏      | 1045/3250 [3:52:28<7:08:26, 11.66s/it] 32%|███▏      | 1046/3250 [3:52:40<7:08:23, 11.66s/it] 32%|███▏      | 1047/3250 [3:52:52<7:08:31, 11.67s/it] 32%|███▏      | 1048/3250 [3:53:03<7:06:51, 11.63s/it] 32%|███▏      | 1049/3250 [3:53:15<7:09:15, 11.70s/it] 32%|███▏      | 1050/3250 [3:53:27<7:11:59, 11.78s/it]                                                       {'loss': 2.103, 'grad_norm': 1.0450257062911987, 'learning_rate': 0.005, 'epoch': 3.23, 'num_input_tokens_seen': 11913440}
 32%|███▏      | 1050/3250 [3:53:27<7:11:59, 11.78s/it] 32%|███▏      | 1051/3250 [3:53:39<7:11:16, 11.77s/it] 32%|███▏      | 1052/3250 [3:53:51<7:11:47, 11.79s/it] 32%|███▏      | 1053/3250 [3:54:02<7:11:22, 11.78s/it] 32%|███▏      | 1054/3250 [3:54:14<7:10:04, 11.75s/it] 32%|███▏      | 1055/3250 [3:54:26<7:10:19, 11.76s/it]                                                       {'loss': 1.8973, 'grad_norm': 1.1991770267486572, 'learning_rate': 0.005, 'epoch': 3.24, 'num_input_tokens_seen': 11971040}
 32%|███▏      | 1055/3250 [3:54:26<7:10:19, 11.76s/it] 32%|███▏      | 1056/3250 [3:54:37<7:08:12, 11.71s/it] 33%|███▎      | 1057/3250 [3:54:49<7:10:15, 11.77s/it] 33%|███▎      | 1058/3250 [3:55:01<7:08:09, 11.72s/it] 33%|███▎      | 1059/3250 [3:55:13<7:07:25, 11.71s/it] 33%|███▎      | 1060/3250 [3:55:24<7:07:12, 11.70s/it]                                                       {'loss': 1.996, 'grad_norm': 1.2871273756027222, 'learning_rate': 0.005, 'epoch': 3.26, 'num_input_tokens_seen': 12027904}
 33%|███▎      | 1060/3250 [3:55:24<7:07:12, 11.70s/it] 33%|███▎      | 1061/3250 [3:55:36<7:04:39, 11.64s/it] 33%|███▎      | 1062/3250 [3:55:47<7:02:05, 11.57s/it] 33%|███▎      | 1063/3250 [3:55:59<6:59:17, 11.50s/it] 33%|███▎      | 1064/3250 [3:56:10<7:00:45, 11.55s/it] 33%|███▎      | 1065/3250 [3:56:22<7:03:23, 11.63s/it]                                                       {'loss': 1.9534, 'grad_norm': 1.4760931730270386, 'learning_rate': 0.005, 'epoch': 3.27, 'num_input_tokens_seen': 12084608}
 33%|███▎      | 1065/3250 [3:56:22<7:03:23, 11.63s/it] 33%|███▎      | 1066/3250 [3:56:34<7:03:25, 11.63s/it] 33%|███▎      | 1067/3250 [3:56:45<7:01:52, 11.60s/it] 33%|███▎      | 1068/3250 [3:56:57<7:01:49, 11.60s/it] 33%|███▎      | 1069/3250 [3:57:08<7:00:34, 11.57s/it] 33%|███▎      | 1070/3250 [3:57:20<7:01:45, 11.61s/it]                                                       {'loss': 2.2049, 'grad_norm': 2.340310573577881, 'learning_rate': 0.005, 'epoch': 3.29, 'num_input_tokens_seen': 12142048}
 33%|███▎      | 1070/3250 [3:57:20<7:01:45, 11.61s/it] 33%|███▎      | 1071/3250 [3:57:31<7:00:02, 11.57s/it] 33%|███▎      | 1072/3250 [3:57:42<6:51:31, 11.34s/it] 33%|███▎      | 1073/3250 [3:57:54<6:53:45, 11.40s/it] 33%|███▎      | 1074/3250 [3:58:05<6:51:31, 11.35s/it] 33%|███▎      | 1075/3250 [3:58:16<6:50:22, 11.32s/it]                                                       {'loss': 2.0222, 'grad_norm': 20.67151641845703, 'learning_rate': 0.005, 'epoch': 3.3, 'num_input_tokens_seen': 12197408}
 33%|███▎      | 1075/3250 [3:58:16<6:50:22, 11.32s/it] 33%|███▎      | 1076/3250 [3:58:28<6:54:29, 11.44s/it] 33%|███▎      | 1077/3250 [3:58:39<6:54:03, 11.43s/it] 33%|███▎      | 1078/3250 [3:58:51<6:55:36, 11.48s/it] 33%|███▎      | 1079/3250 [3:59:03<6:55:57, 11.50s/it] 33%|███▎      | 1080/3250 [3:59:14<6:57:58, 11.56s/it]                                                       {'loss': 1.8693, 'grad_norm': 0.9934075474739075, 'learning_rate': 0.005, 'epoch': 3.32, 'num_input_tokens_seen': 12254464}
 33%|███▎      | 1080/3250 [3:59:14<6:57:58, 11.56s/it] 33%|███▎      | 1081/3250 [3:59:26<6:56:46, 11.53s/it] 33%|███▎      | 1082/3250 [3:59:37<6:54:52, 11.48s/it] 33%|███▎      | 1083/3250 [3:59:48<6:49:14, 11.33s/it] 33%|███▎      | 1084/3250 [3:59:59<6:48:15, 11.31s/it] 33%|███▎      | 1085/3250 [4:00:11<6:54:03, 11.47s/it]                                                       {'loss': 1.8886, 'grad_norm': 1.601881742477417, 'learning_rate': 0.005, 'epoch': 3.33, 'num_input_tokens_seen': 12310304}
 33%|███▎      | 1085/3250 [4:00:11<6:54:03, 11.47s/it] 33%|███▎      | 1086/3250 [4:00:23<6:54:17, 11.49s/it] 33%|███▎      | 1087/3250 [4:00:34<6:55:35, 11.53s/it] 33%|███▎      | 1088/3250 [4:00:46<6:57:01, 11.57s/it] 34%|███▎      | 1089/3250 [4:00:57<6:54:21, 11.50s/it] 34%|███▎      | 1090/3250 [4:01:09<6:57:43, 11.60s/it]                                                       {'loss': 1.7783, 'grad_norm': 1.3520350456237793, 'learning_rate': 0.005, 'epoch': 3.35, 'num_input_tokens_seen': 12366336}
 34%|███▎      | 1090/3250 [4:01:09<6:57:43, 11.60s/it] 34%|███▎      | 1091/3250 [4:01:20<6:52:09, 11.45s/it] 34%|███▎      | 1092/3250 [4:01:32<6:52:13, 11.46s/it] 34%|███▎      | 1093/3250 [4:01:43<6:52:42, 11.48s/it] 34%|███▎      | 1094/3250 [4:01:55<6:56:22, 11.59s/it] 34%|███▎      | 1095/3250 [4:02:07<6:56:03, 11.58s/it]                                                       {'loss': 1.8332, 'grad_norm': 19.07351303100586, 'learning_rate': 0.005, 'epoch': 3.36, 'num_input_tokens_seen': 12422368}
 34%|███▎      | 1095/3250 [4:02:07<6:56:03, 11.58s/it] 34%|███▎      | 1096/3250 [4:02:18<6:55:45, 11.58s/it] 34%|███▍      | 1097/3250 [4:02:30<6:56:24, 11.60s/it] 34%|███▍      | 1098/3250 [4:02:42<6:59:19, 11.69s/it] 34%|███▍      | 1099/3250 [4:02:54<6:59:58, 11.71s/it] 34%|███▍      | 1100/3250 [4:03:05<6:58:40, 11.68s/it]                                                       {'loss': 1.7639, 'grad_norm': 0.8219174146652222, 'learning_rate': 0.005, 'epoch': 3.38, 'num_input_tokens_seen': 12479552}
 34%|███▍      | 1100/3250 [4:03:05<6:58:40, 11.68s/it][INFO|trainer.py:4021] 2024-10-11 08:55:08,845 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-10-11 08:55:08,845 >>   Num examples = 1157
[INFO|trainer.py:4026] 2024-10-11 08:55:08,845 >>   Batch size = 4

  0%|          | 0/145 [00:00<?, ?it/s][A
  1%|▏         | 2/145 [00:01<01:49,  1.31it/s][A
  2%|▏         | 3/145 [00:03<02:37,  1.11s/it][A
  3%|▎         | 4/145 [00:04<02:58,  1.26s/it][A
  3%|▎         | 5/145 [00:06<03:03,  1.31s/it][A
  4%|▍         | 6/145 [00:07<03:14,  1.40s/it][A
  5%|▍         | 7/145 [00:09<03:20,  1.45s/it][A
  6%|▌         | 8/145 [00:10<03:19,  1.46s/it][A
  6%|▌         | 9/145 [00:12<03:18,  1.46s/it][A
  7%|▋         | 10/145 [00:13<03:20,  1.48s/it][A
  8%|▊         | 11/145 [00:15<03:20,  1.50s/it][A
  8%|▊         | 12/145 [00:16<03:22,  1.52s/it][A
  9%|▉         | 13/145 [00:18<03:23,  1.54s/it][A
 10%|▉         | 14/145 [00:19<03:23,  1.56s/it][A
 10%|█         | 15/145 [00:21<03:20,  1.54s/it][A
 11%|█         | 16/145 [00:22<03:17,  1.53s/it][A
 12%|█▏        | 17/145 [00:24<03:17,  1.54s/it][A
 12%|█▏        | 18/145 [00:26<03:16,  1.54s/it][A
 13%|█▎        | 19/145 [00:27<03:15,  1.55s/it][A
 14%|█▍        | 20/145 [00:29<03:13,  1.55s/it][A
 14%|█▍        | 21/145 [00:30<03:09,  1.52s/it][A
 15%|█▌        | 22/145 [00:32<03:06,  1.52s/it][A
 16%|█▌        | 23/145 [00:33<03:04,  1.51s/it][A
 17%|█▋        | 24/145 [00:35<03:03,  1.52s/it][A
 17%|█▋        | 25/145 [00:36<03:03,  1.53s/it][A
 18%|█▊        | 26/145 [00:38<03:00,  1.51s/it][A
 19%|█▊        | 27/145 [00:39<03:00,  1.53s/it][A
 19%|█▉        | 28/145 [00:41<02:57,  1.52s/it][A
 20%|██        | 29/145 [00:42<02:55,  1.52s/it][A
 21%|██        | 30/145 [00:44<02:49,  1.48s/it][A
 21%|██▏       | 31/145 [00:45<02:51,  1.50s/it][A
 22%|██▏       | 32/145 [00:47<02:50,  1.51s/it][A
 23%|██▎       | 33/145 [00:48<02:50,  1.52s/it][A
 23%|██▎       | 34/145 [00:50<02:49,  1.53s/it][A
 24%|██▍       | 35/145 [00:51<02:48,  1.53s/it][A
 25%|██▍       | 36/145 [00:53<02:46,  1.53s/it][A
 26%|██▌       | 37/145 [00:55<02:48,  1.56s/it][A
 26%|██▌       | 38/145 [00:56<02:46,  1.56s/it][A
 27%|██▋       | 39/145 [00:58<02:44,  1.55s/it][A
 28%|██▊       | 40/145 [00:59<02:42,  1.55s/it][A
 28%|██▊       | 41/145 [01:01<02:43,  1.57s/it][A
 29%|██▉       | 42/145 [01:02<02:41,  1.57s/it][A
 30%|██▉       | 43/145 [01:04<02:37,  1.55s/it][A
 30%|███       | 44/145 [01:05<02:39,  1.57s/it][A
 31%|███       | 45/145 [01:07<02:38,  1.59s/it][A
 32%|███▏      | 46/145 [01:09<02:34,  1.56s/it][A
 32%|███▏      | 47/145 [01:10<02:30,  1.54s/it][A
 33%|███▎      | 48/145 [01:12<02:29,  1.55s/it][A
 34%|███▍      | 49/145 [01:13<02:28,  1.55s/it][A
 34%|███▍      | 50/145 [01:15<02:28,  1.56s/it][A
 35%|███▌      | 51/145 [01:16<02:26,  1.56s/it][A
 36%|███▌      | 52/145 [01:18<02:25,  1.56s/it][A
 37%|███▋      | 53/145 [01:19<02:23,  1.56s/it][A
 37%|███▋      | 54/145 [01:21<02:22,  1.56s/it][A
 38%|███▊      | 55/145 [01:23<02:20,  1.56s/it][A
 39%|███▊      | 56/145 [01:24<02:18,  1.55s/it][A
 39%|███▉      | 57/145 [01:26<02:15,  1.54s/it][A
 40%|████      | 58/145 [01:27<02:13,  1.54s/it][A
 41%|████      | 59/145 [01:29<02:14,  1.56s/it][A
 41%|████▏     | 60/145 [01:30<02:11,  1.54s/it][A
 42%|████▏     | 61/145 [01:32<02:09,  1.54s/it][A
 43%|████▎     | 62/145 [01:33<02:06,  1.53s/it][A
 43%|████▎     | 63/145 [01:35<02:06,  1.55s/it][A
 44%|████▍     | 64/145 [01:36<02:04,  1.54s/it][A
 45%|████▍     | 65/145 [01:38<02:04,  1.55s/it][A
 46%|████▌     | 66/145 [01:40<02:02,  1.55s/it][A
 46%|████▌     | 67/145 [01:41<02:00,  1.54s/it][A
 47%|████▋     | 68/145 [01:43<02:00,  1.56s/it][A
 48%|████▊     | 69/145 [01:44<01:59,  1.57s/it][A
 48%|████▊     | 70/145 [01:46<01:53,  1.51s/it][A
 49%|████▉     | 71/145 [01:47<01:51,  1.51s/it][A
 50%|████▉     | 72/145 [01:49<01:51,  1.52s/it][A
 50%|█████     | 73/145 [01:50<01:51,  1.55s/it][A
 51%|█████     | 74/145 [01:52<01:50,  1.56s/it][A
 52%|█████▏    | 75/145 [01:53<01:49,  1.56s/it][A
 52%|█████▏    | 76/145 [01:55<01:47,  1.55s/it][A
 53%|█████▎    | 77/145 [01:57<01:44,  1.53s/it][A
 54%|█████▍    | 78/145 [01:58<01:42,  1.53s/it][A
 54%|█████▍    | 79/145 [02:00<01:40,  1.52s/it][A
 55%|█████▌    | 80/145 [02:01<01:38,  1.51s/it][A
 56%|█████▌    | 81/145 [02:02<01:35,  1.49s/it][A
 57%|█████▋    | 82/145 [02:04<01:35,  1.51s/it][A
 57%|█████▋    | 83/145 [02:06<01:34,  1.53s/it][A
 58%|█████▊    | 84/145 [02:07<01:33,  1.54s/it][A
 59%|█████▊    | 85/145 [02:09<01:30,  1.52s/it][A
 59%|█████▉    | 86/145 [02:10<01:30,  1.53s/it][A
 60%|██████    | 87/145 [02:12<01:30,  1.55s/it][A
 61%|██████    | 88/145 [02:13<01:27,  1.53s/it][A
 61%|██████▏   | 89/145 [02:15<01:26,  1.54s/it][A
 62%|██████▏   | 90/145 [02:16<01:25,  1.55s/it][A
 63%|██████▎   | 91/145 [02:18<01:23,  1.55s/it][A
 63%|██████▎   | 92/145 [02:19<01:21,  1.54s/it][A
 64%|██████▍   | 93/145 [02:21<01:19,  1.52s/it][A
 65%|██████▍   | 94/145 [02:22<01:17,  1.52s/it][A
 66%|██████▌   | 95/145 [02:24<01:16,  1.53s/it][A
 66%|██████▌   | 96/145 [02:26<01:15,  1.53s/it][A
 67%|██████▋   | 97/145 [02:27<01:13,  1.54s/it][A
 68%|██████▊   | 98/145 [02:29<01:14,  1.58s/it][A
 68%|██████▊   | 99/145 [02:30<01:11,  1.55s/it][A
 69%|██████▉   | 100/145 [02:32<01:09,  1.55s/it][A
 70%|██████▉   | 101/145 [02:33<01:08,  1.56s/it][A
 70%|███████   | 102/145 [02:35<01:07,  1.56s/it][A
 71%|███████   | 103/145 [02:37<01:05,  1.56s/it][A
 72%|███████▏  | 104/145 [02:38<01:04,  1.57s/it][A
 72%|███████▏  | 105/145 [02:40<01:02,  1.57s/it][A
 73%|███████▎  | 106/145 [02:41<01:00,  1.56s/it][A
 74%|███████▍  | 107/145 [02:43<00:57,  1.51s/it][A
 74%|███████▍  | 108/145 [02:44<00:55,  1.49s/it][A
 75%|███████▌  | 109/145 [02:46<00:54,  1.51s/it][A
 76%|███████▌  | 110/145 [02:47<00:53,  1.53s/it][A
 77%|███████▋  | 111/145 [02:49<00:50,  1.49s/it][A
 77%|███████▋  | 112/145 [02:50<00:50,  1.52s/it][A
 78%|███████▊  | 113/145 [02:52<00:49,  1.54s/it][A
 79%|███████▊  | 114/145 [02:53<00:48,  1.55s/it][A
 79%|███████▉  | 115/145 [02:55<00:46,  1.55s/it][A
 80%|████████  | 116/145 [02:56<00:44,  1.52s/it][A
 81%|████████  | 117/145 [02:58<00:42,  1.52s/it][A
 81%|████████▏ | 118/145 [02:59<00:40,  1.52s/it][A
 82%|████████▏ | 119/145 [03:01<00:38,  1.48s/it][A
 83%|████████▎ | 120/145 [03:02<00:36,  1.47s/it][A
 83%|████████▎ | 121/145 [03:04<00:35,  1.47s/it][A
 84%|████████▍ | 122/145 [03:05<00:34,  1.49s/it][A
 85%|████████▍ | 123/145 [03:07<00:32,  1.50s/it][A
 86%|████████▌ | 124/145 [03:08<00:31,  1.49s/it][A
 86%|████████▌ | 125/145 [03:10<00:30,  1.54s/it][A
 87%|████████▋ | 126/145 [03:11<00:28,  1.52s/it][A
 88%|████████▊ | 127/145 [03:13<00:27,  1.52s/it][A
 88%|████████▊ | 128/145 [03:14<00:26,  1.55s/it][A
 89%|████████▉ | 129/145 [03:16<00:24,  1.55s/it][A
 90%|████████▉ | 130/145 [03:18<00:23,  1.57s/it][A
 90%|█████████ | 131/145 [03:19<00:21,  1.52s/it][A
 91%|█████████ | 132/145 [03:21<00:20,  1.54s/it][A
 92%|█████████▏| 133/145 [03:22<00:18,  1.51s/it][A
 92%|█████████▏| 134/145 [03:24<00:16,  1.54s/it][A
 93%|█████████▎| 135/145 [03:25<00:15,  1.54s/it][A
 94%|█████████▍| 136/145 [03:27<00:13,  1.54s/it][A
 94%|█████████▍| 137/145 [03:28<00:12,  1.53s/it][A
 95%|█████████▌| 138/145 [03:30<00:10,  1.55s/it][A
 96%|█████████▌| 139/145 [03:31<00:09,  1.54s/it][A
 97%|█████████▋| 140/145 [03:33<00:07,  1.55s/it][A
 97%|█████████▋| 141/145 [03:35<00:06,  1.55s/it][A
 98%|█████████▊| 142/145 [03:36<00:04,  1.53s/it][A
 99%|█████████▊| 143/145 [03:38<00:03,  1.53s/it][A
 99%|█████████▉| 144/145 [03:39<00:01,  1.54s/it][A
100%|██████████| 145/145 [03:41<00:00,  1.51s/it][A
                                                 [A                                                       {'eval_loss': 1.7428176403045654, 'eval_runtime': 222.737, 'eval_samples_per_second': 5.194, 'eval_steps_per_second': 0.651, 'epoch': 3.38, 'num_input_tokens_seen': 12479552}

100%|██████████| 145/145 [03:41<00:00,  1.51s/it][A 34%|███▍      | 1100/3250 [4:06:48<6:58:40, 11.68s/it]
                                                 [A[INFO|trainer.py:3705] 2024-10-11 08:58:51,584 >> Saving model checkpoint to /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1100
[INFO|configuration_utils.py:672] 2024-10-11 08:58:53,048 >> loading configuration file config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/config.json
[WARNING|modeling_rope_utils.py:379] 2024-10-11 08:58:53,048 >> Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
[INFO|configuration_utils.py:739] 2024-10-11 08:58:53,050 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 3584,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 18944,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 28,
  "num_hidden_layers": 28,
  "num_key_value_heads": 4,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.0",
  "use_cache": true,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "in_chans": 3,
    "model_type": "qwen2_vl",
    "spatial_patch_size": 14
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 152064
}

[INFO|tokenization_utils_base.py:2649] 2024-10-11 08:58:53,127 >> tokenizer config file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1100/tokenizer_config.json
[INFO|tokenization_utils_base.py:2658] 2024-10-11 08:58:53,128 >> Special tokens file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1100/special_tokens_map.json
[INFO|image_processing_base.py:258] 2024-10-11 08:58:53,636 >> Image processor saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1100/preprocessor_config.json
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 34%|███▍      | 1101/3250 [4:07:01<47:09:07, 78.99s/it] 34%|███▍      | 1102/3250 [4:07:13<35:03:07, 58.75s/it] 34%|███▍      | 1103/3250 [4:07:24<26:36:39, 44.62s/it] 34%|███▍      | 1104/3250 [4:07:36<20:40:42, 34.69s/it] 34%|███▍      | 1105/3250 [4:07:48<16:36:45, 27.88s/it]                                                        {'loss': 1.8826, 'grad_norm': 1.3060535192489624, 'learning_rate': 0.005, 'epoch': 3.39, 'num_input_tokens_seen': 12535680}
 34%|███▍      | 1105/3250 [4:07:48<16:36:45, 27.88s/it] 34%|███▍      | 1106/3250 [4:08:00<13:41:21, 22.99s/it] 34%|███▍      | 1107/3250 [4:08:11<11:37:24, 19.53s/it] 34%|███▍      | 1108/3250 [4:08:23<10:13:46, 17.19s/it] 34%|███▍      | 1109/3250 [4:08:34<9:14:37, 15.54s/it]  34%|███▍      | 1110/3250 [4:08:46<8:33:49, 14.41s/it]                                                       {'loss': 1.7715, 'grad_norm': 1.1744073629379272, 'learning_rate': 0.005, 'epoch': 3.41, 'num_input_tokens_seen': 12593280}
 34%|███▍      | 1110/3250 [4:08:46<8:33:49, 14.41s/it] 34%|███▍      | 1111/3250 [4:08:58<8:06:05, 13.63s/it] 34%|███▍      | 1112/3250 [4:09:10<7:43:19, 13.00s/it] 34%|███▍      | 1113/3250 [4:09:21<7:30:21, 12.64s/it] 34%|███▍      | 1114/3250 [4:09:33<7:16:34, 12.26s/it] 34%|███▍      | 1115/3250 [4:09:44<7:08:44, 12.05s/it]                                                       {'loss': 1.6967, 'grad_norm': 5.709489345550537, 'learning_rate': 0.005, 'epoch': 3.43, 'num_input_tokens_seen': 12650208}
 34%|███▍      | 1115/3250 [4:09:44<7:08:44, 12.05s/it] 34%|███▍      | 1116/3250 [4:09:55<6:59:54, 11.81s/it] 34%|███▍      | 1117/3250 [4:10:07<6:56:19, 11.71s/it] 34%|███▍      | 1118/3250 [4:10:18<6:53:39, 11.64s/it] 34%|███▍      | 1119/3250 [4:10:30<6:55:48, 11.71s/it] 34%|███▍      | 1120/3250 [4:10:42<6:52:05, 11.61s/it]                                                       {'loss': 1.8535, 'grad_norm': 0.9478718638420105, 'learning_rate': 0.005, 'epoch': 3.44, 'num_input_tokens_seen': 12705056}
 34%|███▍      | 1120/3250 [4:10:42<6:52:05, 11.61s/it] 34%|███▍      | 1121/3250 [4:10:53<6:52:37, 11.63s/it] 35%|███▍      | 1122/3250 [4:11:05<6:55:03, 11.70s/it] 35%|███▍      | 1123/3250 [4:11:17<6:50:38, 11.58s/it] 35%|███▍      | 1124/3250 [4:11:28<6:51:33, 11.61s/it] 35%|███▍      | 1125/3250 [4:11:39<6:47:32, 11.51s/it]                                                       {'loss': 1.8153, 'grad_norm': 0.9035606980323792, 'learning_rate': 0.005, 'epoch': 3.46, 'num_input_tokens_seen': 12761312}
 35%|███▍      | 1125/3250 [4:11:39<6:47:32, 11.51s/it] 35%|███▍      | 1126/3250 [4:11:51<6:48:08, 11.53s/it] 35%|███▍      | 1127/3250 [4:12:03<6:48:10, 11.54s/it] 35%|███▍      | 1128/3250 [4:12:14<6:48:39, 11.55s/it] 35%|███▍      | 1129/3250 [4:12:26<6:50:07, 11.60s/it] 35%|███▍      | 1130/3250 [4:12:37<6:48:51, 11.57s/it]                                                       {'loss': 1.7647, 'grad_norm': 0.5278962254524231, 'learning_rate': 0.005, 'epoch': 3.47, 'num_input_tokens_seen': 12818464}
 35%|███▍      | 1130/3250 [4:12:37<6:48:51, 11.57s/it] 35%|███▍      | 1131/3250 [4:12:49<6:48:36, 11.57s/it] 35%|███▍      | 1132/3250 [4:13:01<6:47:42, 11.55s/it] 35%|███▍      | 1133/3250 [4:13:12<6:47:54, 11.56s/it] 35%|███▍      | 1134/3250 [4:13:24<6:47:56, 11.57s/it] 35%|███▍      | 1135/3250 [4:13:35<6:45:34, 11.51s/it]                                                       {'loss': 1.7306, 'grad_norm': 0.6348806023597717, 'learning_rate': 0.005, 'epoch': 3.49, 'num_input_tokens_seen': 12875488}
 35%|███▍      | 1135/3250 [4:13:35<6:45:34, 11.51s/it] 35%|███▍      | 1136/3250 [4:13:47<6:48:04, 11.58s/it] 35%|███▍      | 1137/3250 [4:13:58<6:46:32, 11.54s/it] 35%|███▌      | 1138/3250 [4:14:10<6:44:12, 11.48s/it] 35%|███▌      | 1139/3250 [4:14:21<6:42:21, 11.44s/it] 35%|███▌      | 1140/3250 [4:14:32<6:41:00, 11.40s/it]                                                       {'loss': 1.8495, 'grad_norm': 0.8334132432937622, 'learning_rate': 0.005, 'epoch': 3.5, 'num_input_tokens_seen': 12932128}
 35%|███▌      | 1140/3250 [4:14:32<6:41:00, 11.40s/it] 35%|███▌      | 1141/3250 [4:14:44<6:44:19, 11.50s/it] 35%|███▌      | 1142/3250 [4:14:55<6:43:18, 11.48s/it] 35%|███▌      | 1143/3250 [4:15:07<6:45:04, 11.53s/it] 35%|███▌      | 1144/3250 [4:15:19<6:44:41, 11.53s/it] 35%|███▌      | 1145/3250 [4:15:30<6:45:38, 11.56s/it]                                                       {'loss': 1.8725, 'grad_norm': 0.7188271880149841, 'learning_rate': 0.005, 'epoch': 3.52, 'num_input_tokens_seen': 12988352}
 35%|███▌      | 1145/3250 [4:15:30<6:45:38, 11.56s/it] 35%|███▌      | 1146/3250 [4:15:42<6:46:19, 11.59s/it] 35%|███▌      | 1147/3250 [4:15:53<6:43:26, 11.51s/it] 35%|███▌      | 1148/3250 [4:16:04<6:37:55, 11.36s/it] 35%|███▌      | 1149/3250 [4:16:16<6:39:18, 11.40s/it] 35%|███▌      | 1150/3250 [4:16:27<6:42:10, 11.49s/it]                                                       {'loss': 1.9072, 'grad_norm': 0.6706913709640503, 'learning_rate': 0.005, 'epoch': 3.53, 'num_input_tokens_seen': 13044096}
 35%|███▌      | 1150/3250 [4:16:27<6:42:10, 11.49s/it] 35%|███▌      | 1151/3250 [4:16:39<6:42:20, 11.50s/it] 35%|███▌      | 1152/3250 [4:16:51<6:44:42, 11.57s/it] 35%|███▌      | 1153/3250 [4:17:02<6:46:03, 11.62s/it] 36%|███▌      | 1154/3250 [4:17:14<6:44:32, 11.58s/it] 36%|███▌      | 1155/3250 [4:17:26<6:44:54, 11.60s/it]                                                       {'loss': 1.8067, 'grad_norm': 1.0085244178771973, 'learning_rate': 0.005, 'epoch': 3.55, 'num_input_tokens_seen': 13102272}
 36%|███▌      | 1155/3250 [4:17:26<6:44:54, 11.60s/it] 36%|███▌      | 1156/3250 [4:17:37<6:40:33, 11.48s/it] 36%|███▌      | 1157/3250 [4:17:48<6:40:38, 11.49s/it] 36%|███▌      | 1158/3250 [4:18:00<6:40:34, 11.49s/it] 36%|███▌      | 1159/3250 [4:18:11<6:38:20, 11.43s/it] 36%|███▌      | 1160/3250 [4:18:22<6:38:02, 11.43s/it]                                                       {'loss': 1.8113, 'grad_norm': 0.8491518497467041, 'learning_rate': 0.005, 'epoch': 3.56, 'num_input_tokens_seen': 13158080}
 36%|███▌      | 1160/3250 [4:18:22<6:38:02, 11.43s/it] 36%|███▌      | 1161/3250 [4:18:34<6:36:49, 11.40s/it] 36%|███▌      | 1162/3250 [4:18:45<6:34:29, 11.34s/it] 36%|███▌      | 1163/3250 [4:18:57<6:36:26, 11.40s/it] 36%|███▌      | 1164/3250 [4:19:08<6:37:01, 11.42s/it] 36%|███▌      | 1165/3250 [4:19:20<6:38:37, 11.47s/it]                                                       {'loss': 1.6638, 'grad_norm': 0.5934738516807556, 'learning_rate': 0.005, 'epoch': 3.58, 'num_input_tokens_seen': 13213888}
 36%|███▌      | 1165/3250 [4:19:20<6:38:37, 11.47s/it] 36%|███▌      | 1166/3250 [4:19:31<6:36:33, 11.42s/it] 36%|███▌      | 1167/3250 [4:19:43<6:39:33, 11.51s/it] 36%|███▌      | 1168/3250 [4:19:54<6:40:37, 11.55s/it] 36%|███▌      | 1169/3250 [4:20:06<6:43:58, 11.65s/it] 36%|███▌      | 1170/3250 [4:20:18<6:42:21, 11.61s/it]                                                       {'loss': 1.6968, 'grad_norm': 0.6593263745307922, 'learning_rate': 0.005, 'epoch': 3.59, 'num_input_tokens_seen': 13270688}
 36%|███▌      | 1170/3250 [4:20:18<6:42:21, 11.61s/it] 36%|███▌      | 1171/3250 [4:20:29<6:39:05, 11.52s/it] 36%|███▌      | 1172/3250 [4:20:40<6:38:44, 11.51s/it] 36%|███▌      | 1173/3250 [4:20:52<6:37:04, 11.47s/it] 36%|███▌      | 1174/3250 [4:21:04<6:39:26, 11.54s/it] 36%|███▌      | 1175/3250 [4:21:15<6:41:11, 11.60s/it]                                                       {'loss': 1.6327, 'grad_norm': 0.6089114546775818, 'learning_rate': 0.005, 'epoch': 3.61, 'num_input_tokens_seen': 13326656}
 36%|███▌      | 1175/3250 [4:21:15<6:41:11, 11.60s/it] 36%|███▌      | 1176/3250 [4:21:27<6:42:29, 11.64s/it] 36%|███▌      | 1177/3250 [4:21:39<6:43:51, 11.69s/it] 36%|███▌      | 1178/3250 [4:21:50<6:42:59, 11.67s/it] 36%|███▋      | 1179/3250 [4:22:02<6:39:48, 11.58s/it] 36%|███▋      | 1180/3250 [4:22:13<6:38:24, 11.55s/it]                                                       {'loss': 1.7693, 'grad_norm': 0.5909726023674011, 'learning_rate': 0.005, 'epoch': 3.63, 'num_input_tokens_seen': 13383744}
 36%|███▋      | 1180/3250 [4:22:13<6:38:24, 11.55s/it] 36%|███▋      | 1181/3250 [4:22:25<6:36:48, 11.51s/it] 36%|███▋      | 1182/3250 [4:22:36<6:35:05, 11.46s/it] 36%|███▋      | 1183/3250 [4:22:48<6:37:39, 11.54s/it] 36%|███▋      | 1184/3250 [4:22:59<6:38:23, 11.57s/it] 36%|███▋      | 1185/3250 [4:23:11<6:34:04, 11.45s/it]                                                       {'loss': 1.6883, 'grad_norm': 0.6749019026756287, 'learning_rate': 0.005, 'epoch': 3.64, 'num_input_tokens_seen': 13439840}
 36%|███▋      | 1185/3250 [4:23:11<6:34:04, 11.45s/it] 36%|███▋      | 1186/3250 [4:23:22<6:35:53, 11.51s/it] 37%|███▋      | 1187/3250 [4:23:34<6:36:40, 11.54s/it] 37%|███▋      | 1188/3250 [4:23:45<6:37:18, 11.56s/it] 37%|███▋      | 1189/3250 [4:23:57<6:35:19, 11.51s/it] 37%|███▋      | 1190/3250 [4:24:09<6:37:29, 11.58s/it]                                                       {'loss': 1.768, 'grad_norm': 1.0538839101791382, 'learning_rate': 0.005, 'epoch': 3.66, 'num_input_tokens_seen': 13496704}
 37%|███▋      | 1190/3250 [4:24:09<6:37:29, 11.58s/it] 37%|███▋      | 1191/3250 [4:24:20<6:35:19, 11.52s/it] 37%|███▋      | 1192/3250 [4:24:32<6:37:16, 11.58s/it] 37%|███▋      | 1193/3250 [4:24:43<6:33:12, 11.47s/it] 37%|███▋      | 1194/3250 [4:24:55<6:35:06, 11.53s/it] 37%|███▋      | 1195/3250 [4:25:06<6:36:16, 11.57s/it]                                                       {'loss': 1.8744, 'grad_norm': 0.4251440763473511, 'learning_rate': 0.005, 'epoch': 3.67, 'num_input_tokens_seen': 13552384}
 37%|███▋      | 1195/3250 [4:25:06<6:36:16, 11.57s/it] 37%|███▋      | 1196/3250 [4:25:18<6:34:49, 11.53s/it] 37%|███▋      | 1197/3250 [4:25:29<6:36:06, 11.58s/it] 37%|███▋      | 1198/3250 [4:25:41<6:38:31, 11.65s/it] 37%|███▋      | 1199/3250 [4:25:52<6:32:18, 11.48s/it] 37%|███▋      | 1200/3250 [4:26:04<6:36:01, 11.59s/it]                                                       {'loss': 1.7534, 'grad_norm': 1.522416353225708, 'learning_rate': 0.005, 'epoch': 3.69, 'num_input_tokens_seen': 13609472}
 37%|███▋      | 1200/3250 [4:26:04<6:36:01, 11.59s/it][INFO|trainer.py:4021] 2024-10-11 09:18:07,703 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-10-11 09:18:07,703 >>   Num examples = 1157
[INFO|trainer.py:4026] 2024-10-11 09:18:07,703 >>   Batch size = 4

  0%|          | 0/145 [00:00<?, ?it/s][A
  1%|▏         | 2/145 [00:01<01:49,  1.31it/s][A
  2%|▏         | 3/145 [00:03<02:37,  1.11s/it][A
  3%|▎         | 4/145 [00:04<02:56,  1.26s/it][A
  3%|▎         | 5/145 [00:06<03:03,  1.31s/it][A
  4%|▍         | 6/145 [00:07<03:13,  1.39s/it][A
  5%|▍         | 7/145 [00:09<03:19,  1.45s/it][A
  6%|▌         | 8/145 [00:10<03:17,  1.44s/it][A
  6%|▌         | 9/145 [00:12<03:17,  1.45s/it][A
  7%|▋         | 10/145 [00:13<03:18,  1.47s/it][A
  8%|▊         | 11/145 [00:15<03:18,  1.48s/it][A
  8%|▊         | 12/145 [00:16<03:20,  1.51s/it][A
  9%|▉         | 13/145 [00:18<03:21,  1.53s/it][A
 10%|▉         | 14/145 [00:19<03:23,  1.55s/it][A
 10%|█         | 15/145 [00:21<03:19,  1.54s/it][A
 11%|█         | 16/145 [00:22<03:16,  1.53s/it][A
 12%|█▏        | 17/145 [00:24<03:15,  1.53s/it][A
 12%|█▏        | 18/145 [00:25<03:14,  1.53s/it][A
 13%|█▎        | 19/145 [00:27<03:13,  1.54s/it][A
 14%|█▍        | 20/145 [00:29<03:12,  1.54s/it][A
 14%|█▍        | 21/145 [00:30<03:08,  1.52s/it][A
 15%|█▌        | 22/145 [00:31<03:05,  1.51s/it][A
 16%|█▌        | 23/145 [00:33<03:03,  1.50s/it][A
 17%|█▋        | 24/145 [00:34<03:02,  1.51s/it][A
 17%|█▋        | 25/145 [00:36<03:01,  1.51s/it][A
 18%|█▊        | 26/145 [00:37<02:59,  1.51s/it][A
 19%|█▊        | 27/145 [00:39<02:58,  1.51s/it][A
 19%|█▉        | 28/145 [00:41<02:56,  1.51s/it][A
 20%|██        | 29/145 [00:42<02:55,  1.51s/it][A
 21%|██        | 30/145 [00:43<02:49,  1.48s/it][A
 21%|██▏       | 31/145 [00:45<02:50,  1.50s/it][A
 22%|██▏       | 32/145 [00:46<02:50,  1.50s/it][A
 23%|██▎       | 33/145 [00:48<02:49,  1.51s/it][A
 23%|██▎       | 34/145 [00:50<02:48,  1.52s/it][A
 24%|██▍       | 35/145 [00:51<02:47,  1.52s/it][A
 25%|██▍       | 36/145 [00:53<02:45,  1.52s/it][A
 26%|██▌       | 37/145 [00:54<02:48,  1.56s/it][A
 26%|██▌       | 38/145 [00:56<02:46,  1.55s/it][A
 27%|██▋       | 39/145 [00:57<02:43,  1.54s/it][A
 28%|██▊       | 40/145 [00:59<02:41,  1.54s/it][A
 28%|██▊       | 41/145 [01:00<02:42,  1.56s/it][A
 29%|██▉       | 42/145 [01:02<02:40,  1.56s/it][A
 30%|██▉       | 43/145 [01:03<02:37,  1.54s/it][A
 30%|███       | 44/145 [01:05<02:37,  1.56s/it][A
 31%|███       | 45/145 [01:07<02:38,  1.58s/it][A
 32%|███▏      | 46/145 [01:08<02:33,  1.55s/it][A
 32%|███▏      | 47/145 [01:10<02:29,  1.53s/it][A
 33%|███▎      | 48/145 [01:11<02:29,  1.54s/it][A
 34%|███▍      | 49/145 [01:13<02:28,  1.55s/it][A
 34%|███▍      | 50/145 [01:14<02:27,  1.55s/it][A
 35%|███▌      | 51/145 [01:16<02:25,  1.55s/it][A
 36%|███▌      | 52/145 [01:17<02:23,  1.54s/it][A
 37%|███▋      | 53/145 [01:19<02:21,  1.54s/it][A
 37%|███▋      | 54/145 [01:21<02:20,  1.55s/it][A
 38%|███▊      | 55/145 [01:22<02:18,  1.54s/it][A
 39%|███▊      | 56/145 [01:24<02:17,  1.54s/it][A
 39%|███▉      | 57/145 [01:25<02:14,  1.53s/it][A
 40%|████      | 58/145 [01:27<02:12,  1.52s/it][A
 41%|████      | 59/145 [01:28<02:13,  1.55s/it][A
 41%|████▏     | 60/145 [01:30<02:10,  1.54s/it][A
 42%|████▏     | 61/145 [01:31<02:08,  1.53s/it][A
 43%|████▎     | 62/145 [01:33<02:05,  1.52s/it][A
 43%|████▎     | 63/145 [01:34<02:06,  1.54s/it][A
 44%|████▍     | 64/145 [01:36<02:04,  1.53s/it][A
 45%|████▍     | 65/145 [01:37<02:03,  1.54s/it][A
 46%|████▌     | 66/145 [01:39<02:01,  1.54s/it][A
 46%|████▌     | 67/145 [01:40<01:59,  1.53s/it][A
 47%|████▋     | 68/145 [01:42<01:59,  1.56s/it][A
 48%|████▊     | 69/145 [01:44<01:58,  1.56s/it][A
 48%|████▊     | 70/145 [01:45<01:53,  1.52s/it][A
 49%|████▉     | 71/145 [01:47<01:51,  1.51s/it][A
 50%|████▉     | 72/145 [01:48<01:51,  1.52s/it][A
 50%|█████     | 73/145 [01:50<01:51,  1.55s/it][A
 51%|█████     | 74/145 [01:51<01:50,  1.55s/it][A
 52%|█████▏    | 75/145 [01:53<01:49,  1.56s/it][A
 52%|█████▏    | 76/145 [01:54<01:46,  1.55s/it][A
 53%|█████▎    | 77/145 [01:56<01:43,  1.52s/it][A
 54%|█████▍    | 78/145 [01:57<01:41,  1.52s/it][A
 54%|█████▍    | 79/145 [01:59<01:39,  1.51s/it][A
 55%|█████▌    | 80/145 [02:00<01:38,  1.51s/it][A
 56%|█████▌    | 81/145 [02:02<01:35,  1.49s/it][A
 57%|█████▋    | 82/145 [02:03<01:34,  1.50s/it][A
 57%|█████▋    | 83/145 [02:05<01:34,  1.52s/it][A
 58%|█████▊    | 84/145 [02:06<01:33,  1.53s/it][A
 59%|█████▊    | 85/145 [02:08<01:29,  1.50s/it][A
 59%|█████▉    | 86/145 [02:09<01:29,  1.52s/it][A
 60%|██████    | 87/145 [02:11<01:29,  1.54s/it][A
 61%|██████    | 88/145 [02:12<01:26,  1.51s/it][A
 61%|██████▏   | 89/145 [02:14<01:25,  1.52s/it][A
 62%|██████▏   | 90/145 [02:16<01:24,  1.53s/it][A
 63%|██████▎   | 91/145 [02:17<01:22,  1.53s/it][A
 63%|██████▎   | 92/145 [02:19<01:21,  1.53s/it][A
 64%|██████▍   | 93/145 [02:20<01:18,  1.51s/it][A
 65%|██████▍   | 94/145 [02:22<01:16,  1.51s/it][A
 66%|██████▌   | 95/145 [02:23<01:15,  1.51s/it][A
 66%|██████▌   | 96/145 [02:25<01:14,  1.52s/it][A
 67%|██████▋   | 97/145 [02:26<01:13,  1.53s/it][A
 68%|██████▊   | 98/145 [02:28<01:13,  1.57s/it][A
 68%|██████▊   | 99/145 [02:29<01:10,  1.54s/it][A
 69%|██████▉   | 100/145 [02:31<01:09,  1.54s/it][A
 70%|██████▉   | 101/145 [02:32<01:08,  1.55s/it][A
 70%|███████   | 102/145 [02:34<01:06,  1.54s/it][A
 71%|███████   | 103/145 [02:35<01:04,  1.54s/it][A
 72%|███████▏  | 104/145 [02:37<01:03,  1.54s/it][A
 72%|███████▏  | 105/145 [02:39<01:01,  1.54s/it][A
 73%|███████▎  | 106/145 [02:40<01:00,  1.54s/it][A
 74%|███████▍  | 107/145 [02:42<00:56,  1.50s/it][A
 74%|███████▍  | 108/145 [02:43<00:54,  1.47s/it][A
 75%|███████▌  | 109/145 [02:44<00:53,  1.50s/it][A
 76%|███████▌  | 110/145 [02:46<00:53,  1.52s/it][A
 77%|███████▋  | 111/145 [02:47<00:50,  1.48s/it][A
 77%|███████▋  | 112/145 [02:49<00:50,  1.52s/it][A
 78%|███████▊  | 113/145 [02:51<00:49,  1.54s/it][A
 79%|███████▊  | 114/145 [02:52<00:47,  1.54s/it][A
 79%|███████▉  | 115/145 [02:54<00:46,  1.54s/it][A
 80%|████████  | 116/145 [02:55<00:43,  1.51s/it][A
 81%|████████  | 117/145 [02:57<00:42,  1.52s/it][A
 81%|████████▏ | 118/145 [02:58<00:40,  1.51s/it][A
 82%|████████▏ | 119/145 [03:00<00:38,  1.47s/it][A
 83%|████████▎ | 120/145 [03:01<00:36,  1.46s/it][A
 83%|████████▎ | 121/145 [03:02<00:35,  1.46s/it][A
 84%|████████▍ | 122/145 [03:04<00:33,  1.47s/it][A
 85%|████████▍ | 123/145 [03:05<00:32,  1.49s/it][A
 86%|████████▌ | 124/145 [03:07<00:30,  1.48s/it][A
 86%|████████▌ | 125/145 [03:09<00:30,  1.54s/it][A
 87%|████████▋ | 126/145 [03:10<00:28,  1.52s/it][A
 88%|████████▊ | 127/145 [03:12<00:27,  1.51s/it][A
 88%|████████▊ | 128/145 [03:13<00:26,  1.54s/it][A
 89%|████████▉ | 129/145 [03:15<00:24,  1.54s/it][A
 90%|████████▉ | 130/145 [03:16<00:23,  1.56s/it][A
 90%|█████████ | 131/145 [03:18<00:21,  1.52s/it][A
 91%|█████████ | 132/145 [03:19<00:19,  1.53s/it][A
 92%|█████████▏| 133/145 [03:21<00:18,  1.50s/it][A
 92%|█████████▏| 134/145 [03:22<00:16,  1.54s/it][A
 93%|█████████▎| 135/145 [03:24<00:15,  1.54s/it][A
 94%|█████████▍| 136/145 [03:25<00:13,  1.53s/it][A
 94%|█████████▍| 137/145 [03:27<00:12,  1.53s/it][A
 95%|█████████▌| 138/145 [03:28<00:10,  1.54s/it][A
 96%|█████████▌| 139/145 [03:30<00:09,  1.54s/it][A
 97%|█████████▋| 140/145 [03:32<00:07,  1.54s/it][A
 97%|█████████▋| 141/145 [03:33<00:06,  1.54s/it][A
 98%|█████████▊| 142/145 [03:35<00:04,  1.53s/it][A
 99%|█████████▊| 143/145 [03:36<00:03,  1.52s/it][A
 99%|█████████▉| 144/145 [03:38<00:01,  1.53s/it][A
100%|██████████| 145/145 [03:39<00:00,  1.50s/it][A
                                                 [A                                                       {'eval_loss': 1.7515720129013062, 'eval_runtime': 221.3046, 'eval_samples_per_second': 5.228, 'eval_steps_per_second': 0.655, 'epoch': 3.69, 'num_input_tokens_seen': 13609472}

100%|██████████| 145/145 [03:39<00:00,  1.50s/it][A 37%|███▋      | 1200/3250 [4:29:45<6:36:01, 11.59s/it]
                                                 [A[INFO|trainer.py:3705] 2024-10-11 09:21:49,010 >> Saving model checkpoint to /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1200
[INFO|configuration_utils.py:672] 2024-10-11 09:21:49,615 >> loading configuration file config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/config.json
[WARNING|modeling_rope_utils.py:379] 2024-10-11 09:21:49,616 >> Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
[INFO|configuration_utils.py:739] 2024-10-11 09:21:49,618 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 3584,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 18944,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 28,
  "num_hidden_layers": 28,
  "num_key_value_heads": 4,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.0",
  "use_cache": true,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "in_chans": 3,
    "model_type": "qwen2_vl",
    "spatial_patch_size": 14
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 152064
}

[INFO|tokenization_utils_base.py:2649] 2024-10-11 09:21:49,696 >> tokenizer config file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1200/tokenizer_config.json
[INFO|tokenization_utils_base.py:2658] 2024-10-11 09:21:49,697 >> Special tokens file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1200/special_tokens_map.json
[INFO|image_processing_base.py:258] 2024-10-11 09:21:50,201 >> Image processor saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1200/preprocessor_config.json
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 37%|███▋      | 1201/3250 [4:29:58<44:35:20, 78.34s/it] 37%|███▋      | 1202/3250 [4:30:10<33:11:58, 58.36s/it] 37%|███▋      | 1203/3250 [4:30:21<25:11:58, 44.32s/it] 37%|███▋      | 1204/3250 [4:30:33<19:35:32, 34.47s/it] 37%|███▋      | 1205/3250 [4:30:45<15:41:05, 27.61s/it]                                                        {'loss': 1.7885, 'grad_norm': 0.6551055908203125, 'learning_rate': 0.005, 'epoch': 3.7, 'num_input_tokens_seen': 13666848}
 37%|███▋      | 1205/3250 [4:30:45<15:41:05, 27.61s/it] 37%|███▋      | 1206/3250 [4:30:56<12:55:58, 22.78s/it] 37%|███▋      | 1207/3250 [4:31:08<11:00:29, 19.40s/it] 37%|███▋      | 1208/3250 [4:31:19<9:40:33, 17.06s/it]  37%|███▋      | 1209/3250 [4:31:31<8:44:59, 15.43s/it] 37%|███▋      | 1210/3250 [4:31:42<8:04:55, 14.26s/it]                                                       {'loss': 1.7028, 'grad_norm': 0.7543010115623474, 'learning_rate': 0.005, 'epoch': 3.72, 'num_input_tokens_seen': 13723648}
 37%|███▋      | 1210/3250 [4:31:42<8:04:55, 14.26s/it] 37%|███▋      | 1211/3250 [4:31:54<7:39:21, 13.52s/it] 37%|███▋      | 1212/3250 [4:32:06<7:18:42, 12.92s/it] 37%|███▋      | 1213/3250 [4:32:17<7:03:50, 12.48s/it] 37%|███▋      | 1214/3250 [4:32:29<6:55:28, 12.24s/it] 37%|███▋      | 1215/3250 [4:32:40<6:48:00, 12.03s/it]                                                       {'loss': 1.7117, 'grad_norm': 0.5932587385177612, 'learning_rate': 0.005, 'epoch': 3.73, 'num_input_tokens_seen': 13780000}
 37%|███▋      | 1215/3250 [4:32:40<6:48:00, 12.03s/it] 37%|███▋      | 1216/3250 [4:32:52<6:40:07, 11.80s/it] 37%|███▋      | 1217/3250 [4:33:03<6:36:42, 11.71s/it] 37%|███▋      | 1218/3250 [4:33:15<6:36:01, 11.69s/it] 38%|███▊      | 1219/3250 [4:33:27<6:36:37, 11.72s/it] 38%|███▊      | 1220/3250 [4:33:38<6:32:55, 11.61s/it]                                                       {'loss': 1.7645, 'grad_norm': 1.0577603578567505, 'learning_rate': 0.005, 'epoch': 3.75, 'num_input_tokens_seen': 13837344}
 38%|███▊      | 1220/3250 [4:33:38<6:32:55, 11.61s/it] 38%|███▊      | 1221/3250 [4:33:50<6:32:49, 11.62s/it] 38%|███▊      | 1222/3250 [4:34:01<6:35:23, 11.70s/it] 38%|███▊      | 1223/3250 [4:34:12<6:25:38, 11.42s/it] 38%|███▊      | 1224/3250 [4:34:24<6:27:18, 11.47s/it] 38%|███▊      | 1225/3250 [4:34:35<6:25:48, 11.43s/it]                                                       {'loss': 1.792, 'grad_norm': 1.2312824726104736, 'learning_rate': 0.005, 'epoch': 3.76, 'num_input_tokens_seen': 13893056}
 38%|███▊      | 1225/3250 [4:34:35<6:25:48, 11.43s/it] 38%|███▊      | 1226/3250 [4:34:47<6:26:50, 11.47s/it] 38%|███▊      | 1227/3250 [4:34:57<6:20:11, 11.28s/it] 38%|███▊      | 1228/3250 [4:35:09<6:21:11, 11.31s/it] 38%|███▊      | 1229/3250 [4:35:20<6:21:56, 11.34s/it] 38%|███▊      | 1230/3250 [4:35:31<6:19:24, 11.27s/it]                                                       {'loss': 2.6511, 'grad_norm': 1.942306399345398, 'learning_rate': 0.005, 'epoch': 3.78, 'num_input_tokens_seen': 13948224}
 38%|███▊      | 1230/3250 [4:35:31<6:19:24, 11.27s/it] 38%|███▊      | 1231/3250 [4:35:43<6:21:45, 11.35s/it] 38%|███▊      | 1232/3250 [4:35:54<6:23:18, 11.40s/it] 38%|███▊      | 1233/3250 [4:36:06<6:22:39, 11.38s/it] 38%|███▊      | 1234/3250 [4:36:17<6:21:28, 11.35s/it] 38%|███▊      | 1235/3250 [4:36:28<6:19:36, 11.30s/it]                                                       {'loss': 2.2702, 'grad_norm': 1.1039379835128784, 'learning_rate': 0.005, 'epoch': 3.79, 'num_input_tokens_seen': 14004448}
 38%|███▊      | 1235/3250 [4:36:28<6:19:36, 11.30s/it] 38%|███▊      | 1236/3250 [4:36:40<6:21:45, 11.37s/it] 38%|███▊      | 1237/3250 [4:36:51<6:22:17, 11.39s/it] 38%|███▊      | 1238/3250 [4:37:03<6:22:50, 11.42s/it] 38%|███▊      | 1239/3250 [4:37:14<6:20:49, 11.36s/it] 38%|███▊      | 1240/3250 [4:37:25<6:21:24, 11.39s/it]                                                       {'loss': 2.3003, 'grad_norm': 1.324893593788147, 'learning_rate': 0.005, 'epoch': 3.81, 'num_input_tokens_seen': 14061568}
 38%|███▊      | 1240/3250 [4:37:25<6:21:24, 11.39s/it] 38%|███▊      | 1241/3250 [4:37:37<6:20:46, 11.37s/it] 38%|███▊      | 1242/3250 [4:37:48<6:17:44, 11.29s/it] 38%|███▊      | 1243/3250 [4:37:59<6:17:56, 11.30s/it] 38%|███▊      | 1244/3250 [4:38:10<6:12:57, 11.16s/it] 38%|███▊      | 1245/3250 [4:38:21<6:10:51, 11.10s/it]                                                       {'loss': 2.2443, 'grad_norm': 1.0192639827728271, 'learning_rate': 0.005, 'epoch': 3.82, 'num_input_tokens_seen': 14117344}
 38%|███▊      | 1245/3250 [4:38:21<6:10:51, 11.10s/it] 38%|███▊      | 1246/3250 [4:38:32<6:11:38, 11.13s/it] 38%|███▊      | 1247/3250 [4:38:43<6:12:34, 11.16s/it] 38%|███▊      | 1248/3250 [4:38:55<6:12:32, 11.17s/it] 38%|███▊      | 1249/3250 [4:39:06<6:13:06, 11.19s/it] 38%|███▊      | 1250/3250 [4:39:17<6:14:30, 11.24s/it]                                                       {'loss': 2.0874, 'grad_norm': 0.6125818490982056, 'learning_rate': 0.005, 'epoch': 3.84, 'num_input_tokens_seen': 14174048}
 38%|███▊      | 1250/3250 [4:39:17<6:14:30, 11.24s/it] 38%|███▊      | 1251/3250 [4:39:28<6:13:41, 11.22s/it] 39%|███▊      | 1252/3250 [4:39:40<6:17:39, 11.34s/it] 39%|███▊      | 1253/3250 [4:39:51<6:18:20, 11.37s/it] 39%|███▊      | 1254/3250 [4:40:02<6:16:03, 11.30s/it] 39%|███▊      | 1255/3250 [4:40:14<6:17:54, 11.37s/it]                                                       {'loss': 2.0515, 'grad_norm': 0.5747556686401367, 'learning_rate': 0.005, 'epoch': 3.86, 'num_input_tokens_seen': 14231392}
 39%|███▊      | 1255/3250 [4:40:14<6:17:54, 11.37s/it] 39%|███▊      | 1256/3250 [4:40:26<6:20:09, 11.44s/it] 39%|███▊      | 1257/3250 [4:40:37<6:19:44, 11.43s/it] 39%|███▊      | 1258/3250 [4:40:48<6:19:32, 11.43s/it] 39%|███▊      | 1259/3250 [4:41:00<6:15:40, 11.32s/it] 39%|███▉      | 1260/3250 [4:41:11<6:16:31, 11.35s/it]                                                       {'loss': 2.0258, 'grad_norm': 0.681338906288147, 'learning_rate': 0.005, 'epoch': 3.87, 'num_input_tokens_seen': 14288896}
 39%|███▉      | 1260/3250 [4:41:11<6:16:31, 11.35s/it] 39%|███▉      | 1261/3250 [4:41:22<6:14:56, 11.31s/it] 39%|███▉      | 1262/3250 [4:41:33<6:11:39, 11.22s/it] 39%|███▉      | 1263/3250 [4:41:45<6:13:15, 11.27s/it] 39%|███▉      | 1264/3250 [4:41:56<6:13:45, 11.29s/it] 39%|███▉      | 1265/3250 [4:42:07<6:14:41, 11.33s/it]                                                       {'loss': 2.032, 'grad_norm': 0.7317892909049988, 'learning_rate': 0.005, 'epoch': 3.89, 'num_input_tokens_seen': 14345568}
 39%|███▉      | 1265/3250 [4:42:07<6:14:41, 11.33s/it] 39%|███▉      | 1266/3250 [4:42:19<6:16:16, 11.38s/it] 39%|███▉      | 1267/3250 [4:42:30<6:16:00, 11.38s/it] 39%|███▉      | 1268/3250 [4:42:41<6:14:24, 11.33s/it] 39%|███▉      | 1269/3250 [4:42:53<6:14:42, 11.35s/it] 39%|███▉      | 1270/3250 [4:43:04<6:15:58, 11.39s/it]                                                       {'loss': 1.9794, 'grad_norm': 0.6585409641265869, 'learning_rate': 0.005, 'epoch': 3.9, 'num_input_tokens_seen': 14402848}
 39%|███▉      | 1270/3250 [4:43:04<6:15:58, 11.39s/it] 39%|███▉      | 1271/3250 [4:43:16<6:15:33, 11.39s/it] 39%|███▉      | 1272/3250 [4:43:27<6:12:09, 11.29s/it] 39%|███▉      | 1273/3250 [4:43:38<6:12:45, 11.31s/it] 39%|███▉      | 1274/3250 [4:43:49<6:13:08, 11.33s/it] 39%|███▉      | 1275/3250 [4:44:01<6:13:06, 11.34s/it]                                                       {'loss': 1.9149, 'grad_norm': 1.0179022550582886, 'learning_rate': 0.005, 'epoch': 3.92, 'num_input_tokens_seen': 14459584}
 39%|███▉      | 1275/3250 [4:44:01<6:13:06, 11.34s/it] 39%|███▉      | 1276/3250 [4:44:12<6:12:35, 11.32s/it] 39%|███▉      | 1277/3250 [4:44:23<6:12:27, 11.33s/it] 39%|███▉      | 1278/3250 [4:44:35<6:12:44, 11.34s/it] 39%|███▉      | 1279/3250 [4:44:46<6:12:05, 11.33s/it] 39%|███▉      | 1280/3250 [4:44:58<6:12:58, 11.36s/it]                                                       {'loss': 1.8403, 'grad_norm': 1.2269408702850342, 'learning_rate': 0.005, 'epoch': 3.93, 'num_input_tokens_seen': 14516480}
 39%|███▉      | 1280/3250 [4:44:58<6:12:58, 11.36s/it] 39%|███▉      | 1281/3250 [4:45:09<6:14:05, 11.40s/it] 39%|███▉      | 1282/3250 [4:45:20<6:11:06, 11.31s/it] 39%|███▉      | 1283/3250 [4:45:31<6:09:15, 11.26s/it] 40%|███▉      | 1284/3250 [4:45:43<6:11:33, 11.34s/it] 40%|███▉      | 1285/3250 [4:45:54<6:11:38, 11.35s/it]                                                       {'loss': 1.8494, 'grad_norm': 0.5141651034355164, 'learning_rate': 0.005, 'epoch': 3.95, 'num_input_tokens_seen': 14572928}
 40%|███▉      | 1285/3250 [4:45:54<6:11:38, 11.35s/it] 40%|███▉      | 1286/3250 [4:46:05<6:11:01, 11.33s/it] 40%|███▉      | 1287/3250 [4:46:17<6:10:56, 11.34s/it] 40%|███▉      | 1288/3250 [4:46:28<6:09:37, 11.30s/it] 40%|███▉      | 1289/3250 [4:46:39<6:10:13, 11.33s/it] 40%|███▉      | 1290/3250 [4:46:51<6:09:10, 11.30s/it]                                                       {'loss': 1.9142, 'grad_norm': 0.5541801452636719, 'learning_rate': 0.005, 'epoch': 3.96, 'num_input_tokens_seen': 14629632}
 40%|███▉      | 1290/3250 [4:46:51<6:09:10, 11.30s/it] 40%|███▉      | 1291/3250 [4:47:02<6:09:08, 11.31s/it] 40%|███▉      | 1292/3250 [4:47:13<6:07:08, 11.25s/it] 40%|███▉      | 1293/3250 [4:47:25<6:08:30, 11.30s/it] 40%|███▉      | 1294/3250 [4:47:36<6:09:26, 11.33s/it] 40%|███▉      | 1295/3250 [4:47:47<6:08:23, 11.31s/it]                                                       {'loss': 1.8968, 'grad_norm': 0.9050481915473938, 'learning_rate': 0.005, 'epoch': 3.98, 'num_input_tokens_seen': 14686432}
 40%|███▉      | 1295/3250 [4:47:47<6:08:23, 11.31s/it] 40%|███▉      | 1296/3250 [4:47:59<6:11:26, 11.41s/it] 40%|███▉      | 1297/3250 [4:48:10<6:09:11, 11.34s/it] 40%|███▉      | 1298/3250 [4:48:21<6:05:09, 11.22s/it] 40%|███▉      | 1299/3250 [4:48:32<6:04:43, 11.22s/it] 40%|████      | 1300/3250 [4:48:44<6:06:52, 11.29s/it]                                                       {'loss': 1.8653, 'grad_norm': 0.6308713555335999, 'learning_rate': 0.005, 'epoch': 3.99, 'num_input_tokens_seen': 14743136}
 40%|████      | 1300/3250 [4:48:44<6:06:52, 11.29s/it][INFO|trainer.py:4021] 2024-10-11 09:40:47,246 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-10-11 09:40:47,246 >>   Num examples = 1157
[INFO|trainer.py:4026] 2024-10-11 09:40:47,246 >>   Batch size = 4

  0%|          | 0/145 [00:00<?, ?it/s][A
  1%|▏         | 2/145 [00:01<01:46,  1.34it/s][A
  2%|▏         | 3/145 [00:03<02:33,  1.08s/it][A
  3%|▎         | 4/145 [00:04<02:53,  1.23s/it][A
  3%|▎         | 5/145 [00:05<02:59,  1.28s/it][A
  4%|▍         | 6/145 [00:07<03:08,  1.36s/it][A
  5%|▍         | 7/145 [00:08<03:15,  1.41s/it][A
  6%|▌         | 8/145 [00:10<03:13,  1.41s/it][A
  6%|▌         | 9/145 [00:11<03:12,  1.42s/it][A
  7%|▋         | 10/145 [00:13<03:14,  1.44s/it][A
  8%|▊         | 11/145 [00:14<03:15,  1.46s/it][A
  8%|▊         | 12/145 [00:16<03:17,  1.48s/it][A
  9%|▉         | 13/145 [00:17<03:18,  1.50s/it][A
 10%|▉         | 14/145 [00:19<03:19,  1.52s/it][A
 10%|█         | 15/145 [00:20<03:15,  1.51s/it][A
 11%|█         | 16/145 [00:22<03:13,  1.50s/it][A
 12%|█▏        | 17/145 [00:23<03:12,  1.50s/it][A
 12%|█▏        | 18/145 [00:25<03:10,  1.50s/it][A
 13%|█▎        | 19/145 [00:26<03:09,  1.50s/it][A
 14%|█▍        | 20/145 [00:28<03:08,  1.51s/it][A
 14%|█▍        | 21/145 [00:29<03:04,  1.49s/it][A
 15%|█▌        | 22/145 [00:31<03:01,  1.48s/it][A
 16%|█▌        | 23/145 [00:32<03:00,  1.48s/it][A
 17%|█▋        | 24/145 [00:34<02:59,  1.48s/it][A
 17%|█▋        | 25/145 [00:35<02:57,  1.48s/it][A
 18%|█▊        | 26/145 [00:37<02:55,  1.48s/it][A
 19%|█▊        | 27/145 [00:38<02:55,  1.49s/it][A
 19%|█▉        | 28/145 [00:40<02:52,  1.48s/it][A
 20%|██        | 29/145 [00:41<02:51,  1.48s/it][A
 21%|██        | 30/145 [00:43<02:45,  1.44s/it][A
 21%|██▏       | 31/145 [00:44<02:46,  1.46s/it][A
 22%|██▏       | 32/145 [00:46<02:46,  1.47s/it][A
 23%|██▎       | 33/145 [00:47<02:45,  1.48s/it][A
 23%|██▎       | 34/145 [00:49<02:44,  1.48s/it][A
 24%|██▍       | 35/145 [00:50<02:43,  1.49s/it][A
 25%|██▍       | 36/145 [00:51<02:42,  1.49s/it][A
 26%|██▌       | 37/145 [00:53<02:44,  1.52s/it][A
 26%|██▌       | 38/145 [00:55<02:42,  1.52s/it][A
 27%|██▋       | 39/145 [00:56<02:39,  1.51s/it][A
 28%|██▊       | 40/145 [00:58<02:38,  1.51s/it][A
 28%|██▊       | 41/145 [00:59<02:38,  1.53s/it][A
 29%|██▉       | 42/145 [01:01<02:37,  1.52s/it][A
 30%|██▉       | 43/145 [01:02<02:33,  1.51s/it][A
 30%|███       | 44/145 [01:04<02:34,  1.53s/it][A
 31%|███       | 45/145 [01:05<02:34,  1.55s/it][A
 32%|███▏      | 46/145 [01:07<02:30,  1.52s/it][A
 32%|███▏      | 47/145 [01:08<02:26,  1.50s/it][A
 33%|███▎      | 48/145 [01:10<02:25,  1.50s/it][A
 34%|███▍      | 49/145 [01:11<02:25,  1.51s/it][A
 34%|███▍      | 50/145 [01:13<02:24,  1.52s/it][A
 35%|███▌      | 51/145 [01:14<02:23,  1.53s/it][A
 36%|███▌      | 52/145 [01:16<02:21,  1.52s/it][A
 37%|███▋      | 53/145 [01:17<02:19,  1.52s/it][A
 37%|███▋      | 54/145 [01:19<02:18,  1.52s/it][A
 38%|███▊      | 55/145 [01:20<02:16,  1.51s/it][A
 39%|███▊      | 56/145 [01:22<02:14,  1.51s/it][A
 39%|███▉      | 57/145 [01:23<02:11,  1.50s/it][A
 40%|████      | 58/145 [01:25<02:09,  1.49s/it][A
 41%|████      | 59/145 [01:26<02:10,  1.52s/it][A
 41%|████▏     | 60/145 [01:28<02:07,  1.51s/it][A
 42%|████▏     | 61/145 [01:29<02:06,  1.50s/it][A
 43%|████▎     | 62/145 [01:31<02:03,  1.48s/it][A
 43%|████▎     | 63/145 [01:32<02:03,  1.51s/it][A
 44%|████▍     | 64/145 [01:34<02:02,  1.51s/it][A
 45%|████▍     | 65/145 [01:35<02:01,  1.51s/it][A
 46%|████▌     | 66/145 [01:37<01:59,  1.51s/it][A
 46%|████▌     | 67/145 [01:38<01:56,  1.50s/it][A
 47%|████▋     | 68/145 [01:40<01:57,  1.52s/it][A
 48%|████▊     | 69/145 [01:42<01:56,  1.53s/it][A
 48%|████▊     | 70/145 [01:43<01:51,  1.48s/it][A
 49%|████▉     | 71/145 [01:44<01:49,  1.48s/it][A
 50%|████▉     | 72/145 [01:46<01:48,  1.49s/it][A
 50%|█████     | 73/145 [01:48<01:49,  1.52s/it][A
 51%|█████     | 74/145 [01:49<01:48,  1.52s/it][A
 52%|█████▏    | 75/145 [01:51<01:46,  1.52s/it][A
 52%|█████▏    | 76/145 [01:52<01:44,  1.51s/it][A
 53%|█████▎    | 77/145 [01:53<01:41,  1.49s/it][A
 54%|█████▍    | 78/145 [01:55<01:40,  1.49s/it][A
 54%|█████▍    | 79/145 [01:56<01:37,  1.48s/it][A
 55%|█████▌    | 80/145 [01:58<01:35,  1.47s/it][A
 56%|█████▌    | 81/145 [01:59<01:32,  1.45s/it][A
 57%|█████▋    | 82/145 [02:01<01:32,  1.47s/it][A
 57%|█████▋    | 83/145 [02:02<01:32,  1.48s/it][A
 58%|█████▊    | 84/145 [02:04<01:31,  1.50s/it][A
 59%|█████▊    | 85/145 [02:05<01:28,  1.47s/it][A
 59%|█████▉    | 86/145 [02:07<01:27,  1.49s/it][A
 60%|██████    | 87/145 [02:08<01:27,  1.51s/it][A
 61%|██████    | 88/145 [02:10<01:24,  1.48s/it][A
 61%|██████▏   | 89/145 [02:11<01:23,  1.49s/it][A
 62%|██████▏   | 90/145 [02:13<01:22,  1.50s/it][A
 63%|██████▎   | 91/145 [02:14<01:20,  1.50s/it][A
 63%|██████▎   | 92/145 [02:16<01:19,  1.50s/it][A
 64%|██████▍   | 93/145 [02:17<01:16,  1.48s/it][A
 65%|██████▍   | 94/145 [02:19<01:15,  1.48s/it][A
 66%|██████▌   | 95/145 [02:20<01:13,  1.48s/it][A
 66%|██████▌   | 96/145 [02:22<01:12,  1.49s/it][A
 67%|██████▋   | 97/145 [02:23<01:11,  1.50s/it][A
 68%|██████▊   | 98/145 [02:25<01:11,  1.53s/it][A
 68%|██████▊   | 99/145 [02:26<01:09,  1.51s/it][A
 69%|██████▉   | 100/145 [02:28<01:08,  1.51s/it][A
 70%|██████▉   | 101/145 [02:29<01:06,  1.52s/it][A
 70%|███████   | 102/145 [02:31<01:05,  1.51s/it][A
 71%|███████   | 103/145 [02:32<01:03,  1.51s/it][A
 72%|███████▏  | 104/145 [02:34<01:02,  1.52s/it][A
 72%|███████▏  | 105/145 [02:35<01:00,  1.52s/it][A
 73%|███████▎  | 106/145 [02:37<00:58,  1.51s/it][A
 74%|███████▍  | 107/145 [02:38<00:55,  1.47s/it][A
 74%|███████▍  | 108/145 [02:40<00:53,  1.44s/it][A
 75%|███████▌  | 109/145 [02:41<00:52,  1.47s/it][A
 76%|███████▌  | 110/145 [02:43<00:52,  1.49s/it][A
 77%|███████▋  | 111/145 [02:44<00:49,  1.46s/it][A
 77%|███████▋  | 112/145 [02:46<00:48,  1.48s/it][A
 78%|███████▊  | 113/145 [02:47<00:47,  1.50s/it][A
 79%|███████▊  | 114/145 [02:49<00:46,  1.51s/it][A
 79%|███████▉  | 115/145 [02:50<00:45,  1.51s/it][A
 80%|████████  | 116/145 [02:52<00:42,  1.48s/it][A
 81%|████████  | 117/145 [02:53<00:41,  1.48s/it][A
 81%|████████▏ | 118/145 [02:55<00:39,  1.48s/it][A
 82%|████████▏ | 119/145 [02:56<00:37,  1.44s/it][A
 83%|████████▎ | 120/145 [02:57<00:35,  1.43s/it][A
 83%|████████▎ | 121/145 [02:59<00:34,  1.43s/it][A
 84%|████████▍ | 122/145 [03:00<00:33,  1.44s/it][A
 85%|████████▍ | 123/145 [03:02<00:32,  1.46s/it][A
 86%|████████▌ | 124/145 [03:03<00:30,  1.45s/it][A
 86%|████████▌ | 125/145 [03:05<00:30,  1.50s/it][A
 87%|████████▋ | 126/145 [03:06<00:28,  1.48s/it][A
 88%|████████▊ | 127/145 [03:08<00:26,  1.48s/it][A
 88%|████████▊ | 128/145 [03:09<00:25,  1.51s/it][A
 89%|████████▉ | 129/145 [03:11<00:24,  1.50s/it][A
 90%|████████▉ | 130/145 [03:12<00:22,  1.53s/it][A
 90%|█████████ | 131/145 [03:14<00:20,  1.49s/it][A
 91%|█████████ | 132/145 [03:15<00:19,  1.50s/it][A
 92%|█████████▏| 133/145 [03:17<00:17,  1.47s/it][A
 92%|█████████▏| 134/145 [03:18<00:16,  1.51s/it][A
 93%|█████████▎| 135/145 [03:20<00:15,  1.51s/it][A
 94%|█████████▍| 136/145 [03:21<00:13,  1.50s/it][A
 94%|█████████▍| 137/145 [03:23<00:11,  1.49s/it][A
 95%|█████████▌| 138/145 [03:24<00:10,  1.50s/it][A
 96%|█████████▌| 139/145 [03:26<00:09,  1.50s/it][A
 97%|█████████▋| 140/145 [03:27<00:07,  1.51s/it][A
 97%|█████████▋| 141/145 [03:29<00:06,  1.51s/it][A
 98%|█████████▊| 142/145 [03:30<00:04,  1.49s/it][A
 99%|█████████▊| 143/145 [03:32<00:02,  1.49s/it][A
 99%|█████████▉| 144/145 [03:33<00:01,  1.50s/it][A
100%|██████████| 145/145 [03:35<00:00,  1.47s/it][A
                                                 [A                                                       {'eval_loss': 1.798219084739685, 'eval_runtime': 216.7568, 'eval_samples_per_second': 5.338, 'eval_steps_per_second': 0.669, 'epoch': 3.99, 'num_input_tokens_seen': 14743136}

100%|██████████| 145/145 [03:35<00:00,  1.47s/it][A 40%|████      | 1300/3250 [4:52:20<6:06:52, 11.29s/it]
                                                 [A[INFO|trainer.py:3705] 2024-10-11 09:44:24,005 >> Saving model checkpoint to /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1300
[INFO|configuration_utils.py:672] 2024-10-11 09:44:25,006 >> loading configuration file config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/config.json
[WARNING|modeling_rope_utils.py:379] 2024-10-11 09:44:25,006 >> Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
[INFO|configuration_utils.py:739] 2024-10-11 09:44:25,008 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 3584,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 18944,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 28,
  "num_hidden_layers": 28,
  "num_key_value_heads": 4,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.0",
  "use_cache": true,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "in_chans": 3,
    "model_type": "qwen2_vl",
    "spatial_patch_size": 14
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 152064
}

[INFO|tokenization_utils_base.py:2649] 2024-10-11 09:44:25,091 >> tokenizer config file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1300/tokenizer_config.json
[INFO|tokenization_utils_base.py:2658] 2024-10-11 09:44:25,092 >> Special tokens file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1300/special_tokens_map.json
[INFO|image_processing_base.py:258] 2024-10-11 09:44:25,597 >> Image processor saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1300/preprocessor_config.json
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 40%|████      | 1301/3250 [4:52:33<41:32:26, 76.73s/it] 40%|████      | 1302/3250 [4:52:44<30:50:39, 57.00s/it] 40%|████      | 1303/3250 [4:52:56<23:26:59, 43.36s/it] 40%|████      | 1304/3250 [4:53:07<18:14:53, 33.76s/it] 40%|████      | 1305/3250 [4:53:18<14:35:15, 27.00s/it]                                                        {'loss': 1.8285, 'grad_norm': 0.7090819478034973, 'learning_rate': 0.005, 'epoch': 4.01, 'num_input_tokens_seen': 14799264}
 40%|████      | 1305/3250 [4:53:18<14:35:15, 27.00s/it] 40%|████      | 1306/3250 [4:53:29<12:02:39, 22.30s/it] 40%|████      | 1307/3250 [4:53:41<10:13:51, 18.96s/it] 40%|████      | 1308/3250 [4:53:52<9:00:29, 16.70s/it]  40%|████      | 1309/3250 [4:54:03<8:08:15, 15.09s/it] 40%|████      | 1310/3250 [4:54:15<7:31:42, 13.97s/it]                                                       {'loss': 1.7565, 'grad_norm': 0.7468149065971375, 'learning_rate': 0.005, 'epoch': 4.02, 'num_input_tokens_seen': 14856320}
 40%|████      | 1310/3250 [4:54:15<7:31:42, 13.97s/it] 40%|████      | 1311/3250 [4:54:26<7:02:33, 13.08s/it] 40%|████      | 1312/3250 [4:54:37<6:46:47, 12.59s/it] 40%|████      | 1313/3250 [4:54:49<6:35:58, 12.27s/it] 40%|████      | 1314/3250 [4:55:00<6:25:12, 11.94s/it] 40%|████      | 1315/3250 [4:55:11<6:19:51, 11.78s/it]                                                       {'loss': 1.7427, 'grad_norm': 0.5948601961135864, 'learning_rate': 0.005, 'epoch': 4.04, 'num_input_tokens_seen': 14912128}
 40%|████      | 1315/3250 [4:55:11<6:19:51, 11.78s/it] 40%|████      | 1316/3250 [4:55:23<6:14:56, 11.63s/it] 41%|████      | 1317/3250 [4:55:34<6:12:18, 11.56s/it] 41%|████      | 1318/3250 [4:55:45<6:08:07, 11.43s/it] 41%|████      | 1319/3250 [4:55:56<6:05:14, 11.35s/it] 41%|████      | 1320/3250 [4:56:08<6:04:39, 11.34s/it]                                                       {'loss': 1.747, 'grad_norm': 0.8442755341529846, 'learning_rate': 0.005, 'epoch': 4.06, 'num_input_tokens_seen': 14968512}
 41%|████      | 1320/3250 [4:56:08<6:04:39, 11.34s/it] 41%|████      | 1321/3250 [4:56:19<6:05:29, 11.37s/it] 41%|████      | 1322/3250 [4:56:30<6:03:54, 11.32s/it] 41%|████      | 1323/3250 [4:56:42<6:06:27, 11.41s/it] 41%|████      | 1324/3250 [4:56:53<6:06:13, 11.41s/it] 41%|████      | 1325/3250 [4:57:05<6:06:12, 11.41s/it]                                                       {'loss': 1.7665, 'grad_norm': 0.5439758896827698, 'learning_rate': 0.005, 'epoch': 4.07, 'num_input_tokens_seen': 15025312}
 41%|████      | 1325/3250 [4:57:05<6:06:12, 11.41s/it] 41%|████      | 1326/3250 [4:57:16<6:07:56, 11.47s/it] 41%|████      | 1327/3250 [4:57:28<6:06:35, 11.44s/it] 41%|████      | 1328/3250 [4:57:39<6:05:43, 11.42s/it] 41%|████      | 1329/3250 [4:57:50<6:01:40, 11.30s/it] 41%|████      | 1330/3250 [4:58:01<5:59:00, 11.22s/it]                                                       {'loss': 1.8043, 'grad_norm': 0.624000608921051, 'learning_rate': 0.005, 'epoch': 4.09, 'num_input_tokens_seen': 15081664}
 41%|████      | 1330/3250 [4:58:01<5:59:00, 11.22s/it] 41%|████      | 1331/3250 [4:58:12<5:57:01, 11.16s/it] 41%|████      | 1332/3250 [4:58:23<5:56:54, 11.16s/it] 41%|████      | 1333/3250 [4:58:35<5:59:17, 11.25s/it] 41%|████      | 1334/3250 [4:58:46<6:00:41, 11.29s/it] 41%|████      | 1335/3250 [4:58:57<6:01:17, 11.32s/it]                                                       {'loss': 1.7492, 'grad_norm': 0.7584112882614136, 'learning_rate': 0.005, 'epoch': 4.1, 'num_input_tokens_seen': 15139040}
 41%|████      | 1335/3250 [4:58:57<6:01:17, 11.32s/it] 41%|████      | 1336/3250 [4:59:09<6:01:08, 11.32s/it] 41%|████      | 1337/3250 [4:59:20<6:01:57, 11.35s/it] 41%|████      | 1338/3250 [4:59:31<5:59:33, 11.28s/it] 41%|████      | 1339/3250 [4:59:42<5:57:47, 11.23s/it] 41%|████      | 1340/3250 [4:59:54<6:00:34, 11.33s/it]                                                       {'loss': 1.7585, 'grad_norm': 0.6623938679695129, 'learning_rate': 0.005, 'epoch': 4.12, 'num_input_tokens_seen': 15196864}
 41%|████      | 1340/3250 [4:59:54<6:00:34, 11.33s/it] 41%|████▏     | 1341/3250 [5:00:05<6:00:34, 11.33s/it] 41%|████▏     | 1342/3250 [5:00:17<6:00:25, 11.33s/it] 41%|████▏     | 1343/3250 [5:00:28<6:00:17, 11.34s/it] 41%|████▏     | 1344/3250 [5:00:39<5:59:57, 11.33s/it] 41%|████▏     | 1345/3250 [5:00:51<6:00:03, 11.34s/it]                                                       {'loss': 1.6453, 'grad_norm': 0.7796968221664429, 'learning_rate': 0.005, 'epoch': 4.13, 'num_input_tokens_seen': 15253216}
 41%|████▏     | 1345/3250 [5:00:51<6:00:03, 11.34s/it] 41%|████▏     | 1346/3250 [5:01:02<5:56:52, 11.25s/it] 41%|████▏     | 1347/3250 [5:01:13<5:58:04, 11.29s/it] 41%|████▏     | 1348/3250 [5:01:24<5:56:48, 11.26s/it] 42%|████▏     | 1349/3250 [5:01:36<5:56:08, 11.24s/it] 42%|████▏     | 1350/3250 [5:01:47<5:55:09, 11.22s/it]                                                       {'loss': 1.681, 'grad_norm': 0.44205278158187866, 'learning_rate': 0.005, 'epoch': 4.15, 'num_input_tokens_seen': 15309536}
 42%|████▏     | 1350/3250 [5:01:47<5:55:09, 11.22s/it] 42%|████▏     | 1351/3250 [5:01:58<5:57:00, 11.28s/it] 42%|████▏     | 1352/3250 [5:02:09<5:55:58, 11.25s/it] 42%|████▏     | 1353/3250 [5:02:20<5:54:48, 11.22s/it] 42%|████▏     | 1354/3250 [5:02:32<5:55:40, 11.26s/it] 42%|████▏     | 1355/3250 [5:02:43<5:57:38, 11.32s/it]                                                       {'loss': 1.7177, 'grad_norm': 0.9242489337921143, 'learning_rate': 0.005, 'epoch': 4.16, 'num_input_tokens_seen': 15366336}
 42%|████▏     | 1355/3250 [5:02:43<5:57:38, 11.32s/it] 42%|████▏     | 1356/3250 [5:02:55<5:58:27, 11.36s/it] 42%|████▏     | 1357/3250 [5:03:06<5:56:56, 11.31s/it] 42%|████▏     | 1358/3250 [5:03:17<5:57:20, 11.33s/it] 42%|████▏     | 1359/3250 [5:03:29<5:59:07, 11.39s/it] 42%|████▏     | 1360/3250 [5:03:40<5:58:30, 11.38s/it]                                                       {'loss': 1.6424, 'grad_norm': 0.6655114889144897, 'learning_rate': 0.005, 'epoch': 4.18, 'num_input_tokens_seen': 15424128}
 42%|████▏     | 1360/3250 [5:03:40<5:58:30, 11.38s/it] 42%|████▏     | 1361/3250 [5:03:52<5:57:45, 11.36s/it] 42%|████▏     | 1362/3250 [5:04:02<5:53:56, 11.25s/it] 42%|████▏     | 1363/3250 [5:04:14<5:55:10, 11.29s/it] 42%|████▏     | 1364/3250 [5:04:25<5:55:37, 11.31s/it] 42%|████▏     | 1365/3250 [5:04:37<5:55:40, 11.32s/it]                                                       {'loss': 1.6719, 'grad_norm': 1.1683974266052246, 'learning_rate': 0.005, 'epoch': 4.19, 'num_input_tokens_seen': 15480000}
 42%|████▏     | 1365/3250 [5:04:37<5:55:40, 11.32s/it] 42%|████▏     | 1366/3250 [5:04:48<5:54:02, 11.28s/it] 42%|████▏     | 1367/3250 [5:04:59<5:52:26, 11.23s/it] 42%|████▏     | 1368/3250 [5:05:10<5:51:06, 11.19s/it] 42%|████▏     | 1369/3250 [5:05:21<5:51:26, 11.21s/it] 42%|████▏     | 1370/3250 [5:05:32<5:51:00, 11.20s/it]                                                       {'loss': 1.6563, 'grad_norm': 0.7027960419654846, 'learning_rate': 0.005, 'epoch': 4.21, 'num_input_tokens_seen': 15535744}
 42%|████▏     | 1370/3250 [5:05:32<5:51:00, 11.20s/it] 42%|████▏     | 1371/3250 [5:05:44<5:51:29, 11.22s/it] 42%|████▏     | 1372/3250 [5:05:55<5:51:21, 11.23s/it] 42%|████▏     | 1373/3250 [5:06:06<5:48:43, 11.15s/it] 42%|████▏     | 1374/3250 [5:06:17<5:51:01, 11.23s/it] 42%|████▏     | 1375/3250 [5:06:29<5:52:52, 11.29s/it]                                                       {'loss': 1.6358, 'grad_norm': 0.7739464044570923, 'learning_rate': 0.005, 'epoch': 4.22, 'num_input_tokens_seen': 15592384}
 42%|████▏     | 1375/3250 [5:06:29<5:52:52, 11.29s/it] 42%|████▏     | 1376/3250 [5:06:40<5:52:56, 11.30s/it] 42%|████▏     | 1377/3250 [5:06:52<5:55:12, 11.38s/it] 42%|████▏     | 1378/3250 [5:07:03<5:52:39, 11.30s/it] 42%|████▏     | 1379/3250 [5:07:14<5:50:03, 11.23s/it] 42%|████▏     | 1380/3250 [5:07:25<5:49:18, 11.21s/it]                                                       {'loss': 1.5814, 'grad_norm': 0.6755483150482178, 'learning_rate': 0.005, 'epoch': 4.24, 'num_input_tokens_seen': 15649472}
 42%|████▏     | 1380/3250 [5:07:25<5:49:18, 11.21s/it] 42%|████▏     | 1381/3250 [5:07:36<5:49:30, 11.22s/it] 43%|████▎     | 1382/3250 [5:07:47<5:49:41, 11.23s/it] 43%|████▎     | 1383/3250 [5:07:59<5:47:49, 11.18s/it] 43%|████▎     | 1384/3250 [5:08:09<5:44:24, 11.07s/it] 43%|████▎     | 1385/3250 [5:08:21<5:47:53, 11.19s/it]                                                       {'loss': 1.6743, 'grad_norm': 4.3505706787109375, 'learning_rate': 0.005, 'epoch': 4.25, 'num_input_tokens_seen': 15706016}
 43%|████▎     | 1385/3250 [5:08:21<5:47:53, 11.19s/it] 43%|████▎     | 1386/3250 [5:08:32<5:49:07, 11.24s/it] 43%|████▎     | 1387/3250 [5:08:44<5:50:40, 11.29s/it] 43%|████▎     | 1388/3250 [5:08:55<5:52:20, 11.35s/it] 43%|████▎     | 1389/3250 [5:09:07<5:53:01, 11.38s/it] 43%|████▎     | 1390/3250 [5:09:17<5:48:44, 11.25s/it]                                                       {'loss': 1.7467, 'grad_norm': 0.9676992893218994, 'learning_rate': 0.005, 'epoch': 4.27, 'num_input_tokens_seen': 15763168}
 43%|████▎     | 1390/3250 [5:09:17<5:48:44, 11.25s/it] 43%|████▎     | 1391/3250 [5:09:29<5:51:41, 11.35s/it] 43%|████▎     | 1392/3250 [5:09:41<5:52:52, 11.40s/it] 43%|████▎     | 1393/3250 [5:09:52<5:51:21, 11.35s/it] 43%|████▎     | 1394/3250 [5:10:03<5:50:56, 11.35s/it] 43%|████▎     | 1395/3250 [5:10:14<5:45:54, 11.19s/it]                                                       {'loss': 1.7534, 'grad_norm': 0.6205716133117676, 'learning_rate': 0.005, 'epoch': 4.29, 'num_input_tokens_seen': 15820192}
 43%|████▎     | 1395/3250 [5:10:14<5:45:54, 11.19s/it] 43%|████▎     | 1396/3250 [5:10:25<5:46:10, 11.20s/it] 43%|████▎     | 1397/3250 [5:10:37<5:47:35, 11.26s/it] 43%|████▎     | 1398/3250 [5:10:48<5:47:37, 11.26s/it] 43%|████▎     | 1399/3250 [5:10:59<5:46:42, 11.24s/it] 43%|████▎     | 1400/3250 [5:11:10<5:43:45, 11.15s/it]                                                       {'loss': 1.7044, 'grad_norm': 0.7232662439346313, 'learning_rate': 0.005, 'epoch': 4.3, 'num_input_tokens_seen': 15876704}
 43%|████▎     | 1400/3250 [5:11:10<5:43:45, 11.15s/it][INFO|trainer.py:4021] 2024-10-11 10:03:13,600 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-10-11 10:03:13,600 >>   Num examples = 1157
[INFO|trainer.py:4026] 2024-10-11 10:03:13,600 >>   Batch size = 4

  0%|          | 0/145 [00:00<?, ?it/s][A
  1%|▏         | 2/145 [00:01<01:46,  1.35it/s][A
  2%|▏         | 3/145 [00:03<02:33,  1.08s/it][A
  3%|▎         | 4/145 [00:04<02:52,  1.23s/it][A
  3%|▎         | 5/145 [00:05<02:59,  1.28s/it][A
  4%|▍         | 6/145 [00:07<03:08,  1.36s/it][A
  5%|▍         | 7/145 [00:08<03:15,  1.41s/it][A
  6%|▌         | 8/145 [00:10<03:13,  1.41s/it][A
  6%|▌         | 9/145 [00:11<03:12,  1.42s/it][A
  7%|▋         | 10/145 [00:13<03:14,  1.44s/it][A
  8%|▊         | 11/145 [00:14<03:14,  1.45s/it][A
  8%|▊         | 12/145 [00:16<03:16,  1.48s/it][A
  9%|▉         | 13/145 [00:17<03:18,  1.50s/it][A
 10%|▉         | 14/145 [00:19<03:19,  1.52s/it][A
 10%|█         | 15/145 [00:20<03:15,  1.51s/it][A
 11%|█         | 16/145 [00:22<03:13,  1.50s/it][A
 12%|█▏        | 17/145 [00:23<03:12,  1.50s/it][A
 12%|█▏        | 18/145 [00:25<03:11,  1.51s/it][A
 13%|█▎        | 19/145 [00:26<03:10,  1.51s/it][A
 14%|█▍        | 20/145 [00:28<03:09,  1.51s/it][A
 14%|█▍        | 21/145 [00:29<03:04,  1.49s/it][A
 15%|█▌        | 22/145 [00:31<03:01,  1.48s/it][A
 16%|█▌        | 23/145 [00:32<02:59,  1.47s/it][A
 17%|█▋        | 24/145 [00:34<02:58,  1.48s/it][A
 17%|█▋        | 25/145 [00:35<02:57,  1.48s/it][A
 18%|█▊        | 26/145 [00:37<02:55,  1.48s/it][A
 19%|█▊        | 27/145 [00:38<02:55,  1.48s/it][A
 19%|█▉        | 28/145 [00:40<02:52,  1.48s/it][A
 20%|██        | 29/145 [00:41<02:51,  1.48s/it][A
 21%|██        | 30/145 [00:43<02:45,  1.44s/it][A
 21%|██▏       | 31/145 [00:44<02:46,  1.46s/it][A
 22%|██▏       | 32/145 [00:46<02:45,  1.47s/it][A
 23%|██▎       | 33/145 [00:47<02:45,  1.48s/it][A
 23%|██▎       | 34/145 [00:48<02:44,  1.48s/it][A
 24%|██▍       | 35/145 [00:50<02:43,  1.49s/it][A
 25%|██▍       | 36/145 [00:51<02:41,  1.48s/it][A
 26%|██▌       | 37/145 [00:53<02:43,  1.52s/it][A
 26%|██▌       | 38/145 [00:55<02:42,  1.52s/it][A
 27%|██▋       | 39/145 [00:56<02:39,  1.51s/it][A
 28%|██▊       | 40/145 [00:58<02:37,  1.50s/it][A
 28%|██▊       | 41/145 [00:59<02:38,  1.52s/it][A
 29%|██▉       | 42/145 [01:01<02:36,  1.52s/it][A
 30%|██▉       | 43/145 [01:02<02:33,  1.50s/it][A
 30%|███       | 44/145 [01:04<02:34,  1.53s/it][A
 31%|███       | 45/145 [01:05<02:34,  1.54s/it][A
 32%|███▏      | 46/145 [01:07<02:30,  1.52s/it][A
 32%|███▏      | 47/145 [01:08<02:26,  1.50s/it][A
 33%|███▎      | 48/145 [01:10<02:25,  1.50s/it][A
 34%|███▍      | 49/145 [01:11<02:25,  1.51s/it][A
 34%|███▍      | 50/145 [01:13<02:24,  1.52s/it][A
 35%|███▌      | 51/145 [01:14<02:22,  1.52s/it][A
 36%|███▌      | 52/145 [01:16<02:21,  1.52s/it][A
 37%|███▋      | 53/145 [01:17<02:19,  1.52s/it][A
 37%|███▋      | 54/145 [01:19<02:18,  1.52s/it][A
 38%|███▊      | 55/145 [01:20<02:15,  1.51s/it][A
 39%|███▊      | 56/145 [01:22<02:14,  1.51s/it][A
 39%|███▉      | 57/145 [01:23<02:11,  1.49s/it][A
 40%|████      | 58/145 [01:25<02:09,  1.49s/it][A
 41%|████      | 59/145 [01:26<02:10,  1.52s/it][A
 41%|████▏     | 60/145 [01:28<02:07,  1.50s/it][A
 42%|████▏     | 61/145 [01:29<02:05,  1.50s/it][A
 43%|████▎     | 62/145 [01:31<02:02,  1.48s/it][A
 43%|████▎     | 63/145 [01:32<02:03,  1.50s/it][A
 44%|████▍     | 64/145 [01:34<02:01,  1.50s/it][A
 45%|████▍     | 65/145 [01:35<02:00,  1.51s/it][A
 46%|████▌     | 66/145 [01:37<01:59,  1.51s/it][A
 46%|████▌     | 67/145 [01:38<01:56,  1.49s/it][A
 47%|████▋     | 68/145 [01:40<01:57,  1.52s/it][A
 48%|████▊     | 69/145 [01:41<01:56,  1.53s/it][A
 48%|████▊     | 70/145 [01:43<01:50,  1.48s/it][A
 49%|████▉     | 71/145 [01:44<01:48,  1.47s/it][A
 50%|████▉     | 72/145 [01:46<01:48,  1.49s/it][A
 50%|█████     | 73/145 [01:47<01:48,  1.51s/it][A
 51%|█████     | 74/145 [01:49<01:47,  1.52s/it][A
 52%|█████▏    | 75/145 [01:50<01:46,  1.52s/it][A
 52%|█████▏    | 76/145 [01:52<01:44,  1.51s/it][A
 53%|█████▎    | 77/145 [01:53<01:41,  1.49s/it][A
 54%|█████▍    | 78/145 [01:55<01:39,  1.48s/it][A
 54%|█████▍    | 79/145 [01:56<01:36,  1.47s/it][A
 55%|█████▌    | 80/145 [01:58<01:35,  1.46s/it][A
 56%|█████▌    | 81/145 [01:59<01:32,  1.45s/it][A
 57%|█████▋    | 82/145 [02:01<01:32,  1.47s/it][A
 57%|█████▋    | 83/145 [02:02<01:31,  1.48s/it][A
 58%|█████▊    | 84/145 [02:04<01:30,  1.49s/it][A
 59%|█████▊    | 85/145 [02:05<01:27,  1.46s/it][A
 59%|█████▉    | 86/145 [02:07<01:27,  1.48s/it][A
 60%|██████    | 87/145 [02:08<01:27,  1.51s/it][A
 61%|██████    | 88/145 [02:10<01:24,  1.48s/it][A
 61%|██████▏   | 89/145 [02:11<01:23,  1.49s/it][A
 62%|██████▏   | 90/145 [02:13<01:22,  1.51s/it][A
 63%|██████▎   | 91/145 [02:14<01:20,  1.50s/it][A
 63%|██████▎   | 92/145 [02:16<01:19,  1.50s/it][A
 64%|██████▍   | 93/145 [02:17<01:16,  1.48s/it][A
 65%|██████▍   | 94/145 [02:18<01:15,  1.47s/it][A
 66%|██████▌   | 95/145 [02:20<01:13,  1.48s/it][A
 66%|██████▌   | 96/145 [02:21<01:12,  1.48s/it][A
 67%|██████▋   | 97/145 [02:23<01:11,  1.50s/it][A
 68%|██████▊   | 98/145 [02:25<01:11,  1.53s/it][A
 68%|██████▊   | 99/145 [02:26<01:09,  1.50s/it][A
 69%|██████▉   | 100/145 [02:28<01:07,  1.51s/it][A
 70%|██████▉   | 101/145 [02:29<01:06,  1.52s/it][A
 70%|███████   | 102/145 [02:31<01:04,  1.51s/it][A
 71%|███████   | 103/145 [02:32<01:03,  1.51s/it][A
 72%|███████▏  | 104/145 [02:34<01:02,  1.52s/it][A
 72%|███████▏  | 105/145 [02:35<01:00,  1.52s/it][A
 73%|███████▎  | 106/145 [02:37<00:58,  1.51s/it][A
 74%|███████▍  | 107/145 [02:38<00:55,  1.47s/it][A
 74%|███████▍  | 108/145 [02:39<00:53,  1.44s/it][A
 75%|███████▌  | 109/145 [02:41<00:52,  1.47s/it][A
 76%|███████▌  | 110/145 [02:42<00:52,  1.49s/it][A
 77%|███████▋  | 111/145 [02:44<00:49,  1.45s/it][A
 77%|███████▋  | 112/145 [02:45<00:48,  1.48s/it][A
 78%|███████▊  | 113/145 [02:47<00:47,  1.50s/it][A
 79%|███████▊  | 114/145 [02:48<00:46,  1.51s/it][A
 79%|███████▉  | 115/145 [02:50<00:45,  1.51s/it][A
 80%|████████  | 116/145 [02:51<00:42,  1.48s/it][A
 81%|████████  | 117/145 [02:53<00:41,  1.48s/it][A
 81%|████████▏ | 118/145 [02:54<00:39,  1.47s/it][A
 82%|████████▏ | 119/145 [02:56<00:37,  1.44s/it][A
 83%|████████▎ | 120/145 [02:57<00:35,  1.42s/it][A
 83%|████████▎ | 121/145 [02:58<00:34,  1.42s/it][A
 84%|████████▍ | 122/145 [03:00<00:33,  1.44s/it][A
 85%|████████▍ | 123/145 [03:01<00:31,  1.45s/it][A
 86%|████████▌ | 124/145 [03:03<00:30,  1.44s/it][A
 86%|████████▌ | 125/145 [03:04<00:30,  1.50s/it][A
 87%|████████▋ | 126/145 [03:06<00:28,  1.48s/it][A
 88%|████████▊ | 127/145 [03:07<00:26,  1.47s/it][A
 88%|████████▊ | 128/145 [03:09<00:25,  1.50s/it][A
 89%|████████▉ | 129/145 [03:10<00:23,  1.50s/it][A
 90%|████████▉ | 130/145 [03:12<00:22,  1.52s/it][A
 90%|█████████ | 131/145 [03:13<00:20,  1.48s/it][A
 91%|█████████ | 132/145 [03:15<00:19,  1.50s/it][A
 92%|█████████▏| 133/145 [03:16<00:17,  1.47s/it][A
 92%|█████████▏| 134/145 [03:18<00:16,  1.51s/it][A
 93%|█████████▎| 135/145 [03:19<00:15,  1.51s/it][A
 94%|█████████▍| 136/145 [03:21<00:13,  1.50s/it][A
 94%|█████████▍| 137/145 [03:22<00:11,  1.49s/it][A
 95%|█████████▌| 138/145 [03:24<00:10,  1.50s/it][A
 96%|█████████▌| 139/145 [03:25<00:09,  1.50s/it][A
 97%|█████████▋| 140/145 [03:27<00:07,  1.51s/it][A
 97%|█████████▋| 141/145 [03:28<00:06,  1.51s/it][A
 98%|█████████▊| 142/145 [03:30<00:04,  1.49s/it][A
 99%|█████████▊| 143/145 [03:31<00:02,  1.49s/it][A
 99%|█████████▉| 144/145 [03:33<00:01,  1.50s/it][A
100%|██████████| 145/145 [03:34<00:00,  1.47s/it][A
                                                 [A                                                       {'eval_loss': 1.638642430305481, 'eval_runtime': 216.4484, 'eval_samples_per_second': 5.345, 'eval_steps_per_second': 0.67, 'epoch': 4.3, 'num_input_tokens_seen': 15876704}

100%|██████████| 145/145 [03:34<00:00,  1.47s/it][A 43%|████▎     | 1400/3250 [5:14:46<5:43:45, 11.15s/it]
                                                 [A[INFO|trainer.py:3705] 2024-10-11 10:06:50,051 >> Saving model checkpoint to /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1400
[INFO|configuration_utils.py:672] 2024-10-11 10:06:51,883 >> loading configuration file config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/config.json
[WARNING|modeling_rope_utils.py:379] 2024-10-11 10:06:51,884 >> Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
[INFO|configuration_utils.py:739] 2024-10-11 10:06:51,886 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 3584,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 18944,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 28,
  "num_hidden_layers": 28,
  "num_key_value_heads": 4,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.0",
  "use_cache": true,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "in_chans": 3,
    "model_type": "qwen2_vl",
    "spatial_patch_size": 14
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 152064
}

[INFO|tokenization_utils_base.py:2649] 2024-10-11 10:06:51,970 >> tokenizer config file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1400/tokenizer_config.json
[INFO|tokenization_utils_base.py:2658] 2024-10-11 10:06:51,970 >> Special tokens file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1400/special_tokens_map.json
[INFO|image_processing_base.py:258] 2024-10-11 10:06:52,518 >> Image processor saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1400/preprocessor_config.json
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 43%|████▎     | 1401/3250 [5:15:00<39:30:58, 76.94s/it] 43%|████▎     | 1402/3250 [5:15:12<29:21:49, 57.20s/it] 43%|████▎     | 1403/3250 [5:15:23<22:16:34, 43.42s/it] 43%|████▎     | 1404/3250 [5:15:34<17:21:04, 33.84s/it] 43%|████▎     | 1405/3250 [5:15:46<13:52:59, 27.09s/it]                                                        {'loss': 1.6647, 'grad_norm': 0.8016621470451355, 'learning_rate': 0.005, 'epoch': 4.32, 'num_input_tokens_seen': 15933696}
 43%|████▎     | 1405/3250 [5:15:46<13:52:59, 27.09s/it] 43%|████▎     | 1406/3250 [5:15:57<11:26:37, 22.34s/it] 43%|████▎     | 1407/3250 [5:16:08<9:44:55, 19.04s/it]  43%|████▎     | 1408/3250 [5:16:19<8:28:39, 16.57s/it] 43%|████▎     | 1409/3250 [5:16:30<7:40:28, 15.01s/it] 43%|████▎     | 1410/3250 [5:16:42<7:04:35, 13.85s/it]                                                       {'loss': 1.6085, 'grad_norm': 0.5882202982902527, 'learning_rate': 0.005, 'epoch': 4.33, 'num_input_tokens_seen': 15989696}
 43%|████▎     | 1410/3250 [5:16:42<7:04:35, 13.85s/it] 43%|████▎     | 1411/3250 [5:16:53<6:40:19, 13.06s/it] 43%|████▎     | 1412/3250 [5:17:04<6:24:18, 12.55s/it] 43%|████▎     | 1413/3250 [5:17:15<6:13:13, 12.19s/it] 44%|████▎     | 1414/3250 [5:17:27<6:05:03, 11.93s/it] 44%|████▎     | 1415/3250 [5:17:38<5:57:43, 11.70s/it]                                                       {'loss': 1.6242, 'grad_norm': 2.6744842529296875, 'learning_rate': 0.005, 'epoch': 4.35, 'num_input_tokens_seen': 16046528}
 44%|████▎     | 1415/3250 [5:17:38<5:57:43, 11.70s/it] 44%|████▎     | 1416/3250 [5:17:49<5:54:59, 11.61s/it] 44%|████▎     | 1417/3250 [5:18:01<5:53:46, 11.58s/it] 44%|████▎     | 1418/3250 [5:18:12<5:52:48, 11.55s/it] 44%|████▎     | 1419/3250 [5:18:24<5:51:13, 11.51s/it] 44%|████▎     | 1420/3250 [5:18:35<5:50:23, 11.49s/it]                                                       {'loss': 1.7577, 'grad_norm': 18.550148010253906, 'learning_rate': 0.005, 'epoch': 4.36, 'num_input_tokens_seen': 16104320}
 44%|████▎     | 1420/3250 [5:18:35<5:50:23, 11.49s/it] 44%|████▎     | 1421/3250 [5:18:47<5:49:30, 11.47s/it] 44%|████▍     | 1422/3250 [5:18:58<5:47:38, 11.41s/it] 44%|████▍     | 1423/3250 [5:19:10<5:50:24, 11.51s/it] 44%|████▍     | 1424/3250 [5:19:21<5:45:35, 11.36s/it] 44%|████▍     | 1425/3250 [5:19:32<5:46:40, 11.40s/it]                                                       {'loss': 1.7337, 'grad_norm': 1.3085458278656006, 'learning_rate': 0.005, 'epoch': 4.38, 'num_input_tokens_seen': 16160704}
 44%|████▍     | 1425/3250 [5:19:32<5:46:40, 11.40s/it] 44%|████▍     | 1426/3250 [5:19:43<5:44:15, 11.32s/it] 44%|████▍     | 1427/3250 [5:19:54<5:41:58, 11.26s/it] 44%|████▍     | 1428/3250 [5:20:06<5:43:50, 11.32s/it] 44%|████▍     | 1429/3250 [5:20:17<5:45:22, 11.38s/it] 44%|████▍     | 1430/3250 [5:20:29<5:45:25, 11.39s/it]                                                       {'loss': 1.7008, 'grad_norm': 0.5895718932151794, 'learning_rate': 0.005, 'epoch': 4.39, 'num_input_tokens_seen': 16217056}
 44%|████▍     | 1430/3250 [5:20:29<5:45:25, 11.39s/it] 44%|████▍     | 1431/3250 [5:20:40<5:41:38, 11.27s/it] 44%|████▍     | 1432/3250 [5:20:51<5:43:59, 11.35s/it] 44%|████▍     | 1433/3250 [5:21:03<5:45:12, 11.40s/it] 44%|████▍     | 1434/3250 [5:21:14<5:44:53, 11.40s/it] 44%|████▍     | 1435/3250 [5:21:25<5:41:08, 11.28s/it]                                                       {'loss': 1.8838, 'grad_norm': 0.7047783136367798, 'learning_rate': 0.005, 'epoch': 4.41, 'num_input_tokens_seen': 16272576}
 44%|████▍     | 1435/3250 [5:21:25<5:41:08, 11.28s/it] 44%|████▍     | 1436/3250 [5:21:37<5:42:04, 11.31s/it] 44%|████▍     | 1437/3250 [5:21:48<5:43:24, 11.36s/it] 44%|████▍     | 1438/3250 [5:22:00<5:44:02, 11.39s/it] 44%|████▍     | 1439/3250 [5:22:11<5:45:11, 11.44s/it] 44%|████▍     | 1440/3250 [5:22:23<5:45:58, 11.47s/it]                                                       {'loss': 1.8587, 'grad_norm': 0.515022337436676, 'learning_rate': 0.005, 'epoch': 4.42, 'num_input_tokens_seen': 16330336}
 44%|████▍     | 1440/3250 [5:22:23<5:45:58, 11.47s/it] 44%|████▍     | 1441/3250 [5:22:34<5:45:00, 11.44s/it] 44%|████▍     | 1442/3250 [5:22:45<5:44:39, 11.44s/it] 44%|████▍     | 1443/3250 [5:22:57<5:47:12, 11.53s/it] 44%|████▍     | 1444/3250 [5:23:09<5:46:20, 11.51s/it] 44%|████▍     | 1445/3250 [5:23:20<5:45:52, 11.50s/it]                                                       {'loss': 1.7906, 'grad_norm': 0.7932896614074707, 'learning_rate': 0.005, 'epoch': 4.44, 'num_input_tokens_seen': 16388256}
 44%|████▍     | 1445/3250 [5:23:20<5:45:52, 11.50s/it] 44%|████▍     | 1446/3250 [5:23:32<5:44:57, 11.47s/it] 45%|████▍     | 1447/3250 [5:23:43<5:45:43, 11.50s/it] 45%|████▍     | 1448/3250 [5:23:54<5:42:49, 11.42s/it] 45%|████▍     | 1449/3250 [5:24:06<5:40:25, 11.34s/it] 45%|████▍     | 1450/3250 [5:24:17<5:41:13, 11.37s/it]                                                       {'loss': 1.7336, 'grad_norm': 1.0159300565719604, 'learning_rate': 0.005, 'epoch': 4.45, 'num_input_tokens_seen': 16445984}
 45%|████▍     | 1450/3250 [5:24:17<5:41:13, 11.37s/it] 45%|████▍     | 1451/3250 [5:24:28<5:39:38, 11.33s/it] 45%|████▍     | 1452/3250 [5:24:40<5:40:33, 11.36s/it] 45%|████▍     | 1453/3250 [5:24:51<5:40:46, 11.38s/it] 45%|████▍     | 1454/3250 [5:25:03<5:43:08, 11.46s/it] 45%|████▍     | 1455/3250 [5:25:14<5:40:05, 11.37s/it]                                                       {'loss': 1.7107, 'grad_norm': 0.8949935436248779, 'learning_rate': 0.005, 'epoch': 4.47, 'num_input_tokens_seen': 16502624}
 45%|████▍     | 1455/3250 [5:25:14<5:40:05, 11.37s/it] 45%|████▍     | 1456/3250 [5:25:25<5:40:06, 11.37s/it] 45%|████▍     | 1457/3250 [5:25:37<5:39:14, 11.35s/it] 45%|████▍     | 1458/3250 [5:25:48<5:40:26, 11.40s/it] 45%|████▍     | 1459/3250 [5:25:59<5:39:06, 11.36s/it] 45%|████▍     | 1460/3250 [5:26:11<5:39:53, 11.39s/it]                                                       {'loss': 1.6423, 'grad_norm': 0.721052348613739, 'learning_rate': 0.005, 'epoch': 4.49, 'num_input_tokens_seen': 16559712}
 45%|████▍     | 1460/3250 [5:26:11<5:39:53, 11.39s/it] 45%|████▍     | 1461/3250 [5:26:22<5:36:54, 11.30s/it] 45%|████▍     | 1462/3250 [5:26:33<5:36:35, 11.30s/it] 45%|████▌     | 1463/3250 [5:26:45<5:38:19, 11.36s/it] 45%|████▌     | 1464/3250 [5:26:56<5:38:11, 11.36s/it] 45%|████▌     | 1465/3250 [5:27:08<5:39:08, 11.40s/it]                                                       {'loss': 1.7222, 'grad_norm': 0.6248904466629028, 'learning_rate': 0.005, 'epoch': 4.5, 'num_input_tokens_seen': 16616224}
 45%|████▌     | 1465/3250 [5:27:08<5:39:08, 11.40s/it] 45%|████▌     | 1466/3250 [5:27:19<5:39:45, 11.43s/it] 45%|████▌     | 1467/3250 [5:27:31<5:41:31, 11.49s/it] 45%|████▌     | 1468/3250 [5:27:42<5:40:37, 11.47s/it] 45%|████▌     | 1469/3250 [5:27:53<5:38:29, 11.40s/it] 45%|████▌     | 1470/3250 [5:28:05<5:38:20, 11.41s/it]                                                       {'loss': 1.5578, 'grad_norm': 0.3852773904800415, 'learning_rate': 0.005, 'epoch': 4.52, 'num_input_tokens_seen': 16672576}
 45%|████▌     | 1470/3250 [5:28:05<5:38:20, 11.41s/it] 45%|████▌     | 1471/3250 [5:28:16<5:36:52, 11.36s/it] 45%|████▌     | 1472/3250 [5:28:27<5:37:21, 11.38s/it] 45%|████▌     | 1473/3250 [5:28:39<5:39:10, 11.45s/it] 45%|████▌     | 1474/3250 [5:28:51<5:42:08, 11.56s/it] 45%|████▌     | 1475/3250 [5:29:03<5:45:10, 11.67s/it]                                                       {'loss': 1.6579, 'grad_norm': 0.5763800740242004, 'learning_rate': 0.005, 'epoch': 4.53, 'num_input_tokens_seen': 16728960}
 45%|████▌     | 1475/3250 [5:29:03<5:45:10, 11.67s/it] 45%|████▌     | 1476/3250 [5:29:14<5:44:31, 11.65s/it] 45%|████▌     | 1477/3250 [5:29:26<5:45:04, 11.68s/it] 45%|████▌     | 1478/3250 [5:29:38<5:45:00, 11.68s/it] 46%|████▌     | 1479/3250 [5:29:50<5:45:04, 11.69s/it] 46%|████▌     | 1480/3250 [5:30:01<5:43:29, 11.64s/it]                                                       {'loss': 1.7414, 'grad_norm': 0.7089329957962036, 'learning_rate': 0.005, 'epoch': 4.55, 'num_input_tokens_seen': 16785376}
 46%|████▌     | 1480/3250 [5:30:01<5:43:29, 11.64s/it] 46%|████▌     | 1481/3250 [5:30:13<5:41:53, 11.60s/it] 46%|████▌     | 1482/3250 [5:30:24<5:40:29, 11.56s/it] 46%|████▌     | 1483/3250 [5:30:36<5:41:58, 11.61s/it] 46%|████▌     | 1484/3250 [5:30:47<5:38:11, 11.49s/it] 46%|████▌     | 1485/3250 [5:30:58<5:36:33, 11.44s/it]                                                       {'loss': 1.5869, 'grad_norm': 6.512486934661865, 'learning_rate': 0.005, 'epoch': 4.56, 'num_input_tokens_seen': 16840768}
 46%|████▌     | 1485/3250 [5:30:58<5:36:33, 11.44s/it] 46%|████▌     | 1486/3250 [5:31:10<5:37:16, 11.47s/it] 46%|████▌     | 1487/3250 [5:31:22<5:40:53, 11.60s/it] 46%|████▌     | 1488/3250 [5:31:33<5:41:37, 11.63s/it] 46%|████▌     | 1489/3250 [5:31:45<5:41:08, 11.62s/it] 46%|████▌     | 1490/3250 [5:31:57<5:42:51, 11.69s/it]                                                       {'loss': 1.683, 'grad_norm': 0.8653528690338135, 'learning_rate': 0.005, 'epoch': 4.58, 'num_input_tokens_seen': 16896992}
 46%|████▌     | 1490/3250 [5:31:57<5:42:51, 11.69s/it] 46%|████▌     | 1491/3250 [5:32:09<5:42:38, 11.69s/it] 46%|████▌     | 1492/3250 [5:32:20<5:41:16, 11.65s/it] 46%|████▌     | 1493/3250 [5:32:32<5:41:43, 11.67s/it] 46%|████▌     | 1494/3250 [5:32:44<5:42:30, 11.70s/it] 46%|████▌     | 1495/3250 [5:32:55<5:43:17, 11.74s/it]                                                       {'loss': 1.8002, 'grad_norm': 0.7268924713134766, 'learning_rate': 0.005, 'epoch': 4.59, 'num_input_tokens_seen': 16953888}
 46%|████▌     | 1495/3250 [5:32:55<5:43:17, 11.74s/it] 46%|████▌     | 1496/3250 [5:33:07<5:42:31, 11.72s/it] 46%|████▌     | 1497/3250 [5:33:19<5:42:41, 11.73s/it] 46%|████▌     | 1498/3250 [5:33:30<5:41:16, 11.69s/it] 46%|████▌     | 1499/3250 [5:33:42<5:40:29, 11.67s/it] 46%|████▌     | 1500/3250 [5:33:54<5:43:32, 11.78s/it]                                                       {'loss': 1.6632, 'grad_norm': 1.3659467697143555, 'learning_rate': 0.005, 'epoch': 4.61, 'num_input_tokens_seen': 17011232}
 46%|████▌     | 1500/3250 [5:33:54<5:43:32, 11.78s/it][INFO|trainer.py:4021] 2024-10-11 10:25:57,730 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-10-11 10:25:57,730 >>   Num examples = 1157
[INFO|trainer.py:4026] 2024-10-11 10:25:57,730 >>   Batch size = 4

  0%|          | 0/145 [00:00<?, ?it/s][A
  1%|▏         | 2/145 [00:01<01:47,  1.33it/s][A
  2%|▏         | 3/145 [00:03<02:35,  1.09s/it][A
  3%|▎         | 4/145 [00:04<02:54,  1.24s/it][A
  3%|▎         | 5/145 [00:05<03:00,  1.29s/it][A
  4%|▍         | 6/145 [00:07<03:11,  1.37s/it][A
  5%|▍         | 7/145 [00:09<03:17,  1.43s/it][A
  6%|▌         | 8/145 [00:10<03:15,  1.42s/it][A
  6%|▌         | 9/145 [00:11<03:14,  1.43s/it][A
  7%|▋         | 10/145 [00:13<03:16,  1.45s/it][A
  8%|▊         | 11/145 [00:14<03:16,  1.47s/it][A
  8%|▊         | 12/145 [00:16<03:19,  1.50s/it][A
  9%|▉         | 13/145 [00:18<03:20,  1.52s/it][A
 10%|▉         | 14/145 [00:19<03:21,  1.54s/it][A
 10%|█         | 15/145 [00:21<03:18,  1.52s/it][A
 11%|█         | 16/145 [00:22<03:15,  1.52s/it][A
 12%|█▏        | 17/145 [00:24<03:14,  1.52s/it][A
 12%|█▏        | 18/145 [00:25<03:12,  1.52s/it][A
 13%|█▎        | 19/145 [00:27<03:11,  1.52s/it][A
 14%|█▍        | 20/145 [00:28<03:10,  1.52s/it][A
 14%|█▍        | 21/145 [00:30<03:05,  1.50s/it][A
 15%|█▌        | 22/145 [00:31<03:03,  1.49s/it][A
 16%|█▌        | 23/145 [00:33<03:01,  1.48s/it][A
 17%|█▋        | 24/145 [00:34<03:00,  1.49s/it][A
 17%|█▋        | 25/145 [00:36<02:59,  1.50s/it][A
 18%|█▊        | 26/145 [00:37<02:57,  1.49s/it][A
 19%|█▊        | 27/145 [00:39<02:56,  1.50s/it][A
 19%|█▉        | 28/145 [00:40<02:54,  1.49s/it][A
 20%|██        | 29/145 [00:42<02:52,  1.49s/it][A
 21%|██        | 30/145 [00:43<02:47,  1.45s/it][A
 21%|██▏       | 31/145 [00:44<02:48,  1.47s/it][A
 22%|██▏       | 32/145 [00:46<02:47,  1.48s/it][A
 23%|██▎       | 33/145 [00:47<02:47,  1.49s/it][A
 23%|██▎       | 34/145 [00:49<02:46,  1.50s/it][A
 24%|██▍       | 35/145 [00:50<02:45,  1.50s/it][A
 25%|██▍       | 36/145 [00:52<02:43,  1.50s/it][A
 26%|██▌       | 37/145 [00:54<02:45,  1.53s/it][A
 26%|██▌       | 38/145 [00:55<02:44,  1.53s/it][A
 27%|██▋       | 39/145 [00:57<02:41,  1.52s/it][A
 28%|██▊       | 40/145 [00:58<02:39,  1.52s/it][A
 28%|██▊       | 41/145 [01:00<02:39,  1.54s/it][A
 29%|██▉       | 42/145 [01:01<02:38,  1.54s/it][A
 30%|██▉       | 43/145 [01:03<02:34,  1.52s/it][A
 30%|███       | 44/145 [01:04<02:36,  1.55s/it][A
 31%|███       | 45/145 [01:06<02:36,  1.56s/it][A
 32%|███▏      | 46/145 [01:07<02:31,  1.53s/it][A
 32%|███▏      | 47/145 [01:09<02:27,  1.51s/it][A
 33%|███▎      | 48/145 [01:10<02:26,  1.52s/it][A
 34%|███▍      | 49/145 [01:12<02:26,  1.52s/it][A
 34%|███▍      | 50/145 [01:13<02:25,  1.53s/it][A
 35%|███▌      | 51/145 [01:15<02:24,  1.53s/it][A
 36%|███▌      | 52/145 [01:17<02:22,  1.53s/it][A
 37%|███▋      | 53/145 [01:18<02:20,  1.53s/it][A
 37%|███▋      | 54/145 [01:20<02:20,  1.54s/it][A
 38%|███▊      | 55/145 [01:21<02:17,  1.53s/it][A
 39%|███▊      | 56/145 [01:23<02:15,  1.53s/it][A
 39%|███▉      | 57/145 [01:24<02:13,  1.52s/it][A
 40%|████      | 58/145 [01:26<02:11,  1.51s/it][A
 41%|████      | 59/145 [01:27<02:11,  1.53s/it][A
 41%|████▏     | 60/145 [01:29<02:09,  1.52s/it][A
 42%|████▏     | 61/145 [01:30<02:07,  1.52s/it][A
 43%|████▎     | 62/145 [01:32<02:04,  1.50s/it][A
 43%|████▎     | 63/145 [01:33<02:04,  1.52s/it][A
 44%|████▍     | 64/145 [01:35<02:02,  1.52s/it][A
 45%|████▍     | 65/145 [01:36<02:02,  1.53s/it][A
 46%|████▌     | 66/145 [01:38<02:00,  1.52s/it][A
 46%|████▌     | 67/145 [01:39<01:57,  1.51s/it][A
 47%|████▋     | 68/145 [01:41<01:58,  1.54s/it][A
 48%|████▊     | 69/145 [01:42<01:57,  1.54s/it][A
 48%|████▊     | 70/145 [01:44<01:52,  1.49s/it][A
 49%|████▉     | 71/145 [01:45<01:50,  1.49s/it][A
 50%|████▉     | 72/145 [01:47<01:49,  1.50s/it][A
 50%|█████     | 73/145 [01:48<01:50,  1.53s/it][A
 51%|█████     | 74/145 [01:50<01:49,  1.54s/it][A
 52%|█████▏    | 75/145 [01:52<01:47,  1.54s/it][A
 52%|█████▏    | 76/145 [01:53<01:45,  1.53s/it][A
 53%|█████▎    | 77/145 [01:54<01:42,  1.51s/it][A
 54%|█████▍    | 78/145 [01:56<01:40,  1.51s/it][A
 54%|█████▍    | 79/145 [01:57<01:38,  1.49s/it][A
 55%|█████▌    | 80/145 [01:59<01:36,  1.48s/it][A
 56%|█████▌    | 81/145 [02:00<01:33,  1.46s/it][A
 57%|█████▋    | 82/145 [02:02<01:33,  1.48s/it][A
 57%|█████▋    | 83/145 [02:03<01:32,  1.49s/it][A
 58%|█████▊    | 84/145 [02:05<01:31,  1.51s/it][A
 59%|█████▊    | 85/145 [02:06<01:28,  1.48s/it][A
 59%|█████▉    | 86/145 [02:08<01:28,  1.50s/it][A
 60%|██████    | 87/145 [02:09<01:28,  1.52s/it][A
 61%|██████    | 88/145 [02:11<01:25,  1.50s/it][A
 61%|██████▏   | 89/145 [02:12<01:24,  1.51s/it][A
 62%|██████▏   | 90/145 [02:14<01:23,  1.52s/it][A
 63%|██████▎   | 91/145 [02:15<01:21,  1.51s/it][A
 63%|██████▎   | 92/145 [02:17<01:20,  1.51s/it][A
 64%|██████▍   | 93/145 [02:18<01:17,  1.49s/it][A
 65%|██████▍   | 94/145 [02:20<01:15,  1.49s/it][A
 66%|██████▌   | 95/145 [02:21<01:14,  1.49s/it][A
 66%|██████▌   | 96/145 [02:23<01:13,  1.50s/it][A
 67%|██████▋   | 97/145 [02:24<01:12,  1.51s/it][A
 68%|██████▊   | 98/145 [02:26<01:12,  1.54s/it][A
 68%|██████▊   | 99/145 [02:28<01:09,  1.52s/it][A
 69%|██████▉   | 100/145 [02:29<01:08,  1.52s/it][A
 70%|██████▉   | 101/145 [02:31<01:07,  1.53s/it][A
 70%|███████   | 102/145 [02:32<01:05,  1.52s/it][A
 71%|███████   | 103/145 [02:34<01:03,  1.52s/it][A
 72%|███████▏  | 104/145 [02:35<01:02,  1.53s/it][A
 72%|███████▏  | 105/145 [02:37<01:01,  1.53s/it][A
 73%|███████▎  | 106/145 [02:38<00:59,  1.52s/it][A
 74%|███████▍  | 107/145 [02:40<00:56,  1.48s/it][A
 74%|███████▍  | 108/145 [02:41<00:53,  1.46s/it][A
 75%|███████▌  | 109/145 [02:43<00:53,  1.48s/it][A
 76%|███████▌  | 110/145 [02:44<00:52,  1.50s/it][A
 77%|███████▋  | 111/145 [02:45<00:49,  1.47s/it][A
 77%|███████▋  | 112/145 [02:47<00:49,  1.50s/it][A
 78%|███████▊  | 113/145 [02:49<00:48,  1.51s/it][A
 79%|███████▊  | 114/145 [02:50<00:47,  1.52s/it][A
 79%|███████▉  | 115/145 [02:52<00:45,  1.52s/it][A
 80%|████████  | 116/145 [02:53<00:43,  1.49s/it][A
 81%|████████  | 117/145 [02:55<00:41,  1.49s/it][A
 81%|████████▏ | 118/145 [02:56<00:40,  1.48s/it][A
 82%|████████▏ | 119/145 [02:57<00:37,  1.45s/it][A
 83%|████████▎ | 120/145 [02:59<00:35,  1.44s/it][A
 83%|████████▎ | 121/145 [03:00<00:34,  1.44s/it][A
 84%|████████▍ | 122/145 [03:02<00:33,  1.45s/it][A
 85%|████████▍ | 123/145 [03:03<00:32,  1.47s/it][A
 86%|████████▌ | 124/145 [03:05<00:30,  1.45s/it][A
 86%|████████▌ | 125/145 [03:06<00:30,  1.51s/it][A
 87%|████████▋ | 126/145 [03:08<00:28,  1.50s/it][A
 88%|████████▊ | 127/145 [03:09<00:26,  1.49s/it][A
 88%|████████▊ | 128/145 [03:11<00:25,  1.52s/it][A
 89%|████████▉ | 129/145 [03:12<00:24,  1.52s/it][A
 90%|████████▉ | 130/145 [03:14<00:23,  1.54s/it][A
 90%|█████████ | 131/145 [03:15<00:20,  1.50s/it][A
 91%|█████████ | 132/145 [03:17<00:19,  1.52s/it][A
 92%|█████████▏| 133/145 [03:18<00:17,  1.49s/it][A
 92%|█████████▏| 134/145 [03:20<00:16,  1.52s/it][A
 93%|█████████▎| 135/145 [03:21<00:15,  1.52s/it][A
 94%|█████████▍| 136/145 [03:23<00:13,  1.52s/it][A
 94%|█████████▍| 137/145 [03:24<00:12,  1.51s/it][A
 95%|█████████▌| 138/145 [03:26<00:10,  1.52s/it][A
 96%|█████████▌| 139/145 [03:27<00:09,  1.51s/it][A
 97%|█████████▋| 140/145 [03:29<00:07,  1.52s/it][A
 97%|█████████▋| 141/145 [03:31<00:06,  1.52s/it][A
 98%|█████████▊| 142/145 [03:32<00:04,  1.51s/it][A
 99%|█████████▊| 143/145 [03:34<00:03,  1.50s/it][A
 99%|█████████▉| 144/145 [03:35<00:01,  1.51s/it][A
100%|██████████| 145/145 [03:36<00:00,  1.48s/it][A
                                                 [A                                                       {'eval_loss': 1.5731770992279053, 'eval_runtime': 218.6497, 'eval_samples_per_second': 5.292, 'eval_steps_per_second': 0.663, 'epoch': 4.61, 'num_input_tokens_seen': 17011232}

100%|██████████| 145/145 [03:36<00:00,  1.48s/it][A 46%|████▌     | 1500/3250 [5:37:33<5:43:32, 11.78s/it]
                                                 [A[INFO|trainer.py:3705] 2024-10-11 10:29:36,382 >> Saving model checkpoint to /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1500
[INFO|configuration_utils.py:672] 2024-10-11 10:29:37,371 >> loading configuration file config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/config.json
[WARNING|modeling_rope_utils.py:379] 2024-10-11 10:29:37,371 >> Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
[INFO|configuration_utils.py:739] 2024-10-11 10:29:37,373 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 3584,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 18944,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 28,
  "num_hidden_layers": 28,
  "num_key_value_heads": 4,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.0",
  "use_cache": true,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "in_chans": 3,
    "model_type": "qwen2_vl",
    "spatial_patch_size": 14
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 152064
}

[INFO|tokenization_utils_base.py:2649] 2024-10-11 10:29:37,452 >> tokenizer config file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1500/tokenizer_config.json
[INFO|tokenization_utils_base.py:2658] 2024-10-11 10:29:37,452 >> Special tokens file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1500/special_tokens_map.json
[INFO|image_processing_base.py:258] 2024-10-11 10:29:37,955 >> Image processor saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1500/preprocessor_config.json
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 46%|████▌     | 1501/3250 [5:37:46<37:50:48, 77.90s/it] 46%|████▌     | 1502/3250 [5:37:58<28:11:32, 58.06s/it] 46%|████▌     | 1503/3250 [5:38:10<21:27:15, 44.21s/it] 46%|████▋     | 1504/3250 [5:38:22<16:42:28, 34.45s/it] 46%|████▋     | 1505/3250 [5:38:34<13:25:16, 27.69s/it]                                                        {'loss': 1.6631, 'grad_norm': 1.1497167348861694, 'learning_rate': 0.005, 'epoch': 4.62, 'num_input_tokens_seen': 17069184}
 46%|████▋     | 1505/3250 [5:38:34<13:25:16, 27.69s/it] 46%|████▋     | 1506/3250 [5:38:45<11:05:38, 22.90s/it] 46%|████▋     | 1507/3250 [5:38:57<9:27:11, 19.52s/it]  46%|████▋     | 1508/3250 [5:39:09<8:19:15, 17.20s/it] 46%|████▋     | 1509/3250 [5:39:20<7:26:50, 15.40s/it] 46%|████▋     | 1510/3250 [5:39:32<6:53:58, 14.27s/it]                                                       {'loss': 1.5107, 'grad_norm': 0.4437122046947479, 'learning_rate': 0.005, 'epoch': 4.64, 'num_input_tokens_seen': 17125344}
 46%|████▋     | 1510/3250 [5:39:32<6:53:58, 14.27s/it] 46%|████▋     | 1511/3250 [5:39:43<6:30:22, 13.47s/it] 47%|████▋     | 1512/3250 [5:39:55<6:12:20, 12.85s/it] 47%|████▋     | 1513/3250 [5:40:06<6:02:41, 12.53s/it] 47%|████▋     | 1514/3250 [5:40:18<5:51:49, 12.16s/it] 47%|████▋     | 1515/3250 [5:40:29<5:44:56, 11.93s/it]                                                       {'loss': 1.6479, 'grad_norm': 0.7612214088439941, 'learning_rate': 0.005, 'epoch': 4.65, 'num_input_tokens_seen': 17182496}
 47%|████▋     | 1515/3250 [5:40:29<5:44:56, 11.93s/it] 47%|████▋     | 1516/3250 [5:40:41<5:41:51, 11.83s/it] 47%|████▋     | 1517/3250 [5:40:52<5:39:28, 11.75s/it] 47%|████▋     | 1518/3250 [5:41:04<5:38:17, 11.72s/it] 47%|████▋     | 1519/3250 [5:41:15<5:36:47, 11.67s/it] 47%|████▋     | 1520/3250 [5:41:27<5:33:27, 11.57s/it]                                                       {'loss': 1.5165, 'grad_norm': 0.36209362745285034, 'learning_rate': 0.005, 'epoch': 4.67, 'num_input_tokens_seen': 17240544}
 47%|████▋     | 1520/3250 [5:41:27<5:33:27, 11.57s/it] 47%|████▋     | 1521/3250 [5:41:38<5:33:30, 11.57s/it] 47%|████▋     | 1522/3250 [5:41:50<5:30:36, 11.48s/it] 47%|████▋     | 1523/3250 [5:42:01<5:27:16, 11.37s/it] 47%|████▋     | 1524/3250 [5:42:12<5:28:50, 11.43s/it] 47%|████▋     | 1525/3250 [5:42:24<5:28:23, 11.42s/it]                                                       {'loss': 1.5186, 'grad_norm': 4.100398540496826, 'learning_rate': 0.005, 'epoch': 4.69, 'num_input_tokens_seen': 17297024}
 47%|████▋     | 1525/3250 [5:42:24<5:28:23, 11.42s/it] 47%|████▋     | 1526/3250 [5:42:35<5:27:49, 11.41s/it] 47%|████▋     | 1527/3250 [5:42:47<5:28:25, 11.44s/it] 47%|████▋     | 1528/3250 [5:42:58<5:24:21, 11.30s/it] 47%|████▋     | 1529/3250 [5:43:09<5:24:47, 11.32s/it] 47%|████▋     | 1530/3250 [5:43:20<5:26:54, 11.40s/it]                                                       {'loss': 1.6676, 'grad_norm': 0.4073038697242737, 'learning_rate': 0.005, 'epoch': 4.7, 'num_input_tokens_seen': 17353088}
 47%|████▋     | 1530/3250 [5:43:20<5:26:54, 11.40s/it] 47%|████▋     | 1531/3250 [5:43:32<5:25:58, 11.38s/it] 47%|████▋     | 1532/3250 [5:43:43<5:27:12, 11.43s/it] 47%|████▋     | 1533/3250 [5:43:55<5:26:20, 11.40s/it] 47%|████▋     | 1534/3250 [5:44:06<5:25:58, 11.40s/it] 47%|████▋     | 1535/3250 [5:44:17<5:24:57, 11.37s/it]                                                       {'loss': 1.83, 'grad_norm': 0.5374093651771545, 'learning_rate': 0.005, 'epoch': 4.72, 'num_input_tokens_seen': 17408832}
 47%|████▋     | 1535/3250 [5:44:17<5:24:57, 11.37s/it] 47%|████▋     | 1536/3250 [5:44:29<5:26:52, 11.44s/it] 47%|████▋     | 1537/3250 [5:44:41<5:28:29, 11.51s/it] 47%|████▋     | 1538/3250 [5:44:52<5:25:38, 11.41s/it] 47%|████▋     | 1539/3250 [5:45:03<5:25:48, 11.43s/it] 47%|████▋     | 1540/3250 [5:45:15<5:28:28, 11.53s/it]                                                       {'loss': 1.7063, 'grad_norm': 0.3523499369621277, 'learning_rate': 0.005, 'epoch': 4.73, 'num_input_tokens_seen': 17465728}
 47%|████▋     | 1540/3250 [5:45:15<5:28:28, 11.53s/it] 47%|████▋     | 1541/3250 [5:45:26<5:25:42, 11.44s/it] 47%|████▋     | 1542/3250 [5:45:38<5:25:28, 11.43s/it] 47%|████▋     | 1543/3250 [5:45:49<5:27:07, 11.50s/it] 48%|████▊     | 1544/3250 [5:46:01<5:27:48, 11.53s/it] 48%|████▊     | 1545/3250 [5:46:13<5:28:38, 11.56s/it]                                                       {'loss': 1.6196, 'grad_norm': 0.7456381916999817, 'learning_rate': 0.005, 'epoch': 4.75, 'num_input_tokens_seen': 17522144}
 48%|████▊     | 1545/3250 [5:46:13<5:28:38, 11.56s/it] 48%|████▊     | 1546/3250 [5:46:24<5:28:45, 11.58s/it] 48%|████▊     | 1547/3250 [5:46:36<5:27:51, 11.55s/it] 48%|████▊     | 1548/3250 [5:46:47<5:27:50, 11.56s/it] 48%|████▊     | 1549/3250 [5:46:58<5:23:05, 11.40s/it] 48%|████▊     | 1550/3250 [5:47:10<5:26:09, 11.51s/it]                                                       {'loss': 1.5157, 'grad_norm': 0.46381086111068726, 'learning_rate': 0.005, 'epoch': 4.76, 'num_input_tokens_seen': 17580128}
 48%|████▊     | 1550/3250 [5:47:10<5:26:09, 11.51s/it] 48%|████▊     | 1551/3250 [5:47:22<5:26:10, 11.52s/it] 48%|████▊     | 1552/3250 [5:47:33<5:27:59, 11.59s/it] 48%|████▊     | 1553/3250 [5:47:45<5:29:16, 11.64s/it] 48%|████▊     | 1554/3250 [5:47:57<5:30:13, 11.68s/it] 48%|████▊     | 1555/3250 [5:48:09<5:30:08, 11.69s/it]                                                       {'loss': 1.5391, 'grad_norm': 0.4938111901283264, 'learning_rate': 0.005, 'epoch': 4.78, 'num_input_tokens_seen': 17637248}
 48%|████▊     | 1555/3250 [5:48:09<5:30:08, 11.69s/it] 48%|████▊     | 1556/3250 [5:48:20<5:27:07, 11.59s/it] 48%|████▊     | 1557/3250 [5:48:32<5:29:01, 11.66s/it] 48%|████▊     | 1558/3250 [5:48:43<5:27:38, 11.62s/it] 48%|████▊     | 1559/3250 [5:48:55<5:30:41, 11.73s/it] 48%|████▊     | 1560/3250 [5:49:07<5:30:28, 11.73s/it]                                                       {'loss': 1.6973, 'grad_norm': 0.454894483089447, 'learning_rate': 0.005, 'epoch': 4.79, 'num_input_tokens_seen': 17694240}
 48%|████▊     | 1560/3250 [5:49:07<5:30:28, 11.73s/it] 48%|████▊     | 1561/3250 [5:49:19<5:32:03, 11.80s/it] 48%|████▊     | 1562/3250 [5:49:31<5:30:08, 11.73s/it] 48%|████▊     | 1563/3250 [5:49:42<5:24:33, 11.54s/it] 48%|████▊     | 1564/3250 [5:49:53<5:25:05, 11.57s/it] 48%|████▊     | 1565/3250 [5:50:05<5:27:33, 11.66s/it]                                                       {'loss': 1.7267, 'grad_norm': 0.4775996506214142, 'learning_rate': 0.005, 'epoch': 4.81, 'num_input_tokens_seen': 17749632}
 48%|████▊     | 1565/3250 [5:50:05<5:27:33, 11.66s/it] 48%|████▊     | 1566/3250 [5:50:17<5:28:36, 11.71s/it] 48%|████▊     | 1567/3250 [5:50:29<5:28:28, 11.71s/it] 48%|████▊     | 1568/3250 [5:50:40<5:28:43, 11.73s/it] 48%|████▊     | 1569/3250 [5:50:52<5:28:17, 11.72s/it] 48%|████▊     | 1570/3250 [5:51:04<5:32:02, 11.86s/it]                                                       {'loss': 1.6718, 'grad_norm': 0.45028775930404663, 'learning_rate': 0.005, 'epoch': 4.82, 'num_input_tokens_seen': 17806784}
 48%|████▊     | 1570/3250 [5:51:04<5:32:02, 11.86s/it] 48%|████▊     | 1571/3250 [5:51:16<5:31:11, 11.84s/it] 48%|████▊     | 1572/3250 [5:51:28<5:27:59, 11.73s/it] 48%|████▊     | 1573/3250 [5:51:39<5:28:41, 11.76s/it] 48%|████▊     | 1574/3250 [5:51:51<5:30:00, 11.81s/it] 48%|████▊     | 1575/3250 [5:52:03<5:28:00, 11.75s/it]                                                       {'loss': 1.619, 'grad_norm': 0.5527601838111877, 'learning_rate': 0.005, 'epoch': 4.84, 'num_input_tokens_seen': 17862624}
 48%|████▊     | 1575/3250 [5:52:03<5:28:00, 11.75s/it] 48%|████▊     | 1576/3250 [5:52:14<5:24:32, 11.63s/it] 49%|████▊     | 1577/3250 [5:52:25<5:19:06, 11.44s/it] 49%|████▊     | 1578/3250 [5:52:37<5:19:05, 11.45s/it] 49%|████▊     | 1579/3250 [5:52:48<5:19:32, 11.47s/it] 49%|████▊     | 1580/3250 [5:53:00<5:24:16, 11.65s/it]                                                       {'loss': 1.5365, 'grad_norm': 0.5630974769592285, 'learning_rate': 0.005, 'epoch': 4.85, 'num_input_tokens_seen': 17917408}
 49%|████▊     | 1580/3250 [5:53:00<5:24:16, 11.65s/it] 49%|████▊     | 1581/3250 [5:53:12<5:24:39, 11.67s/it] 49%|████▊     | 1582/3250 [5:53:24<5:23:59, 11.65s/it] 49%|████▊     | 1583/3250 [5:53:35<5:24:28, 11.68s/it] 49%|████▊     | 1584/3250 [5:53:47<5:26:56, 11.77s/it] 49%|████▉     | 1585/3250 [5:53:59<5:25:44, 11.74s/it]                                                       {'loss': 1.5369, 'grad_norm': 0.46713197231292725, 'learning_rate': 0.005, 'epoch': 4.87, 'num_input_tokens_seen': 17974752}
 49%|████▉     | 1585/3250 [5:53:59<5:25:44, 11.74s/it] 49%|████▉     | 1586/3250 [5:54:11<5:26:36, 11.78s/it] 49%|████▉     | 1587/3250 [5:54:23<5:25:58, 11.76s/it] 49%|████▉     | 1588/3250 [5:54:35<5:26:07, 11.77s/it] 49%|████▉     | 1589/3250 [5:54:46<5:24:31, 11.72s/it] 49%|████▉     | 1590/3250 [5:54:58<5:26:57, 11.82s/it]                                                       {'loss': 2.2134, 'grad_norm': 1.3162803649902344, 'learning_rate': 0.005, 'epoch': 4.88, 'num_input_tokens_seen': 18032416}
 49%|████▉     | 1590/3250 [5:54:58<5:26:57, 11.82s/it] 49%|████▉     | 1591/3250 [5:55:10<5:24:52, 11.75s/it] 49%|████▉     | 1592/3250 [5:55:22<5:25:21, 11.77s/it] 49%|████▉     | 1593/3250 [5:55:33<5:24:16, 11.74s/it] 49%|████▉     | 1594/3250 [5:55:45<5:24:27, 11.76s/it] 49%|████▉     | 1595/3250 [5:55:57<5:22:11, 11.68s/it]                                                       {'loss': 1.7572, 'grad_norm': 1.0086560249328613, 'learning_rate': 0.005, 'epoch': 4.9, 'num_input_tokens_seen': 18088512}
 49%|████▉     | 1595/3250 [5:55:57<5:22:11, 11.68s/it] 49%|████▉     | 1596/3250 [5:56:08<5:19:14, 11.58s/it] 49%|████▉     | 1597/3250 [5:56:20<5:20:24, 11.63s/it] 49%|████▉     | 1598/3250 [5:56:31<5:21:32, 11.68s/it] 49%|████▉     | 1599/3250 [5:56:43<5:19:07, 11.60s/it] 49%|████▉     | 1600/3250 [5:56:54<5:17:20, 11.54s/it]                                                       {'loss': 1.9939, 'grad_norm': 12.951935768127441, 'learning_rate': 0.005, 'epoch': 4.92, 'num_input_tokens_seen': 18145632}
 49%|████▉     | 1600/3250 [5:56:54<5:17:20, 11.54s/it][INFO|trainer.py:4021] 2024-10-11 10:48:57,866 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-10-11 10:48:57,867 >>   Num examples = 1157
[INFO|trainer.py:4026] 2024-10-11 10:48:57,867 >>   Batch size = 4

  0%|          | 0/145 [00:00<?, ?it/s][A
  1%|▏         | 2/145 [00:01<01:48,  1.32it/s][A
  2%|▏         | 3/145 [00:03<02:35,  1.09s/it][A
  3%|▎         | 4/145 [00:04<02:54,  1.24s/it][A
  3%|▎         | 5/145 [00:05<03:00,  1.29s/it][A
  4%|▍         | 6/145 [00:07<03:10,  1.37s/it][A
  5%|▍         | 7/145 [00:09<03:16,  1.42s/it][A
  6%|▌         | 8/145 [00:10<03:14,  1.42s/it][A
  6%|▌         | 9/145 [00:11<03:14,  1.43s/it][A
  7%|▋         | 10/145 [00:13<03:15,  1.45s/it][A
  8%|▊         | 11/145 [00:14<03:16,  1.47s/it][A
  8%|▊         | 12/145 [00:16<03:18,  1.50s/it][A
  9%|▉         | 13/145 [00:18<03:19,  1.51s/it][A
 10%|▉         | 14/145 [00:19<03:20,  1.53s/it][A
 10%|█         | 15/145 [00:21<03:17,  1.52s/it][A
 11%|█         | 16/145 [00:22<03:14,  1.51s/it][A
 12%|█▏        | 17/145 [00:24<03:13,  1.51s/it][A
 12%|█▏        | 18/145 [00:25<03:12,  1.51s/it][A
 13%|█▎        | 19/145 [00:27<03:11,  1.52s/it][A
 14%|█▍        | 20/145 [00:28<03:10,  1.52s/it][A
 14%|█▍        | 21/145 [00:30<03:06,  1.50s/it][A
 15%|█▌        | 22/145 [00:31<03:03,  1.49s/it][A
 16%|█▌        | 23/145 [00:33<03:01,  1.48s/it][A
 17%|█▋        | 24/145 [00:34<03:00,  1.49s/it][A
 17%|█▋        | 25/145 [00:36<02:59,  1.49s/it][A
 18%|█▊        | 26/145 [00:37<02:57,  1.49s/it][A
 19%|█▊        | 27/145 [00:39<02:56,  1.49s/it][A
 19%|█▉        | 28/145 [00:40<02:53,  1.49s/it][A
 20%|██        | 29/145 [00:41<02:52,  1.49s/it][A
 21%|██        | 30/145 [00:43<02:47,  1.46s/it][A
 21%|██▏       | 31/145 [00:44<02:47,  1.47s/it][A
 22%|██▏       | 32/145 [00:46<02:47,  1.48s/it][A
 23%|██▎       | 33/145 [00:47<02:46,  1.49s/it][A
 23%|██▎       | 34/145 [00:49<02:45,  1.49s/it][A
 24%|██▍       | 35/145 [00:50<02:44,  1.50s/it][A
 25%|██▍       | 36/145 [00:52<02:43,  1.50s/it][A
 26%|██▌       | 37/145 [00:54<02:45,  1.53s/it][A
 26%|██▌       | 38/145 [00:55<02:43,  1.53s/it][A
 27%|██▋       | 39/145 [00:57<02:41,  1.52s/it][A
 28%|██▊       | 40/145 [00:58<02:39,  1.52s/it][A
 28%|██▊       | 41/145 [01:00<02:39,  1.54s/it][A
 29%|██▉       | 42/145 [01:01<02:37,  1.53s/it][A
 30%|██▉       | 43/145 [01:03<02:34,  1.52s/it][A
 30%|███       | 44/145 [01:04<02:35,  1.54s/it][A
 31%|███       | 45/145 [01:06<02:35,  1.56s/it][A
 32%|███▏      | 46/145 [01:07<02:31,  1.53s/it][A
 32%|███▏      | 47/145 [01:09<02:27,  1.51s/it][A
 33%|███▎      | 48/145 [01:10<02:26,  1.51s/it][A
 34%|███▍      | 49/145 [01:12<02:26,  1.52s/it][A
 34%|███▍      | 50/145 [01:13<02:25,  1.53s/it][A
 35%|███▌      | 51/145 [01:15<02:23,  1.53s/it][A
 36%|███▌      | 52/145 [01:16<02:21,  1.52s/it][A
 37%|███▋      | 53/145 [01:18<02:20,  1.52s/it][A
 37%|███▋      | 54/145 [01:19<02:19,  1.53s/it][A
 38%|███▊      | 55/145 [01:21<02:16,  1.52s/it][A
 39%|███▊      | 56/145 [01:22<02:15,  1.52s/it][A
 39%|███▉      | 57/145 [01:24<02:12,  1.50s/it][A
 40%|████      | 58/145 [01:25<02:10,  1.50s/it][A
 41%|████      | 59/145 [01:27<02:11,  1.53s/it][A
 41%|████▏     | 60/145 [01:29<02:08,  1.51s/it][A
 42%|████▏     | 61/145 [01:30<02:06,  1.51s/it][A
 43%|████▎     | 62/145 [01:31<02:03,  1.49s/it][A
 43%|████▎     | 63/145 [01:33<02:04,  1.51s/it][A
 44%|████▍     | 64/145 [01:35<02:02,  1.51s/it][A
 45%|████▍     | 65/145 [01:36<02:01,  1.52s/it][A
 46%|████▌     | 66/145 [01:38<02:00,  1.52s/it][A
 46%|████▌     | 67/145 [01:39<01:57,  1.51s/it][A
 47%|████▋     | 68/145 [01:41<01:57,  1.53s/it][A
 48%|████▊     | 69/145 [01:42<01:56,  1.54s/it][A
 48%|████▊     | 70/145 [01:44<01:51,  1.49s/it][A
 49%|████▉     | 71/145 [01:45<01:49,  1.48s/it][A
 50%|████▉     | 72/145 [01:47<01:49,  1.50s/it][A
 50%|█████     | 73/145 [01:48<01:49,  1.52s/it][A
 51%|█████     | 74/145 [01:50<01:48,  1.53s/it][A
 52%|█████▏    | 75/145 [01:51<01:47,  1.53s/it][A
 52%|█████▏    | 76/145 [01:53<01:45,  1.52s/it][A
 53%|█████▎    | 77/145 [01:54<01:41,  1.50s/it][A
 54%|█████▍    | 78/145 [01:56<01:40,  1.50s/it][A
 54%|█████▍    | 79/145 [01:57<01:37,  1.48s/it][A
 55%|█████▌    | 80/145 [01:59<01:36,  1.48s/it][A
 56%|█████▌    | 81/145 [02:00<01:33,  1.45s/it][A
 57%|█████▋    | 82/145 [02:02<01:32,  1.48s/it][A
 57%|█████▋    | 83/145 [02:03<01:32,  1.49s/it][A
 58%|█████▊    | 84/145 [02:05<01:31,  1.50s/it][A
 59%|█████▊    | 85/145 [02:06<01:28,  1.48s/it][A
 59%|█████▉    | 86/145 [02:08<01:28,  1.49s/it][A
 60%|██████    | 87/145 [02:09<01:28,  1.52s/it][A
 61%|██████    | 88/145 [02:11<01:25,  1.49s/it][A
 61%|██████▏   | 89/145 [02:12<01:24,  1.50s/it][A
 62%|██████▏   | 90/145 [02:14<01:23,  1.51s/it][A
 63%|██████▎   | 91/145 [02:15<01:21,  1.51s/it][A
 63%|██████▎   | 92/145 [02:17<01:19,  1.51s/it][A
 64%|██████▍   | 93/145 [02:18<01:17,  1.49s/it][A
 65%|██████▍   | 94/145 [02:20<01:15,  1.48s/it][A
 66%|██████▌   | 95/145 [02:21<01:14,  1.49s/it][A
 66%|██████▌   | 96/145 [02:23<01:13,  1.50s/it][A
 67%|██████▋   | 97/145 [02:24<01:12,  1.51s/it][A
 68%|██████▊   | 98/145 [02:26<01:12,  1.54s/it][A
 68%|██████▊   | 99/145 [02:27<01:09,  1.51s/it][A
 69%|██████▉   | 100/145 [02:29<01:08,  1.52s/it][A
 70%|██████▉   | 101/145 [02:30<01:07,  1.53s/it][A
 70%|███████   | 102/145 [02:32<01:05,  1.52s/it][A
 71%|███████   | 103/145 [02:33<01:03,  1.52s/it][A
 72%|███████▏  | 104/145 [02:35<01:02,  1.53s/it][A
 72%|███████▏  | 105/145 [02:36<01:01,  1.53s/it][A
 73%|███████▎  | 106/145 [02:38<00:59,  1.52s/it][A
 74%|███████▍  | 107/145 [02:39<00:56,  1.48s/it][A
 74%|███████▍  | 108/145 [02:41<00:53,  1.45s/it][A
 75%|███████▌  | 109/145 [02:42<00:53,  1.48s/it][A
 76%|███████▌  | 110/145 [02:44<00:52,  1.50s/it][A
 77%|███████▋  | 111/145 [02:45<00:49,  1.46s/it][A
 77%|███████▋  | 112/145 [02:47<00:49,  1.49s/it][A
 78%|███████▊  | 113/145 [02:48<00:48,  1.51s/it][A
 79%|███████▊  | 114/145 [02:50<00:47,  1.52s/it][A
 79%|███████▉  | 115/145 [02:51<00:45,  1.52s/it][A
 80%|████████  | 116/145 [02:53<00:43,  1.49s/it][A
 81%|████████  | 117/145 [02:54<00:41,  1.49s/it][A
 81%|████████▏ | 118/145 [02:56<00:40,  1.48s/it][A
 82%|████████▏ | 119/145 [02:57<00:37,  1.45s/it][A
 83%|████████▎ | 120/145 [02:58<00:35,  1.43s/it][A
 83%|████████▎ | 121/145 [03:00<00:34,  1.44s/it][A
 84%|████████▍ | 122/145 [03:01<00:33,  1.45s/it][A
 85%|████████▍ | 123/145 [03:03<00:32,  1.46s/it][A
 86%|████████▌ | 124/145 [03:04<00:30,  1.45s/it][A
 86%|████████▌ | 125/145 [03:06<00:30,  1.51s/it][A
 87%|████████▋ | 126/145 [03:07<00:28,  1.49s/it][A
 88%|████████▊ | 127/145 [03:09<00:26,  1.49s/it][A
 88%|████████▊ | 128/145 [03:10<00:25,  1.51s/it][A
 89%|████████▉ | 129/145 [03:12<00:24,  1.51s/it][A
 90%|████████▉ | 130/145 [03:13<00:23,  1.54s/it][A
 90%|█████████ | 131/145 [03:15<00:20,  1.49s/it][A
 91%|█████████ | 132/145 [03:16<00:19,  1.51s/it][A
 92%|█████████▏| 133/145 [03:18<00:17,  1.48s/it][A
 92%|█████████▏| 134/145 [03:19<00:16,  1.52s/it][A
 93%|█████████▎| 135/145 [03:21<00:15,  1.52s/it][A
 94%|█████████▍| 136/145 [03:22<00:13,  1.51s/it][A
 94%|█████████▍| 137/145 [03:24<00:12,  1.50s/it][A
 95%|█████████▌| 138/145 [03:25<00:10,  1.51s/it][A
 96%|█████████▌| 139/145 [03:27<00:09,  1.51s/it][A
 97%|█████████▋| 140/145 [03:28<00:07,  1.52s/it][A
 97%|█████████▋| 141/145 [03:30<00:06,  1.52s/it][A
 98%|█████████▊| 142/145 [03:32<00:04,  1.51s/it][A
 99%|█████████▊| 143/145 [03:33<00:02,  1.50s/it][A
 99%|█████████▉| 144/145 [03:35<00:01,  1.51s/it][A
100%|██████████| 145/145 [03:36<00:00,  1.48s/it][A
                                                 [A                                                       {'eval_loss': 1.9598976373672485, 'eval_runtime': 218.0923, 'eval_samples_per_second': 5.305, 'eval_steps_per_second': 0.665, 'epoch': 4.92, 'num_input_tokens_seen': 18145632}

100%|██████████| 145/145 [03:36<00:00,  1.48s/it][A 49%|████▉     | 1600/3250 [6:00:32<5:17:20, 11.54s/it]
                                                 [A[INFO|trainer.py:3705] 2024-10-11 10:52:35,961 >> Saving model checkpoint to /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1600
[INFO|configuration_utils.py:672] 2024-10-11 10:52:37,370 >> loading configuration file config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/config.json
[WARNING|modeling_rope_utils.py:379] 2024-10-11 10:52:37,371 >> Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
[INFO|configuration_utils.py:739] 2024-10-11 10:52:37,373 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 3584,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 18944,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 28,
  "num_hidden_layers": 28,
  "num_key_value_heads": 4,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.0",
  "use_cache": true,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "in_chans": 3,
    "model_type": "qwen2_vl",
    "spatial_patch_size": 14
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 152064
}

[INFO|tokenization_utils_base.py:2649] 2024-10-11 10:52:37,449 >> tokenizer config file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1600/tokenizer_config.json
[INFO|tokenization_utils_base.py:2658] 2024-10-11 10:52:37,450 >> Special tokens file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1600/special_tokens_map.json
[INFO|image_processing_base.py:258] 2024-10-11 10:52:37,953 >> Image processor saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1600/preprocessor_config.json
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 49%|████▉     | 1601/3250 [6:00:46<35:34:42, 77.67s/it] 49%|████▉     | 1602/3250 [6:00:58<26:29:25, 57.87s/it] 49%|████▉     | 1603/3250 [6:01:09<20:07:16, 43.98s/it] 49%|████▉     | 1604/3250 [6:01:21<15:39:19, 34.24s/it] 49%|████▉     | 1605/3250 [6:01:32<12:30:36, 27.38s/it]                                                        {'loss': 1.9451, 'grad_norm': 0.4296589493751526, 'learning_rate': 0.005, 'epoch': 4.93, 'num_input_tokens_seen': 18201120}
 49%|████▉     | 1605/3250 [6:01:32<12:30:36, 27.38s/it] 49%|████▉     | 1606/3250 [6:01:44<10:18:01, 22.56s/it] 49%|████▉     | 1607/3250 [6:01:55<8:48:22, 19.30s/it]  49%|████▉     | 1608/3250 [6:02:07<7:45:27, 17.01s/it] 50%|████▉     | 1609/3250 [6:02:19<7:03:38, 15.49s/it] 50%|████▉     | 1610/3250 [6:02:31<6:32:20, 14.35s/it]                                                       {'loss': 1.9081, 'grad_norm': 0.6518984436988831, 'learning_rate': 0.005, 'epoch': 4.95, 'num_input_tokens_seen': 18258528}
 50%|████▉     | 1610/3250 [6:02:31<6:32:20, 14.35s/it] 50%|████▉     | 1611/3250 [6:02:42<6:08:52, 13.50s/it] 50%|████▉     | 1612/3250 [6:02:54<5:51:35, 12.88s/it] 50%|████▉     | 1613/3250 [6:03:05<5:42:01, 12.54s/it] 50%|████▉     | 1614/3250 [6:03:17<5:35:06, 12.29s/it] 50%|████▉     | 1615/3250 [6:03:29<5:29:44, 12.10s/it]                                                       {'loss': 1.7284, 'grad_norm': 0.5354993343353271, 'learning_rate': 0.005, 'epoch': 4.96, 'num_input_tokens_seen': 18315296}
 50%|████▉     | 1615/3250 [6:03:29<5:29:44, 12.10s/it] 50%|████▉     | 1616/3250 [6:03:40<5:25:05, 11.94s/it] 50%|████▉     | 1617/3250 [6:03:52<5:22:07, 11.84s/it] 50%|████▉     | 1618/3250 [6:04:03<5:20:17, 11.78s/it] 50%|████▉     | 1619/3250 [6:04:15<5:20:01, 11.77s/it] 50%|████▉     | 1620/3250 [6:04:27<5:17:33, 11.69s/it]                                                       {'loss': 1.8784, 'grad_norm': 0.4952032268047333, 'learning_rate': 0.005, 'epoch': 4.98, 'num_input_tokens_seen': 18371296}
 50%|████▉     | 1620/3250 [6:04:27<5:17:33, 11.69s/it] 50%|████▉     | 1621/3250 [6:04:38<5:17:40, 11.70s/it] 50%|████▉     | 1622/3250 [6:04:50<5:16:26, 11.66s/it] 50%|████▉     | 1623/3250 [6:05:02<5:15:57, 11.65s/it] 50%|████▉     | 1624/3250 [6:05:13<5:14:53, 11.62s/it] 50%|█████     | 1625/3250 [6:05:25<5:14:53, 11.63s/it]                                                       {'loss': 1.7062, 'grad_norm': 0.6362351775169373, 'learning_rate': 0.005, 'epoch': 4.99, 'num_input_tokens_seen': 18428928}
 50%|█████     | 1625/3250 [6:05:25<5:14:53, 11.63s/it] 50%|█████     | 1626/3250 [6:05:37<5:16:35, 11.70s/it] 50%|█████     | 1627/3250 [6:05:48<5:16:37, 11.71s/it] 50%|█████     | 1628/3250 [6:06:00<5:16:03, 11.69s/it] 50%|█████     | 1629/3250 [6:06:11<5:12:10, 11.55s/it] 50%|█████     | 1630/3250 [6:06:23<5:11:15, 11.53s/it]                                                       {'loss': 1.6383, 'grad_norm': 0.6310323476791382, 'learning_rate': 0.005, 'epoch': 5.01, 'num_input_tokens_seen': 18485440}
 50%|█████     | 1630/3250 [6:06:23<5:11:15, 11.53s/it] 50%|█████     | 1631/3250 [6:06:34<5:11:49, 11.56s/it] 50%|█████     | 1632/3250 [6:06:46<5:12:09, 11.58s/it] 50%|█████     | 1633/3250 [6:06:58<5:13:13, 11.62s/it] 50%|█████     | 1634/3250 [6:07:09<5:10:45, 11.54s/it] 50%|█████     | 1635/3250 [6:07:21<5:13:02, 11.63s/it]                                                       {'loss': 1.6172, 'grad_norm': 0.5363874435424805, 'learning_rate': 0.005, 'epoch': 5.02, 'num_input_tokens_seen': 18543264}
 50%|█████     | 1635/3250 [6:07:21<5:13:02, 11.63s/it] 50%|█████     | 1636/3250 [6:07:33<5:14:33, 11.69s/it] 50%|█████     | 1637/3250 [6:07:45<5:14:46, 11.71s/it] 50%|█████     | 1638/3250 [6:07:56<5:12:10, 11.62s/it] 50%|█████     | 1639/3250 [6:08:08<5:11:40, 11.61s/it] 50%|█████     | 1640/3250 [6:08:19<5:12:18, 11.64s/it]                                                       {'loss': 1.4797, 'grad_norm': 0.453329473733902, 'learning_rate': 0.005, 'epoch': 5.04, 'num_input_tokens_seen': 18601376}
 50%|█████     | 1640/3250 [6:08:19<5:12:18, 11.64s/it] 50%|█████     | 1641/3250 [6:08:31<5:12:29, 11.65s/it] 51%|█████     | 1642/3250 [6:08:43<5:12:37, 11.66s/it] 51%|█████     | 1643/3250 [6:08:54<5:13:30, 11.71s/it] 51%|█████     | 1644/3250 [6:09:06<5:11:43, 11.65s/it] 51%|█████     | 1645/3250 [6:09:18<5:13:01, 11.70s/it]                                                       {'loss': 1.6511, 'grad_norm': 0.5282632112503052, 'learning_rate': 0.005, 'epoch': 5.05, 'num_input_tokens_seen': 18657856}
 51%|█████     | 1645/3250 [6:09:18<5:13:01, 11.70s/it] 51%|█████     | 1646/3250 [6:09:29<5:11:10, 11.64s/it] 51%|█████     | 1647/3250 [6:09:41<5:10:18, 11.62s/it] 51%|█████     | 1648/3250 [6:09:52<5:10:26, 11.63s/it] 51%|█████     | 1649/3250 [6:10:04<5:08:53, 11.58s/it] 51%|█████     | 1650/3250 [6:10:16<5:09:34, 11.61s/it]                                                       {'loss': 1.5895, 'grad_norm': 0.496819406747818, 'learning_rate': 0.005, 'epoch': 5.07, 'num_input_tokens_seen': 18714944}
 51%|█████     | 1650/3250 [6:10:16<5:09:34, 11.61s/it] 51%|█████     | 1651/3250 [6:10:27<5:10:14, 11.64s/it] 51%|█████     | 1652/3250 [6:10:39<5:10:09, 11.65s/it] 51%|█████     | 1653/3250 [6:10:51<5:09:39, 11.63s/it] 51%|█████     | 1654/3250 [6:11:02<5:07:48, 11.57s/it] 51%|█████     | 1655/3250 [6:11:14<5:07:56, 11.58s/it]                                                       {'loss': 1.5611, 'grad_norm': 6.437469959259033, 'learning_rate': 0.005, 'epoch': 5.08, 'num_input_tokens_seen': 18771392}
 51%|█████     | 1655/3250 [6:11:14<5:07:56, 11.58s/it] 51%|█████     | 1656/3250 [6:11:25<5:07:06, 11.56s/it] 51%|█████     | 1657/3250 [6:11:37<5:07:26, 11.58s/it] 51%|█████     | 1658/3250 [6:11:48<5:06:51, 11.57s/it] 51%|█████     | 1659/3250 [6:12:00<5:08:13, 11.62s/it] 51%|█████     | 1660/3250 [6:12:12<5:10:07, 11.70s/it]                                                       {'loss': 1.5833, 'grad_norm': 0.5965222716331482, 'learning_rate': 0.005, 'epoch': 5.1, 'num_input_tokens_seen': 18827648}
 51%|█████     | 1660/3250 [6:12:12<5:10:07, 11.70s/it] 51%|█████     | 1661/3250 [6:12:24<5:09:57, 11.70s/it] 51%|█████     | 1662/3250 [6:12:35<5:09:20, 11.69s/it] 51%|█████     | 1663/3250 [6:12:47<5:06:04, 11.57s/it] 51%|█████     | 1664/3250 [6:12:58<5:07:38, 11.64s/it] 51%|█████     | 1665/3250 [6:13:10<5:08:03, 11.66s/it]                                                       {'loss': 1.478, 'grad_norm': 0.6736301183700562, 'learning_rate': 0.005, 'epoch': 5.12, 'num_input_tokens_seen': 18885152}
 51%|█████     | 1665/3250 [6:13:10<5:08:03, 11.66s/it] 51%|█████▏    | 1666/3250 [6:13:22<5:05:50, 11.58s/it] 51%|█████▏    | 1667/3250 [6:13:33<5:08:05, 11.68s/it] 51%|█████▏    | 1668/3250 [6:13:45<5:07:56, 11.68s/it] 51%|█████▏    | 1669/3250 [6:13:57<5:08:07, 11.69s/it] 51%|█████▏    | 1670/3250 [6:14:09<5:08:30, 11.72s/it]                                                       {'loss': 1.4691, 'grad_norm': 0.5372510552406311, 'learning_rate': 0.005, 'epoch': 5.13, 'num_input_tokens_seen': 18942336}
 51%|█████▏    | 1670/3250 [6:14:09<5:08:30, 11.72s/it] 51%|█████▏    | 1671/3250 [6:14:20<5:08:31, 11.72s/it] 51%|█████▏    | 1672/3250 [6:14:32<5:09:08, 11.75s/it] 51%|█████▏    | 1673/3250 [6:14:44<5:09:20, 11.77s/it] 52%|█████▏    | 1674/3250 [6:14:56<5:09:38, 11.79s/it] 52%|█████▏    | 1675/3250 [6:15:07<5:07:28, 11.71s/it]                                                       {'loss': 1.4502, 'grad_norm': 0.3004164397716522, 'learning_rate': 0.005, 'epoch': 5.15, 'num_input_tokens_seen': 18999776}
 52%|█████▏    | 1675/3250 [6:15:07<5:07:28, 11.71s/it] 52%|█████▏    | 1676/3250 [6:15:19<5:06:31, 11.68s/it] 52%|█████▏    | 1677/3250 [6:15:31<5:05:35, 11.66s/it] 52%|█████▏    | 1678/3250 [6:15:42<5:05:24, 11.66s/it] 52%|█████▏    | 1679/3250 [6:15:54<5:03:07, 11.58s/it] 52%|█████▏    | 1680/3250 [6:16:05<5:00:23, 11.48s/it]                                                       {'loss': 1.5271, 'grad_norm': 0.5197604298591614, 'learning_rate': 0.005, 'epoch': 5.16, 'num_input_tokens_seen': 19055456}
 52%|█████▏    | 1680/3250 [6:16:05<5:00:23, 11.48s/it] 52%|█████▏    | 1681/3250 [6:16:17<5:01:46, 11.54s/it] 52%|█████▏    | 1682/3250 [6:16:28<4:58:15, 11.41s/it] 52%|█████▏    | 1683/3250 [6:16:39<4:56:38, 11.36s/it] 52%|█████▏    | 1684/3250 [6:16:51<4:58:42, 11.44s/it] 52%|█████▏    | 1685/3250 [6:17:02<4:58:22, 11.44s/it]                                                       {'loss': 1.5178, 'grad_norm': 0.4406520128250122, 'learning_rate': 0.005, 'epoch': 5.18, 'num_input_tokens_seen': 19112032}
 52%|█████▏    | 1685/3250 [6:17:02<4:58:22, 11.44s/it] 52%|█████▏    | 1686/3250 [6:17:13<4:58:37, 11.46s/it] 52%|█████▏    | 1687/3250 [6:17:25<4:56:32, 11.38s/it] 52%|█████▏    | 1688/3250 [6:17:36<4:54:07, 11.30s/it] 52%|█████▏    | 1689/3250 [6:17:47<4:55:21, 11.35s/it] 52%|█████▏    | 1690/3250 [6:17:59<4:54:44, 11.34s/it]                                                       {'loss': 1.5962, 'grad_norm': 0.3799935281276703, 'learning_rate': 0.005, 'epoch': 5.19, 'num_input_tokens_seen': 19167328}
 52%|█████▏    | 1690/3250 [6:17:59<4:54:44, 11.34s/it] 52%|█████▏    | 1691/3250 [6:18:10<4:54:37, 11.34s/it] 52%|█████▏    | 1692/3250 [6:18:21<4:55:08, 11.37s/it] 52%|█████▏    | 1693/3250 [6:18:33<4:56:09, 11.41s/it] 52%|█████▏    | 1694/3250 [6:18:44<4:56:01, 11.42s/it] 52%|█████▏    | 1695/3250 [6:18:56<4:54:54, 11.38s/it]                                                       {'loss': 1.52, 'grad_norm': 0.4486915171146393, 'learning_rate': 0.005, 'epoch': 5.21, 'num_input_tokens_seen': 19224768}
 52%|█████▏    | 1695/3250 [6:18:56<4:54:54, 11.38s/it] 52%|█████▏    | 1696/3250 [6:19:07<4:55:22, 11.40s/it] 52%|█████▏    | 1697/3250 [6:19:19<4:56:50, 11.47s/it] 52%|█████▏    | 1698/3250 [6:19:30<4:57:03, 11.48s/it] 52%|█████▏    | 1699/3250 [6:19:41<4:54:42, 11.40s/it] 52%|█████▏    | 1700/3250 [6:19:53<4:52:57, 11.34s/it]                                                       {'loss': 1.4999, 'grad_norm': 0.3724419176578522, 'learning_rate': 0.005, 'epoch': 5.22, 'num_input_tokens_seen': 19281440}
 52%|█████▏    | 1700/3250 [6:19:53<4:52:57, 11.34s/it][INFO|trainer.py:4021] 2024-10-11 11:11:56,186 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-10-11 11:11:56,186 >>   Num examples = 1157
[INFO|trainer.py:4026] 2024-10-11 11:11:56,186 >>   Batch size = 4

  0%|          | 0/145 [00:00<?, ?it/s][A
  1%|▏         | 2/145 [00:01<01:47,  1.33it/s][A
  2%|▏         | 3/145 [00:03<02:34,  1.09s/it][A
  3%|▎         | 4/145 [00:04<02:54,  1.24s/it][A
  3%|▎         | 5/145 [00:05<03:00,  1.29s/it][A
  4%|▍         | 6/145 [00:07<03:10,  1.37s/it][A
  5%|▍         | 7/145 [00:09<03:16,  1.42s/it][A
  6%|▌         | 8/145 [00:10<03:15,  1.42s/it][A
  6%|▌         | 9/145 [00:11<03:14,  1.43s/it][A
  7%|▋         | 10/145 [00:13<03:15,  1.45s/it][A
  8%|▊         | 11/145 [00:14<03:16,  1.47s/it][A
  8%|▊         | 12/145 [00:16<03:18,  1.49s/it][A
  9%|▉         | 13/145 [00:17<03:19,  1.51s/it][A
 10%|▉         | 14/145 [00:19<03:20,  1.53s/it][A
 10%|█         | 15/145 [00:21<03:17,  1.52s/it][A
 11%|█         | 16/145 [00:22<03:14,  1.51s/it][A
 12%|█▏        | 17/145 [00:24<03:13,  1.51s/it][A
 12%|█▏        | 18/145 [00:25<03:12,  1.51s/it][A
 13%|█▎        | 19/145 [00:27<03:11,  1.52s/it][A
 14%|█▍        | 20/145 [00:28<03:09,  1.52s/it][A
 14%|█▍        | 21/145 [00:30<03:05,  1.49s/it][A
 15%|█▌        | 22/145 [00:31<03:02,  1.48s/it][A
 16%|█▌        | 23/145 [00:32<03:00,  1.48s/it][A
 17%|█▋        | 24/145 [00:34<02:59,  1.48s/it][A
 17%|█▋        | 25/145 [00:35<02:58,  1.49s/it][A
 18%|█▊        | 26/145 [00:37<02:56,  1.48s/it][A
 19%|█▊        | 27/145 [00:38<02:56,  1.49s/it][A
 19%|█▉        | 28/145 [00:40<02:53,  1.49s/it][A
 20%|██        | 29/145 [00:41<02:52,  1.49s/it][A
 21%|██        | 30/145 [00:43<02:47,  1.45s/it][A
 21%|██▏       | 31/145 [00:44<02:47,  1.47s/it][A
 22%|██▏       | 32/145 [00:46<02:47,  1.48s/it][A
 23%|██▎       | 33/145 [00:47<02:46,  1.49s/it][A
 23%|██▎       | 34/145 [00:49<02:45,  1.49s/it][A
 24%|██▍       | 35/145 [00:50<02:45,  1.50s/it][A
 25%|██▍       | 36/145 [00:52<02:42,  1.50s/it][A
 26%|██▌       | 37/145 [00:53<02:45,  1.53s/it][A
 26%|██▌       | 38/145 [00:55<02:43,  1.53s/it][A
 27%|██▋       | 39/145 [00:56<02:40,  1.52s/it][A
 28%|██▊       | 40/145 [00:58<02:39,  1.52s/it][A
 28%|██▊       | 41/145 [01:00<02:39,  1.54s/it][A
 29%|██▉       | 42/145 [01:01<02:37,  1.53s/it][A
 30%|██▉       | 43/145 [01:03<02:34,  1.51s/it][A
 30%|███       | 44/145 [01:04<02:35,  1.54s/it][A
 31%|███       | 45/145 [01:06<02:35,  1.55s/it][A
 32%|███▏      | 46/145 [01:07<02:31,  1.53s/it][A
 32%|███▏      | 47/145 [01:09<02:27,  1.50s/it][A
 33%|███▎      | 48/145 [01:10<02:26,  1.51s/it][A
 34%|███▍      | 49/145 [01:12<02:26,  1.52s/it][A
 34%|███▍      | 50/145 [01:13<02:25,  1.53s/it][A
 35%|███▌      | 51/145 [01:15<02:23,  1.53s/it][A
 36%|███▌      | 52/145 [01:16<02:22,  1.53s/it][A
 37%|███▋      | 53/145 [01:18<02:20,  1.53s/it][A
 37%|███▋      | 54/145 [01:19<02:19,  1.53s/it][A
 38%|███▊      | 55/145 [01:21<02:16,  1.52s/it][A
 39%|███▊      | 56/145 [01:22<02:15,  1.52s/it][A
 39%|███▉      | 57/145 [01:24<02:12,  1.50s/it][A
 40%|████      | 58/145 [01:25<02:10,  1.49s/it][A
 41%|████      | 59/145 [01:27<02:11,  1.52s/it][A
 41%|████▏     | 60/145 [01:28<02:08,  1.51s/it][A
 42%|████▏     | 61/145 [01:30<02:06,  1.51s/it][A
 43%|████▎     | 62/145 [01:31<02:03,  1.49s/it][A
 43%|████▎     | 63/145 [01:33<02:04,  1.51s/it][A
 44%|████▍     | 64/145 [01:34<02:02,  1.51s/it][A
 45%|████▍     | 65/145 [01:36<02:01,  1.52s/it][A
 46%|████▌     | 66/145 [01:37<01:59,  1.52s/it][A
 46%|████▌     | 67/145 [01:39<01:57,  1.50s/it][A
 47%|████▋     | 68/145 [01:41<01:58,  1.53s/it][A
 48%|████▊     | 69/145 [01:42<01:57,  1.54s/it][A
 48%|████▊     | 70/145 [01:43<01:51,  1.49s/it][A
 49%|████▉     | 71/145 [01:45<01:49,  1.49s/it][A
 50%|████▉     | 72/145 [01:46<01:49,  1.50s/it][A
 50%|█████     | 73/145 [01:48<01:49,  1.52s/it][A
 51%|█████     | 74/145 [01:50<01:48,  1.53s/it][A
 52%|█████▏    | 75/145 [01:51<01:47,  1.53s/it][A
 52%|█████▏    | 76/145 [01:53<01:45,  1.52s/it][A
 53%|█████▎    | 77/145 [01:54<01:41,  1.50s/it][A
 54%|█████▍    | 78/145 [01:56<01:40,  1.49s/it][A
 54%|█████▍    | 79/145 [01:57<01:37,  1.48s/it][A
 55%|█████▌    | 80/145 [01:58<01:35,  1.47s/it][A
 56%|█████▌    | 81/145 [02:00<01:33,  1.45s/it][A
 57%|█████▋    | 82/145 [02:01<01:33,  1.48s/it][A
 57%|█████▋    | 83/145 [02:03<01:32,  1.49s/it][A
 58%|█████▊    | 84/145 [02:04<01:31,  1.50s/it][A
 59%|█████▊    | 85/145 [02:06<01:28,  1.47s/it][A
 59%|█████▉    | 86/145 [02:07<01:27,  1.49s/it][A
 60%|██████    | 87/145 [02:09<01:27,  1.52s/it][A
 61%|██████    | 88/145 [02:10<01:25,  1.49s/it][A
 61%|██████▏   | 89/145 [02:12<01:24,  1.50s/it][A
 62%|██████▏   | 90/145 [02:13<01:23,  1.52s/it][A
 63%|██████▎   | 91/145 [02:15<01:21,  1.51s/it][A
 63%|██████▎   | 92/145 [02:16<01:19,  1.50s/it][A
 64%|██████▍   | 93/145 [02:18<01:17,  1.49s/it][A
 65%|██████▍   | 94/145 [02:19<01:15,  1.48s/it][A
 66%|██████▌   | 95/145 [02:21<01:14,  1.49s/it][A
 66%|██████▌   | 96/145 [02:22<01:13,  1.49s/it][A
 67%|██████▋   | 97/145 [02:24<01:12,  1.51s/it][A
 68%|██████▊   | 98/145 [02:26<01:12,  1.54s/it][A
 68%|██████▊   | 99/145 [02:27<01:09,  1.52s/it][A
 69%|██████▉   | 100/145 [02:29<01:08,  1.52s/it][A
 70%|██████▉   | 101/145 [02:30<01:07,  1.53s/it][A
 70%|███████   | 102/145 [02:32<01:05,  1.52s/it][A
 71%|███████   | 103/145 [02:33<01:03,  1.52s/it][A
 72%|███████▏  | 104/145 [02:35<01:02,  1.52s/it][A
 72%|███████▏  | 105/145 [02:36<01:00,  1.52s/it][A
 73%|███████▎  | 106/145 [02:38<00:59,  1.52s/it][A
 74%|███████▍  | 107/145 [02:39<00:56,  1.48s/it][A
 74%|███████▍  | 108/145 [02:40<00:53,  1.45s/it][A
 75%|███████▌  | 109/145 [02:42<00:53,  1.48s/it][A
 76%|███████▌  | 110/145 [02:44<00:52,  1.50s/it][A
 77%|███████▋  | 111/145 [02:45<00:49,  1.47s/it][A
 77%|███████▋  | 112/145 [02:46<00:49,  1.50s/it][A
 78%|███████▊  | 113/145 [02:48<00:48,  1.51s/it][A
 79%|███████▊  | 114/145 [02:50<00:47,  1.52s/it][A
 79%|███████▉  | 115/145 [02:51<00:45,  1.52s/it][A
 80%|████████  | 116/145 [02:53<00:43,  1.49s/it][A
 81%|████████  | 117/145 [02:54<00:41,  1.48s/it][A
 81%|████████▏ | 118/145 [02:55<00:39,  1.48s/it][A
 82%|████████▏ | 119/145 [02:57<00:37,  1.45s/it][A
 83%|████████▎ | 120/145 [02:58<00:35,  1.43s/it][A
 83%|████████▎ | 121/145 [03:00<00:34,  1.44s/it][A
 84%|████████▍ | 122/145 [03:01<00:33,  1.45s/it][A
 85%|████████▍ | 123/145 [03:03<00:32,  1.46s/it][A
 86%|████████▌ | 124/145 [03:04<00:30,  1.45s/it][A
 86%|████████▌ | 125/145 [03:06<00:30,  1.51s/it][A
 87%|████████▋ | 126/145 [03:07<00:28,  1.49s/it][A
 88%|████████▊ | 127/145 [03:09<00:26,  1.49s/it][A
 88%|████████▊ | 128/145 [03:10<00:25,  1.52s/it][A
 89%|████████▉ | 129/145 [03:12<00:24,  1.51s/it][A
 90%|████████▉ | 130/145 [03:13<00:23,  1.54s/it][A
 90%|█████████ | 131/145 [03:15<00:20,  1.50s/it][A
 91%|█████████ | 132/145 [03:16<00:19,  1.51s/it][A
 92%|█████████▏| 133/145 [03:18<00:17,  1.49s/it][A
 92%|█████████▏| 134/145 [03:19<00:16,  1.52s/it][A
 93%|█████████▎| 135/145 [03:21<00:15,  1.52s/it][A
 94%|█████████▍| 136/145 [03:22<00:13,  1.51s/it][A
 94%|█████████▍| 137/145 [03:24<00:12,  1.50s/it][A
 95%|█████████▌| 138/145 [03:25<00:10,  1.52s/it][A
 96%|█████████▌| 139/145 [03:27<00:09,  1.51s/it][A
 97%|█████████▋| 140/145 [03:28<00:07,  1.52s/it][A
 97%|█████████▋| 141/145 [03:30<00:06,  1.52s/it][A
 98%|█████████▊| 142/145 [03:31<00:04,  1.50s/it][A
 99%|█████████▊| 143/145 [03:33<00:02,  1.50s/it][A
 99%|█████████▉| 144/145 [03:34<00:01,  1.51s/it][A
100%|██████████| 145/145 [03:36<00:00,  1.48s/it][A
                                                 [A                                                       {'eval_loss': 1.4523650407791138, 'eval_runtime': 217.9555, 'eval_samples_per_second': 5.308, 'eval_steps_per_second': 0.665, 'epoch': 5.22, 'num_input_tokens_seen': 19281440}

100%|██████████| 145/145 [03:36<00:00,  1.48s/it][A 52%|█████▏    | 1700/3250 [6:23:31<4:52:57, 11.34s/it]
                                                 [A[INFO|trainer.py:3705] 2024-10-11 11:15:34,144 >> Saving model checkpoint to /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1700
[INFO|configuration_utils.py:672] 2024-10-11 11:15:34,745 >> loading configuration file config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/config.json
[WARNING|modeling_rope_utils.py:379] 2024-10-11 11:15:34,745 >> Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
[INFO|configuration_utils.py:739] 2024-10-11 11:15:34,748 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 3584,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 18944,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 28,
  "num_hidden_layers": 28,
  "num_key_value_heads": 4,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.0",
  "use_cache": true,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "in_chans": 3,
    "model_type": "qwen2_vl",
    "spatial_patch_size": 14
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 152064
}

[INFO|tokenization_utils_base.py:2649] 2024-10-11 11:15:34,825 >> tokenizer config file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1700/tokenizer_config.json
[INFO|tokenization_utils_base.py:2658] 2024-10-11 11:15:34,825 >> Special tokens file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1700/special_tokens_map.json
[INFO|image_processing_base.py:258] 2024-10-11 11:15:35,331 >> Image processor saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1700/preprocessor_config.json
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 52%|█████▏    | 1701/3250 [6:23:43<33:09:47, 77.07s/it] 52%|█████▏    | 1702/3250 [6:23:54<24:37:06, 57.25s/it] 52%|█████▏    | 1703/3250 [6:24:05<18:41:06, 43.48s/it] 52%|█████▏    | 1704/3250 [6:24:17<14:33:27, 33.90s/it] 52%|█████▏    | 1705/3250 [6:24:28<11:38:38, 27.13s/it]                                                        {'loss': 1.4082, 'grad_norm': 0.5609760284423828, 'learning_rate': 0.005, 'epoch': 5.24, 'num_input_tokens_seen': 19337376}
 52%|█████▏    | 1705/3250 [6:24:28<11:38:38, 27.13s/it] 52%|█████▏    | 1706/3250 [6:24:40<9:37:50, 22.45s/it]  53%|█████▎    | 1707/3250 [6:24:51<8:14:06, 19.21s/it] 53%|█████▎    | 1708/3250 [6:25:03<7:13:32, 16.87s/it] 53%|█████▎    | 1709/3250 [6:25:14<6:31:13, 15.23s/it] 53%|█████▎    | 1710/3250 [6:25:26<6:02:07, 14.11s/it]                                                       {'loss': 1.4015, 'grad_norm': 0.35138386487960815, 'learning_rate': 0.005, 'epoch': 5.25, 'num_input_tokens_seen': 19395232}
 53%|█████▎    | 1710/3250 [6:25:26<6:02:07, 14.11s/it] 53%|█████▎    | 1711/3250 [6:25:37<5:39:51, 13.25s/it] 53%|█████▎    | 1712/3250 [6:25:48<5:24:39, 12.67s/it] 53%|█████▎    | 1713/3250 [6:26:00<5:15:15, 12.31s/it] 53%|█████▎    | 1714/3250 [6:26:11<5:10:08, 12.12s/it] 53%|█████▎    | 1715/3250 [6:26:23<5:03:31, 11.86s/it]                                                       {'loss': 1.4119, 'grad_norm': 0.31947600841522217, 'learning_rate': 0.005, 'epoch': 5.27, 'num_input_tokens_seen': 19450976}
 53%|█████▎    | 1715/3250 [6:26:23<5:03:31, 11.86s/it] 53%|█████▎    | 1716/3250 [6:26:34<5:00:50, 11.77s/it] 53%|█████▎    | 1717/3250 [6:26:46<4:57:40, 11.65s/it] 53%|█████▎    | 1718/3250 [6:26:57<4:56:16, 11.60s/it] 53%|█████▎    | 1719/3250 [6:27:09<4:55:23, 11.58s/it] 53%|█████▎    | 1720/3250 [6:27:20<4:50:15, 11.38s/it]                                                       {'loss': 1.4022, 'grad_norm': 0.5416896939277649, 'learning_rate': 0.005, 'epoch': 5.28, 'num_input_tokens_seen': 19506976}
 53%|█████▎    | 1720/3250 [6:27:20<4:50:15, 11.38s/it] 53%|█████▎    | 1721/3250 [6:27:31<4:51:25, 11.44s/it] 53%|█████▎    | 1722/3250 [6:27:42<4:50:36, 11.41s/it] 53%|█████▎    | 1723/3250 [6:27:54<4:49:34, 11.38s/it] 53%|█████▎    | 1724/3250 [6:28:05<4:47:55, 11.32s/it] 53%|█████▎    | 1725/3250 [6:28:17<4:49:29, 11.39s/it]                                                       {'loss': 1.4043, 'grad_norm': 3.730839729309082, 'learning_rate': 0.005, 'epoch': 5.3, 'num_input_tokens_seen': 19562432}
 53%|█████▎    | 1725/3250 [6:28:17<4:49:29, 11.39s/it] 53%|█████▎    | 1726/3250 [6:28:28<4:50:05, 11.42s/it] 53%|█████▎    | 1727/3250 [6:28:39<4:49:46, 11.42s/it] 53%|█████▎    | 1728/3250 [6:28:51<4:51:39, 11.50s/it] 53%|█████▎    | 1729/3250 [6:29:03<4:52:04, 11.52s/it] 53%|█████▎    | 1730/3250 [6:29:14<4:50:04, 11.45s/it]                                                       {'loss': 1.4493, 'grad_norm': 0.677564263343811, 'learning_rate': 0.005, 'epoch': 5.31, 'num_input_tokens_seen': 19619488}
 53%|█████▎    | 1730/3250 [6:29:14<4:50:04, 11.45s/it] 53%|█████▎    | 1731/3250 [6:29:25<4:49:29, 11.43s/it] 53%|█████▎    | 1732/3250 [6:29:37<4:47:50, 11.38s/it] 53%|█████▎    | 1733/3250 [6:29:48<4:48:46, 11.42s/it] 53%|█████▎    | 1734/3250 [6:30:00<4:49:23, 11.45s/it] 53%|█████▎    | 1735/3250 [6:30:11<4:50:21, 11.50s/it]                                                       {'loss': 1.4573, 'grad_norm': 0.4321993291378021, 'learning_rate': 0.005, 'epoch': 5.33, 'num_input_tokens_seen': 19676832}
 53%|█████▎    | 1735/3250 [6:30:11<4:50:21, 11.50s/it] 53%|█████▎    | 1736/3250 [6:30:23<4:48:43, 11.44s/it] 53%|█████▎    | 1737/3250 [6:30:34<4:48:38, 11.45s/it] 53%|█████▎    | 1738/3250 [6:30:46<4:50:35, 11.53s/it] 54%|█████▎    | 1739/3250 [6:30:57<4:49:17, 11.49s/it] 54%|█████▎    | 1740/3250 [6:31:08<4:47:52, 11.44s/it]                                                       {'loss': 1.5252, 'grad_norm': 0.7386429309844971, 'learning_rate': 0.005, 'epoch': 5.35, 'num_input_tokens_seen': 19734016}
 54%|█████▎    | 1740/3250 [6:31:08<4:47:52, 11.44s/it] 54%|█████▎    | 1741/3250 [6:31:20<4:48:10, 11.46s/it] 54%|█████▎    | 1742/3250 [6:31:32<4:48:42, 11.49s/it] 54%|█████▎    | 1743/3250 [6:31:43<4:46:42, 11.41s/it] 54%|█████▎    | 1744/3250 [6:31:54<4:47:13, 11.44s/it] 54%|█████▎    | 1745/3250 [6:32:06<4:48:17, 11.49s/it]                                                       {'loss': 1.8593, 'grad_norm': 0.8680492639541626, 'learning_rate': 0.005, 'epoch': 5.36, 'num_input_tokens_seen': 19790528}
 54%|█████▎    | 1745/3250 [6:32:06<4:48:17, 11.49s/it] 54%|█████▎    | 1746/3250 [6:32:17<4:47:58, 11.49s/it] 54%|█████▍    | 1747/3250 [6:32:29<4:46:54, 11.45s/it] 54%|█████▍    | 1748/3250 [6:32:40<4:45:07, 11.39s/it] 54%|█████▍    | 1749/3250 [6:32:52<4:46:04, 11.44s/it] 54%|█████▍    | 1750/3250 [6:33:03<4:45:52, 11.43s/it]                                                       {'loss': 1.8166, 'grad_norm': 1.1655864715576172, 'learning_rate': 0.005, 'epoch': 5.38, 'num_input_tokens_seen': 19847776}
 54%|█████▍    | 1750/3250 [6:33:03<4:45:52, 11.43s/it] 54%|█████▍    | 1751/3250 [6:33:14<4:45:36, 11.43s/it] 54%|█████▍    | 1752/3250 [6:33:26<4:44:41, 11.40s/it] 54%|█████▍    | 1753/3250 [6:33:37<4:43:37, 11.37s/it] 54%|█████▍    | 1754/3250 [6:33:48<4:42:44, 11.34s/it] 54%|█████▍    | 1755/3250 [6:34:00<4:43:27, 11.38s/it]                                                       {'loss': 1.8579, 'grad_norm': 0.5108492970466614, 'learning_rate': 0.005, 'epoch': 5.39, 'num_input_tokens_seen': 19903776}
 54%|█████▍    | 1755/3250 [6:34:00<4:43:27, 11.38s/it] 54%|█████▍    | 1756/3250 [6:34:11<4:42:51, 11.36s/it] 54%|█████▍    | 1757/3250 [6:34:23<4:43:19, 11.39s/it] 54%|█████▍    | 1758/3250 [6:34:34<4:41:51, 11.34s/it] 54%|█████▍    | 1759/3250 [6:34:45<4:42:51, 11.38s/it] 54%|█████▍    | 1760/3250 [6:34:57<4:42:41, 11.38s/it]                                                       {'loss': 1.7803, 'grad_norm': 0.8566980361938477, 'learning_rate': 0.005, 'epoch': 5.41, 'num_input_tokens_seen': 19959744}
 54%|█████▍    | 1760/3250 [6:34:57<4:42:41, 11.38s/it] 54%|█████▍    | 1761/3250 [6:35:08<4:41:45, 11.35s/it] 54%|█████▍    | 1762/3250 [6:35:20<4:44:29, 11.47s/it] 54%|█████▍    | 1763/3250 [6:35:31<4:44:35, 11.48s/it] 54%|█████▍    | 1764/3250 [6:35:43<4:43:27, 11.45s/it] 54%|█████▍    | 1765/3250 [6:35:54<4:43:14, 11.44s/it]                                                       {'loss': 1.7413, 'grad_norm': 0.5086837410926819, 'learning_rate': 0.005, 'epoch': 5.42, 'num_input_tokens_seen': 20016544}
 54%|█████▍    | 1765/3250 [6:35:54<4:43:14, 11.44s/it] 54%|█████▍    | 1766/3250 [6:36:05<4:42:56, 11.44s/it] 54%|█████▍    | 1767/3250 [6:36:17<4:45:00, 11.53s/it] 54%|█████▍    | 1768/3250 [6:36:29<4:45:32, 11.56s/it] 54%|█████▍    | 1769/3250 [6:36:40<4:45:31, 11.57s/it] 54%|█████▍    | 1770/3250 [6:36:52<4:45:36, 11.58s/it]                                                       {'loss': 1.7776, 'grad_norm': 0.6611051559448242, 'learning_rate': 0.005, 'epoch': 5.44, 'num_input_tokens_seen': 20074400}
 54%|█████▍    | 1770/3250 [6:36:52<4:45:36, 11.58s/it] 54%|█████▍    | 1771/3250 [6:37:03<4:40:47, 11.39s/it] 55%|█████▍    | 1772/3250 [6:37:15<4:42:39, 11.47s/it] 55%|█████▍    | 1773/3250 [6:37:26<4:42:19, 11.47s/it] 55%|█████▍    | 1774/3250 [6:37:37<4:38:53, 11.34s/it] 55%|█████▍    | 1775/3250 [6:37:48<4:39:09, 11.36s/it]                                                       {'loss': 1.6968, 'grad_norm': 0.5082600712776184, 'learning_rate': 0.005, 'epoch': 5.45, 'num_input_tokens_seen': 20129984}
 55%|█████▍    | 1775/3250 [6:37:48<4:39:09, 11.36s/it] 55%|█████▍    | 1776/3250 [6:37:59<4:36:27, 11.25s/it] 55%|█████▍    | 1777/3250 [6:38:11<4:37:13, 11.29s/it] 55%|█████▍    | 1778/3250 [6:38:22<4:37:54, 11.33s/it] 55%|█████▍    | 1779/3250 [6:38:34<4:38:45, 11.37s/it] 55%|█████▍    | 1780/3250 [6:38:45<4:39:43, 11.42s/it]                                                       {'loss': 1.7411, 'grad_norm': 5.656161308288574, 'learning_rate': 0.005, 'epoch': 5.47, 'num_input_tokens_seen': 20186496}
 55%|█████▍    | 1780/3250 [6:38:45<4:39:43, 11.42s/it] 55%|█████▍    | 1781/3250 [6:38:57<4:38:37, 11.38s/it] 55%|█████▍    | 1782/3250 [6:39:08<4:38:02, 11.36s/it] 55%|█████▍    | 1783/3250 [6:39:19<4:38:11, 11.38s/it] 55%|█████▍    | 1784/3250 [6:39:31<4:38:34, 11.40s/it] 55%|█████▍    | 1785/3250 [6:39:42<4:38:01, 11.39s/it]                                                       {'loss': 1.6604, 'grad_norm': 0.34282296895980835, 'learning_rate': 0.005, 'epoch': 5.48, 'num_input_tokens_seen': 20242528}
 55%|█████▍    | 1785/3250 [6:39:42<4:38:01, 11.39s/it] 55%|█████▍    | 1786/3250 [6:39:53<4:36:23, 11.33s/it] 55%|█████▍    | 1787/3250 [6:40:05<4:36:43, 11.35s/it] 55%|█████▌    | 1788/3250 [6:40:16<4:36:33, 11.35s/it] 55%|█████▌    | 1789/3250 [6:40:28<4:39:02, 11.46s/it] 55%|█████▌    | 1790/3250 [6:40:39<4:36:20, 11.36s/it]                                                       {'loss': 1.6857, 'grad_norm': 0.5231271982192993, 'learning_rate': 0.005, 'epoch': 5.5, 'num_input_tokens_seen': 20298784}
 55%|█████▌    | 1790/3250 [6:40:39<4:36:20, 11.36s/it] 55%|█████▌    | 1791/3250 [6:40:50<4:34:36, 11.29s/it] 55%|█████▌    | 1792/3250 [6:41:02<4:36:54, 11.40s/it] 55%|█████▌    | 1793/3250 [6:41:13<4:38:53, 11.48s/it] 55%|█████▌    | 1794/3250 [6:41:25<4:36:43, 11.40s/it] 55%|█████▌    | 1795/3250 [6:41:36<4:33:55, 11.30s/it]                                                       {'loss': 1.7817, 'grad_norm': 0.5402133464813232, 'learning_rate': 0.005, 'epoch': 5.51, 'num_input_tokens_seen': 20354880}
 55%|█████▌    | 1795/3250 [6:41:36<4:33:55, 11.30s/it] 55%|█████▌    | 1796/3250 [6:41:47<4:35:16, 11.36s/it] 55%|█████▌    | 1797/3250 [6:41:58<4:34:16, 11.33s/it] 55%|█████▌    | 1798/3250 [6:42:10<4:35:14, 11.37s/it] 55%|█████▌    | 1799/3250 [6:42:21<4:35:12, 11.38s/it] 55%|█████▌    | 1800/3250 [6:42:33<4:35:38, 11.41s/it]                                                       {'loss': 1.7891, 'grad_norm': 0.5655699372291565, 'learning_rate': 0.005, 'epoch': 5.53, 'num_input_tokens_seen': 20411904}
 55%|█████▌    | 1800/3250 [6:42:33<4:35:38, 11.41s/it][INFO|trainer.py:4021] 2024-10-11 11:34:36,312 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-10-11 11:34:36,312 >>   Num examples = 1157
[INFO|trainer.py:4026] 2024-10-11 11:34:36,313 >>   Batch size = 4

  0%|          | 0/145 [00:00<?, ?it/s][A
  1%|▏         | 2/145 [00:01<01:47,  1.33it/s][A
  2%|▏         | 3/145 [00:03<02:34,  1.09s/it][A
  3%|▎         | 4/145 [00:04<02:54,  1.24s/it][A
  3%|▎         | 5/145 [00:05<03:00,  1.29s/it][A
  4%|▍         | 6/145 [00:07<03:10,  1.37s/it][A
  5%|▍         | 7/145 [00:09<03:16,  1.43s/it][A
  6%|▌         | 8/145 [00:10<03:14,  1.42s/it][A
  6%|▌         | 9/145 [00:11<03:14,  1.43s/it][A
  7%|▋         | 10/145 [00:13<03:15,  1.45s/it][A
  8%|▊         | 11/145 [00:14<03:16,  1.47s/it][A
  8%|▊         | 12/145 [00:16<03:19,  1.50s/it][A
  9%|▉         | 13/145 [00:18<03:19,  1.52s/it][A
 10%|▉         | 14/145 [00:19<03:20,  1.53s/it][A
 10%|█         | 15/145 [00:21<03:17,  1.52s/it][A
 11%|█         | 16/145 [00:22<03:14,  1.51s/it][A
 12%|█▏        | 17/145 [00:24<03:13,  1.51s/it][A
 12%|█▏        | 18/145 [00:25<03:12,  1.52s/it][A
 13%|█▎        | 19/145 [00:27<03:11,  1.52s/it][A
 14%|█▍        | 20/145 [00:28<03:09,  1.52s/it][A
 14%|█▍        | 21/145 [00:30<03:05,  1.50s/it][A
 15%|█▌        | 22/145 [00:31<03:03,  1.49s/it][A
 16%|█▌        | 23/145 [00:33<03:01,  1.49s/it][A
 17%|█▋        | 24/145 [00:34<03:00,  1.49s/it][A
 17%|█▋        | 25/145 [00:36<02:59,  1.49s/it][A
 18%|█▊        | 26/145 [00:37<02:56,  1.49s/it][A
 19%|█▊        | 27/145 [00:39<02:56,  1.50s/it][A
 19%|█▉        | 28/145 [00:40<02:54,  1.49s/it][A
 20%|██        | 29/145 [00:41<02:52,  1.49s/it][A
 21%|██        | 30/145 [00:43<02:47,  1.45s/it][A
 21%|██▏       | 31/145 [00:44<02:47,  1.47s/it][A
 22%|██▏       | 32/145 [00:46<02:47,  1.48s/it][A
 23%|██▎       | 33/145 [00:47<02:46,  1.49s/it][A
 23%|██▎       | 34/145 [00:49<02:45,  1.49s/it][A
 24%|██▍       | 35/145 [00:50<02:44,  1.50s/it][A
 25%|██▍       | 36/145 [00:52<02:43,  1.50s/it][A
 26%|██▌       | 37/145 [00:53<02:45,  1.53s/it][A
 26%|██▌       | 38/145 [00:55<02:43,  1.53s/it][A
 27%|██▋       | 39/145 [00:57<02:40,  1.52s/it][A
 28%|██▊       | 40/145 [00:58<02:39,  1.52s/it][A
 28%|██▊       | 41/145 [01:00<02:39,  1.54s/it][A
 29%|██▉       | 42/145 [01:01<02:37,  1.53s/it][A
 30%|██▉       | 43/145 [01:03<02:34,  1.52s/it][A
 30%|███       | 44/145 [01:04<02:35,  1.54s/it][A
 31%|███       | 45/145 [01:06<02:35,  1.56s/it][A
 32%|███▏      | 46/145 [01:07<02:31,  1.53s/it][A
 32%|███▏      | 47/145 [01:09<02:28,  1.51s/it][A
 33%|███▎      | 48/145 [01:10<02:27,  1.52s/it][A
 34%|███▍      | 49/145 [01:12<02:26,  1.53s/it][A
 34%|███▍      | 50/145 [01:13<02:25,  1.53s/it][A
 35%|███▌      | 51/145 [01:15<02:24,  1.53s/it][A
 36%|███▌      | 52/145 [01:16<02:22,  1.53s/it][A
 37%|███▋      | 53/145 [01:18<02:20,  1.53s/it][A
 37%|███▋      | 54/145 [01:19<02:19,  1.53s/it][A
 38%|███▊      | 55/145 [01:21<02:16,  1.52s/it][A
 39%|███▊      | 56/145 [01:23<02:15,  1.52s/it][A
 39%|███▉      | 57/145 [01:24<02:12,  1.50s/it][A
 40%|████      | 58/145 [01:25<02:10,  1.50s/it][A
 41%|████      | 59/145 [01:27<02:11,  1.52s/it][A
 41%|████▏     | 60/145 [01:29<02:08,  1.51s/it][A
 42%|████▏     | 61/145 [01:30<02:06,  1.51s/it][A
 43%|████▎     | 62/145 [01:31<02:03,  1.49s/it][A
 43%|████▎     | 63/145 [01:33<02:03,  1.51s/it][A
 44%|████▍     | 64/145 [01:35<02:02,  1.51s/it][A
 45%|████▍     | 65/145 [01:36<02:01,  1.52s/it][A
 46%|████▌     | 66/145 [01:38<01:59,  1.52s/it][A
 46%|████▌     | 67/145 [01:39<01:57,  1.51s/it][A
 47%|████▋     | 68/145 [01:41<01:57,  1.53s/it][A
 48%|████▊     | 69/145 [01:42<01:56,  1.54s/it][A
 48%|████▊     | 70/145 [01:44<01:51,  1.49s/it][A
 49%|████▉     | 71/145 [01:45<01:49,  1.48s/it][A
 50%|████▉     | 72/145 [01:47<01:49,  1.50s/it][A
 50%|█████     | 73/145 [01:48<01:49,  1.52s/it][A
 51%|█████     | 74/145 [01:50<01:48,  1.53s/it][A
 52%|█████▏    | 75/145 [01:51<01:47,  1.53s/it][A
 52%|█████▏    | 76/145 [01:53<01:44,  1.52s/it][A
 53%|█████▎    | 77/145 [01:54<01:41,  1.49s/it][A
 54%|█████▍    | 78/145 [01:56<01:40,  1.49s/it][A
 54%|█████▍    | 79/145 [01:57<01:37,  1.48s/it][A
 55%|█████▌    | 80/145 [01:59<01:35,  1.47s/it][A
 56%|█████▌    | 81/145 [02:00<01:32,  1.45s/it][A
 57%|█████▋    | 82/145 [02:02<01:33,  1.48s/it][A
 57%|█████▋    | 83/145 [02:03<01:32,  1.49s/it][A
 58%|█████▊    | 84/145 [02:05<01:31,  1.50s/it][A
 59%|█████▊    | 85/145 [02:06<01:28,  1.48s/it][A
 59%|█████▉    | 86/145 [02:08<01:28,  1.49s/it][A
 60%|██████    | 87/145 [02:09<01:28,  1.52s/it][A
 61%|██████    | 88/145 [02:11<01:25,  1.49s/it][A
 61%|██████▏   | 89/145 [02:12<01:24,  1.50s/it][A
 62%|██████▏   | 90/145 [02:14<01:23,  1.51s/it][A
 63%|██████▎   | 91/145 [02:15<01:21,  1.51s/it][A
 63%|██████▎   | 92/145 [02:17<01:19,  1.51s/it][A
 64%|██████▍   | 93/145 [02:18<01:17,  1.49s/it][A
 65%|██████▍   | 94/145 [02:19<01:15,  1.48s/it][A
 66%|██████▌   | 95/145 [02:21<01:14,  1.49s/it][A
 66%|██████▌   | 96/145 [02:23<01:13,  1.50s/it][A
 67%|██████▋   | 97/145 [02:24<01:12,  1.51s/it][A
 68%|██████▊   | 98/145 [02:26<01:12,  1.54s/it][A
 68%|██████▊   | 99/145 [02:27<01:09,  1.51s/it][A
 69%|██████▉   | 100/145 [02:29<01:08,  1.52s/it][A
 70%|██████▉   | 101/145 [02:30<01:07,  1.53s/it][A
 70%|███████   | 102/145 [02:32<01:05,  1.52s/it][A
 71%|███████   | 103/145 [02:33<01:03,  1.52s/it][A
 72%|███████▏  | 104/145 [02:35<01:02,  1.52s/it][A
 72%|███████▏  | 105/145 [02:36<01:00,  1.52s/it][A
 73%|███████▎  | 106/145 [02:38<00:59,  1.52s/it][A
 74%|███████▍  | 107/145 [02:39<00:56,  1.48s/it][A
 74%|███████▍  | 108/145 [02:41<00:53,  1.45s/it][A
 75%|███████▌  | 109/145 [02:42<00:53,  1.48s/it][A
 76%|███████▌  | 110/145 [02:44<00:52,  1.50s/it][A
 77%|███████▋  | 111/145 [02:45<00:49,  1.47s/it][A
 77%|███████▋  | 112/145 [02:47<00:49,  1.49s/it][A
 78%|███████▊  | 113/145 [02:48<00:48,  1.51s/it][A
 79%|███████▊  | 114/145 [02:50<00:47,  1.52s/it][A
 79%|███████▉  | 115/145 [02:51<00:45,  1.52s/it][A
 80%|████████  | 116/145 [02:53<00:43,  1.49s/it][A
 81%|████████  | 117/145 [02:54<00:41,  1.49s/it][A
 81%|████████▏ | 118/145 [02:56<00:40,  1.49s/it][A
 82%|████████▏ | 119/145 [02:57<00:37,  1.45s/it][A
 83%|████████▎ | 120/145 [02:58<00:35,  1.44s/it][A
 83%|████████▎ | 121/145 [03:00<00:34,  1.44s/it][A
 84%|████████▍ | 122/145 [03:01<00:33,  1.45s/it][A
 85%|████████▍ | 123/145 [03:03<00:32,  1.47s/it][A
 86%|████████▌ | 124/145 [03:04<00:30,  1.45s/it][A
 86%|████████▌ | 125/145 [03:06<00:30,  1.51s/it][A
 87%|████████▋ | 126/145 [03:07<00:28,  1.49s/it][A
 88%|████████▊ | 127/145 [03:09<00:26,  1.49s/it][A
 88%|████████▊ | 128/145 [03:10<00:25,  1.51s/it][A
 89%|████████▉ | 129/145 [03:12<00:24,  1.51s/it][A
 90%|████████▉ | 130/145 [03:13<00:23,  1.54s/it][A
 90%|█████████ | 131/145 [03:15<00:20,  1.49s/it][A
 91%|█████████ | 132/145 [03:16<00:19,  1.51s/it][A
 92%|█████████▏| 133/145 [03:18<00:17,  1.48s/it][A
 92%|█████████▏| 134/145 [03:19<00:16,  1.52s/it][A
 93%|█████████▎| 135/145 [03:21<00:15,  1.52s/it][A
 94%|█████████▍| 136/145 [03:22<00:13,  1.51s/it][A
 94%|█████████▍| 137/145 [03:24<00:12,  1.50s/it][A
 95%|█████████▌| 138/145 [03:25<00:10,  1.52s/it][A
 96%|█████████▌| 139/145 [03:27<00:09,  1.51s/it][A
 97%|█████████▋| 140/145 [03:28<00:07,  1.52s/it][A
 97%|█████████▋| 141/145 [03:30<00:06,  1.52s/it][A
 98%|█████████▊| 142/145 [03:31<00:04,  1.51s/it][A
 99%|█████████▊| 143/145 [03:33<00:02,  1.50s/it][A
 99%|█████████▉| 144/145 [03:34<00:01,  1.51s/it][A
100%|██████████| 145/145 [03:36<00:00,  1.48s/it][A
                                                 [A                                                       {'eval_loss': 1.6033382415771484, 'eval_runtime': 218.0663, 'eval_samples_per_second': 5.306, 'eval_steps_per_second': 0.665, 'epoch': 5.53, 'num_input_tokens_seen': 20411904}

100%|██████████| 145/145 [03:36<00:00,  1.48s/it][A 55%|█████▌    | 1800/3250 [6:46:11<4:35:38, 11.41s/it]
                                                 [A[INFO|trainer.py:3705] 2024-10-11 11:38:14,381 >> Saving model checkpoint to /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1800
[INFO|configuration_utils.py:672] 2024-10-11 11:38:15,785 >> loading configuration file config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/config.json
[WARNING|modeling_rope_utils.py:379] 2024-10-11 11:38:15,785 >> Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
[INFO|configuration_utils.py:739] 2024-10-11 11:38:15,787 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 3584,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 18944,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 28,
  "num_hidden_layers": 28,
  "num_key_value_heads": 4,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.0",
  "use_cache": true,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "in_chans": 3,
    "model_type": "qwen2_vl",
    "spatial_patch_size": 14
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 152064
}

[INFO|tokenization_utils_base.py:2649] 2024-10-11 11:38:15,864 >> tokenizer config file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1800/tokenizer_config.json
[INFO|tokenization_utils_base.py:2658] 2024-10-11 11:38:15,865 >> Special tokens file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1800/special_tokens_map.json
[INFO|image_processing_base.py:258] 2024-10-11 11:38:16,372 >> Image processor saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1800/preprocessor_config.json
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 55%|█████▌    | 1801/3250 [6:46:24<31:10:13, 77.44s/it] 55%|█████▌    | 1802/3250 [6:46:35<23:09:06, 57.56s/it] 55%|█████▌    | 1803/3250 [6:46:47<17:34:15, 43.71s/it] 56%|█████▌    | 1804/3250 [6:46:58<13:41:16, 34.08s/it] 56%|█████▌    | 1805/3250 [6:47:10<10:58:48, 27.36s/it]                                                        {'loss': 1.659, 'grad_norm': 0.5557082295417786, 'learning_rate': 0.005, 'epoch': 5.55, 'num_input_tokens_seen': 20468672}
 56%|█████▌    | 1805/3250 [6:47:10<10:58:48, 27.36s/it] 56%|█████▌    | 1806/3250 [6:47:22<9:06:00, 22.69s/it]  56%|█████▌    | 1807/3250 [6:47:33<7:45:11, 19.34s/it] 56%|█████▌    | 1808/3250 [6:47:45<6:49:03, 17.02s/it] 56%|█████▌    | 1809/3250 [6:47:57<6:09:45, 15.40s/it] 56%|█████▌    | 1810/3250 [6:48:08<5:42:00, 14.25s/it]                                                       {'loss': 1.623, 'grad_norm': 0.5022408962249756, 'learning_rate': 0.005, 'epoch': 5.56, 'num_input_tokens_seen': 20526784}
 56%|█████▌    | 1810/3250 [6:48:08<5:42:00, 14.25s/it] 56%|█████▌    | 1811/3250 [6:48:20<5:23:18, 13.48s/it] 56%|█████▌    | 1812/3250 [6:48:31<5:08:19, 12.86s/it] 56%|█████▌    | 1813/3250 [6:48:43<4:58:46, 12.48s/it] 56%|█████▌    | 1814/3250 [6:48:55<4:52:58, 12.24s/it] 56%|█████▌    | 1815/3250 [6:49:06<4:46:37, 11.98s/it]                                                       {'loss': 1.6596, 'grad_norm': 0.7326306104660034, 'learning_rate': 0.005, 'epoch': 5.58, 'num_input_tokens_seen': 20584608}
 56%|█████▌    | 1815/3250 [6:49:06<4:46:37, 11.98s/it] 56%|█████▌    | 1816/3250 [6:49:17<4:42:36, 11.82s/it] 56%|█████▌    | 1817/3250 [6:49:29<4:43:03, 11.85s/it] 56%|█████▌    | 1818/3250 [6:49:41<4:40:17, 11.74s/it] 56%|█████▌    | 1819/3250 [6:49:52<4:38:06, 11.66s/it] 56%|█████▌    | 1820/3250 [6:50:04<4:36:44, 11.61s/it]                                                       {'loss': 1.8755, 'grad_norm': 0.3529454171657562, 'learning_rate': 0.005, 'epoch': 5.59, 'num_input_tokens_seen': 20641184}
 56%|█████▌    | 1820/3250 [6:50:04<4:36:44, 11.61s/it] 56%|█████▌    | 1821/3250 [6:50:15<4:35:17, 11.56s/it] 56%|█████▌    | 1822/3250 [6:50:26<4:32:10, 11.44s/it] 56%|█████▌    | 1823/3250 [6:50:38<4:32:32, 11.46s/it] 56%|█████▌    | 1824/3250 [6:50:49<4:32:23, 11.46s/it] 56%|█████▌    | 1825/3250 [6:51:01<4:33:18, 11.51s/it]                                                       {'loss': 1.999, 'grad_norm': 0.7645003795623779, 'learning_rate': 0.005, 'epoch': 5.61, 'num_input_tokens_seen': 20697728}
 56%|█████▌    | 1825/3250 [6:51:01<4:33:18, 11.51s/it] 56%|█████▌    | 1826/3250 [6:51:12<4:32:28, 11.48s/it] 56%|█████▌    | 1827/3250 [6:51:24<4:33:09, 11.52s/it] 56%|█████▌    | 1828/3250 [6:51:35<4:32:17, 11.49s/it] 56%|█████▋    | 1829/3250 [6:51:47<4:32:38, 11.51s/it] 56%|█████▋    | 1830/3250 [6:51:58<4:31:55, 11.49s/it]                                                       {'loss': 1.8345, 'grad_norm': 0.6482241153717041, 'learning_rate': 0.005, 'epoch': 5.62, 'num_input_tokens_seen': 20754976}
 56%|█████▋    | 1830/3250 [6:51:58<4:31:55, 11.49s/it] 56%|█████▋    | 1831/3250 [6:52:10<4:32:25, 11.52s/it] 56%|█████▋    | 1832/3250 [6:52:21<4:31:25, 11.48s/it] 56%|█████▋    | 1833/3250 [6:52:33<4:32:15, 11.53s/it] 56%|█████▋    | 1834/3250 [6:52:44<4:29:51, 11.43s/it] 56%|█████▋    | 1835/3250 [6:52:56<4:32:04, 11.54s/it]                                                       {'loss': 1.9434, 'grad_norm': 0.7368680834770203, 'learning_rate': 0.005, 'epoch': 5.64, 'num_input_tokens_seen': 20812192}
 56%|█████▋    | 1835/3250 [6:52:56<4:32:04, 11.54s/it] 56%|█████▋    | 1836/3250 [6:53:07<4:28:42, 11.40s/it] 57%|█████▋    | 1837/3250 [6:53:18<4:25:06, 11.26s/it] 57%|█████▋    | 1838/3250 [6:53:29<4:26:07, 11.31s/it] 57%|█████▋    | 1839/3250 [6:53:41<4:24:46, 11.26s/it] 57%|█████▋    | 1840/3250 [6:53:52<4:25:23, 11.29s/it]                                                       {'loss': 1.7908, 'grad_norm': 0.4609431028366089, 'learning_rate': 0.005, 'epoch': 5.65, 'num_input_tokens_seen': 20867168}
 57%|█████▋    | 1840/3250 [6:53:52<4:25:23, 11.29s/it] 57%|█████▋    | 1841/3250 [6:54:03<4:24:24, 11.26s/it] 57%|█████▋    | 1842/3250 [6:54:15<4:27:13, 11.39s/it] 57%|█████▋    | 1843/3250 [6:54:26<4:28:57, 11.47s/it] 57%|█████▋    | 1844/3250 [6:54:38<4:29:44, 11.51s/it] 57%|█████▋    | 1845/3250 [6:54:50<4:31:30, 11.59s/it]                                                       {'loss': 1.927, 'grad_norm': 0.8153308629989624, 'learning_rate': 0.005, 'epoch': 5.67, 'num_input_tokens_seen': 20923584}
 57%|█████▋    | 1845/3250 [6:54:50<4:31:30, 11.59s/it] 57%|█████▋    | 1846/3250 [6:55:01<4:29:10, 11.50s/it] 57%|█████▋    | 1847/3250 [6:55:13<4:29:48, 11.54s/it] 57%|█████▋    | 1848/3250 [6:55:25<4:30:53, 11.59s/it] 57%|█████▋    | 1849/3250 [6:55:36<4:31:18, 11.62s/it] 57%|█████▋    | 1850/3250 [6:55:48<4:32:21, 11.67s/it]                                                       {'loss': 2.0102, 'grad_norm': 0.7367902994155884, 'learning_rate': 0.005, 'epoch': 5.68, 'num_input_tokens_seen': 20979776}
 57%|█████▋    | 1850/3250 [6:55:48<4:32:21, 11.67s/it] 57%|█████▋    | 1851/3250 [6:55:59<4:29:46, 11.57s/it] 57%|█████▋    | 1852/3250 [6:56:11<4:30:05, 11.59s/it] 57%|█████▋    | 1853/3250 [6:56:23<4:32:39, 11.71s/it] 57%|█████▋    | 1854/3250 [6:56:35<4:32:09, 11.70s/it] 57%|█████▋    | 1855/3250 [6:56:46<4:33:12, 11.75s/it]                                                       {'loss': 1.9528, 'grad_norm': 1.2421953678131104, 'learning_rate': 0.005, 'epoch': 5.7, 'num_input_tokens_seen': 21036288}
 57%|█████▋    | 1855/3250 [6:56:46<4:33:12, 11.75s/it] 57%|█████▋    | 1856/3250 [6:56:58<4:32:49, 11.74s/it] 57%|█████▋    | 1857/3250 [6:57:10<4:31:27, 11.69s/it] 57%|█████▋    | 1858/3250 [6:57:22<4:32:18, 11.74s/it] 57%|█████▋    | 1859/3250 [6:57:33<4:31:11, 11.70s/it] 57%|█████▋    | 1860/3250 [6:57:45<4:31:46, 11.73s/it]                                                       {'loss': 1.8333, 'grad_norm': 0.6261739730834961, 'learning_rate': 0.005, 'epoch': 5.71, 'num_input_tokens_seen': 21092960}
 57%|█████▋    | 1860/3250 [6:57:45<4:31:46, 11.73s/it] 57%|█████▋    | 1861/3250 [6:57:57<4:30:31, 11.69s/it] 57%|█████▋    | 1862/3250 [6:58:09<4:32:39, 11.79s/it] 57%|█████▋    | 1863/3250 [6:58:20<4:30:21, 11.70s/it] 57%|█████▋    | 1864/3250 [6:58:32<4:28:41, 11.63s/it] 57%|█████▋    | 1865/3250 [6:58:43<4:28:41, 11.64s/it]                                                       {'loss': 1.6903, 'grad_norm': 0.5906325578689575, 'learning_rate': 0.005, 'epoch': 5.73, 'num_input_tokens_seen': 21148576}
 57%|█████▋    | 1865/3250 [6:58:43<4:28:41, 11.64s/it] 57%|█████▋    | 1866/3250 [6:58:55<4:28:28, 11.64s/it] 57%|█████▋    | 1867/3250 [6:59:07<4:28:44, 11.66s/it] 57%|█████▋    | 1868/3250 [6:59:18<4:27:37, 11.62s/it] 58%|█████▊    | 1869/3250 [6:59:30<4:28:44, 11.68s/it] 58%|█████▊    | 1870/3250 [6:59:41<4:27:34, 11.63s/it]                                                       {'loss': 1.6646, 'grad_norm': 0.3896152377128601, 'learning_rate': 0.005, 'epoch': 5.75, 'num_input_tokens_seen': 21205760}
 58%|█████▊    | 1870/3250 [6:59:41<4:27:34, 11.63s/it] 58%|█████▊    | 1871/3250 [6:59:53<4:28:19, 11.67s/it] 58%|█████▊    | 1872/3250 [7:00:05<4:28:47, 11.70s/it] 58%|█████▊    | 1873/3250 [7:00:17<4:28:28, 11.70s/it] 58%|█████▊    | 1874/3250 [7:00:28<4:28:28, 11.71s/it] 58%|█████▊    | 1875/3250 [7:00:40<4:28:42, 11.73s/it]                                                       {'loss': 1.6672, 'grad_norm': 0.45760253071784973, 'learning_rate': 0.005, 'epoch': 5.76, 'num_input_tokens_seen': 21263808}
 58%|█████▊    | 1875/3250 [7:00:40<4:28:42, 11.73s/it] 58%|█████▊    | 1876/3250 [7:00:52<4:28:57, 11.74s/it] 58%|█████▊    | 1877/3250 [7:01:04<4:27:33, 11.69s/it] 58%|█████▊    | 1878/3250 [7:01:15<4:28:37, 11.75s/it] 58%|█████▊    | 1879/3250 [7:01:27<4:27:52, 11.72s/it] 58%|█████▊    | 1880/3250 [7:01:39<4:29:26, 11.80s/it]                                                       {'loss': 1.6049, 'grad_norm': 0.43790850043296814, 'learning_rate': 0.005, 'epoch': 5.78, 'num_input_tokens_seen': 21321440}
 58%|█████▊    | 1880/3250 [7:01:39<4:29:26, 11.80s/it] 58%|█████▊    | 1881/3250 [7:01:51<4:29:42, 11.82s/it] 58%|█████▊    | 1882/3250 [7:02:03<4:29:10, 11.81s/it] 58%|█████▊    | 1883/3250 [7:02:14<4:28:05, 11.77s/it] 58%|█████▊    | 1884/3250 [7:02:26<4:27:37, 11.76s/it] 58%|█████▊    | 1885/3250 [7:02:38<4:25:39, 11.68s/it]                                                       {'loss': 1.5877, 'grad_norm': 0.2867698073387146, 'learning_rate': 0.005, 'epoch': 5.79, 'num_input_tokens_seen': 21379072}
 58%|█████▊    | 1885/3250 [7:02:38<4:25:39, 11.68s/it] 58%|█████▊    | 1886/3250 [7:02:49<4:25:55, 11.70s/it] 58%|█████▊    | 1887/3250 [7:03:01<4:24:48, 11.66s/it] 58%|█████▊    | 1888/3250 [7:03:12<4:23:50, 11.62s/it] 58%|█████▊    | 1889/3250 [7:03:24<4:23:39, 11.62s/it] 58%|█████▊    | 1890/3250 [7:03:35<4:21:35, 11.54s/it]                                                       {'loss': 1.6608, 'grad_norm': 0.3247777223587036, 'learning_rate': 0.005, 'epoch': 5.81, 'num_input_tokens_seen': 21435040}
 58%|█████▊    | 1890/3250 [7:03:35<4:21:35, 11.54s/it] 58%|█████▊    | 1891/3250 [7:03:47<4:22:42, 11.60s/it] 58%|█████▊    | 1892/3250 [7:03:59<4:25:18, 11.72s/it] 58%|█████▊    | 1893/3250 [7:04:11<4:24:42, 11.70s/it] 58%|█████▊    | 1894/3250 [7:04:23<4:25:24, 11.74s/it] 58%|█████▊    | 1895/3250 [7:04:34<4:24:15, 11.70s/it]                                                       {'loss': 1.6266, 'grad_norm': 0.4530150890350342, 'learning_rate': 0.005, 'epoch': 5.82, 'num_input_tokens_seen': 21491744}
 58%|█████▊    | 1895/3250 [7:04:34<4:24:15, 11.70s/it] 58%|█████▊    | 1896/3250 [7:04:46<4:23:48, 11.69s/it] 58%|█████▊    | 1897/3250 [7:04:58<4:22:43, 11.65s/it] 58%|█████▊    | 1898/3250 [7:05:09<4:21:44, 11.62s/it] 58%|█████▊    | 1899/3250 [7:05:21<4:21:18, 11.60s/it] 58%|█████▊    | 1900/3250 [7:05:32<4:21:15, 11.61s/it]                                                       {'loss': 1.608, 'grad_norm': 0.27496033906936646, 'learning_rate': 0.005, 'epoch': 5.84, 'num_input_tokens_seen': 21547552}
 58%|█████▊    | 1900/3250 [7:05:32<4:21:15, 11.61s/it][INFO|trainer.py:4021] 2024-10-11 11:57:35,877 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-10-11 11:57:35,877 >>   Num examples = 1157
[INFO|trainer.py:4026] 2024-10-11 11:57:35,877 >>   Batch size = 4

  0%|          | 0/145 [00:00<?, ?it/s][A
  1%|▏         | 2/145 [00:01<01:47,  1.33it/s][A
  2%|▏         | 3/145 [00:03<02:34,  1.09s/it][A
  3%|▎         | 4/145 [00:04<02:53,  1.23s/it][A
  3%|▎         | 5/145 [00:05<02:59,  1.28s/it][A
  4%|▍         | 6/145 [00:07<03:09,  1.36s/it][A
  5%|▍         | 7/145 [00:08<03:15,  1.42s/it][A
  6%|▌         | 8/145 [00:10<03:14,  1.42s/it][A
  6%|▌         | 9/145 [00:11<03:13,  1.43s/it][A
  7%|▋         | 10/145 [00:13<03:15,  1.45s/it][A
  8%|▊         | 11/145 [00:14<03:16,  1.46s/it][A
  8%|▊         | 12/145 [00:16<03:18,  1.49s/it][A
  9%|▉         | 13/145 [00:17<03:19,  1.51s/it][A
 10%|▉         | 14/145 [00:19<03:20,  1.53s/it][A
 10%|█         | 15/145 [00:21<03:17,  1.52s/it][A
 11%|█         | 16/145 [00:22<03:14,  1.51s/it][A
 12%|█▏        | 17/145 [00:24<03:13,  1.51s/it][A
 12%|█▏        | 18/145 [00:25<03:11,  1.51s/it][A
 13%|█▎        | 19/145 [00:27<03:11,  1.52s/it][A
 14%|█▍        | 20/145 [00:28<03:09,  1.52s/it][A
 14%|█▍        | 21/145 [00:30<03:05,  1.50s/it][A
 15%|█▌        | 22/145 [00:31<03:02,  1.49s/it][A
 16%|█▌        | 23/145 [00:32<03:01,  1.49s/it][A
 17%|█▋        | 24/145 [00:34<03:00,  1.49s/it][A
 17%|█▋        | 25/145 [00:35<02:59,  1.50s/it][A
 18%|█▊        | 26/145 [00:37<02:57,  1.49s/it][A
 19%|█▊        | 27/145 [00:38<02:56,  1.50s/it][A
 19%|█▉        | 28/145 [00:40<02:54,  1.49s/it][A
 20%|██        | 29/145 [00:41<02:52,  1.49s/it][A
 21%|██        | 30/145 [00:43<02:46,  1.45s/it][A
 21%|██▏       | 31/145 [00:44<02:47,  1.47s/it][A
 22%|██▏       | 32/145 [00:46<02:46,  1.48s/it][A
 23%|██▎       | 33/145 [00:47<02:46,  1.49s/it][A
 23%|██▎       | 34/145 [00:49<02:45,  1.49s/it][A
 24%|██▍       | 35/145 [00:50<02:45,  1.50s/it][A
 25%|██▍       | 36/145 [00:52<02:43,  1.50s/it][A
 26%|██▌       | 37/145 [00:53<02:45,  1.53s/it][A
 26%|██▌       | 38/145 [00:55<02:43,  1.53s/it][A
 27%|██▋       | 39/145 [00:56<02:40,  1.52s/it][A
 28%|██▊       | 40/145 [00:58<02:39,  1.51s/it][A
 28%|██▊       | 41/145 [01:00<02:39,  1.54s/it][A
 29%|██▉       | 42/145 [01:01<02:38,  1.54s/it][A
 30%|██▉       | 43/145 [01:03<02:34,  1.52s/it][A
 30%|███       | 44/145 [01:04<02:35,  1.54s/it][A
 31%|███       | 45/145 [01:06<02:35,  1.56s/it][A
 32%|███▏      | 46/145 [01:07<02:31,  1.53s/it][A
 32%|███▏      | 47/145 [01:09<02:27,  1.50s/it][A
 33%|███▎      | 48/145 [01:10<02:26,  1.51s/it][A
 34%|███▍      | 49/145 [01:12<02:26,  1.52s/it][A
 34%|███▍      | 50/145 [01:13<02:25,  1.53s/it][A
 35%|███▌      | 51/145 [01:15<02:23,  1.53s/it][A
 36%|███▌      | 52/145 [01:16<02:21,  1.52s/it][A
 37%|███▋      | 53/145 [01:18<02:20,  1.52s/it][A
 37%|███▋      | 54/145 [01:19<02:19,  1.53s/it][A
 38%|███▊      | 55/145 [01:21<02:16,  1.52s/it][A
 39%|███▊      | 56/145 [01:22<02:15,  1.52s/it][A
 39%|███▉      | 57/145 [01:24<02:12,  1.50s/it][A
 40%|████      | 58/145 [01:25<02:09,  1.49s/it][A
 41%|████      | 59/145 [01:27<02:10,  1.52s/it][A
 41%|████▏     | 60/145 [01:28<02:08,  1.51s/it][A
 42%|████▏     | 61/145 [01:30<02:06,  1.51s/it][A
 43%|████▎     | 62/145 [01:31<02:03,  1.49s/it][A
 43%|████▎     | 63/145 [01:33<02:04,  1.51s/it][A
 44%|████▍     | 64/145 [01:34<02:02,  1.51s/it][A
 45%|████▍     | 65/145 [01:36<02:01,  1.52s/it][A
 46%|████▌     | 66/145 [01:37<01:59,  1.52s/it][A
 46%|████▌     | 67/145 [01:39<01:57,  1.50s/it][A
 47%|████▋     | 68/145 [01:41<01:57,  1.53s/it][A
 48%|████▊     | 69/145 [01:42<01:56,  1.54s/it][A
 48%|████▊     | 70/145 [01:43<01:51,  1.49s/it][A
 49%|████▉     | 71/145 [01:45<01:49,  1.48s/it][A
 50%|████▉     | 72/145 [01:46<01:48,  1.49s/it][A
 50%|█████     | 73/145 [01:48<01:49,  1.52s/it][A
 51%|█████     | 74/145 [01:50<01:48,  1.53s/it][A
 52%|█████▏    | 75/145 [01:51<01:47,  1.53s/it][A
 52%|█████▏    | 76/145 [01:53<01:45,  1.52s/it][A
 53%|█████▎    | 77/145 [01:54<01:41,  1.49s/it][A
 54%|█████▍    | 78/145 [01:56<01:40,  1.49s/it][A
 54%|█████▍    | 79/145 [01:57<01:37,  1.48s/it][A
 55%|█████▌    | 80/145 [01:58<01:35,  1.47s/it][A
 56%|█████▌    | 81/145 [02:00<01:33,  1.46s/it][A
 57%|█████▋    | 82/145 [02:01<01:33,  1.48s/it][A
 57%|█████▋    | 83/145 [02:03<01:32,  1.49s/it][A
 58%|█████▊    | 84/145 [02:04<01:31,  1.50s/it][A
 59%|█████▊    | 85/145 [02:06<01:28,  1.47s/it][A
 59%|█████▉    | 86/145 [02:07<01:28,  1.49s/it][A
 60%|██████    | 87/145 [02:09<01:28,  1.52s/it][A
 61%|██████    | 88/145 [02:10<01:25,  1.49s/it][A
 61%|██████▏   | 89/145 [02:12<01:24,  1.50s/it][A
 62%|██████▏   | 90/145 [02:13<01:23,  1.51s/it][A
 63%|██████▎   | 91/145 [02:15<01:21,  1.51s/it][A
 63%|██████▎   | 92/145 [02:16<01:19,  1.50s/it][A
 64%|██████▍   | 93/145 [02:18<01:17,  1.49s/it][A
 65%|██████▍   | 94/145 [02:19<01:15,  1.48s/it][A
 66%|██████▌   | 95/145 [02:21<01:14,  1.49s/it][A
 66%|██████▌   | 96/145 [02:22<01:13,  1.50s/it][A
 67%|██████▋   | 97/145 [02:24<01:12,  1.51s/it][A
 68%|██████▊   | 98/145 [02:26<01:12,  1.54s/it][A
 68%|██████▊   | 99/145 [02:27<01:09,  1.51s/it][A
 69%|██████▉   | 100/145 [02:29<01:08,  1.52s/it][A
 70%|██████▉   | 101/145 [02:30<01:07,  1.53s/it][A
 70%|███████   | 102/145 [02:32<01:05,  1.52s/it][A
 71%|███████   | 103/145 [02:33<01:03,  1.52s/it][A
 72%|███████▏  | 104/145 [02:35<01:02,  1.53s/it][A
 72%|███████▏  | 105/145 [02:36<01:01,  1.53s/it][A
 73%|███████▎  | 106/145 [02:38<00:59,  1.52s/it][A
 74%|███████▍  | 107/145 [02:39<00:56,  1.48s/it][A
 74%|███████▍  | 108/145 [02:40<00:53,  1.45s/it][A
 75%|███████▌  | 109/145 [02:42<00:53,  1.48s/it][A
 76%|███████▌  | 110/145 [02:44<00:52,  1.50s/it][A
 77%|███████▋  | 111/145 [02:45<00:49,  1.46s/it][A
 77%|███████▋  | 112/145 [02:47<00:49,  1.50s/it][A
 78%|███████▊  | 113/145 [02:48<00:48,  1.51s/it][A
 79%|███████▊  | 114/145 [02:50<00:47,  1.52s/it][A
 79%|███████▉  | 115/145 [02:51<00:45,  1.52s/it][A
 80%|████████  | 116/145 [02:53<00:43,  1.49s/it][A
 81%|████████  | 117/145 [02:54<00:41,  1.49s/it][A
 81%|████████▏ | 118/145 [02:56<00:40,  1.48s/it][A
 82%|████████▏ | 119/145 [02:57<00:37,  1.45s/it][A
 83%|████████▎ | 120/145 [02:58<00:35,  1.44s/it][A
 83%|████████▎ | 121/145 [03:00<00:34,  1.44s/it][A
 84%|████████▍ | 122/145 [03:01<00:33,  1.45s/it][A
 85%|████████▍ | 123/145 [03:03<00:32,  1.46s/it][A
 86%|████████▌ | 124/145 [03:04<00:30,  1.45s/it][A
 86%|████████▌ | 125/145 [03:06<00:30,  1.51s/it][A
 87%|████████▋ | 126/145 [03:07<00:28,  1.49s/it][A
 88%|████████▊ | 127/145 [03:09<00:26,  1.49s/it][A
 88%|████████▊ | 128/145 [03:10<00:25,  1.51s/it][A
 89%|████████▉ | 129/145 [03:12<00:24,  1.51s/it][A
 90%|████████▉ | 130/145 [03:13<00:23,  1.54s/it][A
 90%|█████████ | 131/145 [03:15<00:20,  1.49s/it][A
 91%|█████████ | 132/145 [03:16<00:19,  1.51s/it][A
 92%|█████████▏| 133/145 [03:18<00:17,  1.48s/it][A
 92%|█████████▏| 134/145 [03:19<00:16,  1.52s/it][A
 93%|█████████▎| 135/145 [03:21<00:15,  1.52s/it][A
 94%|█████████▍| 136/145 [03:22<00:13,  1.51s/it][A
 94%|█████████▍| 137/145 [03:24<00:12,  1.50s/it][A
 95%|█████████▌| 138/145 [03:25<00:10,  1.51s/it][A
 96%|█████████▌| 139/145 [03:27<00:09,  1.51s/it][A
 97%|█████████▋| 140/145 [03:28<00:07,  1.51s/it][A
 97%|█████████▋| 141/145 [03:30<00:06,  1.52s/it][A
 98%|█████████▊| 142/145 [03:31<00:04,  1.50s/it][A
 99%|█████████▊| 143/145 [03:33<00:02,  1.50s/it][A
 99%|█████████▉| 144/145 [03:34<00:01,  1.51s/it][A
100%|██████████| 145/145 [03:36<00:00,  1.48s/it][A
                                                 [A                                                       {'eval_loss': 1.5585134029388428, 'eval_runtime': 217.956, 'eval_samples_per_second': 5.308, 'eval_steps_per_second': 0.665, 'epoch': 5.84, 'num_input_tokens_seen': 21547552}

100%|██████████| 145/145 [03:36<00:00,  1.48s/it][A 58%|█████▊    | 1900/3250 [7:09:10<4:21:15, 11.61s/it]
                                                 [A[INFO|trainer.py:3705] 2024-10-11 12:01:13,835 >> Saving model checkpoint to /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1900
[INFO|configuration_utils.py:672] 2024-10-11 12:01:14,430 >> loading configuration file config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/config.json
[WARNING|modeling_rope_utils.py:379] 2024-10-11 12:01:14,431 >> Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
[INFO|configuration_utils.py:739] 2024-10-11 12:01:14,433 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 3584,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 18944,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 28,
  "num_hidden_layers": 28,
  "num_key_value_heads": 4,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.0",
  "use_cache": true,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "in_chans": 3,
    "model_type": "qwen2_vl",
    "spatial_patch_size": 14
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 152064
}

[INFO|tokenization_utils_base.py:2649] 2024-10-11 12:01:14,509 >> tokenizer config file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1900/tokenizer_config.json
[INFO|tokenization_utils_base.py:2658] 2024-10-11 12:01:14,510 >> Special tokens file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1900/special_tokens_map.json
[INFO|image_processing_base.py:258] 2024-10-11 12:01:15,004 >> Image processor saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-1900/preprocessor_config.json
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 58%|█████▊    | 1901/3250 [7:09:23<28:58:25, 77.32s/it] 59%|█████▊    | 1902/3250 [7:09:34<21:34:06, 57.60s/it] 59%|█████▊    | 1903/3250 [7:09:46<16:22:49, 43.78s/it] 59%|█████▊    | 1904/3250 [7:09:57<12:44:39, 34.09s/it] 59%|█████▊    | 1905/3250 [7:10:09<10:12:59, 27.35s/it]                                                        {'loss': 1.5988, 'grad_norm': 0.3956286609172821, 'learning_rate': 0.005, 'epoch': 5.85, 'num_input_tokens_seen': 21603200}
 59%|█████▊    | 1905/3250 [7:10:09<10:12:59, 27.35s/it] 59%|█████▊    | 1906/3250 [7:10:21<8:27:49, 22.67s/it]  59%|█████▊    | 1907/3250 [7:10:32<7:13:16, 19.36s/it] 59%|█████▊    | 1908/3250 [7:10:44<6:21:57, 17.08s/it] 59%|█████▊    | 1909/3250 [7:10:56<5:45:13, 15.45s/it] 59%|█████▉    | 1910/3250 [7:11:08<5:20:36, 14.36s/it]                                                       {'loss': 1.5816, 'grad_norm': 0.31993022561073303, 'learning_rate': 0.005, 'epoch': 5.87, 'num_input_tokens_seen': 21661280}
 59%|█████▉    | 1910/3250 [7:11:08<5:20:36, 14.36s/it] 59%|█████▉    | 1911/3250 [7:11:19<5:00:31, 13.47s/it] 59%|█████▉    | 1912/3250 [7:11:31<4:48:12, 12.92s/it] 59%|█████▉    | 1913/3250 [7:11:42<4:38:45, 12.51s/it] 59%|█████▉    | 1914/3250 [7:11:54<4:32:58, 12.26s/it] 59%|█████▉    | 1915/3250 [7:12:06<4:28:21, 12.06s/it]                                                       {'loss': 1.6688, 'grad_norm': 0.37088778614997864, 'learning_rate': 0.005, 'epoch': 5.88, 'num_input_tokens_seen': 21718624}
 59%|█████▉    | 1915/3250 [7:12:06<4:28:21, 12.06s/it] 59%|█████▉    | 1916/3250 [7:12:17<4:23:47, 11.86s/it] 59%|█████▉    | 1917/3250 [7:12:29<4:21:55, 11.79s/it] 59%|█████▉    | 1918/3250 [7:12:40<4:18:51, 11.66s/it] 59%|█████▉    | 1919/3250 [7:12:52<4:18:32, 11.65s/it] 59%|█████▉    | 1920/3250 [7:13:03<4:17:01, 11.60s/it]                                                       {'loss': 1.6693, 'grad_norm': 0.5549155473709106, 'learning_rate': 0.005, 'epoch': 5.9, 'num_input_tokens_seen': 21774656}
 59%|█████▉    | 1920/3250 [7:13:03<4:17:01, 11.60s/it] 59%|█████▉    | 1921/3250 [7:13:15<4:16:17, 11.57s/it] 59%|█████▉    | 1922/3250 [7:13:26<4:16:42, 11.60s/it] 59%|█████▉    | 1923/3250 [7:13:38<4:14:57, 11.53s/it] 59%|█████▉    | 1924/3250 [7:13:49<4:15:02, 11.54s/it] 59%|█████▉    | 1925/3250 [7:14:00<4:12:19, 11.43s/it]                                                       {'loss': 1.5948, 'grad_norm': 0.33991965651512146, 'learning_rate': 0.005, 'epoch': 5.91, 'num_input_tokens_seen': 21830656}
 59%|█████▉    | 1925/3250 [7:14:00<4:12:19, 11.43s/it] 59%|█████▉    | 1926/3250 [7:14:12<4:14:42, 11.54s/it] 59%|█████▉    | 1927/3250 [7:14:24<4:13:53, 11.51s/it] 59%|█████▉    | 1928/3250 [7:14:35<4:14:37, 11.56s/it] 59%|█████▉    | 1929/3250 [7:14:47<4:14:30, 11.56s/it] 59%|█████▉    | 1930/3250 [7:14:58<4:13:56, 11.54s/it]                                                       {'loss': 1.5025, 'grad_norm': 0.3259178102016449, 'learning_rate': 0.005, 'epoch': 5.93, 'num_input_tokens_seen': 21888192}
 59%|█████▉    | 1930/3250 [7:14:58<4:13:56, 11.54s/it] 59%|█████▉    | 1931/3250 [7:15:10<4:12:16, 11.48s/it] 59%|█████▉    | 1932/3250 [7:15:21<4:09:47, 11.37s/it] 59%|█████▉    | 1933/3250 [7:15:33<4:12:11, 11.49s/it] 60%|█████▉    | 1934/3250 [7:15:44<4:13:18, 11.55s/it] 60%|█████▉    | 1935/3250 [7:15:56<4:12:09, 11.51s/it]                                                       {'loss': 1.6223, 'grad_norm': 0.5271351933479309, 'learning_rate': 0.005, 'epoch': 5.94, 'num_input_tokens_seen': 21943360}
 60%|█████▉    | 1935/3250 [7:15:56<4:12:09, 11.51s/it] 60%|█████▉    | 1936/3250 [7:16:07<4:13:24, 11.57s/it] 60%|█████▉    | 1937/3250 [7:16:19<4:13:38, 11.59s/it] 60%|█████▉    | 1938/3250 [7:16:31<4:14:13, 11.63s/it] 60%|█████▉    | 1939/3250 [7:16:42<4:11:21, 11.50s/it] 60%|█████▉    | 1940/3250 [7:16:53<4:08:15, 11.37s/it]                                                       {'loss': 1.5815, 'grad_norm': 0.3444567620754242, 'learning_rate': 0.005, 'epoch': 5.96, 'num_input_tokens_seen': 21998528}
 60%|█████▉    | 1940/3250 [7:16:53<4:08:15, 11.37s/it] 60%|█████▉    | 1941/3250 [7:17:05<4:09:29, 11.44s/it] 60%|█████▉    | 1942/3250 [7:17:16<4:10:39, 11.50s/it] 60%|█████▉    | 1943/3250 [7:17:28<4:12:04, 11.57s/it] 60%|█████▉    | 1944/3250 [7:17:40<4:12:10, 11.59s/it] 60%|█████▉    | 1945/3250 [7:17:51<4:11:01, 11.54s/it]                                                       {'loss': 1.582, 'grad_norm': 0.8032941222190857, 'learning_rate': 0.005, 'epoch': 5.98, 'num_input_tokens_seen': 22054816}
 60%|█████▉    | 1945/3250 [7:17:51<4:11:01, 11.54s/it] 60%|█████▉    | 1946/3250 [7:18:03<4:11:19, 11.56s/it] 60%|█████▉    | 1947/3250 [7:18:14<4:10:31, 11.54s/it] 60%|█████▉    | 1948/3250 [7:18:26<4:10:15, 11.53s/it] 60%|█████▉    | 1949/3250 [7:18:37<4:10:51, 11.57s/it] 60%|██████    | 1950/3250 [7:18:49<4:12:43, 11.66s/it]                                                       {'loss': 1.5276, 'grad_norm': 0.5908264517784119, 'learning_rate': 0.005, 'epoch': 5.99, 'num_input_tokens_seen': 22111584}
 60%|██████    | 1950/3250 [7:18:49<4:12:43, 11.66s/it] 60%|██████    | 1951/3250 [7:19:01<4:12:47, 11.68s/it] 60%|██████    | 1952/3250 [7:19:12<4:11:23, 11.62s/it] 60%|██████    | 1953/3250 [7:19:24<4:10:42, 11.60s/it] 60%|██████    | 1954/3250 [7:19:36<4:12:22, 11.68s/it] 60%|██████    | 1955/3250 [7:19:47<4:10:44, 11.62s/it]                                                       {'loss': 1.5969, 'grad_norm': 0.5362610220909119, 'learning_rate': 0.005, 'epoch': 6.01, 'num_input_tokens_seen': 22168512}
 60%|██████    | 1955/3250 [7:19:47<4:10:44, 11.62s/it] 60%|██████    | 1956/3250 [7:19:59<4:10:54, 11.63s/it] 60%|██████    | 1957/3250 [7:20:10<4:09:00, 11.56s/it] 60%|██████    | 1958/3250 [7:20:22<4:08:39, 11.55s/it] 60%|██████    | 1959/3250 [7:20:34<4:09:49, 11.61s/it] 60%|██████    | 1960/3250 [7:20:45<4:10:42, 11.66s/it]                                                       {'loss': 1.5288, 'grad_norm': 0.44699931144714355, 'learning_rate': 0.005, 'epoch': 6.02, 'num_input_tokens_seen': 22225280}
 60%|██████    | 1960/3250 [7:20:45<4:10:42, 11.66s/it] 60%|██████    | 1961/3250 [7:20:57<4:11:39, 11.71s/it] 60%|██████    | 1962/3250 [7:21:09<4:11:01, 11.69s/it] 60%|██████    | 1963/3250 [7:21:20<4:10:05, 11.66s/it] 60%|██████    | 1964/3250 [7:21:32<4:09:15, 11.63s/it] 60%|██████    | 1965/3250 [7:21:44<4:08:50, 11.62s/it]                                                       {'loss': 1.5869, 'grad_norm': 0.389466255903244, 'learning_rate': 0.005, 'epoch': 6.04, 'num_input_tokens_seen': 22282176}
 60%|██████    | 1965/3250 [7:21:44<4:08:50, 11.62s/it] 60%|██████    | 1966/3250 [7:21:55<4:05:40, 11.48s/it] 61%|██████    | 1967/3250 [7:22:06<4:05:10, 11.47s/it] 61%|██████    | 1968/3250 [7:22:18<4:06:20, 11.53s/it] 61%|██████    | 1969/3250 [7:22:29<4:06:40, 11.55s/it] 61%|██████    | 1970/3250 [7:22:41<4:08:02, 11.63s/it]                                                       {'loss': 1.681, 'grad_norm': 0.3810771703720093, 'learning_rate': 0.005, 'epoch': 6.05, 'num_input_tokens_seen': 22337824}
 61%|██████    | 1970/3250 [7:22:41<4:08:02, 11.63s/it] 61%|██████    | 1971/3250 [7:22:53<4:08:21, 11.65s/it] 61%|██████    | 1972/3250 [7:23:05<4:10:04, 11.74s/it] 61%|██████    | 1973/3250 [7:23:17<4:10:20, 11.76s/it] 61%|██████    | 1974/3250 [7:23:28<4:08:30, 11.69s/it] 61%|██████    | 1975/3250 [7:23:40<4:08:41, 11.70s/it]                                                       {'loss': 1.5888, 'grad_norm': 0.3915150463581085, 'learning_rate': 0.005, 'epoch': 6.07, 'num_input_tokens_seen': 22395744}
 61%|██████    | 1975/3250 [7:23:40<4:08:41, 11.70s/it] 61%|██████    | 1976/3250 [7:23:51<4:06:47, 11.62s/it] 61%|██████    | 1977/3250 [7:24:03<4:08:14, 11.70s/it] 61%|██████    | 1978/3250 [7:24:15<4:09:54, 11.79s/it] 61%|██████    | 1979/3250 [7:24:27<4:10:36, 11.83s/it] 61%|██████    | 1980/3250 [7:24:39<4:09:49, 11.80s/it]                                                       {'loss': 1.6407, 'grad_norm': 0.42175614833831787, 'learning_rate': 0.005, 'epoch': 6.08, 'num_input_tokens_seen': 22452384}
 61%|██████    | 1980/3250 [7:24:39<4:09:49, 11.80s/it] 61%|██████    | 1981/3250 [7:24:51<4:09:53, 11.82s/it] 61%|██████    | 1982/3250 [7:25:03<4:09:18, 11.80s/it] 61%|██████    | 1983/3250 [7:25:14<4:09:36, 11.82s/it] 61%|██████    | 1984/3250 [7:25:26<4:09:24, 11.82s/it] 61%|██████    | 1985/3250 [7:25:38<4:10:13, 11.87s/it]                                                       {'loss': 1.7182, 'grad_norm': 0.5169247984886169, 'learning_rate': 0.005, 'epoch': 6.1, 'num_input_tokens_seen': 22510176}
 61%|██████    | 1985/3250 [7:25:38<4:10:13, 11.87s/it] 61%|██████    | 1986/3250 [7:25:50<4:08:59, 11.82s/it] 61%|██████    | 1987/3250 [7:26:02<4:08:24, 11.80s/it] 61%|██████    | 1988/3250 [7:26:14<4:08:38, 11.82s/it] 61%|██████    | 1989/3250 [7:26:25<4:07:54, 11.80s/it] 61%|██████    | 1990/3250 [7:26:37<4:07:10, 11.77s/it]                                                       {'loss': 1.6225, 'grad_norm': 0.42864879965782166, 'learning_rate': 0.005, 'epoch': 6.11, 'num_input_tokens_seen': 22567648}
 61%|██████    | 1990/3250 [7:26:37<4:07:10, 11.77s/it] 61%|██████▏   | 1991/3250 [7:26:49<4:06:21, 11.74s/it] 61%|██████▏   | 1992/3250 [7:27:00<4:05:40, 11.72s/it] 61%|██████▏   | 1993/3250 [7:27:12<4:05:30, 11.72s/it] 61%|██████▏   | 1994/3250 [7:27:23<4:03:10, 11.62s/it] 61%|██████▏   | 1995/3250 [7:27:35<4:02:54, 11.61s/it]                                                       {'loss': 1.7057, 'grad_norm': 0.467260479927063, 'learning_rate': 0.005, 'epoch': 6.13, 'num_input_tokens_seen': 22624256}
 61%|██████▏   | 1995/3250 [7:27:35<4:02:54, 11.61s/it] 61%|██████▏   | 1996/3250 [7:27:46<4:01:14, 11.54s/it] 61%|██████▏   | 1997/3250 [7:27:58<4:03:06, 11.64s/it] 61%|██████▏   | 1998/3250 [7:28:10<4:00:25, 11.52s/it] 62%|██████▏   | 1999/3250 [7:28:21<4:01:49, 11.60s/it] 62%|██████▏   | 2000/3250 [7:28:33<3:59:27, 11.49s/it]                                                       {'loss': 1.6276, 'grad_norm': 0.5317664742469788, 'learning_rate': 0.005, 'epoch': 6.14, 'num_input_tokens_seen': 22679904}
 62%|██████▏   | 2000/3250 [7:28:33<3:59:27, 11.49s/it][INFO|trainer.py:4021] 2024-10-11 12:20:36,153 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-10-11 12:20:36,154 >>   Num examples = 1157
[INFO|trainer.py:4026] 2024-10-11 12:20:36,154 >>   Batch size = 4

  0%|          | 0/145 [00:00<?, ?it/s][A
  1%|▏         | 2/145 [00:01<01:47,  1.33it/s][A
  2%|▏         | 3/145 [00:03<02:34,  1.09s/it][A
  3%|▎         | 4/145 [00:04<02:54,  1.24s/it][A
  3%|▎         | 5/145 [00:05<03:00,  1.29s/it][A
  4%|▍         | 6/145 [00:07<03:11,  1.38s/it][A
  5%|▍         | 7/145 [00:09<03:17,  1.43s/it][A
  6%|▌         | 8/145 [00:10<03:15,  1.43s/it][A
  6%|▌         | 9/145 [00:11<03:15,  1.43s/it][A
  7%|▋         | 10/145 [00:13<03:17,  1.46s/it][A
  8%|▊         | 11/145 [00:14<03:17,  1.47s/it][A
  8%|▊         | 12/145 [00:16<03:19,  1.50s/it][A
  9%|▉         | 13/145 [00:18<03:20,  1.52s/it][A
 10%|▉         | 14/145 [00:19<03:21,  1.54s/it][A
 10%|█         | 15/145 [00:21<03:18,  1.52s/it][A
 11%|█         | 16/145 [00:22<03:15,  1.51s/it][A
 12%|█▏        | 17/145 [00:24<03:14,  1.52s/it][A
 12%|█▏        | 18/145 [00:25<03:13,  1.52s/it][A
 13%|█▎        | 19/145 [00:27<03:12,  1.53s/it][A
 14%|█▍        | 20/145 [00:28<03:10,  1.53s/it][A
 14%|█▍        | 21/145 [00:30<03:06,  1.51s/it][A
 15%|█▌        | 22/145 [00:31<03:03,  1.49s/it][A
 16%|█▌        | 23/145 [00:33<03:01,  1.49s/it][A
 17%|█▋        | 24/145 [00:34<03:01,  1.50s/it][A
 17%|█▋        | 25/145 [00:36<03:00,  1.50s/it][A
 18%|█▊        | 26/145 [00:37<02:57,  1.50s/it][A
 19%|█▊        | 27/145 [00:39<02:57,  1.50s/it][A
 19%|█▉        | 28/145 [00:40<02:54,  1.49s/it][A
 20%|██        | 29/145 [00:42<02:53,  1.50s/it][A
 21%|██        | 30/145 [00:43<02:48,  1.46s/it][A
 21%|██▏       | 31/145 [00:45<02:48,  1.48s/it][A
 22%|██▏       | 32/145 [00:46<02:48,  1.49s/it][A
 23%|██▎       | 33/145 [00:48<02:47,  1.49s/it][A
 23%|██▎       | 34/145 [00:49<02:46,  1.50s/it][A
 24%|██▍       | 35/145 [00:51<02:46,  1.51s/it][A
 25%|██▍       | 36/145 [00:52<02:44,  1.51s/it][A
 26%|██▌       | 37/145 [00:54<02:46,  1.54s/it][A
 26%|██▌       | 38/145 [00:55<02:44,  1.54s/it][A
 27%|██▋       | 39/145 [00:57<02:41,  1.53s/it][A
 28%|██▊       | 40/145 [00:58<02:40,  1.53s/it][A
 28%|██▊       | 41/145 [01:00<02:40,  1.54s/it][A
 29%|██▉       | 42/145 [01:01<02:38,  1.54s/it][A
 30%|██▉       | 43/145 [01:03<02:35,  1.52s/it][A
 30%|███       | 44/145 [01:04<02:36,  1.55s/it][A
 31%|███       | 45/145 [01:06<02:36,  1.56s/it][A
 32%|███▏      | 46/145 [01:08<02:32,  1.54s/it][A
 32%|███▏      | 47/145 [01:09<02:28,  1.52s/it][A
 33%|███▎      | 48/145 [01:11<02:27,  1.52s/it][A
 34%|███▍      | 49/145 [01:12<02:26,  1.53s/it][A
 34%|███▍      | 50/145 [01:14<02:26,  1.54s/it][A
 35%|███▌      | 51/145 [01:15<02:24,  1.54s/it][A
 36%|███▌      | 52/145 [01:17<02:22,  1.54s/it][A
 37%|███▋      | 53/145 [01:18<02:21,  1.53s/it][A
 37%|███▋      | 54/145 [01:20<02:19,  1.54s/it][A
 38%|███▊      | 55/145 [01:21<02:17,  1.53s/it][A
 39%|███▊      | 56/145 [01:23<02:15,  1.53s/it][A
 39%|███▉      | 57/145 [01:24<02:12,  1.51s/it][A
 40%|████      | 58/145 [01:26<02:11,  1.51s/it][A
 41%|████      | 59/145 [01:27<02:11,  1.53s/it][A
 41%|████▏     | 60/145 [01:29<02:09,  1.52s/it][A
 42%|████▏     | 61/145 [01:30<02:07,  1.52s/it][A
 43%|████▎     | 62/145 [01:32<02:04,  1.50s/it][A
 43%|████▎     | 63/145 [01:33<02:04,  1.52s/it][A
 44%|████▍     | 64/145 [01:35<02:02,  1.52s/it][A
 45%|████▍     | 65/145 [01:37<02:02,  1.53s/it][A
 46%|████▌     | 66/145 [01:38<02:00,  1.53s/it][A
 46%|████▌     | 67/145 [01:40<01:58,  1.51s/it][A
 47%|████▋     | 68/145 [01:41<01:58,  1.54s/it][A
 48%|████▊     | 69/145 [01:43<01:57,  1.55s/it][A
 48%|████▊     | 70/145 [01:44<01:52,  1.50s/it][A
 49%|████▉     | 71/145 [01:46<01:50,  1.49s/it][A
 50%|████▉     | 72/145 [01:47<01:50,  1.51s/it][A
 50%|█████     | 73/145 [01:49<01:50,  1.53s/it][A
 51%|█████     | 74/145 [01:50<01:49,  1.54s/it][A
 52%|█████▏    | 75/145 [01:52<01:47,  1.54s/it][A
 52%|█████▏    | 76/145 [01:53<01:45,  1.53s/it][A
 53%|█████▎    | 77/145 [01:55<01:42,  1.50s/it][A
 54%|█████▍    | 78/145 [01:56<01:40,  1.50s/it][A
 54%|█████▍    | 79/145 [01:58<01:38,  1.49s/it][A
 55%|█████▌    | 80/145 [01:59<01:36,  1.49s/it][A
 56%|█████▌    | 81/145 [02:01<01:33,  1.47s/it][A
 57%|█████▋    | 82/145 [02:02<01:33,  1.49s/it][A
 57%|█████▋    | 83/145 [02:04<01:33,  1.50s/it][A
 58%|█████▊    | 84/145 [02:05<01:32,  1.51s/it][A
 59%|█████▊    | 85/145 [02:07<01:28,  1.48s/it][A
 59%|█████▉    | 86/145 [02:08<01:28,  1.50s/it][A
 60%|██████    | 87/145 [02:10<01:28,  1.53s/it][A
 61%|██████    | 88/145 [02:11<01:25,  1.50s/it][A
 61%|██████▏   | 89/145 [02:13<01:24,  1.51s/it][A
 62%|██████▏   | 90/145 [02:14<01:23,  1.52s/it][A
 63%|██████▎   | 91/145 [02:16<01:21,  1.51s/it][A
 63%|██████▎   | 92/145 [02:17<01:20,  1.51s/it][A
 64%|██████▍   | 93/145 [02:19<01:17,  1.49s/it][A
 65%|██████▍   | 94/145 [02:20<01:16,  1.49s/it][A
 66%|██████▌   | 95/145 [02:22<01:14,  1.50s/it][A
 66%|██████▌   | 96/145 [02:23<01:13,  1.51s/it][A
 67%|██████▋   | 97/145 [02:25<01:12,  1.52s/it][A
 68%|██████▊   | 98/145 [02:26<01:12,  1.55s/it][A
 68%|██████▊   | 99/145 [02:28<01:09,  1.52s/it][A
 69%|██████▉   | 100/145 [02:29<01:08,  1.53s/it][A
 70%|██████▉   | 101/145 [02:31<01:07,  1.54s/it][A
 70%|███████   | 102/145 [02:32<01:05,  1.53s/it][A
 71%|███████   | 103/145 [02:34<01:04,  1.53s/it][A
 72%|███████▏  | 104/145 [02:36<01:03,  1.54s/it][A
 72%|███████▏  | 105/145 [02:37<01:01,  1.53s/it][A
 73%|███████▎  | 106/145 [02:39<00:59,  1.53s/it][A
 74%|███████▍  | 107/145 [02:40<00:56,  1.48s/it][A
 74%|███████▍  | 108/145 [02:41<00:54,  1.46s/it][A
 75%|███████▌  | 109/145 [02:43<00:53,  1.48s/it][A
 76%|███████▌  | 110/145 [02:44<00:52,  1.51s/it][A
 77%|███████▋  | 111/145 [02:46<00:50,  1.47s/it][A
 77%|███████▋  | 112/145 [02:47<00:49,  1.50s/it][A
 78%|███████▊  | 113/145 [02:49<00:48,  1.52s/it][A
 79%|███████▊  | 114/145 [02:51<00:47,  1.53s/it][A
 79%|███████▉  | 115/145 [02:52<00:45,  1.53s/it][A
 80%|████████  | 116/145 [02:53<00:43,  1.49s/it][A
 81%|████████  | 117/145 [02:55<00:41,  1.50s/it][A
 81%|████████▏ | 118/145 [02:56<00:40,  1.49s/it][A
 82%|████████▏ | 119/145 [02:58<00:37,  1.46s/it][A
 83%|████████▎ | 120/145 [02:59<00:36,  1.44s/it][A
 83%|████████▎ | 121/145 [03:01<00:34,  1.44s/it][A
 84%|████████▍ | 122/145 [03:02<00:33,  1.46s/it][A
 85%|████████▍ | 123/145 [03:04<00:32,  1.47s/it][A
 86%|████████▌ | 124/145 [03:05<00:30,  1.46s/it][A
 86%|████████▌ | 125/145 [03:07<00:30,  1.52s/it][A
 87%|████████▋ | 126/145 [03:08<00:28,  1.50s/it][A
 88%|████████▊ | 127/145 [03:10<00:26,  1.49s/it][A
 88%|████████▊ | 128/145 [03:11<00:25,  1.52s/it][A
 89%|████████▉ | 129/145 [03:13<00:24,  1.52s/it][A
 90%|████████▉ | 130/145 [03:14<00:23,  1.55s/it][A
 90%|█████████ | 131/145 [03:16<00:21,  1.50s/it][A
 91%|█████████ | 132/145 [03:17<00:19,  1.52s/it][A
 92%|█████████▏| 133/145 [03:19<00:17,  1.49s/it][A
 92%|█████████▏| 134/145 [03:20<00:16,  1.53s/it][A
 93%|█████████▎| 135/145 [03:22<00:15,  1.53s/it][A
 94%|█████████▍| 136/145 [03:23<00:13,  1.52s/it][A
 94%|█████████▍| 137/145 [03:25<00:12,  1.51s/it][A
 95%|█████████▌| 138/145 [03:26<00:10,  1.52s/it][A
 96%|█████████▌| 139/145 [03:28<00:09,  1.52s/it][A
 97%|█████████▋| 140/145 [03:30<00:07,  1.53s/it][A
 97%|█████████▋| 141/145 [03:31<00:06,  1.53s/it][A
 98%|█████████▊| 142/145 [03:33<00:04,  1.51s/it][A
 99%|█████████▊| 143/145 [03:34<00:03,  1.50s/it][A
 99%|█████████▉| 144/145 [03:36<00:01,  1.52s/it][A
100%|██████████| 145/145 [03:37<00:00,  1.48s/it][A
                                                 [A                                                       {'eval_loss': 1.6016837358474731, 'eval_runtime': 219.1648, 'eval_samples_per_second': 5.279, 'eval_steps_per_second': 0.662, 'epoch': 6.14, 'num_input_tokens_seen': 22679904}

100%|██████████| 145/145 [03:37<00:00,  1.48s/it][A 62%|██████▏   | 2000/3250 [7:32:12<3:59:27, 11.49s/it]
                                                 [A[INFO|trainer.py:3705] 2024-10-11 12:24:15,320 >> Saving model checkpoint to /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2000
[INFO|configuration_utils.py:672] 2024-10-11 12:24:16,387 >> loading configuration file config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/config.json
[WARNING|modeling_rope_utils.py:379] 2024-10-11 12:24:16,388 >> Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
[INFO|configuration_utils.py:739] 2024-10-11 12:24:16,390 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 3584,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 18944,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 28,
  "num_hidden_layers": 28,
  "num_key_value_heads": 4,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.0",
  "use_cache": true,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "in_chans": 3,
    "model_type": "qwen2_vl",
    "spatial_patch_size": 14
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 152064
}

[INFO|tokenization_utils_base.py:2649] 2024-10-11 12:24:16,465 >> tokenizer config file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2000/tokenizer_config.json
[INFO|tokenization_utils_base.py:2658] 2024-10-11 12:24:16,466 >> Special tokens file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2000/special_tokens_map.json
[INFO|image_processing_base.py:258] 2024-10-11 12:24:16,952 >> Image processor saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2000/preprocessor_config.json
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 62%|██████▏   | 2001/3250 [7:32:25<26:58:36, 77.76s/it] 62%|██████▏   | 2002/3250 [7:32:37<20:04:42, 57.92s/it] 62%|██████▏   | 2003/3250 [7:32:48<15:13:00, 43.93s/it] 62%|██████▏   | 2004/3250 [7:33:00<11:52:59, 34.33s/it] 62%|██████▏   | 2005/3250 [7:33:11<9:30:50, 27.51s/it]                                                        {'loss': 1.6465, 'grad_norm': 0.5034136772155762, 'learning_rate': 0.005, 'epoch': 6.16, 'num_input_tokens_seen': 22735552}
 62%|██████▏   | 2005/3250 [7:33:11<9:30:50, 27.51s/it] 62%|██████▏   | 2006/3250 [7:33:23<7:52:59, 22.81s/it] 62%|██████▏   | 2007/3250 [7:33:35<6:43:12, 19.46s/it] 62%|██████▏   | 2008/3250 [7:33:47<5:55:07, 17.16s/it] 62%|██████▏   | 2009/3250 [7:33:58<5:20:06, 15.48s/it] 62%|██████▏   | 2010/3250 [7:34:10<4:57:09, 14.38s/it]                                                       {'loss': 1.6028, 'grad_norm': 0.32513007521629333, 'learning_rate': 0.005, 'epoch': 6.18, 'num_input_tokens_seen': 22792704}
 62%|██████▏   | 2010/3250 [7:34:10<4:57:09, 14.38s/it] 62%|██████▏   | 2011/3250 [7:34:21<4:38:54, 13.51s/it] 62%|██████▏   | 2012/3250 [7:34:33<4:28:37, 13.02s/it] 62%|██████▏   | 2013/3250 [7:34:45<4:21:18, 12.67s/it] 62%|██████▏   | 2014/3250 [7:34:57<4:14:36, 12.36s/it] 62%|██████▏   | 2015/3250 [7:35:08<4:09:28, 12.12s/it]                                                       {'loss': 1.6475, 'grad_norm': 0.2720314860343933, 'learning_rate': 0.005, 'epoch': 6.19, 'num_input_tokens_seen': 22848960}
 62%|██████▏   | 2015/3250 [7:35:08<4:09:28, 12.12s/it] 62%|██████▏   | 2016/3250 [7:35:20<4:04:53, 11.91s/it] 62%|██████▏   | 2017/3250 [7:35:31<4:01:45, 11.76s/it] 62%|██████▏   | 2018/3250 [7:35:43<4:02:13, 11.80s/it] 62%|██████▏   | 2019/3250 [7:35:55<4:01:46, 11.78s/it] 62%|██████▏   | 2020/3250 [7:36:07<4:01:35, 11.78s/it]                                                       {'loss': 1.5687, 'grad_norm': 0.4938652217388153, 'learning_rate': 0.005, 'epoch': 6.21, 'num_input_tokens_seen': 22905280}
 62%|██████▏   | 2020/3250 [7:36:07<4:01:35, 11.78s/it] 62%|██████▏   | 2021/3250 [7:36:18<3:58:59, 11.67s/it] 62%|██████▏   | 2022/3250 [7:36:30<3:57:54, 11.62s/it] 62%|██████▏   | 2023/3250 [7:36:41<3:57:57, 11.64s/it] 62%|██████▏   | 2024/3250 [7:36:53<3:59:05, 11.70s/it] 62%|██████▏   | 2025/3250 [7:37:04<3:56:29, 11.58s/it]                                                       {'loss': 1.5809, 'grad_norm': 0.7036150693893433, 'learning_rate': 0.005, 'epoch': 6.22, 'num_input_tokens_seen': 22961696}
 62%|██████▏   | 2025/3250 [7:37:04<3:56:29, 11.58s/it] 62%|██████▏   | 2026/3250 [7:37:16<3:57:40, 11.65s/it] 62%|██████▏   | 2027/3250 [7:37:28<3:57:54, 11.67s/it] 62%|██████▏   | 2028/3250 [7:37:40<3:58:14, 11.70s/it] 62%|██████▏   | 2029/3250 [7:37:51<3:58:40, 11.73s/it] 62%|██████▏   | 2030/3250 [7:38:03<3:58:24, 11.72s/it]                                                       {'loss': 1.5419, 'grad_norm': 0.42870813608169556, 'learning_rate': 0.005, 'epoch': 6.24, 'num_input_tokens_seen': 23019488}
 62%|██████▏   | 2030/3250 [7:38:03<3:58:24, 11.72s/it] 62%|██████▏   | 2031/3250 [7:38:15<3:58:18, 11.73s/it] 63%|██████▎   | 2032/3250 [7:38:27<3:58:19, 11.74s/it] 63%|██████▎   | 2033/3250 [7:38:38<3:57:20, 11.70s/it] 63%|██████▎   | 2034/3250 [7:38:50<3:57:21, 11.71s/it] 63%|██████▎   | 2035/3250 [7:39:02<3:55:46, 11.64s/it]                                                       {'loss': 1.554, 'grad_norm': 0.47867196798324585, 'learning_rate': 0.005, 'epoch': 6.25, 'num_input_tokens_seen': 23076576}
 63%|██████▎   | 2035/3250 [7:39:02<3:55:46, 11.64s/it] 63%|██████▎   | 2036/3250 [7:39:13<3:55:42, 11.65s/it] 63%|██████▎   | 2037/3250 [7:39:25<3:56:53, 11.72s/it] 63%|██████▎   | 2038/3250 [7:39:37<3:55:27, 11.66s/it] 63%|██████▎   | 2039/3250 [7:39:48<3:55:09, 11.65s/it] 63%|██████▎   | 2040/3250 [7:40:00<3:55:06, 11.66s/it]                                                       {'loss': 1.5138, 'grad_norm': 0.27496975660324097, 'learning_rate': 0.005, 'epoch': 6.27, 'num_input_tokens_seen': 23132864}
 63%|██████▎   | 2040/3250 [7:40:00<3:55:06, 11.66s/it] 63%|██████▎   | 2041/3250 [7:40:12<3:55:32, 11.69s/it] 63%|██████▎   | 2042/3250 [7:40:23<3:55:41, 11.71s/it] 63%|██████▎   | 2043/3250 [7:40:35<3:52:56, 11.58s/it] 63%|██████▎   | 2044/3250 [7:40:47<3:54:34, 11.67s/it] 63%|██████▎   | 2045/3250 [7:40:58<3:54:28, 11.67s/it]                                                       {'loss': 1.5646, 'grad_norm': 0.3485250771045685, 'learning_rate': 0.005, 'epoch': 6.28, 'num_input_tokens_seen': 23190112}
 63%|██████▎   | 2045/3250 [7:40:58<3:54:28, 11.67s/it] 63%|██████▎   | 2046/3250 [7:41:09<3:51:06, 11.52s/it] 63%|██████▎   | 2047/3250 [7:41:21<3:52:38, 11.60s/it] 63%|██████▎   | 2048/3250 [7:41:33<3:52:30, 11.61s/it] 63%|██████▎   | 2049/3250 [7:41:45<3:53:45, 11.68s/it] 63%|██████▎   | 2050/3250 [7:41:57<3:54:39, 11.73s/it]                                                       {'loss': 1.567, 'grad_norm': 0.42084696888923645, 'learning_rate': 0.005, 'epoch': 6.3, 'num_input_tokens_seen': 23246912}
 63%|██████▎   | 2050/3250 [7:41:57<3:54:39, 11.73s/it] 63%|██████▎   | 2051/3250 [7:42:08<3:54:17, 11.72s/it] 63%|██████▎   | 2052/3250 [7:42:20<3:53:07, 11.68s/it] 63%|██████▎   | 2053/3250 [7:42:31<3:52:19, 11.65s/it] 63%|██████▎   | 2054/3250 [7:42:43<3:52:40, 11.67s/it] 63%|██████▎   | 2055/3250 [7:42:55<3:51:39, 11.63s/it]                                                       {'loss': 1.5619, 'grad_norm': 0.42589449882507324, 'learning_rate': 0.005, 'epoch': 6.31, 'num_input_tokens_seen': 23303520}
 63%|██████▎   | 2055/3250 [7:42:55<3:51:39, 11.63s/it] 63%|██████▎   | 2056/3250 [7:43:06<3:50:23, 11.58s/it] 63%|██████▎   | 2057/3250 [7:43:18<3:51:37, 11.65s/it] 63%|██████▎   | 2058/3250 [7:43:30<3:52:15, 11.69s/it] 63%|██████▎   | 2059/3250 [7:43:41<3:51:21, 11.66s/it] 63%|██████▎   | 2060/3250 [7:43:53<3:52:47, 11.74s/it]                                                       {'loss': 1.5298, 'grad_norm': 0.5085076689720154, 'learning_rate': 0.005, 'epoch': 6.33, 'num_input_tokens_seen': 23360448}
 63%|██████▎   | 2060/3250 [7:43:53<3:52:47, 11.74s/it] 63%|██████▎   | 2061/3250 [7:44:05<3:53:40, 11.79s/it] 63%|██████▎   | 2062/3250 [7:44:17<3:53:54, 11.81s/it] 63%|██████▎   | 2063/3250 [7:44:29<3:52:09, 11.74s/it] 64%|██████▎   | 2064/3250 [7:44:40<3:50:58, 11.68s/it] 64%|██████▎   | 2065/3250 [7:44:52<3:52:21, 11.76s/it]                                                       {'loss': 1.5004, 'grad_norm': 0.3250269293785095, 'learning_rate': 0.005, 'epoch': 6.34, 'num_input_tokens_seen': 23418272}
 64%|██████▎   | 2065/3250 [7:44:52<3:52:21, 11.76s/it] 64%|██████▎   | 2066/3250 [7:45:04<3:52:09, 11.77s/it] 64%|██████▎   | 2067/3250 [7:45:16<3:52:14, 11.78s/it] 64%|██████▎   | 2068/3250 [7:45:27<3:50:58, 11.72s/it] 64%|██████▎   | 2069/3250 [7:45:39<3:50:52, 11.73s/it] 64%|██████▎   | 2070/3250 [7:45:51<3:49:56, 11.69s/it]                                                       {'loss': 1.4985, 'grad_norm': 0.4107348620891571, 'learning_rate': 0.005, 'epoch': 6.36, 'num_input_tokens_seen': 23474944}
 64%|██████▎   | 2070/3250 [7:45:51<3:49:56, 11.69s/it] 64%|██████▎   | 2071/3250 [7:46:02<3:49:15, 11.67s/it] 64%|██████▍   | 2072/3250 [7:46:14<3:50:16, 11.73s/it] 64%|██████▍   | 2073/3250 [7:46:26<3:48:51, 11.67s/it] 64%|██████▍   | 2074/3250 [7:46:37<3:48:57, 11.68s/it] 64%|██████▍   | 2075/3250 [7:46:49<3:49:55, 11.74s/it]                                                       {'loss': 1.5488, 'grad_norm': 0.5785093307495117, 'learning_rate': 0.005, 'epoch': 6.37, 'num_input_tokens_seen': 23532672}
 64%|██████▍   | 2075/3250 [7:46:49<3:49:55, 11.74s/it] 64%|██████▍   | 2076/3250 [7:47:01<3:49:08, 11.71s/it] 64%|██████▍   | 2077/3250 [7:47:13<3:49:56, 11.76s/it] 64%|██████▍   | 2078/3250 [7:47:24<3:49:13, 11.74s/it] 64%|██████▍   | 2079/3250 [7:47:36<3:46:44, 11.62s/it] 64%|██████▍   | 2080/3250 [7:47:47<3:44:55, 11.53s/it]                                                       {'loss': 1.4946, 'grad_norm': 0.48189377784729004, 'learning_rate': 0.005, 'epoch': 6.39, 'num_input_tokens_seen': 23588192}
 64%|██████▍   | 2080/3250 [7:47:47<3:44:55, 11.53s/it] 64%|██████▍   | 2081/3250 [7:47:58<3:43:27, 11.47s/it] 64%|██████▍   | 2082/3250 [7:48:10<3:46:00, 11.61s/it] 64%|██████▍   | 2083/3250 [7:48:22<3:46:15, 11.63s/it] 64%|██████▍   | 2084/3250 [7:48:34<3:47:29, 11.71s/it] 64%|██████▍   | 2085/3250 [7:48:46<3:47:04, 11.70s/it]                                                       {'loss': 1.6028, 'grad_norm': 0.18176500499248505, 'learning_rate': 0.005, 'epoch': 6.41, 'num_input_tokens_seen': 23645344}
 64%|██████▍   | 2085/3250 [7:48:46<3:47:04, 11.70s/it] 64%|██████▍   | 2086/3250 [7:48:57<3:46:16, 11.66s/it] 64%|██████▍   | 2087/3250 [7:49:09<3:45:42, 11.64s/it] 64%|██████▍   | 2088/3250 [7:49:20<3:44:31, 11.59s/it] 64%|██████▍   | 2089/3250 [7:49:32<3:44:09, 11.58s/it] 64%|██████▍   | 2090/3250 [7:49:43<3:42:36, 11.51s/it]                                                       {'loss': 1.5416, 'grad_norm': 0.5493407845497131, 'learning_rate': 0.005, 'epoch': 6.42, 'num_input_tokens_seen': 23700896}
 64%|██████▍   | 2090/3250 [7:49:43<3:42:36, 11.51s/it] 64%|██████▍   | 2091/3250 [7:49:55<3:42:14, 11.51s/it] 64%|██████▍   | 2092/3250 [7:50:06<3:42:43, 11.54s/it] 64%|██████▍   | 2093/3250 [7:50:18<3:43:06, 11.57s/it] 64%|██████▍   | 2094/3250 [7:50:30<3:43:32, 11.60s/it] 64%|██████▍   | 2095/3250 [7:50:41<3:43:42, 11.62s/it]                                                       {'loss': 1.6786, 'grad_norm': 0.5798735618591309, 'learning_rate': 0.005, 'epoch': 6.44, 'num_input_tokens_seen': 23757952}
 64%|██████▍   | 2095/3250 [7:50:41<3:43:42, 11.62s/it] 64%|██████▍   | 2096/3250 [7:50:53<3:43:58, 11.65s/it] 65%|██████▍   | 2097/3250 [7:51:04<3:40:56, 11.50s/it] 65%|██████▍   | 2098/3250 [7:51:16<3:43:05, 11.62s/it] 65%|██████▍   | 2099/3250 [7:51:27<3:41:52, 11.57s/it] 65%|██████▍   | 2100/3250 [7:51:39<3:41:47, 11.57s/it]                                                       {'loss': 1.6072, 'grad_norm': 0.682547926902771, 'learning_rate': 0.005, 'epoch': 6.45, 'num_input_tokens_seen': 23812928}
 65%|██████▍   | 2100/3250 [7:51:39<3:41:47, 11.57s/it][INFO|trainer.py:4021] 2024-10-11 12:43:42,628 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-10-11 12:43:42,628 >>   Num examples = 1157
[INFO|trainer.py:4026] 2024-10-11 12:43:42,628 >>   Batch size = 4

  0%|          | 0/145 [00:00<?, ?it/s][A
  1%|▏         | 2/145 [00:01<01:47,  1.33it/s][A
  2%|▏         | 3/145 [00:03<02:34,  1.09s/it][A
  3%|▎         | 4/145 [00:04<02:54,  1.24s/it][A
  3%|▎         | 5/145 [00:05<03:00,  1.29s/it][A
  4%|▍         | 6/145 [00:07<03:10,  1.37s/it][A
  5%|▍         | 7/145 [00:09<03:16,  1.42s/it][A
  6%|▌         | 8/145 [00:10<03:14,  1.42s/it][A
  6%|▌         | 9/145 [00:11<03:13,  1.43s/it][A
  7%|▋         | 10/145 [00:13<03:15,  1.45s/it][A
  8%|▊         | 11/145 [00:14<03:16,  1.47s/it][A
  8%|▊         | 12/145 [00:16<03:18,  1.49s/it][A
  9%|▉         | 13/145 [00:17<03:19,  1.51s/it][A
 10%|▉         | 14/145 [00:19<03:20,  1.53s/it][A
 10%|█         | 15/145 [00:21<03:17,  1.52s/it][A
 11%|█         | 16/145 [00:22<03:14,  1.51s/it][A
 12%|█▏        | 17/145 [00:24<03:13,  1.51s/it][A
 12%|█▏        | 18/145 [00:25<03:12,  1.51s/it][A
 13%|█▎        | 19/145 [00:27<03:11,  1.52s/it][A
 14%|█▍        | 20/145 [00:28<03:09,  1.52s/it][A
 14%|█▍        | 21/145 [00:30<03:05,  1.50s/it][A
 15%|█▌        | 22/145 [00:31<03:03,  1.49s/it][A
 16%|█▌        | 23/145 [00:32<03:01,  1.49s/it][A
 17%|█▋        | 24/145 [00:34<03:00,  1.49s/it][A
 17%|█▋        | 25/145 [00:36<02:59,  1.50s/it][A
 18%|█▊        | 26/145 [00:37<02:56,  1.49s/it][A
 19%|█▊        | 27/145 [00:38<02:56,  1.50s/it][A
 19%|█▉        | 28/145 [00:40<02:54,  1.49s/it][A
 20%|██        | 29/145 [00:41<02:52,  1.49s/it][A
 21%|██        | 30/145 [00:43<02:47,  1.45s/it][A
 21%|██▏       | 31/145 [00:44<02:47,  1.47s/it][A
 22%|██▏       | 32/145 [00:46<02:47,  1.48s/it][A
 23%|██▎       | 33/145 [00:47<02:46,  1.49s/it][A
 23%|██▎       | 34/145 [00:49<02:45,  1.49s/it][A
 24%|██▍       | 35/145 [00:50<02:44,  1.50s/it][A
 25%|██▍       | 36/145 [00:52<02:42,  1.49s/it][A
 26%|██▌       | 37/145 [00:53<02:45,  1.53s/it][A
 26%|██▌       | 38/145 [00:55<02:43,  1.53s/it][A
 27%|██▋       | 39/145 [00:56<02:41,  1.52s/it][A
 28%|██▊       | 40/145 [00:58<02:39,  1.52s/it][A
 28%|██▊       | 41/145 [01:00<02:40,  1.54s/it][A
 29%|██▉       | 42/145 [01:01<02:38,  1.54s/it][A
 30%|██▉       | 43/145 [01:03<02:34,  1.52s/it][A
 30%|███       | 44/145 [01:04<02:35,  1.54s/it][A
 31%|███       | 45/145 [01:06<02:35,  1.56s/it][A
 32%|███▏      | 46/145 [01:07<02:31,  1.53s/it][A
 32%|███▏      | 47/145 [01:09<02:27,  1.51s/it][A
 33%|███▎      | 48/145 [01:10<02:26,  1.51s/it][A
 34%|███▍      | 49/145 [01:12<02:26,  1.52s/it][A
 34%|███▍      | 50/145 [01:13<02:25,  1.53s/it][A
 35%|███▌      | 51/145 [01:15<02:24,  1.53s/it][A
 36%|███▌      | 52/145 [01:16<02:21,  1.53s/it][A
 37%|███▋      | 53/145 [01:18<02:20,  1.52s/it][A
 37%|███▋      | 54/145 [01:19<02:19,  1.53s/it][A
 38%|███▊      | 55/145 [01:21<02:16,  1.52s/it][A
 39%|███▊      | 56/145 [01:22<02:14,  1.52s/it][A
 39%|███▉      | 57/145 [01:24<02:12,  1.50s/it][A
 40%|████      | 58/145 [01:25<02:10,  1.50s/it][A
 41%|████      | 59/145 [01:27<02:11,  1.53s/it][A
 41%|████▏     | 60/145 [01:28<02:08,  1.51s/it][A
 42%|████▏     | 61/145 [01:30<02:06,  1.51s/it][A
 43%|████▎     | 62/145 [01:31<02:04,  1.49s/it][A
 43%|████▎     | 63/145 [01:33<02:04,  1.52s/it][A
 44%|████▍     | 64/145 [01:35<02:02,  1.51s/it][A
 45%|████▍     | 65/145 [01:36<02:01,  1.52s/it][A
 46%|████▌     | 66/145 [01:38<02:00,  1.52s/it][A
 46%|████▌     | 67/145 [01:39<01:57,  1.51s/it][A
 47%|████▋     | 68/145 [01:41<01:58,  1.53s/it][A
 48%|████▊     | 69/145 [01:42<01:56,  1.54s/it][A
 48%|████▊     | 70/145 [01:44<01:51,  1.49s/it][A
 49%|████▉     | 71/145 [01:45<01:49,  1.48s/it][A
 50%|████▉     | 72/145 [01:47<01:49,  1.50s/it][A
 50%|█████     | 73/145 [01:48<01:49,  1.52s/it][A
 51%|█████     | 74/145 [01:50<01:48,  1.53s/it][A
 52%|█████▏    | 75/145 [01:51<01:47,  1.54s/it][A
 52%|█████▏    | 76/145 [01:53<01:45,  1.52s/it][A
 53%|█████▎    | 77/145 [01:54<01:41,  1.50s/it][A
 54%|█████▍    | 78/145 [01:56<01:40,  1.49s/it][A
 54%|█████▍    | 79/145 [01:57<01:38,  1.49s/it][A
 55%|█████▌    | 80/145 [01:59<01:36,  1.48s/it][A
 56%|█████▌    | 81/145 [02:00<01:33,  1.46s/it][A
 57%|█████▋    | 82/145 [02:02<01:33,  1.48s/it][A
 57%|█████▋    | 83/145 [02:03<01:32,  1.49s/it][A
 58%|█████▊    | 84/145 [02:05<01:31,  1.50s/it][A
 59%|█████▊    | 85/145 [02:06<01:28,  1.47s/it][A
 59%|█████▉    | 86/145 [02:08<01:28,  1.50s/it][A
 60%|██████    | 87/145 [02:09<01:28,  1.52s/it][A
 61%|██████    | 88/145 [02:11<01:25,  1.49s/it][A
 61%|██████▏   | 89/145 [02:12<01:24,  1.50s/it][A
 62%|██████▏   | 90/145 [02:14<01:23,  1.51s/it][A
 63%|██████▎   | 91/145 [02:15<01:21,  1.51s/it][A
 63%|██████▎   | 92/145 [02:17<01:19,  1.51s/it][A
 64%|██████▍   | 93/145 [02:18<01:17,  1.49s/it][A
 65%|██████▍   | 94/145 [02:20<01:15,  1.48s/it][A
 66%|██████▌   | 95/145 [02:21<01:14,  1.49s/it][A
 66%|██████▌   | 96/145 [02:23<01:13,  1.50s/it][A
 67%|██████▋   | 97/145 [02:24<01:12,  1.51s/it][A
 68%|██████▊   | 98/145 [02:26<01:12,  1.54s/it][A
 68%|██████▊   | 99/145 [02:27<01:09,  1.51s/it][A
 69%|██████▉   | 100/145 [02:29<01:08,  1.52s/it][A
 70%|██████▉   | 101/145 [02:30<01:07,  1.53s/it][A
 70%|███████   | 102/145 [02:32<01:05,  1.52s/it][A
 71%|███████   | 103/145 [02:33<01:03,  1.52s/it][A
 72%|███████▏  | 104/145 [02:35<01:02,  1.53s/it][A
 72%|███████▏  | 105/145 [02:36<01:01,  1.53s/it][A
 73%|███████▎  | 106/145 [02:38<00:59,  1.52s/it][A
 74%|███████▍  | 107/145 [02:39<00:56,  1.48s/it][A
 74%|███████▍  | 108/145 [02:41<00:53,  1.45s/it][A
 75%|███████▌  | 109/145 [02:42<00:53,  1.48s/it][A
 76%|███████▌  | 110/145 [02:44<00:52,  1.50s/it][A
 77%|███████▋  | 111/145 [02:45<00:49,  1.46s/it][A
 77%|███████▋  | 112/145 [02:47<00:49,  1.49s/it][A
 78%|███████▊  | 113/145 [02:48<00:48,  1.51s/it][A
 79%|███████▊  | 114/145 [02:50<00:47,  1.52s/it][A
 79%|███████▉  | 115/145 [02:51<00:45,  1.52s/it][A
 80%|████████  | 116/145 [02:53<00:43,  1.49s/it][A
 81%|████████  | 117/145 [02:54<00:41,  1.49s/it][A
 81%|████████▏ | 118/145 [02:56<00:39,  1.48s/it][A
 82%|████████▏ | 119/145 [02:57<00:37,  1.45s/it][A
 83%|████████▎ | 120/145 [02:58<00:35,  1.43s/it][A
 83%|████████▎ | 121/145 [03:00<00:34,  1.44s/it][A
 84%|████████▍ | 122/145 [03:01<00:33,  1.45s/it][A
 85%|████████▍ | 123/145 [03:03<00:32,  1.46s/it][A
 86%|████████▌ | 124/145 [03:04<00:30,  1.45s/it][A
 86%|████████▌ | 125/145 [03:06<00:30,  1.51s/it][A
 87%|████████▋ | 126/145 [03:07<00:28,  1.49s/it][A
 88%|████████▊ | 127/145 [03:09<00:26,  1.48s/it][A
 88%|████████▊ | 128/145 [03:10<00:25,  1.51s/it][A
 89%|████████▉ | 129/145 [03:12<00:24,  1.51s/it][A
 90%|████████▉ | 130/145 [03:13<00:23,  1.54s/it][A
 90%|█████████ | 131/145 [03:15<00:20,  1.50s/it][A
 91%|█████████ | 132/145 [03:16<00:19,  1.51s/it][A
 92%|█████████▏| 133/145 [03:18<00:17,  1.49s/it][A
 92%|█████████▏| 134/145 [03:19<00:16,  1.52s/it][A
 93%|█████████▎| 135/145 [03:21<00:15,  1.52s/it][A
 94%|█████████▍| 136/145 [03:22<00:13,  1.51s/it][A
 94%|█████████▍| 137/145 [03:24<00:12,  1.50s/it][A
 95%|█████████▌| 138/145 [03:25<00:10,  1.52s/it][A
 96%|█████████▌| 139/145 [03:27<00:09,  1.51s/it][A
 97%|█████████▋| 140/145 [03:29<00:07,  1.52s/it][A
 97%|█████████▋| 141/145 [03:30<00:06,  1.52s/it][A
 98%|█████████▊| 142/145 [03:32<00:04,  1.51s/it][A
 99%|█████████▊| 143/145 [03:33<00:02,  1.50s/it][A
 99%|█████████▉| 144/145 [03:35<00:01,  1.51s/it][A
100%|██████████| 145/145 [03:36<00:00,  1.48s/it][A
                                                 [A                                                       {'eval_loss': 1.5770421028137207, 'eval_runtime': 218.1082, 'eval_samples_per_second': 5.305, 'eval_steps_per_second': 0.665, 'epoch': 6.45, 'num_input_tokens_seen': 23812928}

100%|██████████| 145/145 [03:36<00:00,  1.48s/it][A 65%|██████▍   | 2100/3250 [7:55:17<3:41:47, 11.57s/it]
                                                 [A[INFO|trainer.py:3705] 2024-10-11 12:47:20,738 >> Saving model checkpoint to /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2100
[INFO|configuration_utils.py:672] 2024-10-11 12:47:21,357 >> loading configuration file config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/config.json
[WARNING|modeling_rope_utils.py:379] 2024-10-11 12:47:21,357 >> Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
[INFO|configuration_utils.py:739] 2024-10-11 12:47:21,359 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 3584,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 18944,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 28,
  "num_hidden_layers": 28,
  "num_key_value_heads": 4,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.0",
  "use_cache": true,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "in_chans": 3,
    "model_type": "qwen2_vl",
    "spatial_patch_size": 14
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 152064
}

[INFO|tokenization_utils_base.py:2649] 2024-10-11 12:47:21,434 >> tokenizer config file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2100/tokenizer_config.json
[INFO|tokenization_utils_base.py:2658] 2024-10-11 12:47:21,434 >> Special tokens file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2100/special_tokens_map.json
[INFO|image_processing_base.py:258] 2024-10-11 12:47:21,921 >> Image processor saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2100/preprocessor_config.json
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 65%|██████▍   | 2101/3250 [7:55:30<24:42:30, 77.42s/it] 65%|██████▍   | 2102/3250 [7:55:42<18:22:57, 57.65s/it] 65%|██████▍   | 2103/3250 [7:55:53<13:58:49, 43.88s/it] 65%|██████▍   | 2104/3250 [7:56:05<10:54:12, 34.25s/it] 65%|██████▍   | 2105/3250 [7:56:17<8:45:24, 27.53s/it]                                                        {'loss': 1.6533, 'grad_norm': 0.2508827745914459, 'learning_rate': 0.005, 'epoch': 6.47, 'num_input_tokens_seen': 23869760}
 65%|██████▍   | 2105/3250 [7:56:17<8:45:24, 27.53s/it] 65%|██████▍   | 2106/3250 [7:56:29<7:14:14, 22.77s/it] 65%|██████▍   | 2107/3250 [7:56:41<6:12:05, 19.53s/it] 65%|██████▍   | 2108/3250 [7:56:52<5:27:36, 17.21s/it] 65%|██████▍   | 2109/3250 [7:57:04<4:55:11, 15.52s/it] 65%|██████▍   | 2110/3250 [7:57:15<4:30:33, 14.24s/it]                                                       {'loss': 1.6338, 'grad_norm': 0.46843013167381287, 'learning_rate': 0.005, 'epoch': 6.48, 'num_input_tokens_seen': 23926240}
 65%|██████▍   | 2110/3250 [7:57:15<4:30:33, 14.24s/it] 65%|██████▍   | 2111/3250 [7:57:27<4:15:17, 13.45s/it] 65%|██████▍   | 2112/3250 [7:57:39<4:05:25, 12.94s/it] 65%|██████▌   | 2113/3250 [7:57:50<3:57:16, 12.52s/it] 65%|██████▌   | 2114/3250 [7:58:02<3:51:04, 12.20s/it] 65%|██████▌   | 2115/3250 [7:58:13<3:48:03, 12.06s/it]                                                       {'loss': 1.5837, 'grad_norm': 0.33158719539642334, 'learning_rate': 0.005, 'epoch': 6.5, 'num_input_tokens_seen': 23982880}
 65%|██████▌   | 2115/3250 [7:58:13<3:48:03, 12.06s/it] 65%|██████▌   | 2116/3250 [7:58:25<3:45:51, 11.95s/it] 65%|██████▌   | 2117/3250 [7:58:37<3:43:07, 11.82s/it] 65%|██████▌   | 2118/3250 [7:58:48<3:43:21, 11.84s/it] 65%|██████▌   | 2119/3250 [7:59:00<3:43:08, 11.84s/it] 65%|██████▌   | 2120/3250 [7:59:12<3:42:23, 11.81s/it]                                                       {'loss': 1.7979, 'grad_norm': 0.7902507781982422, 'learning_rate': 0.005, 'epoch': 6.51, 'num_input_tokens_seen': 24039616}
 65%|██████▌   | 2120/3250 [7:59:12<3:42:23, 11.81s/it] 65%|██████▌   | 2121/3250 [7:59:24<3:41:00, 11.75s/it] 65%|██████▌   | 2122/3250 [7:59:35<3:40:52, 11.75s/it] 65%|██████▌   | 2123/3250 [7:59:47<3:39:33, 11.69s/it] 65%|██████▌   | 2124/3250 [7:59:59<3:41:03, 11.78s/it] 65%|██████▌   | 2125/3250 [8:00:11<3:41:36, 11.82s/it]                                                       {'loss': 1.8605, 'grad_norm': 0.6520991325378418, 'learning_rate': 0.005, 'epoch': 6.53, 'num_input_tokens_seen': 24096160}
 65%|██████▌   | 2125/3250 [8:00:11<3:41:36, 11.82s/it] 65%|██████▌   | 2126/3250 [8:00:22<3:39:32, 11.72s/it] 65%|██████▌   | 2127/3250 [8:00:34<3:40:56, 11.80s/it] 65%|██████▌   | 2128/3250 [8:00:46<3:39:35, 11.74s/it] 66%|██████▌   | 2129/3250 [8:00:58<3:39:25, 11.74s/it] 66%|██████▌   | 2130/3250 [8:01:09<3:36:27, 11.60s/it]                                                       {'loss': 1.7418, 'grad_norm': 0.49588289856910706, 'learning_rate': 0.005, 'epoch': 6.54, 'num_input_tokens_seen': 24151936}
 66%|██████▌   | 2130/3250 [8:01:09<3:36:27, 11.60s/it] 66%|██████▌   | 2131/3250 [8:01:20<3:36:02, 11.58s/it] 66%|██████▌   | 2132/3250 [8:01:32<3:35:31, 11.57s/it] 66%|██████▌   | 2133/3250 [8:01:44<3:35:39, 11.58s/it] 66%|██████▌   | 2134/3250 [8:01:55<3:35:20, 11.58s/it] 66%|██████▌   | 2135/3250 [8:02:07<3:36:55, 11.67s/it]                                                       {'loss': 1.6529, 'grad_norm': 0.3686736226081848, 'learning_rate': 0.005, 'epoch': 6.56, 'num_input_tokens_seen': 24208576}
 66%|██████▌   | 2135/3250 [8:02:07<3:36:55, 11.67s/it] 66%|██████▌   | 2136/3250 [8:02:19<3:36:58, 11.69s/it] 66%|██████▌   | 2137/3250 [8:02:30<3:36:43, 11.68s/it] 66%|██████▌   | 2138/3250 [8:02:42<3:37:39, 11.74s/it] 66%|██████▌   | 2139/3250 [8:02:54<3:34:52, 11.60s/it] 66%|██████▌   | 2140/3250 [8:03:05<3:35:54, 11.67s/it]                                                       {'loss': 1.7096, 'grad_norm': 0.6552709937095642, 'learning_rate': 0.005, 'epoch': 6.57, 'num_input_tokens_seen': 24264992}
 66%|██████▌   | 2140/3250 [8:03:05<3:35:54, 11.67s/it] 66%|██████▌   | 2141/3250 [8:03:17<3:34:14, 11.59s/it] 66%|██████▌   | 2142/3250 [8:03:28<3:32:29, 11.51s/it] 66%|██████▌   | 2143/3250 [8:03:40<3:34:35, 11.63s/it] 66%|██████▌   | 2144/3250 [8:03:52<3:34:33, 11.64s/it] 66%|██████▌   | 2145/3250 [8:04:03<3:32:56, 11.56s/it]                                                       {'loss': 1.601, 'grad_norm': 0.41348913311958313, 'learning_rate': 0.005, 'epoch': 6.59, 'num_input_tokens_seen': 24320224}
 66%|██████▌   | 2145/3250 [8:04:03<3:32:56, 11.56s/it] 66%|██████▌   | 2146/3250 [8:04:15<3:31:54, 11.52s/it] 66%|██████▌   | 2147/3250 [8:04:26<3:32:11, 11.54s/it] 66%|██████▌   | 2148/3250 [8:04:38<3:33:04, 11.60s/it] 66%|██████▌   | 2149/3250 [8:04:50<3:34:38, 11.70s/it] 66%|██████▌   | 2150/3250 [8:05:01<3:33:46, 11.66s/it]                                                       {'loss': 1.6157, 'grad_norm': 0.35603079199790955, 'learning_rate': 0.005, 'epoch': 6.61, 'num_input_tokens_seen': 24376064}
 66%|██████▌   | 2150/3250 [8:05:01<3:33:46, 11.66s/it] 66%|██████▌   | 2151/3250 [8:05:13<3:32:46, 11.62s/it] 66%|██████▌   | 2152/3250 [8:05:24<3:31:57, 11.58s/it] 66%|██████▌   | 2153/3250 [8:05:36<3:31:07, 11.55s/it] 66%|██████▋   | 2154/3250 [8:05:48<3:32:26, 11.63s/it] 66%|██████▋   | 2155/3250 [8:05:59<3:30:56, 11.56s/it]                                                       {'loss': 1.6272, 'grad_norm': 0.48746711015701294, 'learning_rate': 0.005, 'epoch': 6.62, 'num_input_tokens_seen': 24432256}
 66%|██████▋   | 2155/3250 [8:05:59<3:30:56, 11.56s/it] 66%|██████▋   | 2156/3250 [8:06:11<3:31:52, 11.62s/it] 66%|██████▋   | 2157/3250 [8:06:23<3:33:01, 11.69s/it] 66%|██████▋   | 2158/3250 [8:06:34<3:30:24, 11.56s/it] 66%|██████▋   | 2159/3250 [8:06:45<3:29:03, 11.50s/it] 66%|██████▋   | 2160/3250 [8:06:57<3:29:57, 11.56s/it]                                                       {'loss': 1.6167, 'grad_norm': 0.6430102586746216, 'learning_rate': 0.005, 'epoch': 6.64, 'num_input_tokens_seen': 24489088}
 66%|██████▋   | 2160/3250 [8:06:57<3:29:57, 11.56s/it] 66%|██████▋   | 2161/3250 [8:07:09<3:30:04, 11.57s/it] 67%|██████▋   | 2162/3250 [8:07:20<3:30:24, 11.60s/it] 67%|██████▋   | 2163/3250 [8:07:32<3:29:17, 11.55s/it] 67%|██████▋   | 2164/3250 [8:07:44<3:30:34, 11.63s/it] 67%|██████▋   | 2165/3250 [8:07:55<3:29:50, 11.60s/it]                                                       {'loss': 1.5523, 'grad_norm': 0.4306730329990387, 'learning_rate': 0.005, 'epoch': 6.65, 'num_input_tokens_seen': 24545280}
 67%|██████▋   | 2165/3250 [8:07:55<3:29:50, 11.60s/it] 67%|██████▋   | 2166/3250 [8:08:07<3:30:27, 11.65s/it] 67%|██████▋   | 2167/3250 [8:08:19<3:30:32, 11.66s/it] 67%|██████▋   | 2168/3250 [8:08:30<3:30:24, 11.67s/it] 67%|██████▋   | 2169/3250 [8:08:42<3:28:24, 11.57s/it] 67%|██████▋   | 2170/3250 [8:08:53<3:28:30, 11.58s/it]                                                       {'loss': 1.6301, 'grad_norm': 0.5113790035247803, 'learning_rate': 0.005, 'epoch': 6.67, 'num_input_tokens_seen': 24602624}
 67%|██████▋   | 2170/3250 [8:08:53<3:28:30, 11.58s/it] 67%|██████▋   | 2171/3250 [8:09:05<3:28:14, 11.58s/it] 67%|██████▋   | 2172/3250 [8:09:16<3:28:45, 11.62s/it] 67%|██████▋   | 2173/3250 [8:09:28<3:29:32, 11.67s/it] 67%|██████▋   | 2174/3250 [8:09:40<3:30:11, 11.72s/it] 67%|██████▋   | 2175/3250 [8:09:52<3:30:03, 11.72s/it]                                                       {'loss': 1.6051, 'grad_norm': 0.3111133575439453, 'learning_rate': 0.005, 'epoch': 6.68, 'num_input_tokens_seen': 24660576}
 67%|██████▋   | 2175/3250 [8:09:52<3:30:03, 11.72s/it] 67%|██████▋   | 2176/3250 [8:10:04<3:30:02, 11.73s/it] 67%|██████▋   | 2177/3250 [8:10:15<3:30:56, 11.80s/it] 67%|██████▋   | 2178/3250 [8:10:27<3:31:03, 11.81s/it] 67%|██████▋   | 2179/3250 [8:10:39<3:29:30, 11.74s/it] 67%|██████▋   | 2180/3250 [8:10:50<3:26:57, 11.60s/it]                                                       {'loss': 1.6453, 'grad_norm': 0.35847151279449463, 'learning_rate': 0.005, 'epoch': 6.7, 'num_input_tokens_seen': 24717184}
 67%|██████▋   | 2180/3250 [8:10:50<3:26:57, 11.60s/it] 67%|██████▋   | 2181/3250 [8:11:02<3:27:33, 11.65s/it] 67%|██████▋   | 2182/3250 [8:11:14<3:28:46, 11.73s/it] 67%|██████▋   | 2183/3250 [8:11:26<3:29:24, 11.78s/it] 67%|██████▋   | 2184/3250 [8:11:37<3:28:24, 11.73s/it] 67%|██████▋   | 2185/3250 [8:11:49<3:28:15, 11.73s/it]                                                       {'loss': 1.6369, 'grad_norm': 0.7087984681129456, 'learning_rate': 0.005, 'epoch': 6.71, 'num_input_tokens_seen': 24774688}
 67%|██████▋   | 2185/3250 [8:11:49<3:28:15, 11.73s/it] 67%|██████▋   | 2186/3250 [8:12:01<3:27:34, 11.71s/it] 67%|██████▋   | 2187/3250 [8:12:13<3:27:43, 11.73s/it] 67%|██████▋   | 2188/3250 [8:12:24<3:28:28, 11.78s/it] 67%|██████▋   | 2189/3250 [8:12:36<3:28:48, 11.81s/it] 67%|██████▋   | 2190/3250 [8:12:48<3:27:47, 11.76s/it]                                                       {'loss': 1.6507, 'grad_norm': 0.5371844172477722, 'learning_rate': 0.005, 'epoch': 6.73, 'num_input_tokens_seen': 24831584}
 67%|██████▋   | 2190/3250 [8:12:48<3:27:47, 11.76s/it] 67%|██████▋   | 2191/3250 [8:12:59<3:26:15, 11.69s/it] 67%|██████▋   | 2192/3250 [8:13:11<3:25:24, 11.65s/it] 67%|██████▋   | 2193/3250 [8:13:22<3:23:33, 11.55s/it] 68%|██████▊   | 2194/3250 [8:13:34<3:23:36, 11.57s/it] 68%|██████▊   | 2195/3250 [8:13:45<3:22:13, 11.50s/it]                                                       {'loss': 1.5992, 'grad_norm': 0.611383855342865, 'learning_rate': 0.005, 'epoch': 6.74, 'num_input_tokens_seen': 24887552}
 68%|██████▊   | 2195/3250 [8:13:45<3:22:13, 11.50s/it] 68%|██████▊   | 2196/3250 [8:13:57<3:23:24, 11.58s/it] 68%|██████▊   | 2197/3250 [8:14:09<3:23:06, 11.57s/it] 68%|██████▊   | 2198/3250 [8:14:20<3:22:23, 11.54s/it] 68%|██████▊   | 2199/3250 [8:14:31<3:21:06, 11.48s/it] 68%|██████▊   | 2200/3250 [8:14:43<3:21:24, 11.51s/it]                                                       {'loss': 1.6163, 'grad_norm': 0.5964645743370056, 'learning_rate': 0.005, 'epoch': 6.76, 'num_input_tokens_seen': 24943616}
 68%|██████▊   | 2200/3250 [8:14:43<3:21:24, 11.51s/it][INFO|trainer.py:4021] 2024-10-11 13:06:46,635 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-10-11 13:06:46,635 >>   Num examples = 1157
[INFO|trainer.py:4026] 2024-10-11 13:06:46,635 >>   Batch size = 4

  0%|          | 0/145 [00:00<?, ?it/s][A
  1%|▏         | 2/145 [00:01<01:46,  1.35it/s][A
  2%|▏         | 3/145 [00:03<02:33,  1.08s/it][A
  3%|▎         | 4/145 [00:04<02:53,  1.23s/it][A
  3%|▎         | 5/145 [00:05<02:59,  1.28s/it][A
  4%|▍         | 6/145 [00:07<03:09,  1.36s/it][A
  5%|▍         | 7/145 [00:08<03:16,  1.42s/it][A
  6%|▌         | 8/145 [00:10<03:14,  1.42s/it][A
  6%|▌         | 9/145 [00:11<03:13,  1.42s/it][A
  7%|▋         | 10/145 [00:13<03:14,  1.44s/it][A
  8%|▊         | 11/145 [00:14<03:15,  1.46s/it][A
  8%|▊         | 12/145 [00:16<03:17,  1.49s/it][A
  9%|▉         | 13/145 [00:17<03:18,  1.50s/it][A
 10%|▉         | 14/145 [00:19<03:19,  1.52s/it][A
 10%|█         | 15/145 [00:20<03:16,  1.51s/it][A
 11%|█         | 16/145 [00:22<03:13,  1.50s/it][A
 12%|█▏        | 17/145 [00:23<03:12,  1.50s/it][A
 12%|█▏        | 18/145 [00:25<03:12,  1.51s/it][A
 13%|█▎        | 19/145 [00:26<03:11,  1.52s/it][A
 14%|█▍        | 20/145 [00:28<03:09,  1.51s/it][A
 14%|█▍        | 21/145 [00:29<03:04,  1.49s/it][A
 15%|█▌        | 22/145 [00:31<03:02,  1.48s/it][A
 16%|█▌        | 23/145 [00:32<03:00,  1.48s/it][A
 17%|█▋        | 24/145 [00:34<02:59,  1.48s/it][A
 17%|█▋        | 25/145 [00:35<02:58,  1.49s/it][A
 18%|█▊        | 26/145 [00:37<02:55,  1.48s/it][A
 19%|█▊        | 27/145 [00:38<02:55,  1.49s/it][A
 19%|█▉        | 28/145 [00:40<02:53,  1.48s/it][A
 20%|██        | 29/145 [00:41<02:51,  1.48s/it][A
 21%|██        | 30/145 [00:43<02:46,  1.45s/it][A
 21%|██▏       | 31/145 [00:44<02:47,  1.47s/it][A
 22%|██▏       | 32/145 [00:46<02:46,  1.47s/it][A
 23%|██▎       | 33/145 [00:47<02:45,  1.48s/it][A
 23%|██▎       | 34/145 [00:49<02:44,  1.48s/it][A
 24%|██▍       | 35/145 [00:50<02:44,  1.49s/it][A
 25%|██▍       | 36/145 [00:52<02:42,  1.49s/it][A
 26%|██▌       | 37/145 [00:53<02:44,  1.52s/it][A
 26%|██▌       | 38/145 [00:55<02:42,  1.52s/it][A
 27%|██▋       | 39/145 [00:56<02:40,  1.51s/it][A
 28%|██▊       | 40/145 [00:58<02:38,  1.51s/it][A
 28%|██▊       | 41/145 [00:59<02:39,  1.53s/it][A
 29%|██▉       | 42/145 [01:01<02:37,  1.53s/it][A
 30%|██▉       | 43/145 [01:02<02:33,  1.51s/it][A
 30%|███       | 44/145 [01:04<02:34,  1.53s/it][A
 31%|███       | 45/145 [01:05<02:34,  1.55s/it][A
 32%|███▏      | 46/145 [01:07<02:30,  1.52s/it][A
 32%|███▏      | 47/145 [01:08<02:26,  1.50s/it][A
 33%|███▎      | 48/145 [01:10<02:25,  1.50s/it][A
 34%|███▍      | 49/145 [01:11<02:25,  1.51s/it][A
 34%|███▍      | 50/145 [01:13<02:24,  1.52s/it][A
 35%|███▌      | 51/145 [01:15<02:23,  1.53s/it][A
 36%|███▌      | 52/145 [01:16<02:21,  1.52s/it][A
 37%|███▋      | 53/145 [01:18<02:19,  1.52s/it][A
 37%|███▋      | 54/145 [01:19<02:18,  1.52s/it][A
 38%|███▊      | 55/145 [01:21<02:16,  1.51s/it][A
 39%|███▊      | 56/145 [01:22<02:14,  1.51s/it][A
 39%|███▉      | 57/145 [01:24<02:11,  1.50s/it][A
 40%|████      | 58/145 [01:25<02:09,  1.49s/it][A
 41%|████      | 59/145 [01:27<02:10,  1.52s/it][A
 41%|████▏     | 60/145 [01:28<02:08,  1.51s/it][A
 42%|████▏     | 61/145 [01:30<02:06,  1.50s/it][A
 43%|████▎     | 62/145 [01:31<02:03,  1.49s/it][A
 43%|████▎     | 63/145 [01:33<02:03,  1.51s/it][A
 44%|████▍     | 64/145 [01:34<02:01,  1.50s/it][A
 45%|████▍     | 65/145 [01:36<02:01,  1.51s/it][A
 46%|████▌     | 66/145 [01:37<01:59,  1.51s/it][A
 46%|████▌     | 67/145 [01:39<01:57,  1.50s/it][A
 47%|████▋     | 68/145 [01:40<01:57,  1.53s/it][A
 48%|████▊     | 69/145 [01:42<01:56,  1.53s/it][A
 48%|████▊     | 70/145 [01:43<01:51,  1.49s/it][A
 49%|████▉     | 71/145 [01:45<01:49,  1.48s/it][A
 50%|████▉     | 72/145 [01:46<01:48,  1.49s/it][A
 50%|█████     | 73/145 [01:48<01:49,  1.52s/it][A
 51%|█████     | 74/145 [01:49<01:48,  1.52s/it][A
 52%|█████▏    | 75/145 [01:51<01:46,  1.53s/it][A
 52%|█████▏    | 76/145 [01:52<01:44,  1.52s/it][A
 53%|█████▎    | 77/145 [01:54<01:41,  1.49s/it][A
 54%|█████▍    | 78/145 [01:55<01:40,  1.49s/it][A
 54%|█████▍    | 79/145 [01:57<01:37,  1.48s/it][A
 55%|█████▌    | 80/145 [01:58<01:36,  1.48s/it][A
 56%|█████▌    | 81/145 [02:00<01:33,  1.46s/it][A
 57%|█████▋    | 82/145 [02:01<01:33,  1.48s/it][A
 57%|█████▋    | 83/145 [02:03<01:32,  1.49s/it][A
 58%|█████▊    | 84/145 [02:04<01:31,  1.50s/it][A
 59%|█████▊    | 85/145 [02:05<01:28,  1.47s/it][A
 59%|█████▉    | 86/145 [02:07<01:27,  1.49s/it][A
 60%|██████    | 87/145 [02:09<01:27,  1.51s/it][A
 61%|██████    | 88/145 [02:10<01:24,  1.49s/it][A
 61%|██████▏   | 89/145 [02:12<01:23,  1.50s/it][A
 62%|██████▏   | 90/145 [02:13<01:22,  1.51s/it][A
 63%|██████▎   | 91/145 [02:15<01:21,  1.50s/it][A
 63%|██████▎   | 92/145 [02:16<01:19,  1.50s/it][A
 64%|██████▍   | 93/145 [02:17<01:17,  1.48s/it][A
 65%|██████▍   | 94/145 [02:19<01:15,  1.48s/it][A
 66%|██████▌   | 95/145 [02:20<01:14,  1.48s/it][A
 66%|██████▌   | 96/145 [02:22<01:13,  1.49s/it][A
 67%|██████▋   | 97/145 [02:23<01:12,  1.50s/it][A
 68%|██████▊   | 98/145 [02:25<01:11,  1.53s/it][A
 68%|██████▊   | 99/145 [02:27<01:09,  1.51s/it][A
 69%|██████▉   | 100/145 [02:28<01:08,  1.51s/it][A
 70%|██████▉   | 101/145 [02:30<01:07,  1.52s/it][A
 70%|███████   | 102/145 [02:31<01:05,  1.52s/it][A
 71%|███████   | 103/145 [02:33<01:03,  1.51s/it][A
 72%|███████▏  | 104/145 [02:34<01:02,  1.52s/it][A
 72%|███████▏  | 105/145 [02:36<01:00,  1.51s/it][A
 73%|███████▎  | 106/145 [02:37<00:58,  1.51s/it][A
 74%|███████▍  | 107/145 [02:39<00:55,  1.47s/it][A
 74%|███████▍  | 108/145 [02:40<00:53,  1.44s/it][A
 75%|███████▌  | 109/145 [02:41<00:52,  1.47s/it][A
 76%|███████▌  | 110/145 [02:43<00:52,  1.49s/it][A
 77%|███████▋  | 111/145 [02:44<00:49,  1.46s/it][A
 77%|███████▋  | 112/145 [02:46<00:49,  1.49s/it][A
 78%|███████▊  | 113/145 [02:47<00:48,  1.50s/it][A
 79%|███████▊  | 114/145 [02:49<00:46,  1.52s/it][A
 79%|███████▉  | 115/145 [02:51<00:45,  1.51s/it][A
 80%|████████  | 116/145 [02:52<00:42,  1.48s/it][A
 81%|████████  | 117/145 [02:53<00:41,  1.49s/it][A
 81%|████████▏ | 118/145 [02:55<00:39,  1.48s/it][A
 82%|████████▏ | 119/145 [02:56<00:37,  1.44s/it][A
 83%|████████▎ | 120/145 [02:58<00:35,  1.43s/it][A
 83%|████████▎ | 121/145 [02:59<00:34,  1.43s/it][A
 84%|████████▍ | 122/145 [03:01<00:33,  1.44s/it][A
 85%|████████▍ | 123/145 [03:02<00:32,  1.46s/it][A
 86%|████████▌ | 124/145 [03:03<00:30,  1.45s/it][A
 86%|████████▌ | 125/145 [03:05<00:30,  1.51s/it][A
 87%|████████▋ | 126/145 [03:07<00:28,  1.49s/it][A
 88%|████████▊ | 127/145 [03:08<00:26,  1.48s/it][A
 88%|████████▊ | 128/145 [03:10<00:25,  1.51s/it][A
 89%|████████▉ | 129/145 [03:11<00:24,  1.50s/it][A
 90%|████████▉ | 130/145 [03:13<00:22,  1.53s/it][A
 90%|█████████ | 131/145 [03:14<00:20,  1.49s/it][A
 91%|█████████ | 132/145 [03:16<00:19,  1.50s/it][A
 92%|█████████▏| 133/145 [03:17<00:17,  1.47s/it][A
 92%|█████████▏| 134/145 [03:19<00:16,  1.51s/it][A
 93%|█████████▎| 135/145 [03:20<00:15,  1.51s/it][A
 94%|█████████▍| 136/145 [03:22<00:13,  1.50s/it][A
 94%|█████████▍| 137/145 [03:23<00:11,  1.50s/it][A
 95%|█████████▌| 138/145 [03:25<00:10,  1.51s/it][A
 96%|█████████▌| 139/145 [03:26<00:09,  1.51s/it][A
 97%|█████████▋| 140/145 [03:28<00:07,  1.51s/it][A
 97%|█████████▋| 141/145 [03:29<00:06,  1.51s/it][A
 98%|█████████▊| 142/145 [03:31<00:04,  1.50s/it][A
 99%|█████████▊| 143/145 [03:32<00:02,  1.49s/it][A
 99%|█████████▉| 144/145 [03:34<00:01,  1.50s/it][A
100%|██████████| 145/145 [03:35<00:00,  1.47s/it][A
                                                 [A                                                       {'eval_loss': 1.649027705192566, 'eval_runtime': 217.16, 'eval_samples_per_second': 5.328, 'eval_steps_per_second': 0.668, 'epoch': 6.76, 'num_input_tokens_seen': 24943616}

100%|██████████| 145/145 [03:35<00:00,  1.47s/it][A 68%|██████▊   | 2200/3250 [8:18:20<3:21:24, 11.51s/it]
                                                 [A[INFO|trainer.py:3705] 2024-10-11 13:10:23,797 >> Saving model checkpoint to /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2200
[INFO|configuration_utils.py:672] 2024-10-11 13:10:24,418 >> loading configuration file config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/config.json
[WARNING|modeling_rope_utils.py:379] 2024-10-11 13:10:24,419 >> Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
[INFO|configuration_utils.py:739] 2024-10-11 13:10:24,421 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 3584,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 18944,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 28,
  "num_hidden_layers": 28,
  "num_key_value_heads": 4,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.0",
  "use_cache": true,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "in_chans": 3,
    "model_type": "qwen2_vl",
    "spatial_patch_size": 14
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 152064
}

[INFO|tokenization_utils_base.py:2649] 2024-10-11 13:10:24,496 >> tokenizer config file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2200/tokenizer_config.json
[INFO|tokenization_utils_base.py:2658] 2024-10-11 13:10:24,496 >> Special tokens file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2200/special_tokens_map.json
[INFO|image_processing_base.py:258] 2024-10-11 13:10:24,984 >> Image processor saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2200/preprocessor_config.json
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 68%|██████▊   | 2201/3250 [8:18:33<22:25:36, 76.97s/it] 68%|██████▊   | 2202/3250 [8:18:45<16:42:48, 57.41s/it] 68%|██████▊   | 2203/3250 [8:18:56<12:42:30, 43.70s/it] 68%|██████▊   | 2204/3250 [8:19:08<9:54:17, 34.09s/it]  68%|██████▊   | 2205/3250 [8:19:19<7:55:46, 27.32s/it]                                                       {'loss': 1.7442, 'grad_norm': 0.7217536568641663, 'learning_rate': 0.005, 'epoch': 6.77, 'num_input_tokens_seen': 25000832}
 68%|██████▊   | 2205/3250 [8:19:19<7:55:46, 27.32s/it] 68%|██████▊   | 2206/3250 [8:19:31<6:33:08, 22.59s/it] 68%|██████▊   | 2207/3250 [8:19:42<5:34:11, 19.22s/it] 68%|██████▊   | 2208/3250 [8:19:54<4:55:22, 17.01s/it] 68%|██████▊   | 2209/3250 [8:20:06<4:26:26, 15.36s/it] 68%|██████▊   | 2210/3250 [8:20:17<4:06:54, 14.24s/it]                                                       {'loss': 1.6319, 'grad_norm': 7.824042320251465, 'learning_rate': 0.005, 'epoch': 6.79, 'num_input_tokens_seen': 25057408}
 68%|██████▊   | 2210/3250 [8:20:17<4:06:54, 14.24s/it] 68%|██████▊   | 2211/3250 [8:20:28<3:49:38, 13.26s/it] 68%|██████▊   | 2212/3250 [8:20:40<3:41:13, 12.79s/it] 68%|██████▊   | 2213/3250 [8:20:52<3:34:52, 12.43s/it] 68%|██████▊   | 2214/3250 [8:21:03<3:31:04, 12.22s/it] 68%|██████▊   | 2215/3250 [8:21:15<3:26:50, 11.99s/it]                                                       {'loss': 1.751, 'grad_norm': 0.7745048999786377, 'learning_rate': 0.005, 'epoch': 6.8, 'num_input_tokens_seen': 25113408}
 68%|██████▊   | 2215/3250 [8:21:15<3:26:50, 11.99s/it] 68%|██████▊   | 2216/3250 [8:21:26<3:23:50, 11.83s/it] 68%|██████▊   | 2217/3250 [8:21:38<3:23:03, 11.79s/it] 68%|██████▊   | 2218/3250 [8:21:50<3:22:26, 11.77s/it] 68%|██████▊   | 2219/3250 [8:22:01<3:22:16, 11.77s/it] 68%|██████▊   | 2220/3250 [8:22:12<3:18:09, 11.54s/it]                                                       {'loss': 1.6376, 'grad_norm': 0.6309710741043091, 'learning_rate': 0.005, 'epoch': 6.82, 'num_input_tokens_seen': 25169600}
 68%|██████▊   | 2220/3250 [8:22:12<3:18:09, 11.54s/it] 68%|██████▊   | 2221/3250 [8:22:24<3:18:12, 11.56s/it] 68%|██████▊   | 2222/3250 [8:22:35<3:17:35, 11.53s/it] 68%|██████▊   | 2223/3250 [8:22:47<3:17:18, 11.53s/it] 68%|██████▊   | 2224/3250 [8:22:59<3:18:01, 11.58s/it] 68%|██████▊   | 2225/3250 [8:23:10<3:15:56, 11.47s/it]                                                       {'loss': 1.6367, 'grad_norm': 0.4100961983203888, 'learning_rate': 0.005, 'epoch': 6.84, 'num_input_tokens_seen': 25224992}
 68%|██████▊   | 2225/3250 [8:23:10<3:15:56, 11.47s/it] 68%|██████▊   | 2226/3250 [8:23:22<3:17:02, 11.55s/it] 69%|██████▊   | 2227/3250 [8:23:33<3:16:46, 11.54s/it] 69%|██████▊   | 2228/3250 [8:23:45<3:17:57, 11.62s/it] 69%|██████▊   | 2229/3250 [8:23:57<3:17:31, 11.61s/it] 69%|██████▊   | 2230/3250 [8:24:08<3:17:40, 11.63s/it]                                                       {'loss': 1.6073, 'grad_norm': 5.952466011047363, 'learning_rate': 0.005, 'epoch': 6.85, 'num_input_tokens_seen': 25281888}
 69%|██████▊   | 2230/3250 [8:24:08<3:17:40, 11.63s/it] 69%|██████▊   | 2231/3250 [8:24:20<3:17:05, 11.61s/it] 69%|██████▊   | 2232/3250 [8:24:31<3:17:31, 11.64s/it] 69%|██████▊   | 2233/3250 [8:24:43<3:14:32, 11.48s/it] 69%|██████▊   | 2234/3250 [8:24:54<3:14:59, 11.52s/it] 69%|██████▉   | 2235/3250 [8:25:06<3:16:05, 11.59s/it]                                                       {'loss': 1.628, 'grad_norm': 0.4566808342933655, 'learning_rate': 0.005, 'epoch': 6.87, 'num_input_tokens_seen': 25337888}
 69%|██████▉   | 2235/3250 [8:25:06<3:16:05, 11.59s/it] 69%|██████▉   | 2236/3250 [8:25:18<3:16:40, 11.64s/it] 69%|██████▉   | 2237/3250 [8:25:29<3:16:55, 11.66s/it] 69%|██████▉   | 2238/3250 [8:25:41<3:17:06, 11.69s/it] 69%|██████▉   | 2239/3250 [8:25:53<3:18:11, 11.76s/it] 69%|██████▉   | 2240/3250 [8:26:05<3:17:46, 11.75s/it]                                                       {'loss': 2.5856, 'grad_norm': 1.303519606590271, 'learning_rate': 0.005, 'epoch': 6.88, 'num_input_tokens_seen': 25396192}
 69%|██████▉   | 2240/3250 [8:26:05<3:17:46, 11.75s/it] 69%|██████▉   | 2241/3250 [8:26:16<3:16:24, 11.68s/it] 69%|██████▉   | 2242/3250 [8:26:28<3:16:40, 11.71s/it] 69%|██████▉   | 2243/3250 [8:26:39<3:14:41, 11.60s/it] 69%|██████▉   | 2244/3250 [8:26:51<3:15:17, 11.65s/it] 69%|██████▉   | 2245/3250 [8:27:03<3:14:30, 11.61s/it]                                                       {'loss': 2.5906, 'grad_norm': 0.8021437525749207, 'learning_rate': 0.005, 'epoch': 6.9, 'num_input_tokens_seen': 25452128}
 69%|██████▉   | 2245/3250 [8:27:03<3:14:30, 11.61s/it] 69%|██████▉   | 2246/3250 [8:27:14<3:13:24, 11.56s/it] 69%|██████▉   | 2247/3250 [8:27:26<3:14:03, 11.61s/it] 69%|██████▉   | 2248/3250 [8:27:38<3:14:04, 11.62s/it] 69%|██████▉   | 2249/3250 [8:27:49<3:14:35, 11.66s/it] 69%|██████▉   | 2250/3250 [8:28:01<3:14:37, 11.68s/it]                                                       {'loss': 2.1631, 'grad_norm': 0.8316810727119446, 'learning_rate': 0.005, 'epoch': 6.91, 'num_input_tokens_seen': 25509056}
 69%|██████▉   | 2250/3250 [8:28:01<3:14:37, 11.68s/it] 69%|██████▉   | 2251/3250 [8:28:12<3:12:32, 11.56s/it] 69%|██████▉   | 2252/3250 [8:28:24<3:13:17, 11.62s/it] 69%|██████▉   | 2253/3250 [8:28:36<3:13:40, 11.66s/it] 69%|██████▉   | 2254/3250 [8:28:48<3:13:54, 11.68s/it] 69%|██████▉   | 2255/3250 [8:28:59<3:13:03, 11.64s/it]                                                       {'loss': 1.8786, 'grad_norm': 0.8104075193405151, 'learning_rate': 0.005, 'epoch': 6.93, 'num_input_tokens_seen': 25566112}
 69%|██████▉   | 2255/3250 [8:28:59<3:13:03, 11.64s/it] 69%|██████▉   | 2256/3250 [8:29:11<3:12:49, 11.64s/it] 69%|██████▉   | 2257/3250 [8:29:22<3:11:43, 11.58s/it] 69%|██████▉   | 2258/3250 [8:29:34<3:11:53, 11.61s/it] 70%|██████▉   | 2259/3250 [8:29:46<3:12:10, 11.64s/it] 70%|██████▉   | 2260/3250 [8:29:57<3:12:17, 11.65s/it]                                                       {'loss': 1.8977, 'grad_norm': 40.77123260498047, 'learning_rate': 0.005, 'epoch': 6.94, 'num_input_tokens_seen': 25622560}
 70%|██████▉   | 2260/3250 [8:29:57<3:12:17, 11.65s/it] 70%|██████▉   | 2261/3250 [8:30:09<3:11:07, 11.60s/it] 70%|██████▉   | 2262/3250 [8:30:21<3:11:49, 11.65s/it] 70%|██████▉   | 2263/3250 [8:30:32<3:11:36, 11.65s/it] 70%|██████▉   | 2264/3250 [8:30:43<3:09:24, 11.53s/it] 70%|██████▉   | 2265/3250 [8:30:55<3:09:14, 11.53s/it]                                                       {'loss': 2.075, 'grad_norm': 1.472269058227539, 'learning_rate': 0.005, 'epoch': 6.96, 'num_input_tokens_seen': 25679136}
 70%|██████▉   | 2265/3250 [8:30:55<3:09:14, 11.53s/it] 70%|██████▉   | 2266/3250 [8:31:07<3:09:56, 11.58s/it] 70%|██████▉   | 2267/3250 [8:31:18<3:09:27, 11.56s/it] 70%|██████▉   | 2268/3250 [8:31:30<3:10:15, 11.62s/it] 70%|██████▉   | 2269/3250 [8:31:42<3:11:19, 11.70s/it] 70%|██████▉   | 2270/3250 [8:31:54<3:11:45, 11.74s/it]                                                       {'loss': 1.8493, 'grad_norm': 0.5039834976196289, 'learning_rate': 0.005, 'epoch': 6.97, 'num_input_tokens_seen': 25736416}
 70%|██████▉   | 2270/3250 [8:31:54<3:11:45, 11.74s/it] 70%|██████▉   | 2271/3250 [8:32:05<3:10:51, 11.70s/it] 70%|██████▉   | 2272/3250 [8:32:17<3:10:42, 11.70s/it] 70%|██████▉   | 2273/3250 [8:32:29<3:11:19, 11.75s/it] 70%|██████▉   | 2274/3250 [8:32:40<3:09:42, 11.66s/it] 70%|███████   | 2275/3250 [8:32:52<3:09:43, 11.68s/it]                                                       {'loss': 1.7529, 'grad_norm': 0.456673264503479, 'learning_rate': 0.005, 'epoch': 6.99, 'num_input_tokens_seen': 25793248}
 70%|███████   | 2275/3250 [8:32:52<3:09:43, 11.68s/it] 70%|███████   | 2276/3250 [8:33:04<3:10:16, 11.72s/it] 70%|███████   | 2277/3250 [8:33:15<3:08:50, 11.64s/it] 70%|███████   | 2278/3250 [8:33:27<3:09:17, 11.68s/it] 70%|███████   | 2279/3250 [8:33:39<3:09:35, 11.72s/it] 70%|███████   | 2280/3250 [8:33:51<3:10:32, 11.79s/it]                                                       {'loss': 1.8211, 'grad_norm': 0.5270116925239563, 'learning_rate': 0.005, 'epoch': 7.0, 'num_input_tokens_seen': 25851104}
 70%|███████   | 2280/3250 [8:33:51<3:10:32, 11.79s/it] 70%|███████   | 2281/3250 [8:34:02<3:07:24, 11.60s/it] 70%|███████   | 2282/3250 [8:34:14<3:07:04, 11.60s/it] 70%|███████   | 2283/3250 [8:34:25<3:06:51, 11.59s/it] 70%|███████   | 2284/3250 [8:34:37<3:07:32, 11.65s/it] 70%|███████   | 2285/3250 [8:34:48<3:06:57, 11.62s/it]                                                       {'loss': 1.8093, 'grad_norm': 13.591681480407715, 'learning_rate': 0.005, 'epoch': 7.02, 'num_input_tokens_seen': 25906336}
 70%|███████   | 2285/3250 [8:34:48<3:06:57, 11.62s/it] 70%|███████   | 2286/3250 [8:35:00<3:05:04, 11.52s/it] 70%|███████   | 2287/3250 [8:35:11<3:05:49, 11.58s/it] 70%|███████   | 2288/3250 [8:35:23<3:06:30, 11.63s/it] 70%|███████   | 2289/3250 [8:35:35<3:07:12, 11.69s/it] 70%|███████   | 2290/3250 [8:35:46<3:05:53, 11.62s/it]                                                       {'loss': 1.7639, 'grad_norm': 0.6722121238708496, 'learning_rate': 0.005, 'epoch': 7.04, 'num_input_tokens_seen': 25962272}
 70%|███████   | 2290/3250 [8:35:46<3:05:53, 11.62s/it] 70%|███████   | 2291/3250 [8:35:58<3:05:36, 11.61s/it] 71%|███████   | 2292/3250 [8:36:10<3:05:08, 11.60s/it] 71%|███████   | 2293/3250 [8:36:21<3:06:04, 11.67s/it] 71%|███████   | 2294/3250 [8:36:33<3:04:20, 11.57s/it] 71%|███████   | 2295/3250 [8:36:44<3:03:55, 11.56s/it]                                                       {'loss': 1.768, 'grad_norm': 0.3414784371852875, 'learning_rate': 0.005, 'epoch': 7.05, 'num_input_tokens_seen': 26017760}
 71%|███████   | 2295/3250 [8:36:44<3:03:55, 11.56s/it] 71%|███████   | 2296/3250 [8:36:56<3:03:55, 11.57s/it] 71%|███████   | 2297/3250 [8:37:08<3:04:52, 11.64s/it] 71%|███████   | 2298/3250 [8:37:19<3:04:24, 11.62s/it] 71%|███████   | 2299/3250 [8:37:31<3:04:26, 11.64s/it] 71%|███████   | 2300/3250 [8:37:43<3:04:13, 11.63s/it]                                                       {'loss': 1.6996, 'grad_norm': 0.423844575881958, 'learning_rate': 0.005, 'epoch': 7.07, 'num_input_tokens_seen': 26074464}
 71%|███████   | 2300/3250 [8:37:43<3:04:13, 11.63s/it][INFO|trainer.py:4021] 2024-10-11 13:29:46,244 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-10-11 13:29:46,244 >>   Num examples = 1157
[INFO|trainer.py:4026] 2024-10-11 13:29:46,244 >>   Batch size = 4

  0%|          | 0/145 [00:00<?, ?it/s][A
  1%|▏         | 2/145 [00:01<01:46,  1.34it/s][A
  2%|▏         | 3/145 [00:03<02:34,  1.09s/it][A
  3%|▎         | 4/145 [00:04<02:53,  1.23s/it][A
  3%|▎         | 5/145 [00:05<03:00,  1.29s/it][A
  4%|▍         | 6/145 [00:07<03:10,  1.37s/it][A
  5%|▍         | 7/145 [00:08<03:16,  1.42s/it][A
  6%|▌         | 8/145 [00:10<03:14,  1.42s/it][A
  6%|▌         | 9/145 [00:11<03:13,  1.43s/it][A
  7%|▋         | 10/145 [00:13<03:14,  1.44s/it][A
  8%|▊         | 11/145 [00:14<03:15,  1.46s/it][A
  8%|▊         | 12/145 [00:16<03:17,  1.49s/it][A
  9%|▉         | 13/145 [00:17<03:18,  1.51s/it][A
 10%|▉         | 14/145 [00:19<03:19,  1.52s/it][A
 10%|█         | 15/145 [00:20<03:16,  1.51s/it][A
 11%|█         | 16/145 [00:22<03:13,  1.50s/it][A
 12%|█▏        | 17/145 [00:23<03:12,  1.51s/it][A
 12%|█▏        | 18/145 [00:25<03:12,  1.51s/it][A
 13%|█▎        | 19/145 [00:27<03:11,  1.52s/it][A
 14%|█▍        | 20/145 [00:28<03:09,  1.51s/it][A
 14%|█▍        | 21/145 [00:29<03:05,  1.49s/it][A
 15%|█▌        | 22/145 [00:31<03:02,  1.48s/it][A
 16%|█▌        | 23/145 [00:32<03:01,  1.48s/it][A
 17%|█▋        | 24/145 [00:34<03:00,  1.49s/it][A
 17%|█▋        | 25/145 [00:35<02:59,  1.49s/it][A
 18%|█▊        | 26/145 [00:37<02:57,  1.49s/it][A
 19%|█▊        | 27/145 [00:38<02:56,  1.49s/it][A
 19%|█▉        | 28/145 [00:40<02:53,  1.49s/it][A
 20%|██        | 29/145 [00:41<02:52,  1.48s/it][A
 21%|██        | 30/145 [00:43<02:46,  1.45s/it][A
 21%|██▏       | 31/145 [00:44<02:47,  1.47s/it][A
 22%|██▏       | 32/145 [00:46<02:46,  1.48s/it][A
 23%|██▎       | 33/145 [00:47<02:46,  1.48s/it][A
 23%|██▎       | 34/145 [00:49<02:45,  1.49s/it][A
 24%|██▍       | 35/145 [00:50<02:44,  1.50s/it][A
 25%|██▍       | 36/145 [00:52<02:42,  1.49s/it][A
 26%|██▌       | 37/145 [00:53<02:44,  1.53s/it][A
 26%|██▌       | 38/145 [00:55<02:43,  1.53s/it][A
 27%|██▋       | 39/145 [00:56<02:40,  1.52s/it][A
 28%|██▊       | 40/145 [00:58<02:39,  1.52s/it][A
 28%|██▊       | 41/145 [00:59<02:39,  1.53s/it][A
 29%|██▉       | 42/145 [01:01<02:37,  1.53s/it][A
 30%|██▉       | 43/145 [01:02<02:34,  1.51s/it][A
 30%|███       | 44/145 [01:04<02:35,  1.54s/it][A
 31%|███       | 45/145 [01:06<02:35,  1.55s/it][A
 32%|███▏      | 46/145 [01:07<02:31,  1.53s/it][A
 32%|███▏      | 47/145 [01:09<02:27,  1.50s/it][A
 33%|███▎      | 48/145 [01:10<02:26,  1.51s/it][A
 34%|███▍      | 49/145 [01:12<02:26,  1.52s/it][A
 34%|███▍      | 50/145 [01:13<02:25,  1.53s/it][A
 35%|███▌      | 51/145 [01:15<02:24,  1.53s/it][A
 36%|███▌      | 52/145 [01:16<02:22,  1.53s/it][A
 37%|███▋      | 53/145 [01:18<02:20,  1.53s/it][A
 37%|███▋      | 54/145 [01:19<02:19,  1.53s/it][A
 38%|███▊      | 55/145 [01:21<02:16,  1.52s/it][A
 39%|███▊      | 56/145 [01:22<02:15,  1.52s/it][A
 39%|███▉      | 57/145 [01:24<02:12,  1.50s/it][A
 40%|████      | 58/145 [01:25<02:10,  1.50s/it][A
 41%|████      | 59/145 [01:27<02:11,  1.52s/it][A
 41%|████▏     | 60/145 [01:28<02:08,  1.51s/it][A
 42%|████▏     | 61/145 [01:30<02:06,  1.51s/it][A
 43%|████▎     | 62/145 [01:31<02:03,  1.49s/it][A
 43%|████▎     | 63/145 [01:33<02:03,  1.51s/it][A
 44%|████▍     | 64/145 [01:34<02:02,  1.51s/it][A
 45%|████▍     | 65/145 [01:36<02:01,  1.52s/it][A
 46%|████▌     | 66/145 [01:37<01:59,  1.52s/it][A
 46%|████▌     | 67/145 [01:39<01:57,  1.50s/it][A
 47%|████▋     | 68/145 [01:40<01:57,  1.53s/it][A
 48%|████▊     | 69/145 [01:42<01:56,  1.54s/it][A
 48%|████▊     | 70/145 [01:43<01:51,  1.49s/it][A
 49%|████▉     | 71/145 [01:45<01:49,  1.48s/it][A
 50%|████▉     | 72/145 [01:46<01:49,  1.50s/it][A
 50%|█████     | 73/145 [01:48<01:49,  1.52s/it][A
 51%|█████     | 74/145 [01:50<01:48,  1.53s/it][A
 52%|█████▏    | 75/145 [01:51<01:47,  1.53s/it][A
 52%|█████▏    | 76/145 [01:53<01:44,  1.52s/it][A
 53%|█████▎    | 77/145 [01:54<01:41,  1.49s/it][A
 54%|█████▍    | 78/145 [01:55<01:40,  1.49s/it][A
 54%|█████▍    | 79/145 [01:57<01:37,  1.48s/it][A
 55%|█████▌    | 80/145 [01:58<01:36,  1.48s/it][A
 56%|█████▌    | 81/145 [02:00<01:33,  1.46s/it][A
 57%|█████▋    | 82/145 [02:01<01:33,  1.48s/it][A
 57%|█████▋    | 83/145 [02:03<01:32,  1.49s/it][A
 58%|█████▊    | 84/145 [02:04<01:31,  1.50s/it][A
 59%|█████▊    | 85/145 [02:06<01:28,  1.47s/it][A
 59%|█████▉    | 86/145 [02:07<01:28,  1.49s/it][A
 60%|██████    | 87/145 [02:09<01:27,  1.52s/it][A
 61%|██████    | 88/145 [02:10<01:25,  1.49s/it][A
 61%|██████▏   | 89/145 [02:12<01:24,  1.50s/it][A
 62%|██████▏   | 90/145 [02:13<01:23,  1.51s/it][A
 63%|██████▎   | 91/145 [02:15<01:21,  1.51s/it][A
 63%|██████▎   | 92/145 [02:16<01:19,  1.50s/it][A
 64%|██████▍   | 93/145 [02:18<01:17,  1.49s/it][A
 65%|██████▍   | 94/145 [02:19<01:15,  1.48s/it][A
 66%|██████▌   | 95/145 [02:21<01:14,  1.49s/it][A
 66%|██████▌   | 96/145 [02:22<01:13,  1.50s/it][A
 67%|██████▋   | 97/145 [02:24<01:12,  1.51s/it][A
 68%|██████▊   | 98/145 [02:25<01:12,  1.54s/it][A
 68%|██████▊   | 99/145 [02:27<01:09,  1.51s/it][A
 69%|██████▉   | 100/145 [02:28<01:08,  1.52s/it][A
 70%|██████▉   | 101/145 [02:30<01:07,  1.53s/it][A
 70%|███████   | 102/145 [02:32<01:05,  1.52s/it][A
 71%|███████   | 103/145 [02:33<01:03,  1.52s/it][A
 72%|███████▏  | 104/145 [02:35<01:02,  1.52s/it][A
 72%|███████▏  | 105/145 [02:36<01:00,  1.52s/it][A
 73%|███████▎  | 106/145 [02:38<00:59,  1.52s/it][A
 74%|███████▍  | 107/145 [02:39<00:56,  1.47s/it][A
 74%|███████▍  | 108/145 [02:40<00:53,  1.45s/it][A
 75%|███████▌  | 109/145 [02:42<00:53,  1.48s/it][A
 76%|███████▌  | 110/145 [02:43<00:52,  1.50s/it][A
 77%|███████▋  | 111/145 [02:45<00:49,  1.46s/it][A
 77%|███████▋  | 112/145 [02:46<00:49,  1.49s/it][A
 78%|███████▊  | 113/145 [02:48<00:48,  1.51s/it][A
 79%|███████▊  | 114/145 [02:50<00:47,  1.52s/it][A
 79%|███████▉  | 115/145 [02:51<00:45,  1.52s/it][A
 80%|████████  | 116/145 [02:52<00:43,  1.49s/it][A
 81%|████████  | 117/145 [02:54<00:41,  1.49s/it][A
 81%|████████▏ | 118/145 [02:55<00:39,  1.48s/it][A
 82%|████████▏ | 119/145 [02:57<00:37,  1.45s/it][A
 83%|████████▎ | 120/145 [02:58<00:35,  1.43s/it][A
 83%|████████▎ | 121/145 [03:00<00:34,  1.43s/it][A
 84%|████████▍ | 122/145 [03:01<00:33,  1.45s/it][A
 85%|████████▍ | 123/145 [03:03<00:32,  1.46s/it][A
 86%|████████▌ | 124/145 [03:04<00:30,  1.45s/it][A
 86%|████████▌ | 125/145 [03:06<00:30,  1.51s/it][A
 87%|████████▋ | 126/145 [03:07<00:28,  1.49s/it][A
 88%|████████▊ | 127/145 [03:09<00:26,  1.48s/it][A
 88%|████████▊ | 128/145 [03:10<00:25,  1.51s/it][A
 89%|████████▉ | 129/145 [03:12<00:24,  1.51s/it][A
 90%|████████▉ | 130/145 [03:13<00:22,  1.53s/it][A
 90%|█████████ | 131/145 [03:15<00:20,  1.49s/it][A
 91%|█████████ | 132/145 [03:16<00:19,  1.51s/it][A
 92%|█████████▏| 133/145 [03:18<00:17,  1.48s/it][A
 92%|█████████▏| 134/145 [03:19<00:16,  1.51s/it][A
 93%|█████████▎| 135/145 [03:21<00:15,  1.52s/it][A
 94%|█████████▍| 136/145 [03:22<00:13,  1.51s/it][A
 94%|█████████▍| 137/145 [03:24<00:12,  1.50s/it][A
 95%|█████████▌| 138/145 [03:25<00:10,  1.52s/it][A
 96%|█████████▌| 139/145 [03:27<00:09,  1.51s/it][A
 97%|█████████▋| 140/145 [03:28<00:07,  1.51s/it][A
 97%|█████████▋| 141/145 [03:30<00:06,  1.52s/it][A
 98%|█████████▊| 142/145 [03:31<00:04,  1.50s/it][A
 99%|█████████▊| 143/145 [03:33<00:02,  1.49s/it][A
 99%|█████████▉| 144/145 [03:34<00:01,  1.51s/it][A
100%|██████████| 145/145 [03:36<00:00,  1.48s/it][A
                                                 [A                                                       {'eval_loss': 1.830086588859558, 'eval_runtime': 217.8126, 'eval_samples_per_second': 5.312, 'eval_steps_per_second': 0.666, 'epoch': 7.07, 'num_input_tokens_seen': 26074464}

100%|██████████| 145/145 [03:36<00:00,  1.48s/it][A 71%|███████   | 2300/3250 [8:41:20<3:04:13, 11.63s/it]
                                                 [A[INFO|trainer.py:3705] 2024-10-11 13:33:24,059 >> Saving model checkpoint to /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2300
[INFO|configuration_utils.py:672] 2024-10-11 13:33:24,645 >> loading configuration file config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/config.json
[WARNING|modeling_rope_utils.py:379] 2024-10-11 13:33:24,645 >> Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
[INFO|configuration_utils.py:739] 2024-10-11 13:33:24,647 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 3584,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 18944,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 28,
  "num_hidden_layers": 28,
  "num_key_value_heads": 4,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.0",
  "use_cache": true,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "in_chans": 3,
    "model_type": "qwen2_vl",
    "spatial_patch_size": 14
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 152064
}

[INFO|tokenization_utils_base.py:2649] 2024-10-11 13:33:24,721 >> tokenizer config file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2300/tokenizer_config.json
[INFO|tokenization_utils_base.py:2658] 2024-10-11 13:33:24,722 >> Special tokens file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2300/special_tokens_map.json
[INFO|image_processing_base.py:258] 2024-10-11 13:33:25,213 >> Image processor saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2300/preprocessor_config.json
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 71%|███████   | 2301/3250 [8:41:33<20:22:20, 77.28s/it] 71%|███████   | 2302/3250 [8:41:45<15:09:09, 57.54s/it] 71%|███████   | 2303/3250 [8:41:56<11:30:48, 43.77s/it] 71%|███████   | 2304/3250 [8:42:08<8:58:13, 34.14s/it]  71%|███████   | 2305/3250 [8:42:20<7:12:56, 27.49s/it]                                                       {'loss': 1.8551, 'grad_norm': 0.49724921584129333, 'learning_rate': 0.005, 'epoch': 7.08, 'num_input_tokens_seen': 26130688}
 71%|███████   | 2305/3250 [8:42:20<7:12:56, 27.49s/it] 71%|███████   | 2306/3250 [8:42:32<5:58:10, 22.76s/it] 71%|███████   | 2307/3250 [8:42:43<5:06:30, 19.50s/it] 71%|███████   | 2308/3250 [8:42:55<4:29:40, 17.18s/it] 71%|███████   | 2309/3250 [8:43:07<4:04:44, 15.60s/it] 71%|███████   | 2310/3250 [8:43:19<3:45:50, 14.42s/it]                                                       {'loss': 1.8097, 'grad_norm': 0.4230138063430786, 'learning_rate': 0.005, 'epoch': 7.1, 'num_input_tokens_seen': 26189056}
 71%|███████   | 2310/3250 [8:43:19<3:45:50, 14.42s/it] 71%|███████   | 2311/3250 [8:43:30<3:30:36, 13.46s/it] 71%|███████   | 2312/3250 [8:43:42<3:21:45, 12.91s/it] 71%|███████   | 2313/3250 [8:43:53<3:16:00, 12.55s/it] 71%|███████   | 2314/3250 [8:44:05<3:11:47, 12.29s/it] 71%|███████   | 2315/3250 [8:44:17<3:09:16, 12.15s/it]                                                       {'loss': 1.7129, 'grad_norm': 1.107628583908081, 'learning_rate': 0.005, 'epoch': 7.11, 'num_input_tokens_seen': 26245856}
 71%|███████   | 2315/3250 [8:44:17<3:09:16, 12.15s/it] 71%|███████▏  | 2316/3250 [8:44:28<3:05:38, 11.93s/it] 71%|███████▏  | 2317/3250 [8:44:40<3:04:56, 11.89s/it] 71%|███████▏  | 2318/3250 [8:44:52<3:04:00, 11.85s/it] 71%|███████▏  | 2319/3250 [8:45:03<3:02:50, 11.78s/it] 71%|███████▏  | 2320/3250 [8:45:15<3:03:24, 11.83s/it]                                                       {'loss': 1.8462, 'grad_norm': 0.6266388297080994, 'learning_rate': 0.005, 'epoch': 7.13, 'num_input_tokens_seen': 26302624}
 71%|███████▏  | 2320/3250 [8:45:15<3:03:24, 11.83s/it] 71%|███████▏  | 2321/3250 [8:45:27<3:02:15, 11.77s/it] 71%|███████▏  | 2322/3250 [8:45:39<3:01:31, 11.74s/it] 71%|███████▏  | 2323/3250 [8:45:50<3:00:49, 11.70s/it] 72%|███████▏  | 2324/3250 [8:46:02<2:59:44, 11.65s/it] 72%|███████▏  | 2325/3250 [8:46:14<2:59:44, 11.66s/it]                                                       {'loss': 1.7949, 'grad_norm': 5.783568382263184, 'learning_rate': 0.005, 'epoch': 7.14, 'num_input_tokens_seen': 26359168}
 72%|███████▏  | 2325/3250 [8:46:14<2:59:44, 11.66s/it] 72%|███████▏  | 2326/3250 [8:46:25<2:59:01, 11.63s/it] 72%|███████▏  | 2327/3250 [8:46:37<2:58:48, 11.62s/it] 72%|███████▏  | 2328/3250 [8:46:48<2:57:56, 11.58s/it] 72%|███████▏  | 2329/3250 [8:47:00<2:57:52, 11.59s/it] 72%|███████▏  | 2330/3250 [8:47:11<2:56:43, 11.53s/it]                                                       {'loss': 1.8514, 'grad_norm': 0.5618712306022644, 'learning_rate': 0.005, 'epoch': 7.16, 'num_input_tokens_seen': 26415296}
 72%|███████▏  | 2330/3250 [8:47:11<2:56:43, 11.53s/it] 72%|███████▏  | 2331/3250 [8:47:23<2:57:59, 11.62s/it] 72%|███████▏  | 2332/3250 [8:47:35<2:57:25, 11.60s/it] 72%|███████▏  | 2333/3250 [8:47:46<2:57:33, 11.62s/it] 72%|███████▏  | 2334/3250 [8:47:58<2:58:34, 11.70s/it] 72%|███████▏  | 2335/3250 [8:48:10<2:58:51, 11.73s/it]                                                       {'loss': 1.7801, 'grad_norm': 0.573464035987854, 'learning_rate': 0.005, 'epoch': 7.17, 'num_input_tokens_seen': 26473056}
 72%|███████▏  | 2335/3250 [8:48:10<2:58:51, 11.73s/it] 72%|███████▏  | 2336/3250 [8:48:22<2:59:22, 11.78s/it] 72%|███████▏  | 2337/3250 [8:48:33<2:58:30, 11.73s/it] 72%|███████▏  | 2338/3250 [8:48:45<2:58:49, 11.77s/it] 72%|███████▏  | 2339/3250 [8:48:57<2:58:22, 11.75s/it] 72%|███████▏  | 2340/3250 [8:49:08<2:56:26, 11.63s/it]                                                       {'loss': 1.9228, 'grad_norm': 1.4580577611923218, 'learning_rate': 0.005, 'epoch': 7.19, 'num_input_tokens_seen': 26530112}
 72%|███████▏  | 2340/3250 [8:49:08<2:56:26, 11.63s/it] 72%|███████▏  | 2341/3250 [8:49:20<2:56:46, 11.67s/it] 72%|███████▏  | 2342/3250 [8:49:32<2:57:45, 11.75s/it] 72%|███████▏  | 2343/3250 [8:49:44<2:56:30, 11.68s/it] 72%|███████▏  | 2344/3250 [8:49:55<2:56:35, 11.69s/it] 72%|███████▏  | 2345/3250 [8:50:07<2:57:00, 11.73s/it]                                                       {'loss': 1.9354, 'grad_norm': 0.6437186002731323, 'learning_rate': 0.005, 'epoch': 7.2, 'num_input_tokens_seen': 26588576}
 72%|███████▏  | 2345/3250 [8:50:07<2:57:00, 11.73s/it] 72%|███████▏  | 2346/3250 [8:50:19<2:55:35, 11.65s/it] 72%|███████▏  | 2347/3250 [8:50:30<2:55:57, 11.69s/it] 72%|███████▏  | 2348/3250 [8:50:42<2:55:00, 11.64s/it] 72%|███████▏  | 2349/3250 [8:50:53<2:54:00, 11.59s/it] 72%|███████▏  | 2350/3250 [8:51:05<2:55:52, 11.73s/it]                                                       {'loss': 1.8156, 'grad_norm': 0.7015158534049988, 'learning_rate': 0.005, 'epoch': 7.22, 'num_input_tokens_seen': 26645408}
 72%|███████▏  | 2350/3250 [8:51:05<2:55:52, 11.73s/it] 72%|███████▏  | 2351/3250 [8:51:17<2:55:28, 11.71s/it] 72%|███████▏  | 2352/3250 [8:51:28<2:52:52, 11.55s/it] 72%|███████▏  | 2353/3250 [8:51:40<2:52:47, 11.56s/it] 72%|███████▏  | 2354/3250 [8:51:51<2:52:54, 11.58s/it] 72%|███████▏  | 2355/3250 [8:52:03<2:52:23, 11.56s/it]                                                       {'loss': 1.7361, 'grad_norm': 9.848684310913086, 'learning_rate': 0.005, 'epoch': 7.24, 'num_input_tokens_seen': 26701376}
 72%|███████▏  | 2355/3250 [8:52:03<2:52:23, 11.56s/it] 72%|███████▏  | 2356/3250 [8:52:14<2:52:09, 11.55s/it] 73%|███████▎  | 2357/3250 [8:52:26<2:52:13, 11.57s/it] 73%|███████▎  | 2358/3250 [8:52:38<2:52:41, 11.62s/it] 73%|███████▎  | 2359/3250 [8:52:49<2:51:16, 11.53s/it] 73%|███████▎  | 2360/3250 [8:53:01<2:50:29, 11.49s/it]                                                       {'loss': 1.7882, 'grad_norm': 3.2362234592437744, 'learning_rate': 0.005, 'epoch': 7.25, 'num_input_tokens_seen': 26758016}
 73%|███████▎  | 2360/3250 [8:53:01<2:50:29, 11.49s/it] 73%|███████▎  | 2361/3250 [8:53:12<2:50:49, 11.53s/it] 73%|███████▎  | 2362/3250 [8:53:24<2:50:57, 11.55s/it] 73%|███████▎  | 2363/3250 [8:53:35<2:51:24, 11.60s/it] 73%|███████▎  | 2364/3250 [8:53:47<2:51:37, 11.62s/it] 73%|███████▎  | 2365/3250 [8:53:59<2:50:49, 11.58s/it]                                                       {'loss': 1.7747, 'grad_norm': 0.7316423058509827, 'learning_rate': 0.005, 'epoch': 7.27, 'num_input_tokens_seen': 26814688}
 73%|███████▎  | 2365/3250 [8:53:59<2:50:49, 11.58s/it] 73%|███████▎  | 2366/3250 [8:54:10<2:51:00, 11.61s/it] 73%|███████▎  | 2367/3250 [8:54:22<2:51:51, 11.68s/it] 73%|███████▎  | 2368/3250 [8:54:34<2:51:42, 11.68s/it] 73%|███████▎  | 2369/3250 [8:54:45<2:49:31, 11.54s/it] 73%|███████▎  | 2370/3250 [8:54:56<2:48:43, 11.50s/it]                                                       {'loss': 1.7457, 'grad_norm': 0.5720497965812683, 'learning_rate': 0.005, 'epoch': 7.28, 'num_input_tokens_seen': 26871424}
 73%|███████▎  | 2370/3250 [8:54:56<2:48:43, 11.50s/it] 73%|███████▎  | 2371/3250 [8:55:08<2:49:59, 11.60s/it] 73%|███████▎  | 2372/3250 [8:55:20<2:50:10, 11.63s/it] 73%|███████▎  | 2373/3250 [8:55:32<2:50:38, 11.67s/it] 73%|███████▎  | 2374/3250 [8:55:43<2:48:27, 11.54s/it] 73%|███████▎  | 2375/3250 [8:55:55<2:48:40, 11.57s/it]                                                       {'loss': 1.7148, 'grad_norm': 0.5866813063621521, 'learning_rate': 0.005, 'epoch': 7.3, 'num_input_tokens_seen': 26927488}
 73%|███████▎  | 2375/3250 [8:55:55<2:48:40, 11.57s/it] 73%|███████▎  | 2376/3250 [8:56:06<2:47:55, 11.53s/it] 73%|███████▎  | 2377/3250 [8:56:18<2:48:14, 11.56s/it] 73%|███████▎  | 2378/3250 [8:56:29<2:48:38, 11.60s/it] 73%|███████▎  | 2379/3250 [8:56:41<2:47:49, 11.56s/it] 73%|███████▎  | 2380/3250 [8:56:53<2:48:30, 11.62s/it]                                                       {'loss': 1.7987, 'grad_norm': 0.2834341526031494, 'learning_rate': 0.005, 'epoch': 7.31, 'num_input_tokens_seen': 26984608}
 73%|███████▎  | 2380/3250 [8:56:53<2:48:30, 11.62s/it] 73%|███████▎  | 2381/3250 [8:57:04<2:46:37, 11.50s/it] 73%|███████▎  | 2382/3250 [8:57:16<2:48:11, 11.63s/it] 73%|███████▎  | 2383/3250 [8:57:27<2:48:16, 11.65s/it] 73%|███████▎  | 2384/3250 [8:57:39<2:47:52, 11.63s/it] 73%|███████▎  | 2385/3250 [8:57:51<2:47:53, 11.65s/it]                                                       {'loss': 1.703, 'grad_norm': 0.3484399914741516, 'learning_rate': 0.005, 'epoch': 7.33, 'num_input_tokens_seen': 27041632}
 73%|███████▎  | 2385/3250 [8:57:51<2:47:53, 11.65s/it] 73%|███████▎  | 2386/3250 [8:58:02<2:47:44, 11.65s/it] 73%|███████▎  | 2387/3250 [8:58:14<2:45:58, 11.54s/it] 73%|███████▎  | 2388/3250 [8:58:25<2:46:49, 11.61s/it] 74%|███████▎  | 2389/3250 [8:58:37<2:46:51, 11.63s/it] 74%|███████▎  | 2390/3250 [8:58:49<2:47:19, 11.67s/it]                                                       {'loss': 1.6966, 'grad_norm': 0.42352294921875, 'learning_rate': 0.005, 'epoch': 7.34, 'num_input_tokens_seen': 27097248}
 74%|███████▎  | 2390/3250 [8:58:49<2:47:19, 11.67s/it] 74%|███████▎  | 2391/3250 [8:59:01<2:47:31, 11.70s/it] 74%|███████▎  | 2392/3250 [8:59:12<2:46:35, 11.65s/it] 74%|███████▎  | 2393/3250 [8:59:24<2:45:43, 11.60s/it] 74%|███████▎  | 2394/3250 [8:59:35<2:44:55, 11.56s/it] 74%|███████▎  | 2395/3250 [8:59:47<2:44:12, 11.52s/it]                                                       {'loss': 1.6827, 'grad_norm': 0.3838818371295929, 'learning_rate': 0.005, 'epoch': 7.36, 'num_input_tokens_seen': 27153184}
 74%|███████▎  | 2395/3250 [8:59:47<2:44:12, 11.52s/it] 74%|███████▎  | 2396/3250 [8:59:58<2:41:47, 11.37s/it] 74%|███████▍  | 2397/3250 [9:00:09<2:42:43, 11.45s/it] 74%|███████▍  | 2398/3250 [9:00:21<2:41:53, 11.40s/it] 74%|███████▍  | 2399/3250 [9:00:31<2:39:43, 11.26s/it] 74%|███████▍  | 2400/3250 [9:00:43<2:41:09, 11.38s/it]                                                       {'loss': 1.6358, 'grad_norm': 0.6057211756706238, 'learning_rate': 0.005, 'epoch': 7.37, 'num_input_tokens_seen': 27208288}
 74%|███████▍  | 2400/3250 [9:00:43<2:41:09, 11.38s/it][INFO|trainer.py:4021] 2024-10-11 13:52:46,702 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-10-11 13:52:46,702 >>   Num examples = 1157
[INFO|trainer.py:4026] 2024-10-11 13:52:46,702 >>   Batch size = 4

  0%|          | 0/145 [00:00<?, ?it/s][A
  1%|▏         | 2/145 [00:01<01:47,  1.33it/s][A
  2%|▏         | 3/145 [00:03<02:34,  1.09s/it][A
  3%|▎         | 4/145 [00:04<02:54,  1.23s/it][A
  3%|▎         | 5/145 [00:05<02:59,  1.29s/it][A
  4%|▍         | 6/145 [00:07<03:10,  1.37s/it][A
  5%|▍         | 7/145 [00:08<03:16,  1.42s/it][A
  6%|▌         | 8/145 [00:10<03:14,  1.42s/it][A
  6%|▌         | 9/145 [00:11<03:13,  1.43s/it][A
  7%|▋         | 10/145 [00:13<03:15,  1.45s/it][A
  8%|▊         | 11/145 [00:14<03:16,  1.46s/it][A
  8%|▊         | 12/145 [00:16<03:18,  1.49s/it][A
  9%|▉         | 13/145 [00:17<03:19,  1.51s/it][A
 10%|▉         | 14/145 [00:19<03:20,  1.53s/it][A
 10%|█         | 15/145 [00:21<03:17,  1.52s/it][A
 11%|█         | 16/145 [00:22<03:14,  1.51s/it][A
 12%|█▏        | 17/145 [00:24<03:13,  1.51s/it][A
 12%|█▏        | 18/145 [00:25<03:12,  1.52s/it][A
 13%|█▎        | 19/145 [00:27<03:12,  1.52s/it][A
 14%|█▍        | 20/145 [00:28<03:10,  1.53s/it][A
 14%|█▍        | 21/145 [00:30<03:06,  1.50s/it][A
 15%|█▌        | 22/145 [00:31<03:03,  1.49s/it][A
 16%|█▌        | 23/145 [00:33<03:02,  1.49s/it][A
 17%|█▋        | 24/145 [00:34<03:01,  1.50s/it][A
 17%|█▋        | 25/145 [00:36<02:59,  1.50s/it][A
 18%|█▊        | 26/145 [00:37<02:57,  1.49s/it][A
 19%|█▊        | 27/145 [00:39<02:56,  1.50s/it][A
 19%|█▉        | 28/145 [00:40<02:54,  1.49s/it][A
 20%|██        | 29/145 [00:41<02:52,  1.49s/it][A
 21%|██        | 30/145 [00:43<02:47,  1.46s/it][A
 21%|██▏       | 31/145 [00:44<02:48,  1.48s/it][A
 22%|██▏       | 32/145 [00:46<02:47,  1.48s/it][A
 23%|██▎       | 33/145 [00:47<02:46,  1.49s/it][A
 23%|██▎       | 34/145 [00:49<02:45,  1.49s/it][A
 24%|██▍       | 35/145 [00:50<02:44,  1.50s/it][A
 25%|██▍       | 36/145 [00:52<02:42,  1.50s/it][A
 26%|██▌       | 37/145 [00:54<02:45,  1.53s/it][A
 26%|██▌       | 38/145 [00:55<02:43,  1.53s/it][A
 27%|██▋       | 39/145 [00:57<02:41,  1.52s/it][A
 28%|██▊       | 40/145 [00:58<02:39,  1.52s/it][A
 28%|██▊       | 41/145 [01:00<02:39,  1.54s/it][A
 29%|██▉       | 42/145 [01:01<02:38,  1.54s/it][A
 30%|██▉       | 43/145 [01:03<02:35,  1.52s/it][A
 30%|███       | 44/145 [01:04<02:36,  1.55s/it][A
 31%|███       | 45/145 [01:06<02:36,  1.56s/it][A
 32%|███▏      | 46/145 [01:07<02:32,  1.54s/it][A
 32%|███▏      | 47/145 [01:09<02:28,  1.51s/it][A
 33%|███▎      | 48/145 [01:10<02:27,  1.52s/it][A
 34%|███▍      | 49/145 [01:12<02:26,  1.53s/it][A
 34%|███▍      | 50/145 [01:13<02:25,  1.54s/it][A
 35%|███▌      | 51/145 [01:15<02:24,  1.54s/it][A
 36%|███▌      | 52/145 [01:16<02:22,  1.53s/it][A
 37%|███▋      | 53/145 [01:18<02:20,  1.53s/it][A
 37%|███▋      | 54/145 [01:20<02:19,  1.54s/it][A
 38%|███▊      | 55/145 [01:21<02:17,  1.52s/it][A
 39%|███▊      | 56/145 [01:23<02:15,  1.52s/it][A
 39%|███▉      | 57/145 [01:24<02:12,  1.51s/it][A
 40%|████      | 58/145 [01:26<02:10,  1.50s/it][A
 41%|████      | 59/145 [01:27<02:11,  1.53s/it][A
 41%|████▏     | 60/145 [01:29<02:08,  1.52s/it][A
 42%|████▏     | 61/145 [01:30<02:07,  1.51s/it][A
 43%|████▎     | 62/145 [01:32<02:04,  1.50s/it][A
 43%|████▎     | 63/145 [01:33<02:04,  1.51s/it][A
 44%|████▍     | 64/145 [01:35<02:02,  1.51s/it][A
 45%|████▍     | 65/145 [01:36<02:01,  1.52s/it][A
 46%|████▌     | 66/145 [01:38<02:00,  1.52s/it][A
 46%|████▌     | 67/145 [01:39<01:57,  1.51s/it][A
 47%|████▋     | 68/145 [01:41<01:58,  1.53s/it][A
 48%|████▊     | 69/145 [01:42<01:57,  1.54s/it][A
 48%|████▊     | 70/145 [01:44<01:51,  1.49s/it][A
 49%|████▉     | 71/145 [01:45<01:49,  1.48s/it][A
 50%|████▉     | 72/145 [01:47<01:49,  1.50s/it][A
 50%|█████     | 73/145 [01:48<01:49,  1.52s/it][A
 51%|█████     | 74/145 [01:50<01:48,  1.53s/it][A
 52%|█████▏    | 75/145 [01:51<01:47,  1.53s/it][A
 52%|█████▏    | 76/145 [01:53<01:45,  1.52s/it][A
 53%|█████▎    | 77/145 [01:54<01:41,  1.50s/it][A
 54%|█████▍    | 78/145 [01:56<01:40,  1.50s/it][A
 54%|█████▍    | 79/145 [01:57<01:38,  1.49s/it][A
 55%|█████▌    | 80/145 [01:59<01:36,  1.48s/it][A
 56%|█████▌    | 81/145 [02:00<01:33,  1.46s/it][A
 57%|█████▋    | 82/145 [02:02<01:33,  1.48s/it][A
 57%|█████▋    | 83/145 [02:03<01:32,  1.50s/it][A
 58%|█████▊    | 84/145 [02:05<01:31,  1.51s/it][A
 59%|█████▊    | 85/145 [02:06<01:28,  1.48s/it][A
 59%|█████▉    | 86/145 [02:08<01:28,  1.49s/it][A
 60%|██████    | 87/145 [02:09<01:28,  1.52s/it][A
 61%|██████    | 88/145 [02:11<01:25,  1.49s/it][A
 61%|██████▏   | 89/145 [02:12<01:24,  1.50s/it][A
 62%|██████▏   | 90/145 [02:14<01:23,  1.52s/it][A
 63%|██████▎   | 91/145 [02:15<01:21,  1.51s/it][A
 63%|██████▎   | 92/145 [02:17<01:19,  1.51s/it][A
 64%|██████▍   | 93/145 [02:18<01:17,  1.49s/it][A
 65%|██████▍   | 94/145 [02:20<01:15,  1.48s/it][A
 66%|██████▌   | 95/145 [02:21<01:14,  1.49s/it][A
 66%|██████▌   | 96/145 [02:23<01:13,  1.50s/it][A
 67%|██████▋   | 97/145 [02:24<01:12,  1.51s/it][A
 68%|██████▊   | 98/145 [02:26<01:12,  1.54s/it][A
 68%|██████▊   | 99/145 [02:27<01:09,  1.52s/it][A
 69%|██████▉   | 100/145 [02:29<01:08,  1.52s/it][A
 70%|██████▉   | 101/145 [02:30<01:07,  1.53s/it][A
 70%|███████   | 102/145 [02:32<01:05,  1.52s/it][A
 71%|███████   | 103/145 [02:33<01:03,  1.52s/it][A
 72%|███████▏  | 104/145 [02:35<01:02,  1.53s/it][A
 72%|███████▏  | 105/145 [02:36<01:00,  1.52s/it][A
 73%|███████▎  | 106/145 [02:38<00:59,  1.52s/it][A
 74%|███████▍  | 107/145 [02:39<00:56,  1.48s/it][A
 74%|███████▍  | 108/145 [02:41<00:53,  1.45s/it][A
 75%|███████▌  | 109/145 [02:42<00:53,  1.48s/it][A
 76%|███████▌  | 110/145 [02:44<00:52,  1.50s/it][A
 77%|███████▋  | 111/145 [02:45<00:49,  1.46s/it][A
 77%|███████▋  | 112/145 [02:47<00:49,  1.49s/it][A
 78%|███████▊  | 113/145 [02:48<00:48,  1.51s/it][A
 79%|███████▊  | 114/145 [02:50<00:47,  1.52s/it][A
 79%|███████▉  | 115/145 [02:51<00:45,  1.52s/it][A
 80%|████████  | 116/145 [02:53<00:43,  1.49s/it][A
 81%|████████  | 117/145 [02:54<00:41,  1.49s/it][A
 81%|████████▏ | 118/145 [02:56<00:40,  1.48s/it][A
 82%|████████▏ | 119/145 [02:57<00:37,  1.45s/it][A
 83%|████████▎ | 120/145 [02:59<00:35,  1.43s/it][A
 83%|████████▎ | 121/145 [03:00<00:34,  1.44s/it][A
 84%|████████▍ | 122/145 [03:01<00:33,  1.45s/it][A
 85%|████████▍ | 123/145 [03:03<00:32,  1.46s/it][A
 86%|████████▌ | 124/145 [03:04<00:30,  1.45s/it][A
 86%|████████▌ | 125/145 [03:06<00:30,  1.51s/it][A
 87%|████████▋ | 126/145 [03:08<00:28,  1.49s/it][A
 88%|████████▊ | 127/145 [03:09<00:26,  1.49s/it][A
 88%|████████▊ | 128/145 [03:11<00:25,  1.52s/it][A
 89%|████████▉ | 129/145 [03:12<00:24,  1.51s/it][A
 90%|████████▉ | 130/145 [03:14<00:23,  1.54s/it][A
 90%|█████████ | 131/145 [03:15<00:20,  1.50s/it][A
 91%|█████████ | 132/145 [03:17<00:19,  1.51s/it][A
 92%|█████████▏| 133/145 [03:18<00:17,  1.49s/it][A
 92%|█████████▏| 134/145 [03:20<00:16,  1.52s/it][A
 93%|█████████▎| 135/145 [03:21<00:15,  1.52s/it][A
 94%|█████████▍| 136/145 [03:23<00:13,  1.52s/it][A
 94%|█████████▍| 137/145 [03:24<00:12,  1.51s/it][A
 95%|█████████▌| 138/145 [03:26<00:10,  1.52s/it][A
 96%|█████████▌| 139/145 [03:27<00:09,  1.51s/it][A
 97%|█████████▋| 140/145 [03:29<00:07,  1.52s/it][A
 97%|█████████▋| 141/145 [03:30<00:06,  1.52s/it][A
 98%|█████████▊| 142/145 [03:32<00:04,  1.51s/it][A
 99%|█████████▊| 143/145 [03:33<00:02,  1.50s/it][A
 99%|█████████▉| 144/145 [03:35<00:01,  1.51s/it][A
100%|██████████| 145/145 [03:36<00:00,  1.48s/it][A
                                                 [A                                                       {'eval_loss': 1.601271152496338, 'eval_runtime': 218.3218, 'eval_samples_per_second': 5.3, 'eval_steps_per_second': 0.664, 'epoch': 7.37, 'num_input_tokens_seen': 27208288}

100%|██████████| 145/145 [03:36<00:00,  1.48s/it][A 74%|███████▍  | 2400/3250 [9:04:21<2:41:09, 11.38s/it]
                                                 [A[INFO|trainer.py:3705] 2024-10-11 13:56:25,026 >> Saving model checkpoint to /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2400
[INFO|configuration_utils.py:672] 2024-10-11 13:56:25,628 >> loading configuration file config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/config.json
[WARNING|modeling_rope_utils.py:379] 2024-10-11 13:56:25,628 >> Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
[INFO|configuration_utils.py:739] 2024-10-11 13:56:25,630 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 3584,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 18944,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 28,
  "num_hidden_layers": 28,
  "num_key_value_heads": 4,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.0",
  "use_cache": true,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "in_chans": 3,
    "model_type": "qwen2_vl",
    "spatial_patch_size": 14
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 152064
}

[INFO|tokenization_utils_base.py:2649] 2024-10-11 13:56:25,706 >> tokenizer config file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2400/tokenizer_config.json
[INFO|tokenization_utils_base.py:2658] 2024-10-11 13:56:25,706 >> Special tokens file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2400/special_tokens_map.json
[INFO|image_processing_base.py:258] 2024-10-11 13:56:26,195 >> Image processor saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2400/preprocessor_config.json
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 74%|███████▍  | 2401/3250 [9:04:34<18:13:17, 77.26s/it] 74%|███████▍  | 2402/3250 [9:04:46<13:33:16, 57.54s/it] 74%|███████▍  | 2403/3250 [9:04:57<10:16:37, 43.68s/it] 74%|███████▍  | 2404/3250 [9:05:09<8:00:01, 34.04s/it]  74%|███████▍  | 2405/3250 [9:05:20<6:23:27, 27.23s/it]                                                       {'loss': 1.7181, 'grad_norm': 0.4242566227912903, 'learning_rate': 0.005, 'epoch': 7.39, 'num_input_tokens_seen': 27265152}
 74%|███████▍  | 2405/3250 [9:05:20<6:23:27, 27.23s/it] 74%|███████▍  | 2406/3250 [9:05:31<5:17:02, 22.54s/it] 74%|███████▍  | 2407/3250 [9:05:43<4:29:24, 19.18s/it] 74%|███████▍  | 2408/3250 [9:05:54<3:56:45, 16.87s/it] 74%|███████▍  | 2409/3250 [9:06:06<3:33:36, 15.24s/it] 74%|███████▍  | 2410/3250 [9:06:17<3:17:13, 14.09s/it]                                                       {'loss': 1.6402, 'grad_norm': 0.28565165400505066, 'learning_rate': 0.005, 'epoch': 7.4, 'num_input_tokens_seen': 27321600}
 74%|███████▍  | 2410/3250 [9:06:17<3:17:13, 14.09s/it] 74%|███████▍  | 2411/3250 [9:06:29<3:06:05, 13.31s/it] 74%|███████▍  | 2412/3250 [9:06:40<2:57:23, 12.70s/it] 74%|███████▍  | 2413/3250 [9:06:51<2:51:52, 12.32s/it] 74%|███████▍  | 2414/3250 [9:07:03<2:48:27, 12.09s/it] 74%|███████▍  | 2415/3250 [9:07:14<2:45:49, 11.92s/it]                                                       {'loss': 1.6103, 'grad_norm': 0.5235552787780762, 'learning_rate': 0.005, 'epoch': 7.42, 'num_input_tokens_seen': 27378560}
 74%|███████▍  | 2415/3250 [9:07:14<2:45:49, 11.92s/it] 74%|███████▍  | 2416/3250 [9:07:26<2:44:08, 11.81s/it] 74%|███████▍  | 2417/3250 [9:07:37<2:41:44, 11.65s/it] 74%|███████▍  | 2418/3250 [9:07:49<2:40:55, 11.61s/it] 74%|███████▍  | 2419/3250 [9:08:00<2:39:27, 11.51s/it] 74%|███████▍  | 2420/3250 [9:08:12<2:40:09, 11.58s/it]                                                       {'loss': 1.5687, 'grad_norm': 0.28685125708580017, 'learning_rate': 0.005, 'epoch': 7.43, 'num_input_tokens_seen': 27435104}
 74%|███████▍  | 2420/3250 [9:08:12<2:40:09, 11.58s/it] 74%|███████▍  | 2421/3250 [9:08:23<2:39:10, 11.52s/it] 75%|███████▍  | 2422/3250 [9:08:34<2:37:45, 11.43s/it] 75%|███████▍  | 2423/3250 [9:08:46<2:37:27, 11.42s/it] 75%|███████▍  | 2424/3250 [9:08:57<2:37:06, 11.41s/it] 75%|███████▍  | 2425/3250 [9:09:09<2:37:03, 11.42s/it]                                                       {'loss': 1.6827, 'grad_norm': 0.6322144865989685, 'learning_rate': 0.005, 'epoch': 7.45, 'num_input_tokens_seen': 27491136}
 75%|███████▍  | 2425/3250 [9:09:09<2:37:03, 11.42s/it] 75%|███████▍  | 2426/3250 [9:09:20<2:37:13, 11.45s/it] 75%|███████▍  | 2427/3250 [9:09:32<2:37:09, 11.46s/it] 75%|███████▍  | 2428/3250 [9:09:43<2:37:37, 11.51s/it] 75%|███████▍  | 2429/3250 [9:09:55<2:37:35, 11.52s/it] 75%|███████▍  | 2430/3250 [9:10:06<2:36:17, 11.44s/it]                                                       {'loss': 1.6405, 'grad_norm': 0.4882526099681854, 'learning_rate': 0.005, 'epoch': 7.47, 'num_input_tokens_seen': 27548992}
 75%|███████▍  | 2430/3250 [9:10:06<2:36:17, 11.44s/it] 75%|███████▍  | 2431/3250 [9:10:17<2:35:09, 11.37s/it] 75%|███████▍  | 2432/3250 [9:10:29<2:35:13, 11.39s/it] 75%|███████▍  | 2433/3250 [9:10:40<2:35:51, 11.45s/it] 75%|███████▍  | 2434/3250 [9:10:52<2:35:26, 11.43s/it] 75%|███████▍  | 2435/3250 [9:11:03<2:34:46, 11.39s/it]                                                       {'loss': 1.6504, 'grad_norm': 0.6084161400794983, 'learning_rate': 0.005, 'epoch': 7.48, 'num_input_tokens_seen': 27605216}
 75%|███████▍  | 2435/3250 [9:11:03<2:34:46, 11.39s/it] 75%|███████▍  | 2436/3250 [9:11:14<2:33:41, 11.33s/it] 75%|███████▍  | 2437/3250 [9:11:26<2:34:05, 11.37s/it] 75%|███████▌  | 2438/3250 [9:11:37<2:34:40, 11.43s/it] 75%|███████▌  | 2439/3250 [9:11:49<2:35:26, 11.50s/it] 75%|███████▌  | 2440/3250 [9:12:00<2:35:10, 11.49s/it]                                                       {'loss': 1.5801, 'grad_norm': 0.5469775199890137, 'learning_rate': 0.005, 'epoch': 7.5, 'num_input_tokens_seen': 27662048}
 75%|███████▌  | 2440/3250 [9:12:00<2:35:10, 11.49s/it] 75%|███████▌  | 2441/3250 [9:12:12<2:35:01, 11.50s/it] 75%|███████▌  | 2442/3250 [9:12:23<2:35:02, 11.51s/it] 75%|███████▌  | 2443/3250 [9:12:35<2:35:19, 11.55s/it] 75%|███████▌  | 2444/3250 [9:12:46<2:35:05, 11.54s/it] 75%|███████▌  | 2445/3250 [9:12:58<2:35:05, 11.56s/it]                                                       {'loss': 1.6544, 'grad_norm': 1.0064425468444824, 'learning_rate': 0.005, 'epoch': 7.51, 'num_input_tokens_seen': 27719808}
 75%|███████▌  | 2445/3250 [9:12:58<2:35:05, 11.56s/it] 75%|███████▌  | 2446/3250 [9:13:10<2:35:18, 11.59s/it] 75%|███████▌  | 2447/3250 [9:13:21<2:33:18, 11.46s/it] 75%|███████▌  | 2448/3250 [9:13:32<2:33:15, 11.47s/it] 75%|███████▌  | 2449/3250 [9:13:44<2:33:39, 11.51s/it] 75%|███████▌  | 2450/3250 [9:13:56<2:33:58, 11.55s/it]                                                       {'loss': 1.5867, 'grad_norm': 1.662537693977356, 'learning_rate': 0.005, 'epoch': 7.53, 'num_input_tokens_seen': 27776192}
 75%|███████▌  | 2450/3250 [9:13:56<2:33:58, 11.55s/it] 75%|███████▌  | 2451/3250 [9:14:07<2:32:00, 11.42s/it] 75%|███████▌  | 2452/3250 [9:14:18<2:31:54, 11.42s/it] 75%|███████▌  | 2453/3250 [9:14:30<2:31:46, 11.43s/it] 76%|███████▌  | 2454/3250 [9:14:41<2:30:09, 11.32s/it] 76%|███████▌  | 2455/3250 [9:14:52<2:28:22, 11.20s/it]                                                       {'loss': 1.5652, 'grad_norm': 0.35350343585014343, 'learning_rate': 0.005, 'epoch': 7.54, 'num_input_tokens_seen': 27832096}
 76%|███████▌  | 2455/3250 [9:14:52<2:28:22, 11.20s/it] 76%|███████▌  | 2456/3250 [9:15:03<2:28:49, 11.25s/it] 76%|███████▌  | 2457/3250 [9:15:14<2:29:32, 11.31s/it] 76%|███████▌  | 2458/3250 [9:15:26<2:30:23, 11.39s/it] 76%|███████▌  | 2459/3250 [9:15:37<2:29:37, 11.35s/it] 76%|███████▌  | 2460/3250 [9:15:49<2:29:17, 11.34s/it]                                                       {'loss': 1.6133, 'grad_norm': 0.5121628642082214, 'learning_rate': 0.005, 'epoch': 7.56, 'num_input_tokens_seen': 27888640}
 76%|███████▌  | 2460/3250 [9:15:49<2:29:17, 11.34s/it] 76%|███████▌  | 2461/3250 [9:16:00<2:28:25, 11.29s/it] 76%|███████▌  | 2462/3250 [9:16:11<2:28:50, 11.33s/it] 76%|███████▌  | 2463/3250 [9:16:22<2:28:33, 11.33s/it] 76%|███████▌  | 2464/3250 [9:16:34<2:28:55, 11.37s/it] 76%|███████▌  | 2465/3250 [9:16:45<2:28:21, 11.34s/it]                                                       {'loss': 1.6856, 'grad_norm': 0.45921704173088074, 'learning_rate': 0.005, 'epoch': 7.57, 'num_input_tokens_seen': 27945184}
 76%|███████▌  | 2465/3250 [9:16:45<2:28:21, 11.34s/it] 76%|███████▌  | 2466/3250 [9:16:57<2:28:14, 11.35s/it] 76%|███████▌  | 2467/3250 [9:17:08<2:28:34, 11.39s/it] 76%|███████▌  | 2468/3250 [9:17:19<2:28:08, 11.37s/it] 76%|███████▌  | 2469/3250 [9:17:31<2:28:27, 11.41s/it] 76%|███████▌  | 2470/3250 [9:17:42<2:28:59, 11.46s/it]                                                       {'loss': 1.6506, 'grad_norm': 0.4332016110420227, 'learning_rate': 0.005, 'epoch': 7.59, 'num_input_tokens_seen': 28003456}
 76%|███████▌  | 2470/3250 [9:17:42<2:28:59, 11.46s/it] 76%|███████▌  | 2471/3250 [9:17:54<2:29:17, 11.50s/it] 76%|███████▌  | 2472/3250 [9:18:05<2:27:43, 11.39s/it] 76%|███████▌  | 2473/3250 [9:18:16<2:27:16, 11.37s/it] 76%|███████▌  | 2474/3250 [9:18:28<2:25:59, 11.29s/it] 76%|███████▌  | 2475/3250 [9:18:39<2:25:20, 11.25s/it]                                                       {'loss': 1.7147, 'grad_norm': 0.4528111219406128, 'learning_rate': 0.005, 'epoch': 7.6, 'num_input_tokens_seen': 28058560}
 76%|███████▌  | 2475/3250 [9:18:39<2:25:20, 11.25s/it] 76%|███████▌  | 2476/3250 [9:18:50<2:25:42, 11.29s/it] 76%|███████▌  | 2477/3250 [9:19:02<2:25:49, 11.32s/it] 76%|███████▌  | 2478/3250 [9:19:13<2:26:35, 11.39s/it] 76%|███████▋  | 2479/3250 [9:19:25<2:27:22, 11.47s/it] 76%|███████▋  | 2480/3250 [9:19:36<2:27:13, 11.47s/it]                                                       {'loss': 1.7178, 'grad_norm': 0.6700091361999512, 'learning_rate': 0.005, 'epoch': 7.62, 'num_input_tokens_seen': 28115136}
 76%|███████▋  | 2480/3250 [9:19:36<2:27:13, 11.47s/it] 76%|███████▋  | 2481/3250 [9:19:48<2:27:26, 11.50s/it] 76%|███████▋  | 2482/3250 [9:19:59<2:26:48, 11.47s/it] 76%|███████▋  | 2483/3250 [9:20:11<2:26:48, 11.48s/it] 76%|███████▋  | 2484/3250 [9:20:22<2:27:35, 11.56s/it] 76%|███████▋  | 2485/3250 [9:20:34<2:26:31, 11.49s/it]                                                       {'loss': 1.6586, 'grad_norm': 0.39794427156448364, 'learning_rate': 0.005, 'epoch': 7.63, 'num_input_tokens_seen': 28171840}
 76%|███████▋  | 2485/3250 [9:20:34<2:26:31, 11.49s/it] 76%|███████▋  | 2486/3250 [9:20:45<2:26:39, 11.52s/it] 77%|███████▋  | 2487/3250 [9:20:56<2:24:42, 11.38s/it] 77%|███████▋  | 2488/3250 [9:21:08<2:24:34, 11.38s/it] 77%|███████▋  | 2489/3250 [9:21:20<2:25:40, 11.49s/it] 77%|███████▋  | 2490/3250 [9:21:31<2:25:05, 11.45s/it]                                                       {'loss': 1.6676, 'grad_norm': 0.8586061000823975, 'learning_rate': 0.005, 'epoch': 7.65, 'num_input_tokens_seen': 28228640}
 77%|███████▋  | 2490/3250 [9:21:31<2:25:05, 11.45s/it] 77%|███████▋  | 2491/3250 [9:21:43<2:25:30, 11.50s/it] 77%|███████▋  | 2492/3250 [9:21:54<2:23:55, 11.39s/it] 77%|███████▋  | 2493/3250 [9:22:05<2:24:18, 11.44s/it] 77%|███████▋  | 2494/3250 [9:22:17<2:24:12, 11.44s/it] 77%|███████▋  | 2495/3250 [9:22:28<2:24:33, 11.49s/it]                                                       {'loss': 1.6695, 'grad_norm': 0.22314950823783875, 'learning_rate': 0.005, 'epoch': 7.67, 'num_input_tokens_seen': 28285760}
 77%|███████▋  | 2495/3250 [9:22:28<2:24:33, 11.49s/it] 77%|███████▋  | 2496/3250 [9:22:40<2:23:34, 11.42s/it] 77%|███████▋  | 2497/3250 [9:22:51<2:24:19, 11.50s/it] 77%|███████▋  | 2498/3250 [9:23:03<2:23:57, 11.49s/it] 77%|███████▋  | 2499/3250 [9:23:14<2:24:21, 11.53s/it] 77%|███████▋  | 2500/3250 [9:23:26<2:23:30, 11.48s/it]                                                       {'loss': 1.6497, 'grad_norm': 0.7457538843154907, 'learning_rate': 0.005, 'epoch': 7.68, 'num_input_tokens_seen': 28341568}
 77%|███████▋  | 2500/3250 [9:23:26<2:23:30, 11.48s/it][INFO|trainer.py:4021] 2024-10-11 14:15:29,278 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-10-11 14:15:29,278 >>   Num examples = 1157
[INFO|trainer.py:4026] 2024-10-11 14:15:29,278 >>   Batch size = 4

  0%|          | 0/145 [00:00<?, ?it/s][A
  1%|▏         | 2/145 [00:01<01:47,  1.33it/s][A
  2%|▏         | 3/145 [00:03<02:34,  1.09s/it][A
  3%|▎         | 4/145 [00:04<02:54,  1.24s/it][A
  3%|▎         | 5/145 [00:05<03:00,  1.29s/it][A
  4%|▍         | 6/145 [00:07<03:10,  1.37s/it][A
  5%|▍         | 7/145 [00:09<03:16,  1.43s/it][A
  6%|▌         | 8/145 [00:10<03:14,  1.42s/it][A
  6%|▌         | 9/145 [00:11<03:14,  1.43s/it][A
  7%|▋         | 10/145 [00:13<03:15,  1.45s/it][A
  8%|▊         | 11/145 [00:14<03:16,  1.47s/it][A
  8%|▊         | 12/145 [00:16<03:19,  1.50s/it][A
  9%|▉         | 13/145 [00:18<03:19,  1.51s/it][A
 10%|▉         | 14/145 [00:19<03:20,  1.53s/it][A
 10%|█         | 15/145 [00:21<03:17,  1.52s/it][A
 11%|█         | 16/145 [00:22<03:14,  1.51s/it][A
 12%|█▏        | 17/145 [00:24<03:13,  1.51s/it][A
 12%|█▏        | 18/145 [00:25<03:12,  1.52s/it][A
 13%|█▎        | 19/145 [00:27<03:11,  1.52s/it][A
 14%|█▍        | 20/145 [00:28<03:10,  1.52s/it][A
 14%|█▍        | 21/145 [00:30<03:06,  1.50s/it][A
 15%|█▌        | 22/145 [00:31<03:03,  1.49s/it][A
 16%|█▌        | 23/145 [00:33<03:02,  1.49s/it][A
 17%|█▋        | 24/145 [00:34<03:01,  1.50s/it][A
 17%|█▋        | 25/145 [00:36<02:59,  1.50s/it][A
 18%|█▊        | 26/145 [00:37<02:57,  1.49s/it][A
 19%|█▊        | 27/145 [00:39<02:56,  1.50s/it][A
 19%|█▉        | 28/145 [00:40<02:54,  1.49s/it][A
 20%|██        | 29/145 [00:42<02:53,  1.49s/it][A
 21%|██        | 30/145 [00:43<02:47,  1.46s/it][A
 21%|██▏       | 31/145 [00:44<02:48,  1.47s/it][A
 22%|██▏       | 32/145 [00:46<02:47,  1.48s/it][A
 23%|██▎       | 33/145 [00:47<02:46,  1.49s/it][A
 23%|██▎       | 34/145 [00:49<02:45,  1.49s/it][A
 24%|██▍       | 35/145 [00:50<02:45,  1.50s/it][A
 25%|██▍       | 36/145 [00:52<02:43,  1.50s/it][A
 26%|██▌       | 37/145 [00:54<02:45,  1.53s/it][A
 26%|██▌       | 38/145 [00:55<02:44,  1.53s/it][A
 27%|██▋       | 39/145 [00:57<02:41,  1.52s/it][A
 28%|██▊       | 40/145 [00:58<02:39,  1.52s/it][A
 28%|██▊       | 41/145 [01:00<02:40,  1.54s/it][A
 29%|██▉       | 42/145 [01:01<02:38,  1.54s/it][A
 30%|██▉       | 43/145 [01:03<02:34,  1.52s/it][A
 30%|███       | 44/145 [01:04<02:36,  1.55s/it][A
 31%|███       | 45/145 [01:06<02:36,  1.56s/it][A
 32%|███▏      | 46/145 [01:07<02:32,  1.54s/it][A
 32%|███▏      | 47/145 [01:09<02:28,  1.51s/it][A
 33%|███▎      | 48/145 [01:10<02:27,  1.52s/it][A
 34%|███▍      | 49/145 [01:12<02:26,  1.53s/it][A
 34%|███▍      | 50/145 [01:13<02:26,  1.54s/it][A
 35%|███▌      | 51/145 [01:15<02:24,  1.53s/it][A
 36%|███▌      | 52/145 [01:17<02:22,  1.53s/it][A
 37%|███▋      | 53/145 [01:18<02:20,  1.53s/it][A
 37%|███▋      | 54/145 [01:20<02:19,  1.54s/it][A
 38%|███▊      | 55/145 [01:21<02:17,  1.52s/it][A
 39%|███▊      | 56/145 [01:23<02:15,  1.52s/it][A
 39%|███▉      | 57/145 [01:24<02:13,  1.51s/it][A
 40%|████      | 58/145 [01:26<02:10,  1.50s/it][A
 41%|████      | 59/145 [01:27<02:11,  1.53s/it][A
 41%|████▏     | 60/145 [01:29<02:08,  1.52s/it][A
 42%|████▏     | 61/145 [01:30<02:07,  1.51s/it][A
 43%|████▎     | 62/145 [01:32<02:04,  1.50s/it][A
 43%|████▎     | 63/145 [01:33<02:04,  1.52s/it][A
 44%|████▍     | 64/145 [01:35<02:02,  1.51s/it][A
 45%|████▍     | 65/145 [01:36<02:01,  1.52s/it][A
 46%|████▌     | 66/145 [01:38<02:00,  1.52s/it][A
 46%|████▌     | 67/145 [01:39<01:57,  1.51s/it][A
 47%|████▋     | 68/145 [01:41<01:58,  1.53s/it][A
 48%|████▊     | 69/145 [01:42<01:57,  1.54s/it][A
 48%|████▊     | 70/145 [01:44<01:52,  1.49s/it][A
 49%|████▉     | 71/145 [01:45<01:49,  1.49s/it][A
 50%|████▉     | 72/145 [01:47<01:49,  1.50s/it][A
 50%|█████     | 73/145 [01:48<01:49,  1.53s/it][A
 51%|█████     | 74/145 [01:50<01:48,  1.53s/it][A
 52%|█████▏    | 75/145 [01:51<01:47,  1.53s/it][A
 52%|█████▏    | 76/145 [01:53<01:45,  1.52s/it][A
 53%|█████▎    | 77/145 [01:54<01:41,  1.50s/it][A
 54%|█████▍    | 78/145 [01:56<01:40,  1.50s/it][A
 54%|█████▍    | 79/145 [01:57<01:38,  1.49s/it][A
 55%|█████▌    | 80/145 [01:59<01:36,  1.49s/it][A
 56%|█████▌    | 81/145 [02:00<01:33,  1.47s/it][A
 57%|█████▋    | 82/145 [02:02<01:33,  1.49s/it][A
 57%|█████▋    | 83/145 [02:03<01:32,  1.50s/it][A
 58%|█████▊    | 84/145 [02:05<01:32,  1.51s/it][A
 59%|█████▊    | 85/145 [02:06<01:28,  1.48s/it][A
 59%|█████▉    | 86/145 [02:08<01:28,  1.50s/it][A
 60%|██████    | 87/145 [02:09<01:28,  1.52s/it][A
 61%|██████    | 88/145 [02:11<01:25,  1.50s/it][A
 61%|██████▏   | 89/145 [02:12<01:24,  1.51s/it][A
 62%|██████▏   | 90/145 [02:14<01:23,  1.52s/it][A
 63%|██████▎   | 91/145 [02:15<01:21,  1.51s/it][A
 63%|██████▎   | 92/145 [02:17<01:19,  1.51s/it][A
 64%|██████▍   | 93/145 [02:18<01:17,  1.49s/it][A
 65%|██████▍   | 94/145 [02:20<01:15,  1.49s/it][A
 66%|██████▌   | 95/145 [02:21<01:14,  1.49s/it][A
 66%|██████▌   | 96/145 [02:23<01:13,  1.50s/it][A
 67%|██████▋   | 97/145 [02:24<01:12,  1.51s/it][A
 68%|██████▊   | 98/145 [02:26<01:12,  1.54s/it][A
 68%|██████▊   | 99/145 [02:27<01:09,  1.52s/it][A
 69%|██████▉   | 100/145 [02:29<01:08,  1.52s/it][A
 70%|██████▉   | 101/145 [02:31<01:07,  1.53s/it][A
 70%|███████   | 102/145 [02:32<01:05,  1.52s/it][A
 71%|███████   | 103/145 [02:34<01:03,  1.52s/it][A
 72%|███████▏  | 104/145 [02:35<01:02,  1.53s/it][A
 72%|███████▏  | 105/145 [02:37<01:01,  1.53s/it][A
 73%|███████▎  | 106/145 [02:38<00:59,  1.52s/it][A
 74%|███████▍  | 107/145 [02:40<00:56,  1.48s/it][A
 74%|███████▍  | 108/145 [02:41<00:53,  1.46s/it][A
 75%|███████▌  | 109/145 [02:42<00:53,  1.48s/it][A
 76%|███████▌  | 110/145 [02:44<00:52,  1.50s/it][A
 77%|███████▋  | 111/145 [02:45<00:50,  1.47s/it][A
 77%|███████▋  | 112/145 [02:47<00:49,  1.50s/it][A
 78%|███████▊  | 113/145 [02:49<00:48,  1.52s/it][A
 79%|███████▊  | 114/145 [02:50<00:47,  1.53s/it][A
 79%|███████▉  | 115/145 [02:52<00:45,  1.52s/it][A
 80%|████████  | 116/145 [02:53<00:43,  1.49s/it][A
 81%|████████  | 117/145 [02:55<00:41,  1.50s/it][A
 81%|████████▏ | 118/145 [02:56<00:40,  1.49s/it][A
 82%|████████▏ | 119/145 [02:57<00:37,  1.45s/it][A
 83%|████████▎ | 120/145 [02:59<00:35,  1.44s/it][A
 83%|████████▎ | 121/145 [03:00<00:34,  1.44s/it][A
 84%|████████▍ | 122/145 [03:02<00:33,  1.45s/it][A
 85%|████████▍ | 123/145 [03:03<00:32,  1.46s/it][A
 86%|████████▌ | 124/145 [03:05<00:30,  1.45s/it][A
 86%|████████▌ | 125/145 [03:06<00:30,  1.51s/it][A
 87%|████████▋ | 126/145 [03:08<00:28,  1.50s/it][A
 88%|████████▊ | 127/145 [03:09<00:26,  1.49s/it][A
 88%|████████▊ | 128/145 [03:11<00:25,  1.52s/it][A
 89%|████████▉ | 129/145 [03:12<00:24,  1.52s/it][A
 90%|████████▉ | 130/145 [03:14<00:23,  1.54s/it][A
 90%|█████████ | 131/145 [03:15<00:20,  1.50s/it][A
 91%|█████████ | 132/145 [03:17<00:19,  1.51s/it][A
 92%|█████████▏| 133/145 [03:18<00:17,  1.49s/it][A
 92%|█████████▏| 134/145 [03:20<00:16,  1.52s/it][A
 93%|█████████▎| 135/145 [03:21<00:15,  1.52s/it][A
 94%|█████████▍| 136/145 [03:23<00:13,  1.52s/it][A
 94%|█████████▍| 137/145 [03:24<00:12,  1.51s/it][A
 95%|█████████▌| 138/145 [03:26<00:10,  1.52s/it][A
 96%|█████████▌| 139/145 [03:27<00:09,  1.51s/it][A
 97%|█████████▋| 140/145 [03:29<00:07,  1.52s/it][A
 97%|█████████▋| 141/145 [03:31<00:06,  1.52s/it][A
 98%|█████████▊| 142/145 [03:32<00:04,  1.51s/it][A
 99%|█████████▊| 143/145 [03:33<00:03,  1.50s/it][A
 99%|█████████▉| 144/145 [03:35<00:01,  1.51s/it][A
100%|██████████| 145/145 [03:36<00:00,  1.48s/it][A
                                                 [A                                                       {'eval_loss': 1.6073899269104004, 'eval_runtime': 218.6232, 'eval_samples_per_second': 5.292, 'eval_steps_per_second': 0.663, 'epoch': 7.68, 'num_input_tokens_seen': 28341568}

100%|██████████| 145/145 [03:36<00:00,  1.48s/it][A 77%|███████▋  | 2500/3250 [9:27:04<2:23:30, 11.48s/it]
                                                 [A[INFO|trainer.py:3705] 2024-10-11 14:19:07,904 >> Saving model checkpoint to /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2500
[INFO|configuration_utils.py:672] 2024-10-11 14:19:09,851 >> loading configuration file config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/config.json
[WARNING|modeling_rope_utils.py:379] 2024-10-11 14:19:09,851 >> Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
[INFO|configuration_utils.py:739] 2024-10-11 14:19:09,853 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 3584,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 18944,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 28,
  "num_hidden_layers": 28,
  "num_key_value_heads": 4,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.0",
  "use_cache": true,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "in_chans": 3,
    "model_type": "qwen2_vl",
    "spatial_patch_size": 14
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 152064
}

[INFO|tokenization_utils_base.py:2649] 2024-10-11 14:19:09,931 >> tokenizer config file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2500/tokenizer_config.json
[INFO|tokenization_utils_base.py:2658] 2024-10-11 14:19:09,931 >> Special tokens file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2500/special_tokens_map.json
[INFO|image_processing_base.py:258] 2024-10-11 14:19:10,421 >> Image processor saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2500/preprocessor_config.json
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 77%|███████▋  | 2501/3250 [9:27:18<16:12:03, 77.87s/it] 77%|███████▋  | 2502/3250 [9:27:30<12:02:54, 57.99s/it] 77%|███████▋  | 2503/3250 [9:27:41<9:08:06, 44.03s/it]  77%|███████▋  | 2504/3250 [9:27:53<7:06:08, 34.27s/it] 77%|███████▋  | 2505/3250 [9:28:04<5:40:41, 27.44s/it]                                                       {'loss': 1.6016, 'grad_norm': 0.4128347933292389, 'learning_rate': 0.005, 'epoch': 7.7, 'num_input_tokens_seen': 28399648}
 77%|███████▋  | 2505/3250 [9:28:04<5:40:41, 27.44s/it] 77%|███████▋  | 2506/3250 [9:28:16<4:41:48, 22.73s/it] 77%|███████▋  | 2507/3250 [9:28:28<3:59:57, 19.38s/it] 77%|███████▋  | 2508/3250 [9:28:39<3:29:46, 16.96s/it] 77%|███████▋  | 2509/3250 [9:28:51<3:09:03, 15.31s/it] 77%|███████▋  | 2510/3250 [9:29:02<2:53:46, 14.09s/it]                                                       {'loss': 1.5738, 'grad_norm': 0.5892913341522217, 'learning_rate': 0.005, 'epoch': 7.71, 'num_input_tokens_seen': 28456096}
 77%|███████▋  | 2510/3250 [9:29:02<2:53:46, 14.09s/it] 77%|███████▋  | 2511/3250 [9:29:13<2:43:34, 13.28s/it] 77%|███████▋  | 2512/3250 [9:29:25<2:36:12, 12.70s/it] 77%|███████▋  | 2513/3250 [9:29:35<2:29:31, 12.17s/it] 77%|███████▋  | 2514/3250 [9:29:47<2:26:48, 11.97s/it] 77%|███████▋  | 2515/3250 [9:29:59<2:24:59, 11.84s/it]                                                       {'loss': 1.4706, 'grad_norm': 0.4631648063659668, 'learning_rate': 0.005, 'epoch': 7.73, 'num_input_tokens_seen': 28511360}
 77%|███████▋  | 2515/3250 [9:29:59<2:24:59, 11.84s/it] 77%|███████▋  | 2516/3250 [9:30:10<2:24:27, 11.81s/it] 77%|███████▋  | 2517/3250 [9:30:22<2:24:33, 11.83s/it] 77%|███████▋  | 2518/3250 [9:30:34<2:23:45, 11.78s/it] 78%|███████▊  | 2519/3250 [9:30:45<2:21:48, 11.64s/it] 78%|███████▊  | 2520/3250 [9:30:56<2:19:49, 11.49s/it]                                                       {'loss': 1.616, 'grad_norm': 0.49359002709388733, 'learning_rate': 0.005, 'epoch': 7.74, 'num_input_tokens_seen': 28568480}
 78%|███████▊  | 2520/3250 [9:30:56<2:19:49, 11.49s/it] 78%|███████▊  | 2521/3250 [9:31:08<2:19:40, 11.50s/it] 78%|███████▊  | 2522/3250 [9:31:19<2:19:45, 11.52s/it] 78%|███████▊  | 2523/3250 [9:31:31<2:18:56, 11.47s/it] 78%|███████▊  | 2524/3250 [9:31:42<2:19:38, 11.54s/it] 78%|███████▊  | 2525/3250 [9:31:54<2:20:09, 11.60s/it]                                                       {'loss': 1.6597, 'grad_norm': 0.28343287110328674, 'learning_rate': 0.005, 'epoch': 7.76, 'num_input_tokens_seen': 28625376}
 78%|███████▊  | 2525/3250 [9:31:54<2:20:09, 11.60s/it] 78%|███████▊  | 2526/3250 [9:32:06<2:19:39, 11.57s/it] 78%|███████▊  | 2527/3250 [9:32:17<2:18:53, 11.53s/it] 78%|███████▊  | 2528/3250 [9:32:29<2:19:11, 11.57s/it] 78%|███████▊  | 2529/3250 [9:32:40<2:18:32, 11.53s/it] 78%|███████▊  | 2530/3250 [9:32:52<2:17:54, 11.49s/it]                                                       {'loss': 1.819, 'grad_norm': 0.34714338183403015, 'learning_rate': 0.005, 'epoch': 7.77, 'num_input_tokens_seen': 28682560}
 78%|███████▊  | 2530/3250 [9:32:52<2:17:54, 11.49s/it] 78%|███████▊  | 2531/3250 [9:33:03<2:16:27, 11.39s/it] 78%|███████▊  | 2532/3250 [9:33:14<2:16:09, 11.38s/it] 78%|███████▊  | 2533/3250 [9:33:26<2:16:28, 11.42s/it] 78%|███████▊  | 2534/3250 [9:33:37<2:16:35, 11.45s/it] 78%|███████▊  | 2535/3250 [9:33:48<2:15:16, 11.35s/it]                                                       {'loss': 1.7647, 'grad_norm': 1.7639719247817993, 'learning_rate': 0.005, 'epoch': 7.79, 'num_input_tokens_seen': 28738432}
 78%|███████▊  | 2535/3250 [9:33:48<2:15:16, 11.35s/it] 78%|███████▊  | 2536/3250 [9:34:00<2:15:45, 11.41s/it] 78%|███████▊  | 2537/3250 [9:34:11<2:16:09, 11.46s/it] 78%|███████▊  | 2538/3250 [9:34:23<2:16:17, 11.49s/it] 78%|███████▊  | 2539/3250 [9:34:35<2:16:44, 11.54s/it] 78%|███████▊  | 2540/3250 [9:34:46<2:16:51, 11.57s/it]                                                       {'loss': 1.66, 'grad_norm': 0.41078680753707886, 'learning_rate': 0.005, 'epoch': 7.8, 'num_input_tokens_seen': 28796320}
 78%|███████▊  | 2540/3250 [9:34:46<2:16:51, 11.57s/it] 78%|███████▊  | 2541/3250 [9:34:57<2:15:47, 11.49s/it] 78%|███████▊  | 2542/3250 [9:35:09<2:16:14, 11.55s/it] 78%|███████▊  | 2543/3250 [9:35:21<2:15:54, 11.53s/it] 78%|███████▊  | 2544/3250 [9:35:32<2:15:32, 11.52s/it] 78%|███████▊  | 2545/3250 [9:35:44<2:15:43, 11.55s/it]                                                       {'loss': 1.595, 'grad_norm': 0.3782096803188324, 'learning_rate': 0.005, 'epoch': 7.82, 'num_input_tokens_seen': 28853216}
 78%|███████▊  | 2545/3250 [9:35:44<2:15:43, 11.55s/it] 78%|███████▊  | 2546/3250 [9:35:55<2:16:06, 11.60s/it] 78%|███████▊  | 2547/3250 [9:36:07<2:15:15, 11.54s/it] 78%|███████▊  | 2548/3250 [9:36:18<2:14:19, 11.48s/it] 78%|███████▊  | 2549/3250 [9:36:30<2:13:55, 11.46s/it] 78%|███████▊  | 2550/3250 [9:36:41<2:14:45, 11.55s/it]                                                       {'loss': 1.6241, 'grad_norm': 0.5166966915130615, 'learning_rate': 0.005, 'epoch': 7.83, 'num_input_tokens_seen': 28910688}
 78%|███████▊  | 2550/3250 [9:36:41<2:14:45, 11.55s/it] 78%|███████▊  | 2551/3250 [9:36:53<2:13:49, 11.49s/it] 79%|███████▊  | 2552/3250 [9:37:04<2:13:41, 11.49s/it] 79%|███████▊  | 2553/3250 [9:37:16<2:13:40, 11.51s/it] 79%|███████▊  | 2554/3250 [9:37:27<2:12:40, 11.44s/it] 79%|███████▊  | 2555/3250 [9:37:39<2:12:40, 11.45s/it]                                                       {'loss': 1.5785, 'grad_norm': 0.4574360251426697, 'learning_rate': 0.005, 'epoch': 7.85, 'num_input_tokens_seen': 28967328}
 79%|███████▊  | 2555/3250 [9:37:39<2:12:40, 11.45s/it] 79%|███████▊  | 2556/3250 [9:37:49<2:10:26, 11.28s/it] 79%|███████▊  | 2557/3250 [9:38:01<2:11:25, 11.38s/it] 79%|███████▊  | 2558/3250 [9:38:12<2:10:48, 11.34s/it] 79%|███████▊  | 2559/3250 [9:38:23<2:09:56, 11.28s/it] 79%|███████▉  | 2560/3250 [9:38:35<2:10:36, 11.36s/it]                                                       {'loss': 1.5303, 'grad_norm': 0.5526018738746643, 'learning_rate': 0.005, 'epoch': 7.86, 'num_input_tokens_seen': 29022784}
 79%|███████▉  | 2560/3250 [9:38:35<2:10:36, 11.36s/it] 79%|███████▉  | 2561/3250 [9:38:46<2:10:50, 11.39s/it] 79%|███████▉  | 2562/3250 [9:38:58<2:11:28, 11.47s/it] 79%|███████▉  | 2563/3250 [9:39:10<2:12:00, 11.53s/it] 79%|███████▉  | 2564/3250 [9:39:21<2:11:21, 11.49s/it] 79%|███████▉  | 2565/3250 [9:39:33<2:11:20, 11.50s/it]                                                       {'loss': 1.6847, 'grad_norm': 0.5788753032684326, 'learning_rate': 0.005, 'epoch': 7.88, 'num_input_tokens_seen': 29080128}
 79%|███████▉  | 2565/3250 [9:39:33<2:11:20, 11.50s/it] 79%|███████▉  | 2566/3250 [9:39:44<2:10:53, 11.48s/it] 79%|███████▉  | 2567/3250 [9:39:56<2:10:55, 11.50s/it] 79%|███████▉  | 2568/3250 [9:40:07<2:10:48, 11.51s/it] 79%|███████▉  | 2569/3250 [9:40:18<2:09:51, 11.44s/it] 79%|███████▉  | 2570/3250 [9:40:30<2:10:07, 11.48s/it]                                                       {'loss': 1.7234, 'grad_norm': 0.31870773434638977, 'learning_rate': 0.005, 'epoch': 7.9, 'num_input_tokens_seen': 29136480}
 79%|███████▉  | 2570/3250 [9:40:30<2:10:07, 11.48s/it] 79%|███████▉  | 2571/3250 [9:40:41<2:09:34, 11.45s/it] 79%|███████▉  | 2572/3250 [9:40:53<2:09:15, 11.44s/it] 79%|███████▉  | 2573/3250 [9:41:04<2:08:57, 11.43s/it] 79%|███████▉  | 2574/3250 [9:41:16<2:09:02, 11.45s/it] 79%|███████▉  | 2575/3250 [9:41:27<2:08:55, 11.46s/it]                                                       {'loss': 1.7262, 'grad_norm': 0.49571049213409424, 'learning_rate': 0.005, 'epoch': 7.91, 'num_input_tokens_seen': 29192992}
 79%|███████▉  | 2575/3250 [9:41:27<2:08:55, 11.46s/it] 79%|███████▉  | 2576/3250 [9:41:39<2:08:09, 11.41s/it] 79%|███████▉  | 2577/3250 [9:41:50<2:09:08, 11.51s/it] 79%|███████▉  | 2578/3250 [9:42:02<2:08:32, 11.48s/it] 79%|███████▉  | 2579/3250 [9:42:13<2:08:23, 11.48s/it] 79%|███████▉  | 2580/3250 [9:42:25<2:08:59, 11.55s/it]                                                       {'loss': 1.7365, 'grad_norm': 0.3982425034046173, 'learning_rate': 0.005, 'epoch': 7.93, 'num_input_tokens_seen': 29250496}
 79%|███████▉  | 2580/3250 [9:42:25<2:08:59, 11.55s/it] 79%|███████▉  | 2581/3250 [9:42:37<2:09:02, 11.57s/it] 79%|███████▉  | 2582/3250 [9:42:48<2:07:34, 11.46s/it] 79%|███████▉  | 2583/3250 [9:42:59<2:07:12, 11.44s/it] 80%|███████▉  | 2584/3250 [9:43:11<2:07:08, 11.45s/it] 80%|███████▉  | 2585/3250 [9:43:22<2:06:47, 11.44s/it]                                                       {'loss': 1.6992, 'grad_norm': 0.4891709089279175, 'learning_rate': 0.005, 'epoch': 7.94, 'num_input_tokens_seen': 29306432}
 80%|███████▉  | 2585/3250 [9:43:22<2:06:47, 11.44s/it] 80%|███████▉  | 2586/3250 [9:43:34<2:07:24, 11.51s/it] 80%|███████▉  | 2587/3250 [9:43:45<2:07:18, 11.52s/it] 80%|███████▉  | 2588/3250 [9:43:56<2:05:57, 11.42s/it] 80%|███████▉  | 2589/3250 [9:44:08<2:05:14, 11.37s/it] 80%|███████▉  | 2590/3250 [9:44:19<2:05:11, 11.38s/it]                                                       {'loss': 1.7267, 'grad_norm': 0.4221881330013275, 'learning_rate': 0.005, 'epoch': 7.96, 'num_input_tokens_seen': 29363200}
 80%|███████▉  | 2590/3250 [9:44:19<2:05:11, 11.38s/it] 80%|███████▉  | 2591/3250 [9:44:30<2:05:02, 11.38s/it] 80%|███████▉  | 2592/3250 [9:44:42<2:05:48, 11.47s/it] 80%|███████▉  | 2593/3250 [9:44:54<2:05:50, 11.49s/it] 80%|███████▉  | 2594/3250 [9:45:05<2:05:58, 11.52s/it] 80%|███████▉  | 2595/3250 [9:45:16<2:04:24, 11.40s/it]                                                       {'loss': 1.7214, 'grad_norm': 0.4878821074962616, 'learning_rate': 0.005, 'epoch': 7.97, 'num_input_tokens_seen': 29420288}
 80%|███████▉  | 2595/3250 [9:45:16<2:04:24, 11.40s/it] 80%|███████▉  | 2596/3250 [9:45:28<2:04:08, 11.39s/it] 80%|███████▉  | 2597/3250 [9:45:39<2:04:20, 11.43s/it] 80%|███████▉  | 2598/3250 [9:45:51<2:04:41, 11.47s/it] 80%|███████▉  | 2599/3250 [9:46:02<2:03:49, 11.41s/it] 80%|████████  | 2600/3250 [9:46:14<2:04:29, 11.49s/it]                                                       {'loss': 1.7011, 'grad_norm': 0.4066392183303833, 'learning_rate': 0.005, 'epoch': 7.99, 'num_input_tokens_seen': 29477376}
 80%|████████  | 2600/3250 [9:46:14<2:04:29, 11.49s/it][INFO|trainer.py:4021] 2024-10-11 14:38:17,407 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-10-11 14:38:17,408 >>   Num examples = 1157
[INFO|trainer.py:4026] 2024-10-11 14:38:17,408 >>   Batch size = 4

  0%|          | 0/145 [00:00<?, ?it/s][A
  1%|▏         | 2/145 [00:01<01:47,  1.33it/s][A
  2%|▏         | 3/145 [00:03<02:34,  1.09s/it][A
  3%|▎         | 4/145 [00:04<02:54,  1.24s/it][A
  3%|▎         | 5/145 [00:05<03:01,  1.29s/it][A
  4%|▍         | 6/145 [00:07<03:11,  1.38s/it][A
  5%|▍         | 7/145 [00:09<03:17,  1.43s/it][A
  6%|▌         | 8/145 [00:10<03:15,  1.43s/it][A
  6%|▌         | 9/145 [00:11<03:15,  1.44s/it][A
  7%|▋         | 10/145 [00:13<03:16,  1.45s/it][A
  8%|▊         | 11/145 [00:14<03:16,  1.47s/it][A
  8%|▊         | 12/145 [00:16<03:19,  1.50s/it][A
  9%|▉         | 13/145 [00:18<03:20,  1.52s/it][A
 10%|▉         | 14/145 [00:19<03:21,  1.54s/it][A
 10%|█         | 15/145 [00:21<03:17,  1.52s/it][A
 11%|█         | 16/145 [00:22<03:15,  1.51s/it][A
 12%|█▏        | 17/145 [00:24<03:14,  1.52s/it][A
 12%|█▏        | 18/145 [00:25<03:13,  1.52s/it][A
 13%|█▎        | 19/145 [00:27<03:12,  1.53s/it][A
 14%|█▍        | 20/145 [00:28<03:11,  1.53s/it][A
 14%|█▍        | 21/145 [00:30<03:06,  1.51s/it][A
 15%|█▌        | 22/145 [00:31<03:04,  1.50s/it][A
 16%|█▌        | 23/145 [00:33<03:02,  1.49s/it][A
 17%|█▋        | 24/145 [00:34<03:01,  1.50s/it][A
 17%|█▋        | 25/145 [00:36<03:00,  1.50s/it][A
 18%|█▊        | 26/145 [00:37<02:58,  1.50s/it][A
 19%|█▊        | 27/145 [00:39<02:57,  1.50s/it][A
 19%|█▉        | 28/145 [00:40<02:55,  1.50s/it][A
 20%|██        | 29/145 [00:42<02:53,  1.50s/it][A
 21%|██        | 30/145 [00:43<02:48,  1.46s/it][A
 21%|██▏       | 31/145 [00:45<02:48,  1.48s/it][A
 22%|██▏       | 32/145 [00:46<02:48,  1.49s/it][A
 23%|██▎       | 33/145 [00:48<02:47,  1.50s/it][A
 23%|██▎       | 34/145 [00:49<02:46,  1.50s/it][A
 24%|██▍       | 35/145 [00:51<02:45,  1.51s/it][A
 25%|██▍       | 36/145 [00:52<02:43,  1.50s/it][A
 26%|██▌       | 37/145 [00:54<02:46,  1.54s/it][A
 26%|██▌       | 38/145 [00:55<02:44,  1.54s/it][A
 27%|██▋       | 39/145 [00:57<02:41,  1.53s/it][A
 28%|██▊       | 40/145 [00:58<02:39,  1.52s/it][A
 28%|██▊       | 41/145 [01:00<02:40,  1.54s/it][A
 29%|██▉       | 42/145 [01:01<02:38,  1.54s/it][A
 30%|██▉       | 43/145 [01:03<02:35,  1.52s/it][A
 30%|███       | 44/145 [01:05<02:36,  1.55s/it][A
 31%|███       | 45/145 [01:06<02:36,  1.56s/it][A
 32%|███▏      | 46/145 [01:08<02:32,  1.54s/it][A
 32%|███▏      | 47/145 [01:09<02:28,  1.51s/it][A
 33%|███▎      | 48/145 [01:11<02:27,  1.52s/it][A
 34%|███▍      | 49/145 [01:12<02:25,  1.52s/it][A
 34%|███▍      | 50/145 [01:14<02:21,  1.49s/it][A
 35%|███▌      | 51/145 [01:15<02:18,  1.47s/it][A
 36%|███▌      | 52/145 [01:16<02:14,  1.45s/it][A
 37%|███▋      | 53/145 [01:18<02:12,  1.44s/it][A
 37%|███▋      | 54/145 [01:19<02:10,  1.44s/it][A
 38%|███▊      | 55/145 [01:21<02:07,  1.42s/it][A
 39%|███▊      | 56/145 [01:22<02:06,  1.42s/it][A
 39%|███▉      | 57/145 [01:23<02:03,  1.40s/it][A
 40%|████      | 58/145 [01:25<02:00,  1.39s/it][A
 41%|████      | 59/145 [01:26<02:02,  1.42s/it][A
 41%|████▏     | 60/145 [01:28<01:59,  1.41s/it][A
 42%|████▏     | 61/145 [01:29<01:57,  1.40s/it][A
 43%|████▎     | 62/145 [01:30<01:54,  1.38s/it][A
 43%|████▎     | 63/145 [01:32<01:55,  1.40s/it][A
 44%|████▍     | 64/145 [01:33<01:53,  1.40s/it][A
 45%|████▍     | 65/145 [01:35<01:52,  1.41s/it][A
 46%|████▌     | 66/145 [01:36<01:51,  1.41s/it][A
 46%|████▌     | 67/145 [01:37<01:48,  1.39s/it][A
 47%|████▋     | 68/145 [01:39<01:49,  1.42s/it][A
 48%|████▊     | 69/145 [01:40<01:48,  1.42s/it][A
 48%|████▊     | 70/145 [01:41<01:42,  1.37s/it][A
 49%|████▉     | 71/145 [01:43<01:40,  1.36s/it][A
 50%|████▉     | 72/145 [01:44<01:40,  1.38s/it][A
 50%|█████     | 73/145 [01:46<01:41,  1.41s/it][A
 51%|█████     | 74/145 [01:47<01:40,  1.42s/it][A
 52%|█████▏    | 75/145 [01:49<01:39,  1.42s/it][A
 52%|█████▏    | 76/145 [01:50<01:37,  1.41s/it][A
 53%|█████▎    | 77/145 [01:51<01:33,  1.38s/it][A
 54%|█████▍    | 78/145 [01:53<01:32,  1.38s/it][A
 54%|█████▍    | 79/145 [01:54<01:30,  1.36s/it][A
 55%|█████▌    | 80/145 [01:55<01:28,  1.36s/it][A
 56%|█████▌    | 81/145 [01:57<01:25,  1.34s/it][A
 57%|█████▋    | 82/145 [01:58<01:25,  1.36s/it][A
 57%|█████▋    | 83/145 [01:59<01:25,  1.38s/it][A
 58%|█████▊    | 84/145 [02:01<01:24,  1.39s/it][A
 59%|█████▊    | 85/145 [02:02<01:21,  1.36s/it][A
 59%|█████▉    | 86/145 [02:04<01:21,  1.38s/it][A
 60%|██████    | 87/145 [02:05<01:21,  1.40s/it][A
 61%|██████    | 88/145 [02:06<01:18,  1.38s/it][A
 61%|██████▏   | 89/145 [02:08<01:17,  1.39s/it][A
 62%|██████▏   | 90/145 [02:09<01:16,  1.40s/it][A
 63%|██████▎   | 91/145 [02:11<01:15,  1.40s/it][A
 63%|██████▎   | 92/145 [02:12<01:13,  1.39s/it][A
 64%|██████▍   | 93/145 [02:13<01:11,  1.37s/it][A
 65%|██████▍   | 94/145 [02:15<01:10,  1.37s/it][A
 66%|██████▌   | 95/145 [02:16<01:09,  1.38s/it][A
 66%|██████▌   | 96/145 [02:18<01:08,  1.39s/it][A
 67%|██████▋   | 97/145 [02:19<01:07,  1.40s/it][A
 68%|██████▊   | 98/145 [02:20<01:07,  1.43s/it][A
 68%|██████▊   | 99/145 [02:22<01:04,  1.40s/it][A
 69%|██████▉   | 100/145 [02:23<01:03,  1.40s/it][A
 70%|██████▉   | 101/145 [02:25<01:02,  1.42s/it][A
 70%|███████   | 102/145 [02:26<01:00,  1.41s/it][A
 71%|███████   | 103/145 [02:27<00:58,  1.40s/it][A
 72%|███████▏  | 104/145 [02:29<00:57,  1.40s/it][A
 72%|███████▏  | 105/145 [02:30<00:56,  1.40s/it][A
 73%|███████▎  | 106/145 [02:32<00:54,  1.40s/it][A
 74%|███████▍  | 107/145 [02:33<00:51,  1.36s/it][A
 74%|███████▍  | 108/145 [02:34<00:49,  1.33s/it][A
 75%|███████▌  | 109/145 [02:36<00:48,  1.35s/it][A
 76%|███████▌  | 110/145 [02:37<00:48,  1.38s/it][A
 77%|███████▋  | 111/145 [02:38<00:45,  1.34s/it][A
 77%|███████▋  | 112/145 [02:40<00:45,  1.37s/it][A
 78%|███████▊  | 113/145 [02:41<00:44,  1.39s/it][A
 79%|███████▊  | 114/145 [02:43<00:43,  1.41s/it][A
 79%|███████▉  | 115/145 [02:44<00:42,  1.41s/it][A
 80%|████████  | 116/145 [02:45<00:39,  1.38s/it][A
 81%|████████  | 117/145 [02:47<00:38,  1.38s/it][A
 81%|████████▏ | 118/145 [02:48<00:37,  1.37s/it][A
 82%|████████▏ | 119/145 [02:49<00:34,  1.33s/it][A
 83%|████████▎ | 120/145 [02:51<00:32,  1.32s/it][A
 83%|████████▎ | 121/145 [02:52<00:31,  1.32s/it][A
 84%|████████▍ | 122/145 [02:53<00:30,  1.33s/it][A
 85%|████████▍ | 123/145 [02:55<00:29,  1.34s/it][A
 86%|████████▌ | 124/145 [02:56<00:28,  1.33s/it][A
 86%|████████▌ | 125/145 [02:57<00:28,  1.40s/it][A
 87%|████████▋ | 126/145 [02:59<00:26,  1.38s/it][A
 88%|████████▊ | 127/145 [03:00<00:24,  1.38s/it][A
 88%|████████▊ | 128/145 [03:02<00:23,  1.41s/it][A
 89%|████████▉ | 129/145 [03:03<00:22,  1.40s/it][A
 90%|████████▉ | 130/145 [03:05<00:21,  1.43s/it][A
 90%|█████████ | 131/145 [03:06<00:19,  1.37s/it][A
 91%|█████████ | 132/145 [03:07<00:18,  1.40s/it][A
 92%|█████████▏| 133/145 [03:09<00:16,  1.37s/it][A
 92%|█████████▏| 134/145 [03:10<00:15,  1.40s/it][A
 93%|█████████▎| 135/145 [03:11<00:14,  1.41s/it][A
 94%|█████████▍| 136/145 [03:13<00:12,  1.40s/it][A
 94%|█████████▍| 137/145 [03:14<00:11,  1.39s/it][A
 95%|█████████▌| 138/145 [03:16<00:09,  1.40s/it][A
 96%|█████████▌| 139/145 [03:17<00:08,  1.40s/it][A
 97%|█████████▋| 140/145 [03:18<00:07,  1.40s/it][A
 97%|█████████▋| 141/145 [03:20<00:05,  1.41s/it][A
 98%|█████████▊| 142/145 [03:21<00:04,  1.39s/it][A
 99%|█████████▊| 143/145 [03:23<00:02,  1.38s/it][A
 99%|█████████▉| 144/145 [03:24<00:01,  1.40s/it][A
100%|██████████| 145/145 [03:25<00:00,  1.37s/it][A
                                                 [A                                                       {'eval_loss': 1.739702582359314, 'eval_runtime': 207.4533, 'eval_samples_per_second': 5.577, 'eval_steps_per_second': 0.699, 'epoch': 7.99, 'num_input_tokens_seen': 29477376}

100%|██████████| 145/145 [03:25<00:00,  1.37s/it][A 80%|████████  | 2600/3250 [9:49:41<2:04:29, 11.49s/it]
                                                 [A[INFO|trainer.py:3705] 2024-10-11 14:41:44,863 >> Saving model checkpoint to /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2600
[INFO|configuration_utils.py:672] 2024-10-11 14:41:45,823 >> loading configuration file config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/config.json
[WARNING|modeling_rope_utils.py:379] 2024-10-11 14:41:45,823 >> Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
[INFO|configuration_utils.py:739] 2024-10-11 14:41:45,825 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 3584,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 18944,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 28,
  "num_hidden_layers": 28,
  "num_key_value_heads": 4,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.0",
  "use_cache": true,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "in_chans": 3,
    "model_type": "qwen2_vl",
    "spatial_patch_size": 14
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 152064
}

[INFO|tokenization_utils_base.py:2649] 2024-10-11 14:41:45,892 >> tokenizer config file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2600/tokenizer_config.json
[INFO|tokenization_utils_base.py:2658] 2024-10-11 14:41:45,892 >> Special tokens file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2600/special_tokens_map.json
[INFO|image_processing_base.py:258] 2024-10-11 14:41:46,322 >> Image processor saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2600/preprocessor_config.json
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 80%|████████  | 2601/3250 [9:49:54<13:20:47, 74.03s/it] 80%|████████  | 2602/3250 [9:50:04<9:54:18, 55.03s/it]  80%|████████  | 2603/3250 [9:50:15<7:31:08, 41.84s/it] 80%|████████  | 2604/3250 [9:50:26<5:50:35, 32.56s/it] 80%|████████  | 2605/3250 [9:50:37<4:40:26, 26.09s/it]                                                       {'loss': 1.7241, 'grad_norm': 0.2792925238609314, 'learning_rate': 0.005, 'epoch': 8.0, 'num_input_tokens_seen': 29534368}
 80%|████████  | 2605/3250 [9:50:37<4:40:26, 26.09s/it] 80%|████████  | 2606/3250 [9:50:48<3:51:26, 21.56s/it] 80%|████████  | 2607/3250 [9:50:59<3:16:28, 18.33s/it] 80%|████████  | 2608/3250 [9:51:10<2:52:24, 16.11s/it] 80%|████████  | 2609/3250 [9:51:21<2:36:11, 14.62s/it] 80%|████████  | 2610/3250 [9:51:32<2:24:54, 13.59s/it]                                                       {'loss': 1.7435, 'grad_norm': 0.36765119433403015, 'learning_rate': 0.005, 'epoch': 8.02, 'num_input_tokens_seen': 29591232}
 80%|████████  | 2610/3250 [9:51:32<2:24:54, 13.59s/it] 80%|████████  | 2611/3250 [9:51:43<2:16:14, 12.79s/it] 80%|████████  | 2612/3250 [9:51:54<2:09:41, 12.20s/it] 80%|████████  | 2613/3250 [9:52:05<2:05:38, 11.83s/it] 80%|████████  | 2614/3250 [9:52:16<2:02:15, 11.53s/it] 80%|████████  | 2615/3250 [9:52:27<1:58:59, 11.24s/it]                                                       {'loss': 1.7589, 'grad_norm': 0.3709743618965149, 'learning_rate': 0.005, 'epoch': 8.03, 'num_input_tokens_seen': 29646656}
 80%|████████  | 2615/3250 [9:52:27<1:58:59, 11.24s/it] 80%|████████  | 2616/3250 [9:52:37<1:56:49, 11.06s/it] 81%|████████  | 2617/3250 [9:52:48<1:56:02, 11.00s/it] 81%|████████  | 2618/3250 [9:52:59<1:55:41, 10.98s/it] 81%|████████  | 2619/3250 [9:53:10<1:55:23, 10.97s/it] 81%|████████  | 2620/3250 [9:53:21<1:55:44, 11.02s/it]                                                       {'loss': 1.6665, 'grad_norm': 0.6447936296463013, 'learning_rate': 0.005, 'epoch': 8.05, 'num_input_tokens_seen': 29702848}
 81%|████████  | 2620/3250 [9:53:21<1:55:44, 11.02s/it] 81%|████████  | 2621/3250 [9:53:32<1:55:53, 11.06s/it] 81%|████████  | 2622/3250 [9:53:43<1:54:29, 10.94s/it] 81%|████████  | 2623/3250 [9:53:54<1:54:27, 10.95s/it] 81%|████████  | 2624/3250 [9:54:05<1:53:53, 10.92s/it] 81%|████████  | 2625/3250 [9:54:16<1:53:34, 10.90s/it]                                                       {'loss': 1.7308, 'grad_norm': 0.3949798345565796, 'learning_rate': 0.005, 'epoch': 8.06, 'num_input_tokens_seen': 29758656}
 81%|████████  | 2625/3250 [9:54:16<1:53:34, 10.90s/it] 81%|████████  | 2626/3250 [9:54:26<1:52:30, 10.82s/it] 81%|████████  | 2627/3250 [9:54:37<1:52:59, 10.88s/it] 81%|████████  | 2628/3250 [9:54:48<1:52:35, 10.86s/it] 81%|████████  | 2629/3250 [9:54:59<1:52:58, 10.92s/it] 81%|████████  | 2630/3250 [9:55:09<1:50:55, 10.74s/it]                                                       {'loss': 1.6795, 'grad_norm': 0.3343539834022522, 'learning_rate': 0.005, 'epoch': 8.08, 'num_input_tokens_seen': 29814816}
 81%|████████  | 2630/3250 [9:55:09<1:50:55, 10.74s/it] 81%|████████  | 2631/3250 [9:55:20<1:51:50, 10.84s/it] 81%|████████  | 2632/3250 [9:55:31<1:51:39, 10.84s/it] 81%|████████  | 2633/3250 [9:55:42<1:51:59, 10.89s/it] 81%|████████  | 2634/3250 [9:55:53<1:52:08, 10.92s/it] 81%|████████  | 2635/3250 [9:56:04<1:52:11, 10.95s/it]                                                       {'loss': 1.6512, 'grad_norm': 0.337027370929718, 'learning_rate': 0.005, 'epoch': 8.1, 'num_input_tokens_seen': 29871968}
 81%|████████  | 2635/3250 [9:56:04<1:52:11, 10.95s/it] 81%|████████  | 2636/3250 [9:56:15<1:52:30, 10.99s/it] 81%|████████  | 2637/3250 [9:56:27<1:52:50, 11.04s/it] 81%|████████  | 2638/3250 [9:56:38<1:52:39, 11.05s/it] 81%|████████  | 2639/3250 [9:56:49<1:52:11, 11.02s/it] 81%|████████  | 2640/3250 [9:57:00<1:52:18, 11.05s/it]                                                       {'loss': 1.6935, 'grad_norm': 0.3447263240814209, 'learning_rate': 0.005, 'epoch': 8.11, 'num_input_tokens_seen': 29930336}
 81%|████████  | 2640/3250 [9:57:00<1:52:18, 11.05s/it] 81%|████████▏ | 2641/3250 [9:57:11<1:52:13, 11.06s/it] 81%|████████▏ | 2642/3250 [9:57:22<1:51:18, 10.98s/it] 81%|████████▏ | 2643/3250 [9:57:32<1:50:46, 10.95s/it] 81%|████████▏ | 2644/3250 [9:57:44<1:51:09, 11.01s/it] 81%|████████▏ | 2645/3250 [9:57:54<1:49:30, 10.86s/it]                                                       {'loss': 1.6245, 'grad_norm': 0.29518815875053406, 'learning_rate': 0.005, 'epoch': 8.13, 'num_input_tokens_seen': 29987584}
 81%|████████▏ | 2645/3250 [9:57:54<1:49:30, 10.86s/it] 81%|████████▏ | 2646/3250 [9:58:05<1:50:17, 10.96s/it] 81%|████████▏ | 2647/3250 [9:58:16<1:48:38, 10.81s/it] 81%|████████▏ | 2648/3250 [9:58:27<1:49:17, 10.89s/it] 82%|████████▏ | 2649/3250 [9:58:37<1:48:16, 10.81s/it] 82%|████████▏ | 2650/3250 [9:58:48<1:47:38, 10.76s/it]                                                       {'loss': 1.6371, 'grad_norm': 0.45994648337364197, 'learning_rate': 0.005, 'epoch': 8.14, 'num_input_tokens_seen': 30044448}
 82%|████████▏ | 2650/3250 [9:58:48<1:47:38, 10.76s/it] 82%|████████▏ | 2651/3250 [9:58:59<1:47:43, 10.79s/it] 82%|████████▏ | 2652/3250 [9:59:10<1:49:06, 10.95s/it] 82%|████████▏ | 2653/3250 [9:59:21<1:49:19, 10.99s/it] 82%|████████▏ | 2654/3250 [9:59:32<1:49:08, 10.99s/it] 82%|████████▏ | 2655/3250 [9:59:44<1:49:34, 11.05s/it]                                                       {'loss': 1.6544, 'grad_norm': 0.2777346968650818, 'learning_rate': 0.005, 'epoch': 8.16, 'num_input_tokens_seen': 30101536}
 82%|████████▏ | 2655/3250 [9:59:44<1:49:34, 11.05s/it] 82%|████████▏ | 2656/3250 [9:59:54<1:48:42, 10.98s/it] 82%|████████▏ | 2657/3250 [10:00:05<1:47:03, 10.83s/it] 82%|████████▏ | 2658/3250 [10:00:16<1:47:01, 10.85s/it] 82%|████████▏ | 2659/3250 [10:00:27<1:47:15, 10.89s/it] 82%|████████▏ | 2660/3250 [10:00:38<1:47:04, 10.89s/it]                                                        {'loss': 1.7138, 'grad_norm': 0.6351368427276611, 'learning_rate': 0.005, 'epoch': 8.17, 'num_input_tokens_seen': 30157536}
 82%|████████▏ | 2660/3250 [10:00:38<1:47:04, 10.89s/it] 82%|████████▏ | 2661/3250 [10:00:49<1:47:15, 10.93s/it] 82%|████████▏ | 2662/3250 [10:00:59<1:46:27, 10.86s/it] 82%|████████▏ | 2663/3250 [10:01:10<1:46:35, 10.90s/it] 82%|████████▏ | 2664/3250 [10:01:21<1:45:45, 10.83s/it] 82%|████████▏ | 2665/3250 [10:01:32<1:46:12, 10.89s/it]                                                        {'loss': 1.6789, 'grad_norm': 0.3240962028503418, 'learning_rate': 0.005, 'epoch': 8.19, 'num_input_tokens_seen': 30213536}
 82%|████████▏ | 2665/3250 [10:01:32<1:46:12, 10.89s/it] 82%|████████▏ | 2666/3250 [10:01:43<1:46:30, 10.94s/it] 82%|████████▏ | 2667/3250 [10:01:54<1:46:26, 10.95s/it] 82%|████████▏ | 2668/3250 [10:02:05<1:46:45, 11.01s/it] 82%|████████▏ | 2669/3250 [10:02:16<1:46:20, 10.98s/it] 82%|████████▏ | 2670/3250 [10:02:27<1:45:29, 10.91s/it]                                                        {'loss': 1.6205, 'grad_norm': 2.0517263412475586, 'learning_rate': 0.005, 'epoch': 8.2, 'num_input_tokens_seen': 30269664}
 82%|████████▏ | 2670/3250 [10:02:27<1:45:29, 10.91s/it] 82%|████████▏ | 2671/3250 [10:02:38<1:45:39, 10.95s/it] 82%|████████▏ | 2672/3250 [10:02:49<1:45:50, 10.99s/it] 82%|████████▏ | 2673/3250 [10:03:00<1:45:19, 10.95s/it] 82%|████████▏ | 2674/3250 [10:03:11<1:45:10, 10.96s/it] 82%|████████▏ | 2675/3250 [10:03:22<1:45:17, 10.99s/it]                                                        {'loss': 1.6245, 'grad_norm': 0.46543189883232117, 'learning_rate': 0.005, 'epoch': 8.22, 'num_input_tokens_seen': 30327648}
 82%|████████▏ | 2675/3250 [10:03:22<1:45:17, 10.99s/it] 82%|████████▏ | 2676/3250 [10:03:33<1:45:10, 10.99s/it] 82%|████████▏ | 2677/3250 [10:03:44<1:45:25, 11.04s/it] 82%|████████▏ | 2678/3250 [10:03:55<1:45:05, 11.02s/it] 82%|████████▏ | 2679/3250 [10:04:06<1:44:28, 10.98s/it] 82%|████████▏ | 2680/3250 [10:04:17<1:44:48, 11.03s/it]                                                        {'loss': 2.0784, 'grad_norm': 0.6441724300384521, 'learning_rate': 0.005, 'epoch': 8.23, 'num_input_tokens_seen': 30385120}
 82%|████████▏ | 2680/3250 [10:04:17<1:44:48, 11.03s/it] 82%|████████▏ | 2681/3250 [10:04:28<1:44:44, 11.04s/it] 83%|████████▎ | 2682/3250 [10:04:39<1:43:27, 10.93s/it] 83%|████████▎ | 2683/3250 [10:04:50<1:43:30, 10.95s/it] 83%|████████▎ | 2684/3250 [10:05:01<1:43:43, 11.00s/it] 83%|████████▎ | 2685/3250 [10:05:12<1:43:11, 10.96s/it]                                                        {'loss': 1.8639, 'grad_norm': 0.5786650776863098, 'learning_rate': 0.005, 'epoch': 8.25, 'num_input_tokens_seen': 30442240}
 83%|████████▎ | 2685/3250 [10:05:12<1:43:11, 10.96s/it] 83%|████████▎ | 2686/3250 [10:05:23<1:42:27, 10.90s/it] 83%|████████▎ | 2687/3250 [10:05:34<1:42:43, 10.95s/it] 83%|████████▎ | 2688/3250 [10:05:44<1:42:06, 10.90s/it] 83%|████████▎ | 2689/3250 [10:05:56<1:42:43, 10.99s/it] 83%|████████▎ | 2690/3250 [10:06:07<1:42:31, 10.98s/it]                                                        {'loss': 1.7763, 'grad_norm': 0.47714856266975403, 'learning_rate': 0.005, 'epoch': 8.26, 'num_input_tokens_seen': 30498752}
 83%|████████▎ | 2690/3250 [10:06:07<1:42:31, 10.98s/it] 83%|████████▎ | 2691/3250 [10:06:18<1:42:21, 10.99s/it] 83%|████████▎ | 2692/3250 [10:06:29<1:42:03, 10.97s/it] 83%|████████▎ | 2693/3250 [10:06:40<1:41:58, 10.98s/it] 83%|████████▎ | 2694/3250 [10:06:50<1:41:42, 10.98s/it] 83%|████████▎ | 2695/3250 [10:07:02<1:41:52, 11.01s/it]                                                        {'loss': 1.7782, 'grad_norm': 0.2945414185523987, 'learning_rate': 0.005, 'epoch': 8.28, 'num_input_tokens_seen': 30556480}
 83%|████████▎ | 2695/3250 [10:07:02<1:41:52, 11.01s/it] 83%|████████▎ | 2696/3250 [10:07:12<1:41:10, 10.96s/it] 83%|████████▎ | 2697/3250 [10:07:23<1:40:53, 10.95s/it] 83%|████████▎ | 2698/3250 [10:07:34<1:39:35, 10.82s/it] 83%|████████▎ | 2699/3250 [10:07:45<1:40:00, 10.89s/it] 83%|████████▎ | 2700/3250 [10:07:56<1:40:11, 10.93s/it]                                                        {'loss': 1.6999, 'grad_norm': 0.4186013340950012, 'learning_rate': 0.005, 'epoch': 8.29, 'num_input_tokens_seen': 30612896}
 83%|████████▎ | 2700/3250 [10:07:56<1:40:11, 10.93s/it][INFO|trainer.py:4021] 2024-10-11 14:59:59,538 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-10-11 14:59:59,538 >>   Num examples = 1157
[INFO|trainer.py:4026] 2024-10-11 14:59:59,538 >>   Batch size = 4

  0%|          | 0/145 [00:00<?, ?it/s][A
  1%|▏         | 2/145 [00:01<01:38,  1.45it/s][A
  2%|▏         | 3/145 [00:02<02:22,  1.01s/it][A
  3%|▎         | 4/145 [00:04<02:42,  1.15s/it][A
  3%|▎         | 5/145 [00:05<02:45,  1.19s/it][A
  4%|▍         | 6/145 [00:06<02:55,  1.26s/it][A
  5%|▍         | 7/145 [00:08<03:01,  1.32s/it][A
  6%|▌         | 8/145 [00:09<02:59,  1.31s/it][A
  6%|▌         | 9/145 [00:10<02:58,  1.31s/it][A
  7%|▋         | 10/145 [00:12<02:59,  1.33s/it][A
  8%|▊         | 11/145 [00:13<03:01,  1.35s/it][A
  8%|▊         | 12/145 [00:15<03:04,  1.38s/it][A
  9%|▉         | 13/145 [00:16<03:05,  1.40s/it][A
 10%|▉         | 14/145 [00:18<03:05,  1.42s/it][A
 10%|█         | 15/145 [00:19<03:03,  1.41s/it][A
 11%|█         | 16/145 [00:20<03:00,  1.40s/it][A
 12%|█▏        | 17/145 [00:22<02:59,  1.40s/it][A
 12%|█▏        | 18/145 [00:23<02:58,  1.41s/it][A
 13%|█▎        | 19/145 [00:25<02:57,  1.41s/it][A
 14%|█▍        | 20/145 [00:26<02:55,  1.41s/it][A
 14%|█▍        | 21/145 [00:27<02:51,  1.38s/it][A
 15%|█▌        | 22/145 [00:29<02:48,  1.37s/it][A
 16%|█▌        | 23/145 [00:30<02:47,  1.37s/it][A
 17%|█▋        | 24/145 [00:31<02:46,  1.38s/it][A
 17%|█▋        | 25/145 [00:33<02:45,  1.38s/it][A
 18%|█▊        | 26/145 [00:34<02:44,  1.38s/it][A
 19%|█▊        | 27/145 [00:36<02:43,  1.39s/it][A
 19%|█▉        | 28/145 [00:37<02:41,  1.38s/it][A
 20%|██        | 29/145 [00:38<02:40,  1.38s/it][A
 21%|██        | 30/145 [00:40<02:34,  1.35s/it][A
 21%|██▏       | 31/145 [00:41<02:35,  1.37s/it][A
 22%|██▏       | 32/145 [00:42<02:35,  1.38s/it][A
 23%|██▎       | 33/145 [00:44<02:34,  1.38s/it][A
 23%|██▎       | 34/145 [00:45<02:33,  1.39s/it][A
 24%|██▍       | 35/145 [00:47<02:33,  1.39s/it][A
 25%|██▍       | 36/145 [00:48<02:30,  1.38s/it][A
 26%|██▌       | 37/145 [00:49<02:32,  1.42s/it][A
 26%|██▌       | 38/145 [00:51<02:31,  1.41s/it][A
 27%|██▋       | 39/145 [00:52<02:28,  1.40s/it][A
 28%|██▊       | 40/145 [00:54<02:26,  1.40s/it][A
 28%|██▊       | 41/145 [00:55<02:27,  1.42s/it][A
 29%|██▉       | 42/145 [00:56<02:25,  1.42s/it][A
 30%|██▉       | 43/145 [00:58<02:22,  1.39s/it][A
 30%|███       | 44/145 [00:59<02:24,  1.43s/it][A
 31%|███       | 45/145 [01:01<02:24,  1.45s/it][A
 32%|███▏      | 46/145 [01:02<02:20,  1.42s/it][A
 32%|███▏      | 47/145 [01:04<02:16,  1.39s/it][A
 33%|███▎      | 48/145 [01:05<02:15,  1.40s/it][A
 34%|███▍      | 49/145 [01:06<02:15,  1.41s/it][A
 34%|███▍      | 50/145 [01:08<02:15,  1.42s/it][A
 35%|███▌      | 51/145 [01:09<02:13,  1.42s/it][A
 36%|███▌      | 52/145 [01:11<02:11,  1.42s/it][A
 37%|███▋      | 53/145 [01:12<02:10,  1.42s/it][A
 37%|███▋      | 54/145 [01:14<02:09,  1.43s/it][A
 38%|███▊      | 55/145 [01:15<02:07,  1.41s/it][A
 39%|███▊      | 56/145 [01:16<02:05,  1.41s/it][A
 39%|███▉      | 57/145 [01:18<02:02,  1.40s/it][A
 40%|████      | 58/145 [01:19<02:00,  1.38s/it][A
 41%|████      | 59/145 [01:21<02:01,  1.41s/it][A
 41%|████▏     | 60/145 [01:22<01:59,  1.40s/it][A
 42%|████▏     | 61/145 [01:23<01:57,  1.40s/it][A
 43%|████▎     | 62/145 [01:25<01:54,  1.38s/it][A
 43%|████▎     | 63/145 [01:26<01:55,  1.41s/it][A
 44%|████▍     | 64/145 [01:27<01:53,  1.40s/it][A
 45%|████▍     | 65/145 [01:29<01:52,  1.41s/it][A
 46%|████▌     | 66/145 [01:30<01:51,  1.41s/it][A
 46%|████▌     | 67/145 [01:32<01:48,  1.40s/it][A
 47%|████▋     | 68/145 [01:33<01:49,  1.42s/it][A
 48%|████▊     | 69/145 [01:35<01:48,  1.43s/it][A
 48%|████▊     | 70/145 [01:36<01:43,  1.38s/it][A
 49%|████▉     | 71/145 [01:37<01:41,  1.37s/it][A
 50%|████▉     | 72/145 [01:39<01:41,  1.38s/it][A
 50%|█████     | 73/145 [01:40<01:41,  1.41s/it][A
 51%|█████     | 74/145 [01:42<01:40,  1.42s/it][A
 52%|█████▏    | 75/145 [01:43<01:39,  1.43s/it][A
 52%|█████▏    | 76/145 [01:44<01:37,  1.42s/it][A
 53%|█████▎    | 77/145 [01:46<01:34,  1.38s/it][A
 54%|█████▍    | 78/145 [01:47<01:32,  1.38s/it][A
 54%|█████▍    | 79/145 [01:48<01:30,  1.36s/it][A
 55%|█████▌    | 80/145 [01:50<01:28,  1.36s/it][A
 56%|█████▌    | 81/145 [01:51<01:25,  1.34s/it][A
 57%|█████▋    | 82/145 [01:52<01:25,  1.36s/it][A
 57%|█████▋    | 83/145 [01:54<01:25,  1.38s/it][A
 58%|█████▊    | 84/145 [01:55<01:24,  1.39s/it][A
 59%|█████▊    | 85/145 [01:57<01:21,  1.36s/it][A
 59%|█████▉    | 86/145 [01:58<01:21,  1.38s/it][A
 60%|██████    | 87/145 [01:59<01:21,  1.41s/it][A
 61%|██████    | 88/145 [02:01<01:18,  1.38s/it][A
 61%|██████▏   | 89/145 [02:02<01:17,  1.39s/it][A
 62%|██████▏   | 90/145 [02:04<01:16,  1.40s/it][A
 63%|██████▎   | 91/145 [02:05<01:15,  1.40s/it][A
 63%|██████▎   | 92/145 [02:06<01:13,  1.40s/it][A
 64%|██████▍   | 93/145 [02:08<01:11,  1.38s/it][A
 65%|██████▍   | 94/145 [02:09<01:10,  1.38s/it][A
 66%|██████▌   | 95/145 [02:11<01:09,  1.38s/it][A
 66%|██████▌   | 96/145 [02:12<01:08,  1.39s/it][A
 67%|██████▋   | 97/145 [02:13<01:07,  1.40s/it][A
 68%|██████▊   | 98/145 [02:15<01:07,  1.44s/it][A
 68%|██████▊   | 99/145 [02:16<01:04,  1.40s/it][A
 69%|██████▉   | 100/145 [02:18<01:03,  1.41s/it][A
 70%|██████▉   | 101/145 [02:19<01:02,  1.42s/it][A
 70%|███████   | 102/145 [02:20<01:00,  1.41s/it][A
 71%|███████   | 103/145 [02:22<00:58,  1.40s/it][A
 72%|███████▏  | 104/145 [02:23<00:57,  1.41s/it][A
 72%|███████▏  | 105/145 [02:25<00:56,  1.41s/it][A
 73%|███████▎  | 106/145 [02:26<00:54,  1.41s/it][A
 74%|███████▍  | 107/145 [02:27<00:51,  1.36s/it][A
 74%|███████▍  | 108/145 [02:29<00:49,  1.34s/it][A
 75%|███████▌  | 109/145 [02:30<00:48,  1.36s/it][A
 76%|███████▌  | 110/145 [02:31<00:48,  1.38s/it][A
 77%|███████▋  | 111/145 [02:33<00:45,  1.34s/it][A
 77%|███████▋  | 112/145 [02:34<00:45,  1.38s/it][A
 78%|███████▊  | 113/145 [02:36<00:44,  1.39s/it][A
 79%|███████▊  | 114/145 [02:37<00:43,  1.41s/it][A
 79%|███████▉  | 115/145 [02:38<00:42,  1.41s/it][A
 80%|████████  | 116/145 [02:40<00:39,  1.37s/it][A
 81%|████████  | 117/145 [02:41<00:38,  1.38s/it][A
 81%|████████▏ | 118/145 [02:42<00:36,  1.37s/it][A
 82%|████████▏ | 119/145 [02:44<00:34,  1.33s/it][A
 83%|████████▎ | 120/145 [02:45<00:32,  1.31s/it][A
 83%|████████▎ | 121/145 [02:46<00:31,  1.31s/it][A
 84%|████████▍ | 122/145 [02:48<00:30,  1.33s/it][A
 85%|████████▍ | 123/145 [02:49<00:29,  1.34s/it][A
 86%|████████▌ | 124/145 [02:50<00:27,  1.33s/it][A
 86%|████████▌ | 125/145 [02:52<00:28,  1.40s/it][A
 87%|████████▋ | 126/145 [02:53<00:26,  1.38s/it][A
 88%|████████▊ | 127/145 [02:55<00:24,  1.38s/it][A
 88%|████████▊ | 128/145 [02:56<00:24,  1.41s/it][A
 89%|████████▉ | 129/145 [02:57<00:22,  1.40s/it][A
 90%|████████▉ | 130/145 [02:59<00:21,  1.43s/it][A
 90%|█████████ | 131/145 [03:00<00:19,  1.38s/it][A
 91%|█████████ | 132/145 [03:02<00:18,  1.40s/it][A
 92%|█████████▏| 133/145 [03:03<00:16,  1.37s/it][A
 92%|█████████▏| 134/145 [03:04<00:15,  1.40s/it][A
 93%|█████████▎| 135/145 [03:06<00:14,  1.41s/it][A
 94%|█████████▍| 136/145 [03:07<00:12,  1.40s/it][A
 94%|█████████▍| 137/145 [03:09<00:11,  1.39s/it][A
 95%|█████████▌| 138/145 [03:10<00:09,  1.41s/it][A
 96%|█████████▌| 139/145 [03:11<00:08,  1.40s/it][A
 97%|█████████▋| 140/145 [03:13<00:07,  1.40s/it][A
 97%|█████████▋| 141/145 [03:14<00:05,  1.41s/it][A
 98%|█████████▊| 142/145 [03:16<00:04,  1.39s/it][A
 99%|█████████▊| 143/145 [03:17<00:02,  1.38s/it][A
 99%|█████████▉| 144/145 [03:18<00:01,  1.40s/it][A
100%|██████████| 145/145 [03:20<00:00,  1.38s/it][A
                                                 [A                                                        {'eval_loss': 1.9510725736618042, 'eval_runtime': 201.806, 'eval_samples_per_second': 5.733, 'eval_steps_per_second': 0.719, 'epoch': 8.29, 'num_input_tokens_seen': 30612896}

100%|██████████| 145/145 [03:20<00:00,  1.38s/it][A 83%|████████▎ | 2700/3250 [10:11:18<1:40:11, 10.93s/it]
                                                 [A[INFO|trainer.py:3705] 2024-10-11 15:03:21,346 >> Saving model checkpoint to /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2700
[INFO|configuration_utils.py:672] 2024-10-11 15:03:21,949 >> loading configuration file config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/config.json
[WARNING|modeling_rope_utils.py:379] 2024-10-11 15:03:21,949 >> Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
[INFO|configuration_utils.py:739] 2024-10-11 15:03:21,951 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 3584,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 18944,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 28,
  "num_hidden_layers": 28,
  "num_key_value_heads": 4,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.0",
  "use_cache": true,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "in_chans": 3,
    "model_type": "qwen2_vl",
    "spatial_patch_size": 14
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 152064
}

[INFO|tokenization_utils_base.py:2649] 2024-10-11 15:03:22,016 >> tokenizer config file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2700/tokenizer_config.json
[INFO|tokenization_utils_base.py:2658] 2024-10-11 15:03:22,016 >> Special tokens file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2700/special_tokens_map.json
[INFO|image_processing_base.py:258] 2024-10-11 15:03:22,375 >> Image processor saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2700/preprocessor_config.json
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 83%|████████▎ | 2701/3250 [10:11:30<10:56:58, 71.80s/it] 83%|████████▎ | 2702/3250 [10:11:41<8:09:29, 53.59s/it]  83%|████████▎ | 2703/3250 [10:11:52<6:11:49, 40.79s/it] 83%|████████▎ | 2704/3250 [10:12:03<4:49:54, 31.86s/it] 83%|████████▎ | 2705/3250 [10:12:14<3:52:59, 25.65s/it]                                                        {'loss': 1.845, 'grad_norm': 0.31514832377433777, 'learning_rate': 0.005, 'epoch': 8.31, 'num_input_tokens_seen': 30668736}
 83%|████████▎ | 2705/3250 [10:12:14<3:52:59, 25.65s/it] 83%|████████▎ | 2706/3250 [10:12:25<3:12:28, 21.23s/it] 83%|████████▎ | 2707/3250 [10:12:36<2:44:00, 18.12s/it] 83%|████████▎ | 2708/3250 [10:12:47<2:25:01, 16.05s/it] 83%|████████▎ | 2709/3250 [10:12:57<2:09:26, 14.35s/it] 83%|████████▎ | 2710/3250 [10:13:08<2:00:15, 13.36s/it]                                                        {'loss': 1.7623, 'grad_norm': 1.0142810344696045, 'learning_rate': 0.005, 'epoch': 8.33, 'num_input_tokens_seen': 30725088}
 83%|████████▎ | 2710/3250 [10:13:08<2:00:15, 13.36s/it] 83%|████████▎ | 2711/3250 [10:13:19<1:52:18, 12.50s/it] 83%|████████▎ | 2712/3250 [10:13:30<1:48:22, 12.09s/it] 83%|████████▎ | 2713/3250 [10:13:41<1:45:31, 11.79s/it] 84%|████████▎ | 2714/3250 [10:13:52<1:43:35, 11.60s/it] 84%|████████▎ | 2715/3250 [10:14:03<1:42:04, 11.45s/it]                                                        {'loss': 1.6948, 'grad_norm': 0.4390208423137665, 'learning_rate': 0.005, 'epoch': 8.34, 'num_input_tokens_seen': 30782176}
 84%|████████▎ | 2715/3250 [10:14:03<1:42:04, 11.45s/it] 84%|████████▎ | 2716/3250 [10:14:14<1:39:19, 11.16s/it] 84%|████████▎ | 2717/3250 [10:14:25<1:38:54, 11.13s/it] 84%|████████▎ | 2718/3250 [10:14:36<1:38:09, 11.07s/it] 84%|████████▎ | 2719/3250 [10:14:47<1:38:19, 11.11s/it] 84%|████████▎ | 2720/3250 [10:14:58<1:37:59, 11.09s/it]                                                        {'loss': 1.7729, 'grad_norm': 0.498097687959671, 'learning_rate': 0.005, 'epoch': 8.36, 'num_input_tokens_seen': 30839616}
 84%|████████▎ | 2720/3250 [10:14:58<1:37:59, 11.09s/it] 84%|████████▎ | 2721/3250 [10:15:09<1:37:47, 11.09s/it] 84%|████████▍ | 2722/3250 [10:15:20<1:37:16, 11.05s/it] 84%|████████▍ | 2723/3250 [10:15:31<1:37:06, 11.06s/it] 84%|████████▍ | 2724/3250 [10:15:42<1:36:55, 11.06s/it] 84%|████████▍ | 2725/3250 [10:15:53<1:36:42, 11.05s/it]                                                        {'loss': 1.7674, 'grad_norm': 0.46275824308395386, 'learning_rate': 0.005, 'epoch': 8.37, 'num_input_tokens_seen': 30896704}
 84%|████████▍ | 2725/3250 [10:15:53<1:36:42, 11.05s/it] 84%|████████▍ | 2726/3250 [10:16:04<1:34:40, 10.84s/it] 84%|████████▍ | 2727/3250 [10:16:14<1:34:20, 10.82s/it] 84%|████████▍ | 2728/3250 [10:16:25<1:34:18, 10.84s/it] 84%|████████▍ | 2729/3250 [10:16:36<1:34:22, 10.87s/it] 84%|████████▍ | 2730/3250 [10:16:47<1:34:14, 10.87s/it]                                                        {'loss': 1.6527, 'grad_norm': 0.3442891836166382, 'learning_rate': 0.005, 'epoch': 8.39, 'num_input_tokens_seen': 30951936}
 84%|████████▍ | 2730/3250 [10:16:47<1:34:14, 10.87s/it] 84%|████████▍ | 2731/3250 [10:16:58<1:35:08, 11.00s/it] 84%|████████▍ | 2732/3250 [10:17:10<1:35:14, 11.03s/it] 84%|████████▍ | 2733/3250 [10:17:20<1:34:27, 10.96s/it] 84%|████████▍ | 2734/3250 [10:17:31<1:34:08, 10.95s/it] 84%|████████▍ | 2735/3250 [10:17:42<1:34:36, 11.02s/it]                                                        {'loss': 1.6537, 'grad_norm': 0.34385085105895996, 'learning_rate': 0.005, 'epoch': 8.4, 'num_input_tokens_seen': 31009504}
 84%|████████▍ | 2735/3250 [10:17:42<1:34:36, 11.02s/it] 84%|████████▍ | 2736/3250 [10:17:53<1:34:12, 11.00s/it] 84%|████████▍ | 2737/3250 [10:18:05<1:34:26, 11.05s/it] 84%|████████▍ | 2738/3250 [10:18:15<1:33:56, 11.01s/it] 84%|████████▍ | 2739/3250 [10:18:26<1:33:02, 10.92s/it] 84%|████████▍ | 2740/3250 [10:18:37<1:33:32, 11.00s/it]                                                        {'loss': 1.712, 'grad_norm': 0.3658232092857361, 'learning_rate': 0.005, 'epoch': 8.42, 'num_input_tokens_seen': 31066816}
 84%|████████▍ | 2740/3250 [10:18:37<1:33:32, 11.00s/it] 84%|████████▍ | 2741/3250 [10:18:48<1:33:22, 11.01s/it] 84%|████████▍ | 2742/3250 [10:19:00<1:33:48, 11.08s/it] 84%|████████▍ | 2743/3250 [10:19:10<1:31:44, 10.86s/it] 84%|████████▍ | 2744/3250 [10:19:21<1:32:11, 10.93s/it] 84%|████████▍ | 2745/3250 [10:19:32<1:32:01, 10.93s/it]                                                        {'loss': 1.7188, 'grad_norm': 0.31385770440101624, 'learning_rate': 0.005, 'epoch': 8.43, 'num_input_tokens_seen': 31122784}
 84%|████████▍ | 2745/3250 [10:19:32<1:32:01, 10.93s/it] 84%|████████▍ | 2746/3250 [10:19:43<1:31:25, 10.88s/it] 85%|████████▍ | 2747/3250 [10:19:54<1:31:47, 10.95s/it] 85%|████████▍ | 2748/3250 [10:20:05<1:31:53, 10.98s/it] 85%|████████▍ | 2749/3250 [10:20:16<1:32:20, 11.06s/it] 85%|████████▍ | 2750/3250 [10:20:27<1:32:15, 11.07s/it]                                                        {'loss': 1.689, 'grad_norm': 0.3160260319709778, 'learning_rate': 0.005, 'epoch': 8.45, 'num_input_tokens_seen': 31179392}
 85%|████████▍ | 2750/3250 [10:20:27<1:32:15, 11.07s/it] 85%|████████▍ | 2751/3250 [10:20:38<1:31:34, 11.01s/it] 85%|████████▍ | 2752/3250 [10:20:49<1:31:26, 11.02s/it] 85%|████████▍ | 2753/3250 [10:21:00<1:31:18, 11.02s/it] 85%|████████▍ | 2754/3250 [10:21:11<1:31:05, 11.02s/it] 85%|████████▍ | 2755/3250 [10:21:22<1:29:55, 10.90s/it]                                                        {'loss': 1.5989, 'grad_norm': 1.066931128501892, 'learning_rate': 0.005, 'epoch': 8.46, 'num_input_tokens_seen': 31235936}
 85%|████████▍ | 2755/3250 [10:21:22<1:29:55, 10.90s/it] 85%|████████▍ | 2756/3250 [10:21:33<1:30:42, 11.02s/it] 85%|████████▍ | 2757/3250 [10:21:44<1:29:32, 10.90s/it] 85%|████████▍ | 2758/3250 [10:21:55<1:29:56, 10.97s/it] 85%|████████▍ | 2759/3250 [10:22:06<1:29:36, 10.95s/it] 85%|████████▍ | 2760/3250 [10:22:17<1:29:40, 10.98s/it]                                                        {'loss': 1.6212, 'grad_norm': 0.3579152226448059, 'learning_rate': 0.005, 'epoch': 8.48, 'num_input_tokens_seen': 31294240}
 85%|████████▍ | 2760/3250 [10:22:17<1:29:40, 10.98s/it] 85%|████████▍ | 2761/3250 [10:22:27<1:28:09, 10.82s/it] 85%|████████▍ | 2762/3250 [10:22:38<1:28:26, 10.87s/it] 85%|████████▌ | 2763/3250 [10:22:49<1:27:12, 10.74s/it] 85%|████████▌ | 2764/3250 [10:23:00<1:28:00, 10.86s/it] 85%|████████▌ | 2765/3250 [10:23:11<1:28:13, 10.91s/it]                                                        {'loss': 1.6195, 'grad_norm': 0.6267834901809692, 'learning_rate': 0.005, 'epoch': 8.49, 'num_input_tokens_seen': 31350368}
 85%|████████▌ | 2765/3250 [10:23:11<1:28:13, 10.91s/it] 85%|████████▌ | 2766/3250 [10:23:22<1:28:16, 10.94s/it] 85%|████████▌ | 2767/3250 [10:23:33<1:28:18, 10.97s/it] 85%|████████▌ | 2768/3250 [10:23:44<1:28:18, 10.99s/it] 85%|████████▌ | 2769/3250 [10:23:55<1:27:56, 10.97s/it] 85%|████████▌ | 2770/3250 [10:24:06<1:27:41, 10.96s/it]                                                        {'loss': 1.6403, 'grad_norm': 0.5304945707321167, 'learning_rate': 0.005, 'epoch': 8.51, 'num_input_tokens_seen': 31407488}
 85%|████████▌ | 2770/3250 [10:24:06<1:27:41, 10.96s/it] 85%|████████▌ | 2771/3250 [10:24:17<1:27:36, 10.97s/it] 85%|████████▌ | 2772/3250 [10:24:28<1:27:18, 10.96s/it] 85%|████████▌ | 2773/3250 [10:24:39<1:27:33, 11.01s/it] 85%|████████▌ | 2774/3250 [10:24:50<1:27:19, 11.01s/it] 85%|████████▌ | 2775/3250 [10:25:01<1:27:37, 11.07s/it]                                                        {'loss': 1.6302, 'grad_norm': 0.4462748169898987, 'learning_rate': 0.005, 'epoch': 8.53, 'num_input_tokens_seen': 31464448}
 85%|████████▌ | 2775/3250 [10:25:01<1:27:37, 11.07s/it] 85%|████████▌ | 2776/3250 [10:25:12<1:25:53, 10.87s/it] 85%|████████▌ | 2777/3250 [10:25:22<1:25:45, 10.88s/it] 85%|████████▌ | 2778/3250 [10:25:33<1:25:24, 10.86s/it] 86%|████████▌ | 2779/3250 [10:25:44<1:24:43, 10.79s/it] 86%|████████▌ | 2780/3250 [10:25:55<1:24:16, 10.76s/it]                                                        {'loss': 1.5966, 'grad_norm': 0.37446022033691406, 'learning_rate': 0.005, 'epoch': 8.54, 'num_input_tokens_seen': 31518912}
 86%|████████▌ | 2780/3250 [10:25:55<1:24:16, 10.76s/it] 86%|████████▌ | 2781/3250 [10:26:05<1:23:27, 10.68s/it] 86%|████████▌ | 2782/3250 [10:26:15<1:22:37, 10.59s/it] 86%|████████▌ | 2783/3250 [10:26:26<1:23:15, 10.70s/it] 86%|████████▌ | 2784/3250 [10:26:37<1:23:55, 10.81s/it] 86%|████████▌ | 2785/3250 [10:26:48<1:23:36, 10.79s/it]                                                        {'loss': 1.6294, 'grad_norm': 1.0850495100021362, 'learning_rate': 0.005, 'epoch': 8.56, 'num_input_tokens_seen': 31573440}
 86%|████████▌ | 2785/3250 [10:26:48<1:23:36, 10.79s/it] 86%|████████▌ | 2786/3250 [10:26:59<1:23:26, 10.79s/it] 86%|████████▌ | 2787/3250 [10:27:10<1:23:44, 10.85s/it] 86%|████████▌ | 2788/3250 [10:27:21<1:23:43, 10.87s/it] 86%|████████▌ | 2789/3250 [10:27:32<1:24:05, 10.95s/it] 86%|████████▌ | 2790/3250 [10:27:43<1:23:30, 10.89s/it]                                                        {'loss': 1.6332, 'grad_norm': 0.6236230134963989, 'learning_rate': 0.005, 'epoch': 8.57, 'num_input_tokens_seen': 31629984}
 86%|████████▌ | 2790/3250 [10:27:43<1:23:30, 10.89s/it] 86%|████████▌ | 2791/3250 [10:27:54<1:23:31, 10.92s/it] 86%|████████▌ | 2792/3250 [10:28:05<1:23:39, 10.96s/it] 86%|████████▌ | 2793/3250 [10:28:16<1:22:46, 10.87s/it] 86%|████████▌ | 2794/3250 [10:28:27<1:23:31, 10.99s/it] 86%|████████▌ | 2795/3250 [10:28:38<1:23:03, 10.95s/it]                                                        {'loss': 1.6602, 'grad_norm': 0.384142130613327, 'learning_rate': 0.005, 'epoch': 8.59, 'num_input_tokens_seen': 31686624}
 86%|████████▌ | 2795/3250 [10:28:38<1:23:03, 10.95s/it] 86%|████████▌ | 2796/3250 [10:28:49<1:22:45, 10.94s/it] 86%|████████▌ | 2797/3250 [10:29:00<1:22:55, 10.98s/it] 86%|████████▌ | 2798/3250 [10:29:11<1:22:49, 10.99s/it] 86%|████████▌ | 2799/3250 [10:29:22<1:22:22, 10.96s/it] 86%|████████▌ | 2800/3250 [10:29:32<1:22:02, 10.94s/it]                                                        {'loss': 1.5591, 'grad_norm': 0.4860081374645233, 'learning_rate': 0.005, 'epoch': 8.6, 'num_input_tokens_seen': 31743072}
 86%|████████▌ | 2800/3250 [10:29:32<1:22:02, 10.94s/it][INFO|trainer.py:4021] 2024-10-11 15:21:36,049 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-10-11 15:21:36,049 >>   Num examples = 1157
[INFO|trainer.py:4026] 2024-10-11 15:21:36,049 >>   Batch size = 4

  0%|          | 0/145 [00:00<?, ?it/s][A
  1%|▏         | 2/145 [00:01<01:38,  1.45it/s][A
  2%|▏         | 3/145 [00:02<02:22,  1.00s/it][A
  3%|▎         | 4/145 [00:04<02:42,  1.15s/it][A
  3%|▎         | 5/145 [00:05<02:46,  1.19s/it][A
  4%|▍         | 6/145 [00:06<02:55,  1.26s/it][A
  5%|▍         | 7/145 [00:08<03:01,  1.32s/it][A
  6%|▌         | 8/145 [00:09<02:59,  1.31s/it][A
  6%|▌         | 9/145 [00:10<02:58,  1.31s/it][A
  7%|▋         | 10/145 [00:12<02:59,  1.33s/it][A
  8%|▊         | 11/145 [00:13<03:01,  1.35s/it][A
  8%|▊         | 12/145 [00:15<03:04,  1.39s/it][A
  9%|▉         | 13/145 [00:16<03:04,  1.40s/it][A
 10%|▉         | 14/145 [00:18<03:05,  1.42s/it][A
 10%|█         | 15/145 [00:19<03:02,  1.41s/it][A
 11%|█         | 16/145 [00:20<02:59,  1.40s/it][A
 12%|█▏        | 17/145 [00:22<02:59,  1.40s/it][A
 12%|█▏        | 18/145 [00:23<02:58,  1.40s/it][A
 13%|█▎        | 19/145 [00:25<02:57,  1.41s/it][A
 14%|█▍        | 20/145 [00:26<02:55,  1.40s/it][A
 14%|█▍        | 21/145 [00:27<02:51,  1.38s/it][A
 15%|█▌        | 22/145 [00:29<02:48,  1.37s/it][A
 16%|█▌        | 23/145 [00:30<02:47,  1.37s/it][A
 17%|█▋        | 24/145 [00:31<02:46,  1.37s/it][A
 17%|█▋        | 25/145 [00:33<02:45,  1.38s/it][A
 18%|█▊        | 26/145 [00:34<02:43,  1.37s/it][A
 19%|█▊        | 27/145 [00:36<02:43,  1.39s/it][A
 19%|█▉        | 28/145 [00:37<02:41,  1.38s/it][A
 20%|██        | 29/145 [00:38<02:39,  1.37s/it][A
 21%|██        | 30/145 [00:40<02:33,  1.34s/it][A
 21%|██▏       | 31/145 [00:41<02:35,  1.36s/it][A
 22%|██▏       | 32/145 [00:42<02:34,  1.37s/it][A
 23%|██▎       | 33/145 [00:44<02:33,  1.37s/it][A
 23%|██▎       | 34/145 [00:45<02:33,  1.38s/it][A
 24%|██▍       | 35/145 [00:47<02:32,  1.39s/it][A
 25%|██▍       | 36/145 [00:48<02:30,  1.38s/it][A
 26%|██▌       | 37/145 [00:49<02:33,  1.42s/it][A
 26%|██▌       | 38/145 [00:51<02:31,  1.42s/it][A
 27%|██▋       | 39/145 [00:52<02:28,  1.40s/it][A
 28%|██▊       | 40/145 [00:54<02:26,  1.40s/it][A
 28%|██▊       | 41/145 [00:55<02:27,  1.42s/it][A
 29%|██▉       | 42/145 [00:56<02:25,  1.42s/it][A
 30%|██▉       | 43/145 [00:58<02:22,  1.39s/it][A
 30%|███       | 44/145 [00:59<02:23,  1.43s/it][A
 31%|███       | 45/145 [01:01<02:24,  1.44s/it][A
 32%|███▏      | 46/145 [01:02<02:20,  1.42s/it][A
 32%|███▏      | 47/145 [01:03<02:16,  1.39s/it][A
 33%|███▎      | 48/145 [01:05<02:15,  1.40s/it][A
 34%|███▍      | 49/145 [01:06<02:15,  1.41s/it][A
 34%|███▍      | 50/145 [01:08<02:15,  1.42s/it][A
 35%|███▌      | 51/145 [01:09<02:13,  1.42s/it][A
 36%|███▌      | 52/145 [01:11<02:11,  1.41s/it][A
 37%|███▋      | 53/145 [01:12<02:10,  1.41s/it][A
 37%|███▋      | 54/145 [01:13<02:09,  1.42s/it][A
 38%|███▊      | 55/145 [01:15<02:06,  1.41s/it][A
 39%|███▊      | 56/145 [01:16<02:05,  1.41s/it][A
 39%|███▉      | 57/145 [01:18<02:03,  1.40s/it][A
 40%|████      | 58/145 [01:19<02:00,  1.39s/it][A
 41%|████      | 59/145 [01:20<02:02,  1.42s/it][A
 41%|████▏     | 60/145 [01:22<01:59,  1.41s/it][A
 42%|████▏     | 61/145 [01:23<01:57,  1.40s/it][A
 43%|████▎     | 62/145 [01:25<01:54,  1.38s/it][A
 43%|████▎     | 63/145 [01:26<01:55,  1.40s/it][A
 44%|████▍     | 64/145 [01:27<01:53,  1.40s/it][A
 45%|████▍     | 65/145 [01:29<01:52,  1.41s/it][A
 46%|████▌     | 66/145 [01:30<01:51,  1.41s/it][A
 46%|████▌     | 67/145 [01:32<01:48,  1.40s/it][A
 47%|████▋     | 68/145 [01:33<01:49,  1.42s/it][A
 48%|████▊     | 69/145 [01:35<01:48,  1.43s/it][A
 48%|████▊     | 70/145 [01:36<01:43,  1.38s/it][A
 49%|████▉     | 71/145 [01:37<01:41,  1.37s/it][A
 50%|████▉     | 72/145 [01:39<01:40,  1.38s/it][A
 50%|█████     | 73/145 [01:40<01:41,  1.41s/it][A
 51%|█████     | 74/145 [01:41<01:40,  1.42s/it][A
 52%|█████▏    | 75/145 [01:43<01:39,  1.42s/it][A
 52%|█████▏    | 76/145 [01:44<01:37,  1.41s/it][A
 53%|█████▎    | 77/145 [01:46<01:33,  1.38s/it][A
 54%|█████▍    | 78/145 [01:47<01:32,  1.38s/it][A
 54%|█████▍    | 79/145 [01:48<01:30,  1.36s/it][A
 55%|█████▌    | 80/145 [01:50<01:28,  1.36s/it][A
 56%|█████▌    | 81/145 [01:51<01:25,  1.34s/it][A
 57%|█████▋    | 82/145 [01:52<01:25,  1.36s/it][A
 57%|█████▋    | 83/145 [01:54<01:25,  1.38s/it][A
 58%|█████▊    | 84/145 [01:55<01:24,  1.39s/it][A
 59%|█████▊    | 85/145 [01:56<01:21,  1.36s/it][A
 59%|█████▉    | 86/145 [01:58<01:21,  1.38s/it][A
 60%|██████    | 87/145 [01:59<01:21,  1.40s/it][A
 61%|██████    | 88/145 [02:01<01:18,  1.38s/it][A
 61%|██████▏   | 89/145 [02:02<01:17,  1.39s/it][A
 62%|██████▏   | 90/145 [02:03<01:16,  1.40s/it][A
 63%|██████▎   | 91/145 [02:05<01:15,  1.40s/it][A
 63%|██████▎   | 92/145 [02:06<01:14,  1.40s/it][A
 64%|██████▍   | 93/145 [02:08<01:11,  1.38s/it][A
 65%|██████▍   | 94/145 [02:09<01:10,  1.38s/it][A
 66%|██████▌   | 95/145 [02:10<01:09,  1.38s/it][A
 66%|██████▌   | 96/145 [02:12<01:08,  1.39s/it][A
 67%|██████▋   | 97/145 [02:13<01:07,  1.40s/it][A
 68%|██████▊   | 98/145 [02:15<01:07,  1.44s/it][A
 68%|██████▊   | 99/145 [02:16<01:04,  1.40s/it][A
 69%|██████▉   | 100/145 [02:17<01:03,  1.41s/it][A
 70%|██████▉   | 101/145 [02:19<01:02,  1.42s/it][A
 70%|███████   | 102/145 [02:20<01:00,  1.41s/it][A
 71%|███████   | 103/145 [02:22<00:58,  1.40s/it][A
 72%|███████▏  | 104/145 [02:23<00:57,  1.41s/it][A
 72%|███████▏  | 105/145 [02:25<00:56,  1.41s/it][A
 73%|███████▎  | 106/145 [02:26<00:54,  1.41s/it][A
 74%|███████▍  | 107/145 [02:27<00:51,  1.36s/it][A
 74%|███████▍  | 108/145 [02:28<00:49,  1.34s/it][A
 75%|███████▌  | 109/145 [02:30<00:48,  1.36s/it][A
 76%|███████▌  | 110/145 [02:31<00:48,  1.38s/it][A
 77%|███████▋  | 111/145 [02:33<00:45,  1.34s/it][A
 77%|███████▋  | 112/145 [02:34<00:45,  1.38s/it][A
 78%|███████▊  | 113/145 [02:35<00:44,  1.40s/it][A
 79%|███████▊  | 114/145 [02:37<00:43,  1.41s/it][A
 79%|███████▉  | 115/145 [02:38<00:42,  1.41s/it][A
 80%|████████  | 116/145 [02:40<00:39,  1.37s/it][A
 81%|████████  | 117/145 [02:41<00:38,  1.37s/it][A
 81%|████████▏ | 118/145 [02:42<00:37,  1.37s/it][A
 82%|████████▏ | 119/145 [02:44<00:34,  1.33s/it][A
 83%|████████▎ | 120/145 [02:45<00:33,  1.32s/it][A
 83%|████████▎ | 121/145 [02:46<00:31,  1.32s/it][A
 84%|████████▍ | 122/145 [02:48<00:30,  1.33s/it][A
 85%|████████▍ | 123/145 [02:49<00:29,  1.34s/it][A
 86%|████████▌ | 124/145 [02:50<00:28,  1.34s/it][A
 86%|████████▌ | 125/145 [02:52<00:28,  1.40s/it][A
 87%|████████▋ | 126/145 [02:53<00:26,  1.38s/it][A
 88%|████████▊ | 127/145 [02:54<00:24,  1.38s/it][A
 88%|████████▊ | 128/145 [02:56<00:23,  1.41s/it][A
 89%|████████▉ | 129/145 [02:57<00:22,  1.40s/it][A
 90%|████████▉ | 130/145 [02:59<00:21,  1.43s/it][A
 90%|█████████ | 131/145 [03:00<00:19,  1.38s/it][A
 91%|█████████ | 132/145 [03:02<00:18,  1.39s/it][A
 92%|█████████▏| 133/145 [03:03<00:16,  1.36s/it][A
 92%|█████████▏| 134/145 [03:04<00:15,  1.40s/it][A
 93%|█████████▎| 135/145 [03:06<00:14,  1.41s/it][A
 94%|█████████▍| 136/145 [03:07<00:12,  1.40s/it][A
 94%|█████████▍| 137/145 [03:08<00:11,  1.39s/it][A
 95%|█████████▌| 138/145 [03:10<00:09,  1.40s/it][A
 96%|█████████▌| 139/145 [03:11<00:08,  1.40s/it][A
 97%|█████████▋| 140/145 [03:13<00:07,  1.40s/it][A
 97%|█████████▋| 141/145 [03:14<00:05,  1.41s/it][A
 98%|█████████▊| 142/145 [03:15<00:04,  1.39s/it][A
 99%|█████████▊| 143/145 [03:17<00:02,  1.38s/it][A
 99%|█████████▉| 144/145 [03:18<00:01,  1.39s/it][A
100%|██████████| 145/145 [03:20<00:00,  1.37s/it][A
                                                 [A                                                        {'eval_loss': 1.5925854444503784, 'eval_runtime': 201.6241, 'eval_samples_per_second': 5.738, 'eval_steps_per_second': 0.719, 'epoch': 8.6, 'num_input_tokens_seen': 31743072}

100%|██████████| 145/145 [03:20<00:00,  1.37s/it][A 86%|████████▌ | 2800/3250 [10:32:54<1:22:02, 10.94s/it]
                                                 [A[INFO|trainer.py:3705] 2024-10-11 15:24:57,676 >> Saving model checkpoint to /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2800
[INFO|configuration_utils.py:672] 2024-10-11 15:24:58,264 >> loading configuration file config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/config.json
[WARNING|modeling_rope_utils.py:379] 2024-10-11 15:24:58,264 >> Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
[INFO|configuration_utils.py:739] 2024-10-11 15:24:58,266 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 3584,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 18944,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 28,
  "num_hidden_layers": 28,
  "num_key_value_heads": 4,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.0",
  "use_cache": true,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "in_chans": 3,
    "model_type": "qwen2_vl",
    "spatial_patch_size": 14
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 152064
}

[INFO|tokenization_utils_base.py:2649] 2024-10-11 15:24:58,333 >> tokenizer config file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2800/tokenizer_config.json
[INFO|tokenization_utils_base.py:2658] 2024-10-11 15:24:58,334 >> Special tokens file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2800/special_tokens_map.json
[INFO|image_processing_base.py:258] 2024-10-11 15:24:58,751 >> Image processor saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2800/preprocessor_config.json
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 86%|████████▌ | 2801/3250 [10:33:06<8:56:37, 71.71s/it] 86%|████████▌ | 2802/3250 [10:33:17<6:40:07, 53.59s/it] 86%|████████▌ | 2803/3250 [10:33:28<5:03:19, 40.71s/it] 86%|████████▋ | 2804/3250 [10:33:39<3:56:22, 31.80s/it] 86%|████████▋ | 2805/3250 [10:33:50<3:09:52, 25.60s/it]                                                        {'loss': 1.6218, 'grad_norm': 0.4580625295639038, 'learning_rate': 0.0005, 'epoch': 8.62, 'num_input_tokens_seen': 31800064}
 86%|████████▋ | 2805/3250 [10:33:50<3:09:52, 25.60s/it] 86%|████████▋ | 2806/3250 [10:34:01<2:37:19, 21.26s/it] 86%|████████▋ | 2807/3250 [10:34:12<2:13:41, 18.11s/it] 86%|████████▋ | 2808/3250 [10:34:23<1:57:40, 15.97s/it] 86%|████████▋ | 2809/3250 [10:34:34<1:46:22, 14.47s/it] 86%|████████▋ | 2810/3250 [10:34:45<1:37:59, 13.36s/it]                                                        {'loss': 1.5762, 'grad_norm': 0.22118735313415527, 'learning_rate': 0.0005, 'epoch': 8.63, 'num_input_tokens_seen': 31855488}
 86%|████████▋ | 2810/3250 [10:34:45<1:37:59, 13.36s/it] 86%|████████▋ | 2811/3250 [10:34:55<1:31:22, 12.49s/it] 87%|████████▋ | 2812/3250 [10:35:06<1:28:04, 12.07s/it] 87%|████████▋ | 2813/3250 [10:35:17<1:25:25, 11.73s/it] 87%|████████▋ | 2814/3250 [10:35:28<1:22:24, 11.34s/it] 87%|████████▋ | 2815/3250 [10:35:38<1:21:07, 11.19s/it]                                                        {'loss': 1.6044, 'grad_norm': 0.25361567735671997, 'learning_rate': 0.0005, 'epoch': 8.65, 'num_input_tokens_seen': 31910752}
 87%|████████▋ | 2815/3250 [10:35:38<1:21:07, 11.19s/it] 87%|████████▋ | 2816/3250 [10:35:50<1:20:51, 11.18s/it] 87%|████████▋ | 2817/3250 [10:36:01<1:20:54, 11.21s/it] 87%|████████▋ | 2818/3250 [10:36:12<1:19:47, 11.08s/it] 87%|████████▋ | 2819/3250 [10:36:23<1:19:28, 11.06s/it] 87%|████████▋ | 2820/3250 [10:36:34<1:18:51, 11.00s/it]                                                        {'loss': 1.6167, 'grad_norm': 0.35364067554473877, 'learning_rate': 0.0005, 'epoch': 8.66, 'num_input_tokens_seen': 31967328}
 87%|████████▋ | 2820/3250 [10:36:34<1:18:51, 11.00s/it] 87%|████████▋ | 2821/3250 [10:36:44<1:18:03, 10.92s/it] 87%|████████▋ | 2822/3250 [10:36:55<1:17:48, 10.91s/it] 87%|████████▋ | 2823/3250 [10:37:06<1:18:13, 10.99s/it] 87%|████████▋ | 2824/3250 [10:37:17<1:17:58, 10.98s/it] 87%|████████▋ | 2825/3250 [10:37:28<1:17:32, 10.95s/it]                                                        {'loss': 1.6401, 'grad_norm': 0.29331690073013306, 'learning_rate': 0.0005, 'epoch': 8.68, 'num_input_tokens_seen': 32023264}
 87%|████████▋ | 2825/3250 [10:37:28<1:17:32, 10.95s/it] 87%|████████▋ | 2826/3250 [10:37:39<1:17:04, 10.91s/it] 87%|████████▋ | 2827/3250 [10:37:50<1:17:00, 10.92s/it] 87%|████████▋ | 2828/3250 [10:38:01<1:17:25, 11.01s/it] 87%|████████▋ | 2829/3250 [10:38:12<1:17:17, 11.02s/it] 87%|████████▋ | 2830/3250 [10:38:23<1:17:28, 11.07s/it]                                                        {'loss': 1.5954, 'grad_norm': 0.19678594172000885, 'learning_rate': 0.0005, 'epoch': 8.69, 'num_input_tokens_seen': 32080672}
 87%|████████▋ | 2830/3250 [10:38:23<1:17:28, 11.07s/it] 87%|████████▋ | 2831/3250 [10:38:34<1:16:59, 11.02s/it] 87%|████████▋ | 2832/3250 [10:38:45<1:16:52, 11.03s/it] 87%|████████▋ | 2833/3250 [10:38:56<1:16:43, 11.04s/it] 87%|████████▋ | 2834/3250 [10:39:07<1:16:18, 11.01s/it] 87%|████████▋ | 2835/3250 [10:39:18<1:16:08, 11.01s/it]                                                        {'loss': 1.5439, 'grad_norm': 0.19154107570648193, 'learning_rate': 0.0005, 'epoch': 8.71, 'num_input_tokens_seen': 32138176}
 87%|████████▋ | 2835/3250 [10:39:18<1:16:08, 11.01s/it] 87%|████████▋ | 2836/3250 [10:39:29<1:15:11, 10.90s/it] 87%|████████▋ | 2837/3250 [10:39:40<1:14:34, 10.83s/it] 87%|████████▋ | 2838/3250 [10:39:51<1:14:57, 10.92s/it] 87%|████████▋ | 2839/3250 [10:40:02<1:15:20, 11.00s/it] 87%|████████▋ | 2840/3250 [10:40:13<1:14:59, 10.97s/it]                                                        {'loss': 1.5261, 'grad_norm': 0.21033474802970886, 'learning_rate': 0.0005, 'epoch': 8.73, 'num_input_tokens_seen': 32194944}
 87%|████████▋ | 2840/3250 [10:40:13<1:14:59, 10.97s/it] 87%|████████▋ | 2841/3250 [10:40:24<1:14:46, 10.97s/it] 87%|████████▋ | 2842/3250 [10:40:35<1:14:22, 10.94s/it] 87%|████████▋ | 2843/3250 [10:40:45<1:13:48, 10.88s/it] 88%|████████▊ | 2844/3250 [10:40:56<1:13:00, 10.79s/it] 88%|████████▊ | 2845/3250 [10:41:07<1:13:25, 10.88s/it]                                                        {'loss': 1.6088, 'grad_norm': 0.2031121850013733, 'learning_rate': 0.0005, 'epoch': 8.74, 'num_input_tokens_seen': 32250656}
 88%|████████▊ | 2845/3250 [10:41:07<1:13:25, 10.88s/it] 88%|████████▊ | 2846/3250 [10:41:18<1:12:52, 10.82s/it] 88%|████████▊ | 2847/3250 [10:41:29<1:12:53, 10.85s/it] 88%|████████▊ | 2848/3250 [10:41:40<1:12:41, 10.85s/it] 88%|████████▊ | 2849/3250 [10:41:50<1:12:20, 10.82s/it] 88%|████████▊ | 2850/3250 [10:42:01<1:12:29, 10.87s/it]                                                        {'loss': 1.5645, 'grad_norm': 0.23079724609851837, 'learning_rate': 0.0005, 'epoch': 8.76, 'num_input_tokens_seen': 32306624}
 88%|████████▊ | 2850/3250 [10:42:01<1:12:29, 10.87s/it] 88%|████████▊ | 2851/3250 [10:42:12<1:11:59, 10.83s/it] 88%|████████▊ | 2852/3250 [10:42:23<1:12:18, 10.90s/it] 88%|████████▊ | 2853/3250 [10:42:34<1:11:09, 10.76s/it] 88%|████████▊ | 2854/3250 [10:42:45<1:11:46, 10.87s/it] 88%|████████▊ | 2855/3250 [10:42:56<1:12:00, 10.94s/it]                                                        {'loss': 1.5558, 'grad_norm': 0.19386160373687744, 'learning_rate': 0.0005, 'epoch': 8.77, 'num_input_tokens_seen': 32363360}
 88%|████████▊ | 2855/3250 [10:42:56<1:12:00, 10.94s/it] 88%|████████▊ | 2856/3250 [10:43:07<1:12:03, 10.97s/it] 88%|████████▊ | 2857/3250 [10:43:18<1:12:14, 11.03s/it] 88%|████████▊ | 2858/3250 [10:43:29<1:12:25, 11.09s/it] 88%|████████▊ | 2859/3250 [10:43:40<1:12:14, 11.09s/it] 88%|████████▊ | 2860/3250 [10:43:51<1:11:55, 11.07s/it]                                                        {'loss': 1.556, 'grad_norm': 0.2297568917274475, 'learning_rate': 0.0005, 'epoch': 8.79, 'num_input_tokens_seen': 32421280}
 88%|████████▊ | 2860/3250 [10:43:51<1:11:55, 11.07s/it] 88%|████████▊ | 2861/3250 [10:44:02<1:11:28, 11.02s/it] 88%|████████▊ | 2862/3250 [10:44:13<1:11:38, 11.08s/it] 88%|████████▊ | 2863/3250 [10:44:25<1:11:53, 11.15s/it] 88%|████████▊ | 2864/3250 [10:44:36<1:11:36, 11.13s/it] 88%|████████▊ | 2865/3250 [10:44:47<1:11:27, 11.14s/it]                                                        {'loss': 1.5659, 'grad_norm': 0.18003566563129425, 'learning_rate': 0.0005, 'epoch': 8.8, 'num_input_tokens_seen': 32478272}
 88%|████████▊ | 2865/3250 [10:44:47<1:11:27, 11.14s/it] 88%|████████▊ | 2866/3250 [10:44:58<1:11:07, 11.11s/it] 88%|████████▊ | 2867/3250 [10:45:09<1:10:33, 11.05s/it] 88%|████████▊ | 2868/3250 [10:45:20<1:10:47, 11.12s/it] 88%|████████▊ | 2869/3250 [10:45:31<1:10:34, 11.12s/it] 88%|████████▊ | 2870/3250 [10:45:42<1:10:22, 11.11s/it]                                                        {'loss': 1.5342, 'grad_norm': 0.2587296664714813, 'learning_rate': 0.0005, 'epoch': 8.82, 'num_input_tokens_seen': 32536448}
 88%|████████▊ | 2870/3250 [10:45:42<1:10:22, 11.11s/it] 88%|████████▊ | 2871/3250 [10:45:53<1:09:47, 11.05s/it] 88%|████████▊ | 2872/3250 [10:46:04<1:09:40, 11.06s/it] 88%|████████▊ | 2873/3250 [10:46:16<1:09:45, 11.10s/it] 88%|████████▊ | 2874/3250 [10:46:26<1:08:32, 10.94s/it] 88%|████████▊ | 2875/3250 [10:46:37<1:08:24, 10.95s/it]                                                        {'loss': 1.5548, 'grad_norm': 0.2854492962360382, 'learning_rate': 0.0005, 'epoch': 8.83, 'num_input_tokens_seen': 32591648}
 88%|████████▊ | 2875/3250 [10:46:37<1:08:24, 10.95s/it] 88%|████████▊ | 2876/3250 [10:46:48<1:08:02, 10.92s/it] 89%|████████▊ | 2877/3250 [10:46:59<1:08:17, 10.98s/it] 89%|████████▊ | 2878/3250 [10:47:10<1:08:16, 11.01s/it] 89%|████████▊ | 2879/3250 [10:47:21<1:07:49, 10.97s/it] 89%|████████▊ | 2880/3250 [10:47:32<1:07:55, 11.01s/it]                                                        {'loss': 1.5801, 'grad_norm': 0.20991264283657074, 'learning_rate': 0.0005, 'epoch': 8.85, 'num_input_tokens_seen': 32648736}
 89%|████████▊ | 2880/3250 [10:47:32<1:07:55, 11.01s/it] 89%|████████▊ | 2881/3250 [10:47:43<1:08:07, 11.08s/it] 89%|████████▊ | 2882/3250 [10:47:55<1:08:21, 11.15s/it] 89%|████████▊ | 2883/3250 [10:48:05<1:07:28, 11.03s/it] 89%|████████▊ | 2884/3250 [10:48:16<1:06:43, 10.94s/it] 89%|████████▉ | 2885/3250 [10:48:27<1:06:03, 10.86s/it]                                                        {'loss': 1.5438, 'grad_norm': 0.2335750013589859, 'learning_rate': 0.0005, 'epoch': 8.86, 'num_input_tokens_seen': 32705056}
 89%|████████▉ | 2885/3250 [10:48:27<1:06:03, 10.86s/it] 89%|████████▉ | 2886/3250 [10:48:38<1:06:09, 10.91s/it] 89%|████████▉ | 2887/3250 [10:48:49<1:06:09, 10.93s/it] 89%|████████▉ | 2888/3250 [10:49:01<1:07:14, 11.14s/it] 89%|████████▉ | 2889/3250 [10:49:12<1:07:41, 11.25s/it] 89%|████████▉ | 2890/3250 [10:49:24<1:08:09, 11.36s/it]                                                        {'loss': 1.6076, 'grad_norm': 0.23030485212802887, 'learning_rate': 0.0005, 'epoch': 8.88, 'num_input_tokens_seen': 32761504}
 89%|████████▉ | 2890/3250 [10:49:24<1:08:09, 11.36s/it] 89%|████████▉ | 2891/3250 [10:49:35<1:08:18, 11.42s/it] 89%|████████▉ | 2892/3250 [10:49:47<1:08:07, 11.42s/it] 89%|████████▉ | 2893/3250 [10:49:58<1:07:59, 11.43s/it] 89%|████████▉ | 2894/3250 [10:50:10<1:08:06, 11.48s/it] 89%|████████▉ | 2895/3250 [10:50:21<1:07:51, 11.47s/it]                                                        {'loss': 1.5095, 'grad_norm': 0.2123696357011795, 'learning_rate': 0.0005, 'epoch': 8.89, 'num_input_tokens_seen': 32818400}
 89%|████████▉ | 2895/3250 [10:50:21<1:07:51, 11.47s/it] 89%|████████▉ | 2896/3250 [10:50:33<1:08:03, 11.53s/it] 89%|████████▉ | 2897/3250 [10:50:44<1:07:56, 11.55s/it] 89%|████████▉ | 2898/3250 [10:50:56<1:07:51, 11.57s/it] 89%|████████▉ | 2899/3250 [10:51:08<1:07:41, 11.57s/it] 89%|████████▉ | 2900/3250 [10:51:19<1:06:53, 11.47s/it]                                                        {'loss': 1.5156, 'grad_norm': 0.24818283319473267, 'learning_rate': 0.0005, 'epoch': 8.91, 'num_input_tokens_seen': 32875040}
 89%|████████▉ | 2900/3250 [10:51:19<1:06:53, 11.47s/it][INFO|trainer.py:4021] 2024-10-11 15:43:22,404 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-10-11 15:43:22,404 >>   Num examples = 1157
[INFO|trainer.py:4026] 2024-10-11 15:43:22,405 >>   Batch size = 4

  0%|          | 0/145 [00:00<?, ?it/s][A
  1%|▏         | 2/145 [00:01<01:47,  1.32it/s][A
  2%|▏         | 3/145 [00:03<02:34,  1.09s/it][A
  3%|▎         | 4/145 [00:04<02:54,  1.24s/it][A
  3%|▎         | 5/145 [00:05<03:00,  1.29s/it][A
  4%|▍         | 6/145 [00:07<03:10,  1.37s/it][A
  5%|▍         | 7/145 [00:09<03:17,  1.43s/it][A
  6%|▌         | 8/145 [00:10<03:15,  1.42s/it][A
  6%|▌         | 9/145 [00:11<03:14,  1.43s/it][A
  7%|▋         | 10/145 [00:13<03:15,  1.45s/it][A
  8%|▊         | 11/145 [00:14<03:16,  1.47s/it][A
  8%|▊         | 12/145 [00:16<03:18,  1.49s/it][A
  9%|▉         | 13/145 [00:18<03:19,  1.51s/it][A
 10%|▉         | 14/145 [00:19<03:20,  1.53s/it][A
 10%|█         | 15/145 [00:21<03:17,  1.52s/it][A
 11%|█         | 16/145 [00:22<03:14,  1.51s/it][A
 12%|█▏        | 17/145 [00:24<03:13,  1.51s/it][A
 12%|█▏        | 18/145 [00:25<03:12,  1.52s/it][A
 13%|█▎        | 19/145 [00:27<03:11,  1.52s/it][A
 14%|█▍        | 20/145 [00:28<03:09,  1.52s/it][A
 14%|█▍        | 21/145 [00:30<03:05,  1.50s/it][A
 15%|█▌        | 22/145 [00:31<03:03,  1.49s/it][A
 16%|█▌        | 23/145 [00:33<03:01,  1.49s/it][A
 17%|█▋        | 24/145 [00:34<03:00,  1.50s/it][A
 17%|█▋        | 25/145 [00:36<02:59,  1.50s/it][A
 18%|█▊        | 26/145 [00:37<02:57,  1.49s/it][A
 19%|█▊        | 27/145 [00:39<02:57,  1.50s/it][A
 19%|█▉        | 28/145 [00:40<02:54,  1.49s/it][A
 20%|██        | 29/145 [00:42<02:53,  1.49s/it][A
 21%|██        | 30/145 [00:43<02:47,  1.46s/it][A
 21%|██▏       | 31/145 [00:44<02:48,  1.48s/it][A
 22%|██▏       | 32/145 [00:46<02:47,  1.48s/it][A
 23%|██▎       | 33/145 [00:47<02:47,  1.49s/it][A
 23%|██▎       | 34/145 [00:49<02:45,  1.50s/it][A
 24%|██▍       | 35/145 [00:50<02:45,  1.50s/it][A
 25%|██▍       | 36/145 [00:52<02:43,  1.50s/it][A
 26%|██▌       | 37/145 [00:54<02:45,  1.53s/it][A
 26%|██▌       | 38/145 [00:55<02:44,  1.53s/it][A
 27%|██▋       | 39/145 [00:57<02:41,  1.52s/it][A
 28%|██▊       | 40/145 [00:58<02:39,  1.52s/it][A
 28%|██▊       | 41/145 [01:00<02:40,  1.54s/it][A
 29%|██▉       | 42/145 [01:01<02:38,  1.54s/it][A
 30%|██▉       | 43/145 [01:03<02:35,  1.52s/it][A
 30%|███       | 44/145 [01:04<02:36,  1.55s/it][A
 31%|███       | 45/145 [01:06<02:36,  1.56s/it][A
 32%|███▏      | 46/145 [01:07<02:31,  1.53s/it][A
 32%|███▏      | 47/145 [01:09<02:27,  1.51s/it][A
 33%|███▎      | 48/145 [01:10<02:27,  1.52s/it][A
 34%|███▍      | 49/145 [01:12<02:26,  1.53s/it][A
 34%|███▍      | 50/145 [01:13<02:25,  1.54s/it][A
 35%|███▌      | 51/145 [01:15<02:24,  1.53s/it][A
 36%|███▌      | 52/145 [01:17<02:22,  1.53s/it][A
 37%|███▋      | 53/145 [01:18<02:20,  1.53s/it][A
 37%|███▋      | 54/145 [01:20<02:19,  1.54s/it][A
 38%|███▊      | 55/145 [01:21<02:17,  1.53s/it][A
 39%|███▊      | 56/145 [01:23<02:15,  1.52s/it][A
 39%|███▉      | 57/145 [01:24<02:12,  1.51s/it][A
 40%|████      | 58/145 [01:26<02:10,  1.50s/it][A
 41%|████      | 59/145 [01:27<02:11,  1.53s/it][A
 41%|████▏     | 60/145 [01:29<02:09,  1.52s/it][A
 42%|████▏     | 61/145 [01:30<02:07,  1.51s/it][A
 43%|████▎     | 62/145 [01:32<02:04,  1.50s/it][A
 43%|████▎     | 63/145 [01:33<02:04,  1.52s/it][A
 44%|████▍     | 64/145 [01:35<02:02,  1.52s/it][A
 45%|████▍     | 65/145 [01:36<02:01,  1.52s/it][A
 46%|████▌     | 66/145 [01:38<02:00,  1.52s/it][A
 46%|████▌     | 67/145 [01:39<01:57,  1.51s/it][A
 47%|████▋     | 68/145 [01:41<01:58,  1.54s/it][A
 48%|████▊     | 69/145 [01:42<01:57,  1.54s/it][A
 48%|████▊     | 70/145 [01:44<01:51,  1.49s/it][A
 49%|████▉     | 71/145 [01:45<01:49,  1.49s/it][A
 50%|████▉     | 72/145 [01:47<01:49,  1.50s/it][A
 50%|█████     | 73/145 [01:48<01:49,  1.53s/it][A
 51%|█████     | 74/145 [01:50<01:48,  1.53s/it][A
 52%|█████▏    | 75/145 [01:51<01:47,  1.54s/it][A
 52%|█████▏    | 76/145 [01:53<01:45,  1.53s/it][A
 53%|█████▎    | 77/145 [01:54<01:41,  1.50s/it][A
 54%|█████▍    | 78/145 [01:56<01:40,  1.50s/it][A
 54%|█████▍    | 79/145 [01:57<01:37,  1.48s/it][A
 55%|█████▌    | 80/145 [01:59<01:36,  1.48s/it][A
 56%|█████▌    | 81/145 [02:00<01:33,  1.46s/it][A
 57%|█████▋    | 82/145 [02:02<01:33,  1.48s/it][A
 57%|█████▋    | 83/145 [02:03<01:32,  1.49s/it][A
 58%|█████▊    | 84/145 [02:05<01:31,  1.50s/it][A
 59%|█████▊    | 85/145 [02:06<01:28,  1.48s/it][A
 59%|█████▉    | 86/145 [02:08<01:28,  1.49s/it][A
 60%|██████    | 87/145 [02:09<01:28,  1.52s/it][A
 61%|██████    | 88/145 [02:11<01:25,  1.50s/it][A
 61%|██████▏   | 89/145 [02:12<01:24,  1.51s/it][A
 62%|██████▏   | 90/145 [02:14<01:23,  1.52s/it][A
 63%|██████▎   | 91/145 [02:15<01:21,  1.51s/it][A
 63%|██████▎   | 92/145 [02:17<01:20,  1.51s/it][A
 64%|██████▍   | 93/145 [02:18<01:17,  1.49s/it][A
 65%|██████▍   | 94/145 [02:20<01:15,  1.49s/it][A
 66%|██████▌   | 95/145 [02:21<01:14,  1.49s/it][A
 66%|██████▌   | 96/145 [02:23<01:13,  1.50s/it][A
 67%|██████▋   | 97/145 [02:24<01:12,  1.51s/it][A
 68%|██████▊   | 98/145 [02:26<01:12,  1.54s/it][A
 68%|██████▊   | 99/145 [02:27<01:09,  1.52s/it][A
 69%|██████▉   | 100/145 [02:29<01:08,  1.53s/it][A
 70%|██████▉   | 101/145 [02:31<01:07,  1.53s/it][A
 70%|███████   | 102/145 [02:32<01:05,  1.53s/it][A
 71%|███████   | 103/145 [02:34<01:03,  1.52s/it][A
 72%|███████▏  | 104/145 [02:35<01:02,  1.53s/it][A
 72%|███████▏  | 105/145 [02:37<01:01,  1.53s/it][A
 73%|███████▎  | 106/145 [02:38<00:59,  1.53s/it][A
 74%|███████▍  | 107/145 [02:40<00:56,  1.48s/it][A
 74%|███████▍  | 108/145 [02:41<00:53,  1.46s/it][A
 75%|███████▌  | 109/145 [02:42<00:53,  1.48s/it][A
 76%|███████▌  | 110/145 [02:44<00:52,  1.50s/it][A
 77%|███████▋  | 111/145 [02:45<00:49,  1.47s/it][A
 77%|███████▋  | 112/145 [02:47<00:49,  1.50s/it][A
 78%|███████▊  | 113/145 [02:49<00:48,  1.52s/it][A
 79%|███████▊  | 114/145 [02:50<00:47,  1.52s/it][A
 79%|███████▉  | 115/145 [02:52<00:45,  1.52s/it][A
 80%|████████  | 116/145 [02:53<00:43,  1.49s/it][A
 81%|████████  | 117/145 [02:55<00:41,  1.50s/it][A
 81%|████████▏ | 118/145 [02:56<00:40,  1.49s/it][A
 82%|████████▏ | 119/145 [02:57<00:37,  1.45s/it][A
 83%|████████▎ | 120/145 [02:59<00:35,  1.44s/it][A
 83%|████████▎ | 121/145 [03:00<00:34,  1.44s/it][A
 84%|████████▍ | 122/145 [03:02<00:33,  1.45s/it][A
 85%|████████▍ | 123/145 [03:03<00:32,  1.47s/it][A
 86%|████████▌ | 124/145 [03:05<00:30,  1.46s/it][A
 86%|████████▌ | 125/145 [03:06<00:30,  1.52s/it][A
 87%|████████▋ | 126/145 [03:08<00:28,  1.50s/it][A
 88%|████████▊ | 127/145 [03:09<00:26,  1.49s/it][A
 88%|████████▊ | 128/145 [03:11<00:25,  1.52s/it][A
 89%|████████▉ | 129/145 [03:12<00:24,  1.51s/it][A
 90%|████████▉ | 130/145 [03:14<00:23,  1.54s/it][A
 90%|█████████ | 131/145 [03:15<00:20,  1.50s/it][A
 91%|█████████ | 132/145 [03:17<00:19,  1.52s/it][A
 92%|█████████▏| 133/145 [03:18<00:17,  1.49s/it][A
 92%|█████████▏| 134/145 [03:20<00:16,  1.52s/it][A
 93%|█████████▎| 135/145 [03:21<00:15,  1.53s/it][A
 94%|█████████▍| 136/145 [03:23<00:13,  1.52s/it][A
 94%|█████████▍| 137/145 [03:24<00:12,  1.51s/it][A
 95%|█████████▌| 138/145 [03:26<00:10,  1.52s/it][A
 96%|█████████▌| 139/145 [03:28<00:09,  1.52s/it][A
 97%|█████████▋| 140/145 [03:29<00:07,  1.52s/it][A
 97%|█████████▋| 141/145 [03:31<00:06,  1.53s/it][A
 98%|█████████▊| 142/145 [03:32<00:04,  1.51s/it][A
 99%|█████████▊| 143/145 [03:34<00:03,  1.51s/it][A
 99%|█████████▉| 144/145 [03:35<00:01,  1.51s/it][A
100%|██████████| 145/145 [03:36<00:00,  1.48s/it][A
                                                 [A                                                        {'eval_loss': 1.5233370065689087, 'eval_runtime': 218.6674, 'eval_samples_per_second': 5.291, 'eval_steps_per_second': 0.663, 'epoch': 8.91, 'num_input_tokens_seen': 32875040}

100%|██████████| 145/145 [03:36<00:00,  1.48s/it][A 89%|████████▉ | 2900/3250 [10:54:57<1:06:53, 11.47s/it]
                                                 [A[INFO|trainer.py:3705] 2024-10-11 15:47:01,074 >> Saving model checkpoint to /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2900
[INFO|configuration_utils.py:672] 2024-10-11 15:47:01,694 >> loading configuration file config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/config.json
[WARNING|modeling_rope_utils.py:379] 2024-10-11 15:47:01,695 >> Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
[INFO|configuration_utils.py:739] 2024-10-11 15:47:01,697 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 3584,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 18944,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 28,
  "num_hidden_layers": 28,
  "num_key_value_heads": 4,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.0",
  "use_cache": true,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "in_chans": 3,
    "model_type": "qwen2_vl",
    "spatial_patch_size": 14
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 152064
}

[INFO|tokenization_utils_base.py:2649] 2024-10-11 15:47:01,772 >> tokenizer config file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2900/tokenizer_config.json
[INFO|tokenization_utils_base.py:2658] 2024-10-11 15:47:01,773 >> Special tokens file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2900/special_tokens_map.json
[INFO|image_processing_base.py:258] 2024-10-11 15:47:02,268 >> Image processor saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-2900/preprocessor_config.json
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 89%|████████▉ | 2901/3250 [10:55:10<7:30:08, 77.39s/it] 89%|████████▉ | 2902/3250 [10:55:22<5:34:17, 57.64s/it] 89%|████████▉ | 2903/3250 [10:55:33<4:13:16, 43.79s/it] 89%|████████▉ | 2904/3250 [10:55:44<3:16:21, 34.05s/it] 89%|████████▉ | 2905/3250 [10:55:56<2:36:39, 27.25s/it]                                                        {'loss': 1.5901, 'grad_norm': 0.2531246244907379, 'learning_rate': 0.0005, 'epoch': 8.92, 'num_input_tokens_seen': 32932640}
 89%|████████▉ | 2905/3250 [10:55:56<2:36:39, 27.25s/it] 89%|████████▉ | 2906/3250 [10:56:07<2:09:05, 22.52s/it] 89%|████████▉ | 2907/3250 [10:56:19<1:50:03, 19.25s/it] 89%|████████▉ | 2908/3250 [10:56:30<1:36:29, 16.93s/it] 90%|████████▉ | 2909/3250 [10:56:42<1:26:57, 15.30s/it] 90%|████████▉ | 2910/3250 [10:56:53<1:20:13, 14.16s/it]                                                        {'loss': 1.5564, 'grad_norm': 0.21008718013763428, 'learning_rate': 0.0005, 'epoch': 8.94, 'num_input_tokens_seen': 32990080}
 90%|████████▉ | 2910/3250 [10:56:53<1:20:13, 14.16s/it] 90%|████████▉ | 2911/3250 [10:57:05<1:15:27, 13.36s/it] 90%|████████▉ | 2912/3250 [10:57:16<1:11:40, 12.72s/it] 90%|████████▉ | 2913/3250 [10:57:28<1:09:44, 12.42s/it] 90%|████████▉ | 2914/3250 [10:57:39<1:06:55, 11.95s/it] 90%|████████▉ | 2915/3250 [10:57:49<1:04:32, 11.56s/it]                                                        {'loss': 1.6294, 'grad_norm': 0.2397739738225937, 'learning_rate': 0.0005, 'epoch': 8.96, 'num_input_tokens_seen': 33046336}
 90%|████████▉ | 2915/3250 [10:57:49<1:04:32, 11.56s/it] 90%|████████▉ | 2916/3250 [10:58:00<1:03:34, 11.42s/it] 90%|████████▉ | 2917/3250 [10:58:11<1:02:40, 11.29s/it] 90%|████████▉ | 2918/3250 [10:58:22<1:01:16, 11.08s/it] 90%|████████▉ | 2919/3250 [10:58:33<1:00:43, 11.01s/it] 90%|████████▉ | 2920/3250 [10:58:44<1:00:40, 11.03s/it]                                                        {'loss': 1.5701, 'grad_norm': 0.2607327699661255, 'learning_rate': 0.0005, 'epoch': 8.97, 'num_input_tokens_seen': 33104128}
 90%|████████▉ | 2920/3250 [10:58:44<1:00:40, 11.03s/it] 90%|████████▉ | 2921/3250 [10:58:55<1:00:18, 11.00s/it] 90%|████████▉ | 2922/3250 [10:59:06<1:00:12, 11.01s/it] 90%|████████▉ | 2923/3250 [10:59:17<59:58, 11.01s/it]   90%|████████▉ | 2924/3250 [10:59:28<59:56, 11.03s/it] 90%|█████████ | 2925/3250 [10:59:39<59:45, 11.03s/it]                                                      {'loss': 1.5281, 'grad_norm': 0.2805980145931244, 'learning_rate': 0.0005, 'epoch': 8.99, 'num_input_tokens_seen': 33161216}
 90%|█████████ | 2925/3250 [10:59:39<59:45, 11.03s/it] 90%|█████████ | 2926/3250 [10:59:50<59:44, 11.06s/it] 90%|█████████ | 2927/3250 [11:00:01<59:55, 11.13s/it] 90%|█████████ | 2928/3250 [11:00:12<59:26, 11.08s/it] 90%|█████████ | 2929/3250 [11:00:23<58:54, 11.01s/it] 90%|█████████ | 2930/3250 [11:00:34<58:48, 11.03s/it]                                                      {'loss': 1.5683, 'grad_norm': 0.3718205988407135, 'learning_rate': 0.0005, 'epoch': 9.0, 'num_input_tokens_seen': 33217088}
 90%|█████████ | 2930/3250 [11:00:34<58:48, 11.03s/it] 90%|█████████ | 2931/3250 [11:00:45<58:27, 11.00s/it] 90%|█████████ | 2932/3250 [11:00:56<58:20, 11.01s/it] 90%|█████████ | 2933/3250 [11:01:07<57:38, 10.91s/it] 90%|█████████ | 2934/3250 [11:01:18<57:33, 10.93s/it] 90%|█████████ | 2935/3250 [11:01:29<57:40, 10.99s/it]                                                      {'loss': 1.5296, 'grad_norm': 0.2095063030719757, 'learning_rate': 0.0005, 'epoch': 9.02, 'num_input_tokens_seen': 33273472}
 90%|█████████ | 2935/3250 [11:01:29<57:40, 10.99s/it] 90%|█████████ | 2936/3250 [11:01:40<57:05, 10.91s/it] 90%|█████████ | 2937/3250 [11:01:51<56:54, 10.91s/it] 90%|█████████ | 2938/3250 [11:02:01<56:07, 10.79s/it] 90%|█████████ | 2939/3250 [11:02:12<56:25, 10.88s/it] 90%|█████████ | 2940/3250 [11:02:23<56:22, 10.91s/it]                                                      {'loss': 1.5897, 'grad_norm': 0.2459029257297516, 'learning_rate': 0.0005, 'epoch': 9.03, 'num_input_tokens_seen': 33329920}
 90%|█████████ | 2940/3250 [11:02:23<56:22, 10.91s/it] 90%|█████████ | 2941/3250 [11:02:34<56:29, 10.97s/it] 91%|█████████ | 2942/3250 [11:02:45<56:12, 10.95s/it] 91%|█████████ | 2943/3250 [11:02:56<55:55, 10.93s/it] 91%|█████████ | 2944/3250 [11:03:07<56:11, 11.02s/it] 91%|█████████ | 2945/3250 [11:03:18<56:06, 11.04s/it]                                                      {'loss': 1.498, 'grad_norm': 0.41624391078948975, 'learning_rate': 0.0005, 'epoch': 9.05, 'num_input_tokens_seen': 33387424}
 91%|█████████ | 2945/3250 [11:03:18<56:06, 11.04s/it] 91%|█████████ | 2946/3250 [11:03:30<56:09, 11.08s/it] 91%|█████████ | 2947/3250 [11:03:41<56:08, 11.12s/it] 91%|█████████ | 2948/3250 [11:03:51<55:14, 10.97s/it] 91%|█████████ | 2949/3250 [11:04:03<55:15, 11.02s/it] 91%|█████████ | 2950/3250 [11:04:14<55:07, 11.02s/it]                                                      {'loss': 1.5161, 'grad_norm': 0.162567600607872, 'learning_rate': 0.0005, 'epoch': 9.06, 'num_input_tokens_seen': 33444480}
 91%|█████████ | 2950/3250 [11:04:14<55:07, 11.02s/it] 91%|█████████ | 2951/3250 [11:04:25<55:19, 11.10s/it] 91%|█████████ | 2952/3250 [11:04:36<55:17, 11.13s/it] 91%|█████████ | 2953/3250 [11:04:47<54:09, 10.94s/it] 91%|█████████ | 2954/3250 [11:04:57<53:47, 10.90s/it] 91%|█████████ | 2955/3250 [11:05:08<53:43, 10.93s/it]                                                      {'loss': 1.5981, 'grad_norm': 0.2968595623970032, 'learning_rate': 0.0005, 'epoch': 9.08, 'num_input_tokens_seen': 33499808}
 91%|█████████ | 2955/3250 [11:05:08<53:43, 10.93s/it] 91%|█████████ | 2956/3250 [11:05:19<53:37, 10.94s/it] 91%|█████████ | 2957/3250 [11:05:30<53:29, 10.96s/it] 91%|█████████ | 2958/3250 [11:05:41<53:24, 10.97s/it] 91%|█████████ | 2959/3250 [11:05:52<52:50, 10.89s/it] 91%|█████████ | 2960/3250 [11:06:03<52:48, 10.93s/it]                                                      {'loss': 1.5713, 'grad_norm': 0.2842510938644409, 'learning_rate': 0.0005, 'epoch': 9.09, 'num_input_tokens_seen': 33557088}
 91%|█████████ | 2960/3250 [11:06:03<52:48, 10.93s/it] 91%|█████████ | 2961/3250 [11:06:14<52:45, 10.95s/it] 91%|█████████ | 2962/3250 [11:06:25<52:50, 11.01s/it] 91%|█████████ | 2963/3250 [11:06:36<52:15, 10.93s/it] 91%|█████████ | 2964/3250 [11:06:47<52:26, 11.00s/it] 91%|█████████ | 2965/3250 [11:06:58<52:19, 11.02s/it]                                                      {'loss': 1.5832, 'grad_norm': 0.24092154204845428, 'learning_rate': 0.0005, 'epoch': 9.11, 'num_input_tokens_seen': 33613632}
 91%|█████████ | 2965/3250 [11:06:58<52:19, 11.02s/it] 91%|█████████▏| 2966/3250 [11:07:09<52:15, 11.04s/it] 91%|█████████▏| 2967/3250 [11:07:20<51:49, 10.99s/it] 91%|█████████▏| 2968/3250 [11:07:31<51:29, 10.96s/it] 91%|█████████▏| 2969/3250 [11:07:42<51:21, 10.96s/it] 91%|█████████▏| 2970/3250 [11:07:53<50:54, 10.91s/it]                                                      {'loss': 1.5247, 'grad_norm': 0.21234185993671417, 'learning_rate': 0.0005, 'epoch': 9.12, 'num_input_tokens_seen': 33671136}
 91%|█████████▏| 2970/3250 [11:07:53<50:54, 10.91s/it] 91%|█████████▏| 2971/3250 [11:08:04<50:33, 10.87s/it] 91%|█████████▏| 2972/3250 [11:08:14<50:08, 10.82s/it] 91%|█████████▏| 2973/3250 [11:08:25<50:04, 10.85s/it] 92%|█████████▏| 2974/3250 [11:08:36<49:35, 10.78s/it] 92%|█████████▏| 2975/3250 [11:08:46<49:13, 10.74s/it]                                                      {'loss': 1.505, 'grad_norm': 0.5078202486038208, 'learning_rate': 0.0005, 'epoch': 9.14, 'num_input_tokens_seen': 33726464}
 92%|█████████▏| 2975/3250 [11:08:46<49:13, 10.74s/it] 92%|█████████▏| 2976/3250 [11:08:57<49:21, 10.81s/it] 92%|█████████▏| 2977/3250 [11:09:08<49:18, 10.84s/it] 92%|█████████▏| 2978/3250 [11:09:19<48:58, 10.80s/it] 92%|█████████▏| 2979/3250 [11:09:30<48:46, 10.80s/it] 92%|█████████▏| 2980/3250 [11:09:40<48:09, 10.70s/it]                                                      {'loss': 1.5789, 'grad_norm': 0.27898046374320984, 'learning_rate': 0.0005, 'epoch': 9.16, 'num_input_tokens_seen': 33781920}
 92%|█████████▏| 2980/3250 [11:09:40<48:09, 10.70s/it] 92%|█████████▏| 2981/3250 [11:09:51<48:07, 10.74s/it] 92%|█████████▏| 2982/3250 [11:10:02<48:39, 10.90s/it] 92%|█████████▏| 2983/3250 [11:10:13<48:34, 10.91s/it] 92%|█████████▏| 2984/3250 [11:10:24<48:15, 10.89s/it] 92%|█████████▏| 2985/3250 [11:10:35<48:15, 10.93s/it]                                                      {'loss': 1.5546, 'grad_norm': 0.2037781924009323, 'learning_rate': 0.0005, 'epoch': 9.17, 'num_input_tokens_seen': 33838752}
 92%|█████████▏| 2985/3250 [11:10:35<48:15, 10.93s/it] 92%|█████████▏| 2986/3250 [11:10:46<47:41, 10.84s/it] 92%|█████████▏| 2987/3250 [11:10:57<47:25, 10.82s/it] 92%|█████████▏| 2988/3250 [11:11:08<47:27, 10.87s/it] 92%|█████████▏| 2989/3250 [11:11:19<47:22, 10.89s/it] 92%|█████████▏| 2990/3250 [11:11:30<47:27, 10.95s/it]                                                      {'loss': 1.5751, 'grad_norm': 0.3256015181541443, 'learning_rate': 0.0005, 'epoch': 9.19, 'num_input_tokens_seen': 33895072}
 92%|█████████▏| 2990/3250 [11:11:30<47:27, 10.95s/it] 92%|█████████▏| 2991/3250 [11:11:41<47:22, 10.98s/it] 92%|█████████▏| 2992/3250 [11:11:52<47:22, 11.02s/it] 92%|█████████▏| 2993/3250 [11:12:02<46:48, 10.93s/it] 92%|█████████▏| 2994/3250 [11:12:14<46:47, 10.97s/it] 92%|█████████▏| 2995/3250 [11:12:24<46:11, 10.87s/it]                                                      {'loss': 1.5325, 'grad_norm': 0.30454209446907043, 'learning_rate': 0.0005, 'epoch': 9.2, 'num_input_tokens_seen': 33951168}
 92%|█████████▏| 2995/3250 [11:12:24<46:11, 10.87s/it] 92%|█████████▏| 2996/3250 [11:12:35<46:02, 10.88s/it] 92%|█████████▏| 2997/3250 [11:12:46<46:01, 10.92s/it] 92%|█████████▏| 2998/3250 [11:12:57<46:01, 10.96s/it] 92%|█████████▏| 2999/3250 [11:13:08<46:09, 11.04s/it] 92%|█████████▏| 3000/3250 [11:13:19<45:53, 11.01s/it]                                                      {'loss': 1.6113, 'grad_norm': 0.18333116173744202, 'learning_rate': 0.0005, 'epoch': 9.22, 'num_input_tokens_seen': 34008640}
 92%|█████████▏| 3000/3250 [11:13:19<45:53, 11.01s/it][INFO|trainer.py:4021] 2024-10-11 16:05:22,950 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-10-11 16:05:22,950 >>   Num examples = 1157
[INFO|trainer.py:4026] 2024-10-11 16:05:22,950 >>   Batch size = 4

  0%|          | 0/145 [00:00<?, ?it/s][A
  1%|▏         | 2/145 [00:01<01:38,  1.45it/s][A
  2%|▏         | 3/145 [00:02<02:22,  1.01s/it][A
  3%|▎         | 4/145 [00:04<02:41,  1.14s/it][A
  3%|▎         | 5/145 [00:05<02:45,  1.18s/it][A
  4%|▍         | 6/145 [00:06<02:55,  1.26s/it][A
  5%|▍         | 7/145 [00:08<03:01,  1.31s/it][A
  6%|▌         | 8/145 [00:09<02:58,  1.30s/it][A
  6%|▌         | 9/145 [00:10<02:58,  1.31s/it][A
  7%|▋         | 10/145 [00:12<02:59,  1.33s/it][A
  8%|▊         | 11/145 [00:13<03:00,  1.35s/it][A
  8%|▊         | 12/145 [00:15<03:03,  1.38s/it][A
  9%|▉         | 13/145 [00:16<03:04,  1.40s/it][A
 10%|▉         | 14/145 [00:18<03:05,  1.42s/it][A
 10%|█         | 15/145 [00:19<03:02,  1.40s/it][A
 11%|█         | 16/145 [00:20<02:59,  1.39s/it][A
 12%|█▏        | 17/145 [00:22<02:59,  1.41s/it][A
 12%|█▏        | 18/145 [00:23<02:58,  1.41s/it][A
 13%|█▎        | 19/145 [00:25<02:57,  1.41s/it][A
 14%|█▍        | 20/145 [00:26<02:55,  1.41s/it][A
 14%|█▍        | 21/145 [00:27<02:51,  1.38s/it][A
 15%|█▌        | 22/145 [00:29<02:48,  1.37s/it][A
 16%|█▌        | 23/145 [00:30<02:46,  1.37s/it][A
 17%|█▋        | 24/145 [00:31<02:46,  1.38s/it][A
 17%|█▋        | 25/145 [00:33<02:45,  1.38s/it][A
 18%|█▊        | 26/145 [00:34<02:43,  1.37s/it][A
 19%|█▊        | 27/145 [00:35<02:43,  1.39s/it][A
 19%|█▉        | 28/145 [00:37<02:40,  1.38s/it][A
 20%|██        | 29/145 [00:38<02:39,  1.37s/it][A
 21%|██        | 30/145 [00:39<02:34,  1.34s/it][A
 21%|██▏       | 31/145 [00:41<02:35,  1.36s/it][A
 22%|██▏       | 32/145 [00:42<02:34,  1.37s/it][A
 23%|██▎       | 33/145 [00:44<02:34,  1.38s/it][A
 23%|██▎       | 34/145 [00:45<02:33,  1.38s/it][A
 24%|██▍       | 35/145 [00:46<02:33,  1.39s/it][A
 25%|██▍       | 36/145 [00:48<02:30,  1.38s/it][A
 26%|██▌       | 37/145 [00:49<02:33,  1.42s/it][A
 26%|██▌       | 38/145 [00:51<02:31,  1.42s/it][A
 27%|██▋       | 39/145 [00:52<02:28,  1.40s/it][A
 28%|██▊       | 40/145 [00:54<02:26,  1.40s/it][A
 28%|██▊       | 41/145 [00:55<02:27,  1.42s/it][A
 29%|██▉       | 42/145 [00:56<02:25,  1.42s/it][A
 30%|██▉       | 43/145 [00:58<02:22,  1.39s/it][A
 30%|███       | 44/145 [00:59<02:23,  1.42s/it][A
 31%|███       | 45/145 [01:01<02:24,  1.44s/it][A
 32%|███▏      | 46/145 [01:02<02:20,  1.42s/it][A
 32%|███▏      | 47/145 [01:03<02:16,  1.39s/it][A
 33%|███▎      | 48/145 [01:05<02:15,  1.40s/it][A
 34%|███▍      | 49/145 [01:06<02:15,  1.41s/it][A
 34%|███▍      | 50/145 [01:08<02:15,  1.42s/it][A
 35%|███▌      | 51/145 [01:09<02:13,  1.42s/it][A
 36%|███▌      | 52/145 [01:11<02:11,  1.41s/it][A
 37%|███▋      | 53/145 [01:12<02:09,  1.41s/it][A
 37%|███▋      | 54/145 [01:13<02:09,  1.42s/it][A
 38%|███▊      | 55/145 [01:15<02:06,  1.41s/it][A
 39%|███▊      | 56/145 [01:16<02:05,  1.41s/it][A
 39%|███▉      | 57/145 [01:18<02:02,  1.39s/it][A
 40%|████      | 58/145 [01:19<02:00,  1.38s/it][A
 41%|████      | 59/145 [01:20<02:01,  1.41s/it][A
 41%|████▏     | 60/145 [01:22<01:59,  1.40s/it][A
 42%|████▏     | 61/145 [01:23<01:57,  1.40s/it][A
 43%|████▎     | 62/145 [01:24<01:54,  1.38s/it][A
 43%|████▎     | 63/145 [01:26<01:54,  1.40s/it][A
 44%|████▍     | 64/145 [01:27<01:53,  1.40s/it][A
 45%|████▍     | 65/145 [01:29<01:52,  1.41s/it][A
 46%|████▌     | 66/145 [01:30<01:51,  1.41s/it][A
 46%|████▌     | 67/145 [01:31<01:48,  1.39s/it][A
 47%|████▋     | 68/145 [01:33<01:49,  1.42s/it][A
 48%|████▊     | 69/145 [01:34<01:48,  1.43s/it][A
 48%|████▊     | 70/145 [01:36<01:42,  1.37s/it][A
 49%|████▉     | 71/145 [01:37<01:40,  1.36s/it][A
 50%|████▉     | 72/145 [01:38<01:40,  1.38s/it][A
 50%|█████     | 73/145 [01:40<01:41,  1.41s/it][A
 51%|█████     | 74/145 [01:41<01:40,  1.41s/it][A
 52%|█████▏    | 75/145 [01:43<01:39,  1.42s/it][A
 52%|█████▏    | 76/145 [01:44<01:37,  1.41s/it][A
 53%|█████▎    | 77/145 [01:45<01:33,  1.38s/it][A
 54%|█████▍    | 78/145 [01:47<01:32,  1.38s/it][A
 54%|█████▍    | 79/145 [01:48<01:29,  1.36s/it][A
 55%|█████▌    | 80/145 [01:49<01:28,  1.36s/it][A
 56%|█████▌    | 81/145 [01:51<01:25,  1.34s/it][A
 57%|█████▋    | 82/145 [01:52<01:25,  1.36s/it][A
 57%|█████▋    | 83/145 [01:54<01:25,  1.37s/it][A
 58%|█████▊    | 84/145 [01:55<01:24,  1.39s/it][A
 59%|█████▊    | 85/145 [01:56<01:21,  1.36s/it][A
 59%|█████▉    | 86/145 [01:58<01:21,  1.37s/it][A
 60%|██████    | 87/145 [01:59<01:21,  1.40s/it][A
 61%|██████    | 88/145 [02:00<01:18,  1.37s/it][A
 61%|██████▏   | 89/145 [02:02<01:17,  1.38s/it][A
 62%|██████▏   | 90/145 [02:03<01:16,  1.39s/it][A
 63%|██████▎   | 91/145 [02:05<01:15,  1.39s/it][A
 63%|██████▎   | 92/145 [02:06<01:13,  1.39s/it][A
 64%|██████▍   | 93/145 [02:07<01:11,  1.37s/it][A
 65%|██████▍   | 94/145 [02:09<01:09,  1.37s/it][A
 66%|██████▌   | 95/145 [02:10<01:08,  1.38s/it][A
 66%|██████▌   | 96/145 [02:12<01:08,  1.39s/it][A
 67%|██████▋   | 97/145 [02:13<01:07,  1.40s/it][A
 68%|██████▊   | 98/145 [02:15<01:07,  1.43s/it][A
 68%|██████▊   | 99/145 [02:16<01:04,  1.40s/it][A
 69%|██████▉   | 100/145 [02:17<01:03,  1.40s/it][A
 70%|██████▉   | 101/145 [02:19<01:02,  1.42s/it][A
 70%|███████   | 102/145 [02:20<01:00,  1.41s/it][A
 71%|███████   | 103/145 [02:21<00:58,  1.40s/it][A
 72%|███████▏  | 104/145 [02:23<00:57,  1.40s/it][A
 72%|███████▏  | 105/145 [02:24<00:56,  1.40s/it][A
 73%|███████▎  | 106/145 [02:26<00:54,  1.40s/it][A
 74%|███████▍  | 107/145 [02:27<00:51,  1.35s/it][A
 74%|███████▍  | 108/145 [02:28<00:49,  1.33s/it][A
 75%|███████▌  | 109/145 [02:30<00:48,  1.35s/it][A
 76%|███████▌  | 110/145 [02:31<00:48,  1.38s/it][A
 77%|███████▋  | 111/145 [02:32<00:45,  1.34s/it][A
 77%|███████▋  | 112/145 [02:34<00:45,  1.38s/it][A
 78%|███████▊  | 113/145 [02:35<00:44,  1.39s/it][A
 79%|███████▊  | 114/145 [02:37<00:43,  1.41s/it][A
 79%|███████▉  | 115/145 [02:38<00:42,  1.41s/it][A
 80%|████████  | 116/145 [02:39<00:39,  1.37s/it][A
 81%|████████  | 117/145 [02:41<00:38,  1.37s/it][A
 81%|████████▏ | 118/145 [02:42<00:36,  1.37s/it][A
 82%|████████▏ | 119/145 [02:43<00:34,  1.33s/it][A
 83%|████████▎ | 120/145 [02:45<00:32,  1.31s/it][A
 83%|████████▎ | 121/145 [02:46<00:31,  1.31s/it][A
 84%|████████▍ | 122/145 [02:47<00:30,  1.32s/it][A
 85%|████████▍ | 123/145 [02:49<00:29,  1.34s/it][A
 86%|████████▌ | 124/145 [02:50<00:27,  1.33s/it][A
 86%|████████▌ | 125/145 [02:51<00:27,  1.40s/it][A
 87%|████████▋ | 126/145 [02:53<00:26,  1.38s/it][A
 88%|████████▊ | 127/145 [02:54<00:24,  1.37s/it][A
 88%|████████▊ | 128/145 [02:56<00:23,  1.40s/it][A
 89%|████████▉ | 129/145 [02:57<00:22,  1.39s/it][A
 90%|████████▉ | 130/145 [02:59<00:21,  1.42s/it][A
 90%|█████████ | 131/145 [03:00<00:19,  1.37s/it][A
 91%|█████████ | 132/145 [03:01<00:18,  1.39s/it][A
 92%|█████████▏| 133/145 [03:03<00:16,  1.37s/it][A
 92%|█████████▏| 134/145 [03:04<00:15,  1.40s/it][A
 93%|█████████▎| 135/145 [03:05<00:14,  1.41s/it][A
 94%|█████████▍| 136/145 [03:07<00:12,  1.39s/it][A
 94%|█████████▍| 137/145 [03:08<00:11,  1.39s/it][A
 95%|█████████▌| 138/145 [03:10<00:09,  1.40s/it][A
 96%|█████████▌| 139/145 [03:11<00:08,  1.40s/it][A
 97%|█████████▋| 140/145 [03:12<00:07,  1.40s/it][A
 97%|█████████▋| 141/145 [03:14<00:05,  1.40s/it][A
 98%|█████████▊| 142/145 [03:15<00:04,  1.39s/it][A
 99%|█████████▊| 143/145 [03:17<00:02,  1.38s/it][A
 99%|█████████▉| 144/145 [03:18<00:01,  1.40s/it][A
100%|██████████| 145/145 [03:19<00:00,  1.37s/it][A
                                                 [A                                                      {'eval_loss': 1.515351414680481, 'eval_runtime': 201.2949, 'eval_samples_per_second': 5.748, 'eval_steps_per_second': 0.72, 'epoch': 9.22, 'num_input_tokens_seen': 34008640}

100%|██████████| 145/145 [03:19<00:00,  1.37s/it][A 92%|█████████▏| 3000/3250 [11:16:41<45:53, 11.01s/it]
                                                 [A[INFO|trainer.py:3705] 2024-10-11 16:08:44,247 >> Saving model checkpoint to /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-3000
[INFO|configuration_utils.py:672] 2024-10-11 16:08:45,745 >> loading configuration file config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/config.json
[WARNING|modeling_rope_utils.py:379] 2024-10-11 16:08:45,745 >> Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
[INFO|configuration_utils.py:739] 2024-10-11 16:08:45,747 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 3584,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 18944,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 28,
  "num_hidden_layers": 28,
  "num_key_value_heads": 4,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.0",
  "use_cache": true,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "in_chans": 3,
    "model_type": "qwen2_vl",
    "spatial_patch_size": 14
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 152064
}

[INFO|tokenization_utils_base.py:2649] 2024-10-11 16:08:45,814 >> tokenizer config file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-3000/tokenizer_config.json
[INFO|tokenization_utils_base.py:2658] 2024-10-11 16:08:45,814 >> Special tokens file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-3000/special_tokens_map.json
[INFO|image_processing_base.py:258] 2024-10-11 16:08:46,222 >> Image processor saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-3000/preprocessor_config.json
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 92%|█████████▏| 3001/3250 [11:16:54<4:58:49, 72.00s/it] 92%|█████████▏| 3002/3250 [11:17:05<3:41:51, 53.68s/it] 92%|█████████▏| 3003/3250 [11:17:16<2:48:27, 40.92s/it] 92%|█████████▏| 3004/3250 [11:17:27<2:11:07, 31.98s/it] 92%|█████████▏| 3005/3250 [11:17:38<1:45:01, 25.72s/it]                                                        {'loss': 1.5014, 'grad_norm': 0.24617944657802582, 'learning_rate': 0.0005, 'epoch': 9.23, 'num_input_tokens_seen': 34065408}
 92%|█████████▏| 3005/3250 [11:17:38<1:45:01, 25.72s/it] 92%|█████████▏| 3006/3250 [11:17:49<1:26:35, 21.29s/it] 93%|█████████▎| 3007/3250 [11:18:00<1:13:36, 18.18s/it] 93%|█████████▎| 3008/3250 [11:18:11<1:04:33, 16.01s/it] 93%|█████████▎| 3009/3250 [11:18:22<58:19, 14.52s/it]   93%|█████████▎| 3010/3250 [11:18:33<53:38, 13.41s/it]                                                      {'loss': 1.5604, 'grad_norm': 0.31552833318710327, 'learning_rate': 0.0005, 'epoch': 9.25, 'num_input_tokens_seen': 34120896}
 93%|█████████▎| 3010/3250 [11:18:33<53:38, 13.41s/it] 93%|█████████▎| 3011/3250 [11:18:44<50:37, 12.71s/it] 93%|█████████▎| 3012/3250 [11:18:54<48:04, 12.12s/it] 93%|█████████▎| 3013/3250 [11:19:06<46:44, 11.83s/it] 93%|█████████▎| 3014/3250 [11:19:17<45:27, 11.56s/it] 93%|█████████▎| 3015/3250 [11:19:27<44:27, 11.35s/it]                                                      {'loss': 1.5465, 'grad_norm': 0.3120487928390503, 'learning_rate': 0.0005, 'epoch': 9.26, 'num_input_tokens_seen': 34178048}
 93%|█████████▎| 3015/3250 [11:19:27<44:27, 11.35s/it] 93%|█████████▎| 3016/3250 [11:19:39<44:02, 11.29s/it] 93%|█████████▎| 3017/3250 [11:19:50<43:40, 11.25s/it] 93%|█████████▎| 3018/3250 [11:20:01<43:04, 11.14s/it] 93%|█████████▎| 3019/3250 [11:20:11<42:28, 11.03s/it] 93%|█████████▎| 3020/3250 [11:20:22<42:16, 11.03s/it]                                                      {'loss': 1.5608, 'grad_norm': 0.18903334438800812, 'learning_rate': 0.0005, 'epoch': 9.28, 'num_input_tokens_seen': 34234592}
 93%|█████████▎| 3020/3250 [11:20:22<42:16, 11.03s/it] 93%|█████████▎| 3021/3250 [11:20:34<42:12, 11.06s/it] 93%|█████████▎| 3022/3250 [11:20:44<41:27, 10.91s/it] 93%|█████████▎| 3023/3250 [11:20:55<41:28, 10.96s/it] 93%|█████████▎| 3024/3250 [11:21:06<41:08, 10.92s/it] 93%|█████████▎| 3025/3250 [11:21:17<40:34, 10.82s/it]                                                      {'loss': 1.5294, 'grad_norm': 0.23518997430801392, 'learning_rate': 0.0005, 'epoch': 9.29, 'num_input_tokens_seen': 34290368}
 93%|█████████▎| 3025/3250 [11:21:17<40:34, 10.82s/it] 93%|█████████▎| 3026/3250 [11:21:28<40:34, 10.87s/it] 93%|█████████▎| 3027/3250 [11:21:38<40:13, 10.83s/it] 93%|█████████▎| 3028/3250 [11:21:49<40:20, 10.90s/it] 93%|█████████▎| 3029/3250 [11:22:00<40:17, 10.94s/it] 93%|█████████▎| 3030/3250 [11:22:11<39:41, 10.83s/it]                                                      {'loss': 1.4937, 'grad_norm': 0.24577400088310242, 'learning_rate': 0.0005, 'epoch': 9.31, 'num_input_tokens_seen': 34346432}
 93%|█████████▎| 3030/3250 [11:22:11<39:41, 10.83s/it] 93%|█████████▎| 3031/3250 [11:22:22<39:27, 10.81s/it] 93%|█████████▎| 3032/3250 [11:22:32<38:57, 10.72s/it] 93%|█████████▎| 3033/3250 [11:22:43<38:58, 10.78s/it] 93%|█████████▎| 3034/3250 [11:22:54<38:49, 10.79s/it] 93%|█████████▎| 3035/3250 [11:23:05<38:58, 10.88s/it]                                                      {'loss': 1.5248, 'grad_norm': 0.276621550321579, 'learning_rate': 0.0005, 'epoch': 9.32, 'num_input_tokens_seen': 34402048}
 93%|█████████▎| 3035/3250 [11:23:05<38:58, 10.88s/it] 93%|█████████▎| 3036/3250 [11:23:16<38:44, 10.86s/it] 93%|█████████▎| 3037/3250 [11:23:27<38:36, 10.88s/it] 93%|█████████▎| 3038/3250 [11:23:38<38:45, 10.97s/it] 94%|█████████▎| 3039/3250 [11:23:49<38:48, 11.04s/it] 94%|█████████▎| 3040/3250 [11:24:00<38:09, 10.90s/it]                                                      {'loss': 1.5914, 'grad_norm': 0.23380593955516815, 'learning_rate': 0.0005, 'epoch': 9.34, 'num_input_tokens_seen': 34458496}
 94%|█████████▎| 3040/3250 [11:24:00<38:09, 10.90s/it] 94%|█████████▎| 3041/3250 [11:24:11<37:55, 10.89s/it] 94%|█████████▎| 3042/3250 [11:24:22<37:54, 10.93s/it] 94%|█████████▎| 3043/3250 [11:24:32<37:19, 10.82s/it] 94%|█████████▎| 3044/3250 [11:24:43<37:08, 10.82s/it] 94%|█████████▎| 3045/3250 [11:24:54<37:12, 10.89s/it]                                                      {'loss': 1.5151, 'grad_norm': 0.2919384241104126, 'learning_rate': 0.0005, 'epoch': 9.35, 'num_input_tokens_seen': 34515168}
 94%|█████████▎| 3045/3250 [11:24:54<37:12, 10.89s/it] 94%|█████████▎| 3046/3250 [11:25:05<37:17, 10.97s/it] 94%|█████████▍| 3047/3250 [11:25:16<37:00, 10.94s/it] 94%|█████████▍| 3048/3250 [11:25:27<37:10, 11.04s/it] 94%|█████████▍| 3049/3250 [11:25:38<36:54, 11.01s/it] 94%|█████████▍| 3050/3250 [11:25:49<36:49, 11.05s/it]                                                      {'loss': 1.5299, 'grad_norm': 0.30951282382011414, 'learning_rate': 0.0005, 'epoch': 9.37, 'num_input_tokens_seen': 34572192}
 94%|█████████▍| 3050/3250 [11:25:49<36:49, 11.05s/it] 94%|█████████▍| 3051/3250 [11:26:01<36:41, 11.06s/it] 94%|█████████▍| 3052/3250 [11:26:11<36:02, 10.92s/it] 94%|█████████▍| 3053/3250 [11:26:22<35:57, 10.95s/it] 94%|█████████▍| 3054/3250 [11:26:33<35:56, 11.00s/it] 94%|█████████▍| 3055/3250 [11:26:44<35:44, 11.00s/it]                                                      {'loss': 1.5087, 'grad_norm': 0.2383147031068802, 'learning_rate': 0.0005, 'epoch': 9.39, 'num_input_tokens_seen': 34628672}
 94%|█████████▍| 3055/3250 [11:26:44<35:44, 11.00s/it] 94%|█████████▍| 3056/3250 [11:26:55<35:28, 10.97s/it] 94%|█████████▍| 3057/3250 [11:27:06<35:16, 10.96s/it] 94%|█████████▍| 3058/3250 [11:27:17<35:03, 10.96s/it] 94%|█████████▍| 3059/3250 [11:27:28<34:56, 10.98s/it] 94%|█████████▍| 3060/3250 [11:27:39<34:23, 10.86s/it]                                                      {'loss': 1.4886, 'grad_norm': 0.26749786734580994, 'learning_rate': 0.0005, 'epoch': 9.4, 'num_input_tokens_seen': 34684928}
 94%|█████████▍| 3060/3250 [11:27:39<34:23, 10.86s/it] 94%|█████████▍| 3061/3250 [11:27:50<34:20, 10.90s/it] 94%|█████████▍| 3062/3250 [11:28:01<34:14, 10.93s/it] 94%|█████████▍| 3063/3250 [11:28:12<34:13, 10.98s/it] 94%|█████████▍| 3064/3250 [11:28:23<34:04, 10.99s/it] 94%|█████████▍| 3065/3250 [11:28:34<33:49, 10.97s/it]                                                      {'loss': 1.5036, 'grad_norm': 0.38278356194496155, 'learning_rate': 0.0005, 'epoch': 9.42, 'num_input_tokens_seen': 34742464}
 94%|█████████▍| 3065/3250 [11:28:34<33:49, 10.97s/it] 94%|█████████▍| 3066/3250 [11:28:44<33:15, 10.85s/it] 94%|█████████▍| 3067/3250 [11:28:55<32:46, 10.75s/it] 94%|█████████▍| 3068/3250 [11:29:06<32:53, 10.84s/it] 94%|█████████▍| 3069/3250 [11:29:17<32:42, 10.84s/it] 94%|█████████▍| 3070/3250 [11:29:27<32:25, 10.81s/it]                                                      {'loss': 1.5754, 'grad_norm': 0.37410807609558105, 'learning_rate': 0.0005, 'epoch': 9.43, 'num_input_tokens_seen': 34797344}
 94%|█████████▍| 3070/3250 [11:29:27<32:25, 10.81s/it] 94%|█████████▍| 3071/3250 [11:29:39<32:29, 10.89s/it] 95%|█████████▍| 3072/3250 [11:29:50<32:33, 10.97s/it] 95%|█████████▍| 3073/3250 [11:30:01<32:21, 10.97s/it] 95%|█████████▍| 3074/3250 [11:30:12<32:13, 10.99s/it] 95%|█████████▍| 3075/3250 [11:30:23<31:59, 10.97s/it]                                                      {'loss': 1.5475, 'grad_norm': 0.20119518041610718, 'learning_rate': 0.0005, 'epoch': 9.45, 'num_input_tokens_seen': 34855712}
 95%|█████████▍| 3075/3250 [11:30:23<31:59, 10.97s/it] 95%|█████████▍| 3076/3250 [11:30:34<31:51, 10.98s/it] 95%|█████████▍| 3077/3250 [11:30:44<31:19, 10.87s/it] 95%|█████████▍| 3078/3250 [11:30:55<31:08, 10.86s/it] 95%|█████████▍| 3079/3250 [11:31:06<31:09, 10.94s/it] 95%|█████████▍| 3080/3250 [11:31:17<31:02, 10.96s/it]                                                      {'loss': 1.5655, 'grad_norm': 0.268230676651001, 'learning_rate': 0.0005, 'epoch': 9.46, 'num_input_tokens_seen': 34912928}
 95%|█████████▍| 3080/3250 [11:31:17<31:02, 10.96s/it] 95%|█████████▍| 3081/3250 [11:31:28<30:57, 10.99s/it] 95%|█████████▍| 3082/3250 [11:31:39<30:40, 10.95s/it] 95%|█████████▍| 3083/3250 [11:31:50<30:40, 11.02s/it] 95%|█████████▍| 3084/3250 [11:32:01<30:22, 10.98s/it] 95%|█████████▍| 3085/3250 [11:32:12<29:58, 10.90s/it]                                                      {'loss': 1.4954, 'grad_norm': 0.2167942076921463, 'learning_rate': 0.0005, 'epoch': 9.48, 'num_input_tokens_seen': 34969824}
 95%|█████████▍| 3085/3250 [11:32:12<29:58, 10.90s/it] 95%|█████████▍| 3086/3250 [11:32:23<29:47, 10.90s/it] 95%|█████████▍| 3087/3250 [11:32:34<29:46, 10.96s/it] 95%|█████████▌| 3088/3250 [11:32:45<29:36, 10.96s/it] 95%|█████████▌| 3089/3250 [11:32:56<29:25, 10.97s/it] 95%|█████████▌| 3090/3250 [11:33:07<29:07, 10.92s/it]                                                      {'loss': 1.5112, 'grad_norm': 0.23248109221458435, 'learning_rate': 0.0005, 'epoch': 9.49, 'num_input_tokens_seen': 35026592}
 95%|█████████▌| 3090/3250 [11:33:07<29:07, 10.92s/it] 95%|█████████▌| 3091/3250 [11:33:18<28:58, 10.94s/it] 95%|█████████▌| 3092/3250 [11:33:29<28:54, 10.98s/it] 95%|█████████▌| 3093/3250 [11:33:40<28:51, 11.03s/it] 95%|█████████▌| 3094/3250 [11:33:51<28:40, 11.03s/it] 95%|█████████▌| 3095/3250 [11:34:02<28:26, 11.01s/it]                                                      {'loss': 1.5122, 'grad_norm': 0.3561837375164032, 'learning_rate': 0.0005, 'epoch': 9.51, 'num_input_tokens_seen': 35083200}
 95%|█████████▌| 3095/3250 [11:34:02<28:26, 11.01s/it] 95%|█████████▌| 3096/3250 [11:34:13<28:09, 10.97s/it] 95%|█████████▌| 3097/3250 [11:34:24<27:57, 10.96s/it] 95%|█████████▌| 3098/3250 [11:34:35<27:49, 10.98s/it] 95%|█████████▌| 3099/3250 [11:34:46<27:38, 10.99s/it] 95%|█████████▌| 3100/3250 [11:34:57<27:32, 11.02s/it]                                                      {'loss': 1.5027, 'grad_norm': 0.25296905636787415, 'learning_rate': 0.0005, 'epoch': 9.52, 'num_input_tokens_seen': 35139968}
 95%|█████████▌| 3100/3250 [11:34:57<27:32, 11.02s/it][INFO|trainer.py:4021] 2024-10-11 16:27:00,381 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-10-11 16:27:00,381 >>   Num examples = 1157
[INFO|trainer.py:4026] 2024-10-11 16:27:00,381 >>   Batch size = 4

  0%|          | 0/145 [00:00<?, ?it/s][A
  1%|▏         | 2/145 [00:01<01:38,  1.45it/s][A
  2%|▏         | 3/145 [00:02<02:22,  1.00s/it][A
  3%|▎         | 4/145 [00:04<02:41,  1.14s/it][A
  3%|▎         | 5/145 [00:05<02:45,  1.19s/it][A
  4%|▍         | 6/145 [00:06<02:55,  1.26s/it][A
  5%|▍         | 7/145 [00:08<03:01,  1.32s/it][A
  6%|▌         | 8/145 [00:09<02:59,  1.31s/it][A
  6%|▌         | 9/145 [00:10<02:58,  1.31s/it][A
  7%|▋         | 10/145 [00:12<02:59,  1.33s/it][A
  8%|▊         | 11/145 [00:13<03:01,  1.35s/it][A
  8%|▊         | 12/145 [00:15<03:03,  1.38s/it][A
  9%|▉         | 13/145 [00:16<03:04,  1.39s/it][A
 10%|▉         | 14/145 [00:18<03:05,  1.41s/it][A
 10%|█         | 15/145 [00:19<03:02,  1.40s/it][A
 11%|█         | 16/145 [00:20<02:59,  1.39s/it][A
 12%|█▏        | 17/145 [00:22<02:59,  1.40s/it][A
 12%|█▏        | 18/145 [00:23<02:58,  1.41s/it][A
 13%|█▎        | 19/145 [00:25<02:57,  1.41s/it][A
 14%|█▍        | 20/145 [00:26<02:55,  1.40s/it][A
 14%|█▍        | 21/145 [00:27<02:51,  1.39s/it][A
 15%|█▌        | 22/145 [00:29<02:49,  1.37s/it][A
 16%|█▌        | 23/145 [00:30<02:47,  1.37s/it][A
 17%|█▋        | 24/145 [00:31<02:46,  1.38s/it][A
 17%|█▋        | 25/145 [00:33<02:45,  1.38s/it][A
 18%|█▊        | 26/145 [00:34<02:43,  1.37s/it][A
 19%|█▊        | 27/145 [00:36<02:43,  1.39s/it][A
 19%|█▉        | 28/145 [00:37<02:41,  1.38s/it][A
 20%|██        | 29/145 [00:38<02:39,  1.38s/it][A
 21%|██        | 30/145 [00:40<02:34,  1.34s/it][A
 21%|██▏       | 31/145 [00:41<02:35,  1.36s/it][A
 22%|██▏       | 32/145 [00:42<02:34,  1.37s/it][A
 23%|██▎       | 33/145 [00:44<02:34,  1.38s/it][A
 23%|██▎       | 34/145 [00:45<02:33,  1.38s/it][A
 24%|██▍       | 35/145 [00:46<02:32,  1.39s/it][A
 25%|██▍       | 36/145 [00:48<02:30,  1.38s/it][A
 26%|██▌       | 37/145 [00:49<02:32,  1.41s/it][A
 26%|██▌       | 38/145 [00:51<02:31,  1.41s/it][A
 27%|██▋       | 39/145 [00:52<02:28,  1.40s/it][A
 28%|██▊       | 40/145 [00:54<02:26,  1.40s/it][A
 28%|██▊       | 41/145 [00:55<02:27,  1.42s/it][A
 29%|██▉       | 42/145 [00:56<02:25,  1.41s/it][A
 30%|██▉       | 43/145 [00:58<02:21,  1.39s/it][A
 30%|███       | 44/145 [00:59<02:23,  1.42s/it][A
 31%|███       | 45/145 [01:01<02:24,  1.44s/it][A
 32%|███▏      | 46/145 [01:02<02:20,  1.41s/it][A
 32%|███▏      | 47/145 [01:03<02:16,  1.39s/it][A
 33%|███▎      | 48/145 [01:05<02:15,  1.39s/it][A
 34%|███▍      | 49/145 [01:06<02:15,  1.41s/it][A
 34%|███▍      | 50/145 [01:08<02:14,  1.42s/it][A
 35%|███▌      | 51/145 [01:09<02:13,  1.42s/it][A
 36%|███▌      | 52/145 [01:11<02:11,  1.41s/it][A
 37%|███▋      | 53/145 [01:12<02:10,  1.41s/it][A
 37%|███▋      | 54/145 [01:13<02:09,  1.42s/it][A
 38%|███▊      | 55/145 [01:15<02:06,  1.41s/it][A
 39%|███▊      | 56/145 [01:16<02:05,  1.41s/it][A
 39%|███▉      | 57/145 [01:17<02:02,  1.39s/it][A
 40%|████      | 58/145 [01:19<02:00,  1.38s/it][A
 41%|████      | 59/145 [01:20<02:01,  1.41s/it][A
 41%|████▏     | 60/145 [01:22<01:59,  1.40s/it][A
 42%|████▏     | 61/145 [01:23<01:57,  1.40s/it][A
 43%|████▎     | 62/145 [01:24<01:54,  1.38s/it][A
 43%|████▎     | 63/145 [01:26<01:55,  1.40s/it][A
 44%|████▍     | 64/145 [01:27<01:53,  1.40s/it][A
 45%|████▍     | 65/145 [01:29<01:52,  1.41s/it][A
 46%|████▌     | 66/145 [01:30<01:51,  1.41s/it][A
 46%|████▌     | 67/145 [01:32<01:49,  1.40s/it][A
 47%|████▋     | 68/145 [01:33<01:49,  1.42s/it][A
 48%|████▊     | 69/145 [01:34<01:48,  1.43s/it][A
 48%|████▊     | 70/145 [01:36<01:43,  1.37s/it][A
 49%|████▉     | 71/145 [01:37<01:40,  1.36s/it][A
 50%|████▉     | 72/145 [01:38<01:40,  1.38s/it][A
 50%|█████     | 73/145 [01:40<01:41,  1.41s/it][A
 51%|█████     | 74/145 [01:41<01:40,  1.42s/it][A
 52%|█████▏    | 75/145 [01:43<01:39,  1.42s/it][A
 52%|█████▏    | 76/145 [01:44<01:37,  1.41s/it][A
 53%|█████▎    | 77/145 [01:45<01:33,  1.38s/it][A
 54%|█████▍    | 78/145 [01:47<01:32,  1.38s/it][A
 54%|█████▍    | 79/145 [01:48<01:29,  1.36s/it][A
 55%|█████▌    | 80/145 [01:50<01:28,  1.36s/it][A
 56%|█████▌    | 81/145 [01:51<01:25,  1.34s/it][A
 57%|█████▋    | 82/145 [01:52<01:25,  1.36s/it][A
 57%|█████▋    | 83/145 [01:54<01:25,  1.38s/it][A
 58%|█████▊    | 84/145 [01:55<01:24,  1.39s/it][A
 59%|█████▊    | 85/145 [01:56<01:21,  1.36s/it][A
 59%|█████▉    | 86/145 [01:58<01:20,  1.37s/it][A
 60%|██████    | 87/145 [01:59<01:21,  1.40s/it][A
 61%|██████    | 88/145 [02:00<01:18,  1.37s/it][A
 61%|██████▏   | 89/145 [02:02<01:17,  1.38s/it][A
 62%|██████▏   | 90/145 [02:03<01:16,  1.39s/it][A
 63%|██████▎   | 91/145 [02:05<01:15,  1.39s/it][A
 63%|██████▎   | 92/145 [02:06<01:13,  1.39s/it][A
 64%|██████▍   | 93/145 [02:07<01:11,  1.37s/it][A
 65%|██████▍   | 94/145 [02:09<01:10,  1.37s/it][A
 66%|██████▌   | 95/145 [02:10<01:08,  1.38s/it][A
 66%|██████▌   | 96/145 [02:12<01:08,  1.39s/it][A
 67%|██████▋   | 97/145 [02:13<01:07,  1.40s/it][A
 68%|██████▊   | 98/145 [02:15<01:07,  1.44s/it][A
 68%|██████▊   | 99/145 [02:16<01:04,  1.40s/it][A
 69%|██████▉   | 100/145 [02:17<01:03,  1.41s/it][A
 70%|██████▉   | 101/145 [02:19<01:02,  1.42s/it][A
 70%|███████   | 102/145 [02:20<01:00,  1.41s/it][A
 71%|███████   | 103/145 [02:22<00:58,  1.40s/it][A
 72%|███████▏  | 104/145 [02:23<00:57,  1.41s/it][A
 72%|███████▏  | 105/145 [02:24<00:56,  1.40s/it][A
 73%|███████▎  | 106/145 [02:26<00:54,  1.40s/it][A
 74%|███████▍  | 107/145 [02:27<00:51,  1.35s/it][A
 74%|███████▍  | 108/145 [02:28<00:49,  1.33s/it][A
 75%|███████▌  | 109/145 [02:30<00:48,  1.35s/it][A
 76%|███████▌  | 110/145 [02:31<00:48,  1.38s/it][A
 77%|███████▋  | 111/145 [02:32<00:45,  1.34s/it][A
 77%|███████▋  | 112/145 [02:34<00:45,  1.38s/it][A
 78%|███████▊  | 113/145 [02:35<00:44,  1.39s/it][A
 79%|███████▊  | 114/145 [02:37<00:43,  1.41s/it][A
 79%|███████▉  | 115/145 [02:38<00:42,  1.41s/it][A
 80%|████████  | 116/145 [02:39<00:39,  1.37s/it][A
 81%|████████  | 117/145 [02:41<00:38,  1.37s/it][A
 81%|████████▏ | 118/145 [02:42<00:36,  1.37s/it][A
 82%|████████▏ | 119/145 [02:43<00:34,  1.33s/it][A
 83%|████████▎ | 120/145 [02:45<00:32,  1.32s/it][A
 83%|████████▎ | 121/145 [02:46<00:31,  1.31s/it][A
 84%|████████▍ | 122/145 [02:47<00:30,  1.32s/it][A
 85%|████████▍ | 123/145 [02:49<00:29,  1.34s/it][A
 86%|████████▌ | 124/145 [02:50<00:27,  1.33s/it][A
 86%|████████▌ | 125/145 [02:51<00:27,  1.39s/it][A
 87%|████████▋ | 126/145 [02:53<00:26,  1.38s/it][A
 88%|████████▊ | 127/145 [02:54<00:24,  1.38s/it][A
 88%|████████▊ | 128/145 [02:56<00:23,  1.40s/it][A
 89%|████████▉ | 129/145 [02:57<00:22,  1.40s/it][A
 90%|████████▉ | 130/145 [02:59<00:21,  1.42s/it][A
 90%|█████████ | 131/145 [03:00<00:19,  1.37s/it][A
 91%|█████████ | 132/145 [03:01<00:18,  1.39s/it][A
 92%|█████████▏| 133/145 [03:03<00:16,  1.36s/it][A
 92%|█████████▏| 134/145 [03:04<00:15,  1.40s/it][A
 93%|█████████▎| 135/145 [03:05<00:14,  1.41s/it][A
 94%|█████████▍| 136/145 [03:07<00:12,  1.40s/it][A
 94%|█████████▍| 137/145 [03:08<00:11,  1.39s/it][A
 95%|█████████▌| 138/145 [03:10<00:09,  1.40s/it][A
 96%|█████████▌| 139/145 [03:11<00:08,  1.40s/it][A
 97%|█████████▋| 140/145 [03:12<00:07,  1.40s/it][A
 97%|█████████▋| 141/145 [03:14<00:05,  1.40s/it][A
 98%|█████████▊| 142/145 [03:15<00:04,  1.39s/it][A
 99%|█████████▊| 143/145 [03:17<00:02,  1.38s/it][A
 99%|█████████▉| 144/145 [03:18<00:01,  1.39s/it][A
100%|██████████| 145/145 [03:19<00:00,  1.37s/it][A
                                                 [A                                                      {'eval_loss': 1.4907664060592651, 'eval_runtime': 201.3363, 'eval_samples_per_second': 5.747, 'eval_steps_per_second': 0.72, 'epoch': 9.52, 'num_input_tokens_seen': 35139968}

100%|██████████| 145/145 [03:19<00:00,  1.37s/it][A 95%|█████████▌| 3100/3250 [11:38:18<27:32, 11.02s/it]
                                                 [A[INFO|trainer.py:3705] 2024-10-11 16:30:21,719 >> Saving model checkpoint to /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-3100
[INFO|configuration_utils.py:672] 2024-10-11 16:30:23,216 >> loading configuration file config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/config.json
[WARNING|modeling_rope_utils.py:379] 2024-10-11 16:30:23,217 >> Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
[INFO|configuration_utils.py:739] 2024-10-11 16:30:23,218 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 3584,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 18944,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 28,
  "num_hidden_layers": 28,
  "num_key_value_heads": 4,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.0",
  "use_cache": true,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "in_chans": 3,
    "model_type": "qwen2_vl",
    "spatial_patch_size": 14
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 152064
}

[INFO|tokenization_utils_base.py:2649] 2024-10-11 16:30:23,286 >> tokenizer config file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-3100/tokenizer_config.json
[INFO|tokenization_utils_base.py:2658] 2024-10-11 16:30:23,287 >> Special tokens file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-3100/special_tokens_map.json
[INFO|image_processing_base.py:258] 2024-10-11 16:30:23,703 >> Image processor saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-3100/preprocessor_config.json
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 95%|█████████▌| 3101/3250 [11:38:31<2:58:46, 71.99s/it] 95%|█████████▌| 3102/3250 [11:38:42<2:12:28, 53.71s/it] 95%|█████████▌| 3103/3250 [11:38:53<1:40:04, 40.85s/it] 96%|█████████▌| 3104/3250 [11:39:04<1:17:40, 31.92s/it] 96%|█████████▌| 3105/3250 [11:39:15<1:02:03, 25.68s/it]                                                        {'loss': 1.4784, 'grad_norm': 0.38785627484321594, 'learning_rate': 0.0005, 'epoch': 9.54, 'num_input_tokens_seen': 35197760}
 96%|█████████▌| 3105/3250 [11:39:15<1:02:03, 25.68s/it] 96%|█████████▌| 3106/3250 [11:39:26<51:03, 21.28s/it]   96%|█████████▌| 3107/3250 [11:39:37<43:21, 18.19s/it] 96%|█████████▌| 3108/3250 [11:39:48<37:58, 16.05s/it] 96%|█████████▌| 3109/3250 [11:39:59<34:03, 14.49s/it] 96%|█████████▌| 3110/3250 [11:40:10<31:21, 13.44s/it]                                                      {'loss': 1.5505, 'grad_norm': 0.21765469014644623, 'learning_rate': 0.0005, 'epoch': 9.55, 'num_input_tokens_seen': 35254880}
 96%|█████████▌| 3110/3250 [11:40:10<31:21, 13.44s/it] 96%|█████████▌| 3111/3250 [11:40:21<29:31, 12.74s/it] 96%|█████████▌| 3112/3250 [11:40:32<28:00, 12.18s/it] 96%|█████████▌| 3113/3250 [11:40:43<27:00, 11.83s/it] 96%|█████████▌| 3114/3250 [11:40:54<26:22, 11.63s/it] 96%|█████████▌| 3115/3250 [11:41:05<25:36, 11.38s/it]                                                      {'loss': 1.5045, 'grad_norm': 0.19883324205875397, 'learning_rate': 0.0005, 'epoch': 9.57, 'num_input_tokens_seen': 35311904}
 96%|█████████▌| 3115/3250 [11:41:05<25:36, 11.38s/it] 96%|█████████▌| 3116/3250 [11:41:16<24:58, 11.18s/it] 96%|█████████▌| 3117/3250 [11:41:27<24:35, 11.09s/it] 96%|█████████▌| 3118/3250 [11:41:37<24:16, 11.04s/it] 96%|█████████▌| 3119/3250 [11:41:49<24:13, 11.10s/it] 96%|█████████▌| 3120/3250 [11:42:00<23:53, 11.03s/it]                                                      {'loss': 1.4975, 'grad_norm': 0.23020511865615845, 'learning_rate': 0.0005, 'epoch': 9.59, 'num_input_tokens_seen': 35368192}
 96%|█████████▌| 3120/3250 [11:42:00<23:53, 11.03s/it] 96%|█████████▌| 3121/3250 [11:42:11<23:42, 11.03s/it] 96%|█████████▌| 3122/3250 [11:42:22<23:40, 11.10s/it] 96%|█████████▌| 3123/3250 [11:42:33<23:31, 11.12s/it] 96%|█████████▌| 3124/3250 [11:42:44<23:03, 10.98s/it] 96%|█████████▌| 3125/3250 [11:42:55<22:55, 11.00s/it]                                                      {'loss': 1.4693, 'grad_norm': 0.3848787844181061, 'learning_rate': 0.0005, 'epoch': 9.6, 'num_input_tokens_seen': 35425280}
 96%|█████████▌| 3125/3250 [11:42:55<22:55, 11.00s/it] 96%|█████████▌| 3126/3250 [11:43:06<22:38, 10.95s/it] 96%|█████████▌| 3127/3250 [11:43:17<22:37, 11.03s/it] 96%|█████████▌| 3128/3250 [11:43:28<22:21, 11.00s/it] 96%|█████████▋| 3129/3250 [11:43:39<22:19, 11.07s/it] 96%|█████████▋| 3130/3250 [11:43:50<21:55, 10.96s/it]                                                      {'loss': 1.494, 'grad_norm': 0.31602686643600464, 'learning_rate': 0.0005, 'epoch': 9.62, 'num_input_tokens_seen': 35481856}
 96%|█████████▋| 3130/3250 [11:43:50<21:55, 10.96s/it] 96%|█████████▋| 3131/3250 [11:44:01<21:43, 10.95s/it] 96%|█████████▋| 3132/3250 [11:44:11<21:22, 10.87s/it] 96%|█████████▋| 3133/3250 [11:44:22<21:14, 10.89s/it] 96%|█████████▋| 3134/3250 [11:44:33<20:59, 10.86s/it] 96%|█████████▋| 3135/3250 [11:44:44<20:54, 10.91s/it]                                                      {'loss': 1.5241, 'grad_norm': 0.2476663589477539, 'learning_rate': 0.0005, 'epoch': 9.63, 'num_input_tokens_seen': 35537888}
 96%|█████████▋| 3135/3250 [11:44:44<20:54, 10.91s/it] 96%|█████████▋| 3136/3250 [11:44:55<20:38, 10.86s/it] 97%|█████████▋| 3137/3250 [11:45:06<20:29, 10.88s/it] 97%|█████████▋| 3138/3250 [11:45:16<20:14, 10.85s/it] 97%|█████████▋| 3139/3250 [11:45:27<20:05, 10.86s/it] 97%|█████████▋| 3140/3250 [11:45:38<19:52, 10.84s/it]                                                      {'loss': 1.5131, 'grad_norm': 0.34914782643318176, 'learning_rate': 0.0005, 'epoch': 9.65, 'num_input_tokens_seen': 35593600}
 97%|█████████▋| 3140/3250 [11:45:38<19:52, 10.84s/it] 97%|█████████▋| 3141/3250 [11:45:49<19:44, 10.87s/it] 97%|█████████▋| 3142/3250 [11:46:00<19:36, 10.89s/it] 97%|█████████▋| 3143/3250 [11:46:11<19:33, 10.97s/it] 97%|█████████▋| 3144/3250 [11:46:22<19:19, 10.94s/it] 97%|█████████▋| 3145/3250 [11:46:33<19:15, 11.01s/it]                                                      {'loss': 1.5298, 'grad_norm': 0.2214612364768982, 'learning_rate': 0.0005, 'epoch': 9.66, 'num_input_tokens_seen': 35650208}
 97%|█████████▋| 3145/3250 [11:46:33<19:15, 11.01s/it] 97%|█████████▋| 3146/3250 [11:46:44<19:04, 11.00s/it] 97%|█████████▋| 3147/3250 [11:46:55<18:55, 11.03s/it] 97%|█████████▋| 3148/3250 [11:47:06<18:48, 11.07s/it] 97%|█████████▋| 3149/3250 [11:47:17<18:30, 11.00s/it] 97%|█████████▋| 3150/3250 [11:47:28<18:04, 10.85s/it]                                                      {'loss': 1.5109, 'grad_norm': 0.32559338212013245, 'learning_rate': 0.0005, 'epoch': 9.68, 'num_input_tokens_seen': 35707072}
 97%|█████████▋| 3150/3250 [11:47:28<18:04, 10.85s/it] 97%|█████████▋| 3151/3250 [11:47:39<18:03, 10.95s/it] 97%|█████████▋| 3152/3250 [11:47:50<17:55, 10.97s/it] 97%|█████████▋| 3153/3250 [11:48:01<17:44, 10.98s/it] 97%|█████████▋| 3154/3250 [11:48:12<17:23, 10.87s/it] 97%|█████████▋| 3155/3250 [11:48:23<17:17, 10.92s/it]                                                      {'loss': 1.523, 'grad_norm': 0.16522806882858276, 'learning_rate': 0.0005, 'epoch': 9.69, 'num_input_tokens_seen': 35764640}
 97%|█████████▋| 3155/3250 [11:48:23<17:17, 10.92s/it] 97%|█████████▋| 3156/3250 [11:48:33<17:04, 10.89s/it] 97%|█████████▋| 3157/3250 [11:48:44<16:51, 10.87s/it] 97%|█████████▋| 3158/3250 [11:48:55<16:43, 10.91s/it] 97%|█████████▋| 3159/3250 [11:49:06<16:39, 10.98s/it] 97%|█████████▋| 3160/3250 [11:49:18<16:30, 11.00s/it]                                                      {'loss': 1.5004, 'grad_norm': 0.38768142461776733, 'learning_rate': 0.0005, 'epoch': 9.71, 'num_input_tokens_seen': 35821024}
 97%|█████████▋| 3160/3250 [11:49:18<16:30, 11.00s/it] 97%|█████████▋| 3161/3250 [11:49:29<16:24, 11.06s/it] 97%|█████████▋| 3162/3250 [11:49:40<16:15, 11.08s/it] 97%|█████████▋| 3163/3250 [11:49:51<16:05, 11.09s/it] 97%|█████████▋| 3164/3250 [11:50:02<15:46, 11.01s/it] 97%|█████████▋| 3165/3250 [11:50:13<15:40, 11.06s/it]                                                      {'loss': 1.4908, 'grad_norm': 0.2798171043395996, 'learning_rate': 0.0005, 'epoch': 9.72, 'num_input_tokens_seen': 35878112}
 97%|█████████▋| 3165/3250 [11:50:13<15:40, 11.06s/it] 97%|█████████▋| 3166/3250 [11:50:24<15:26, 11.03s/it] 97%|█████████▋| 3167/3250 [11:50:35<15:17, 11.06s/it] 97%|█████████▋| 3168/3250 [11:50:46<15:06, 11.06s/it] 98%|█████████▊| 3169/3250 [11:50:57<14:51, 11.01s/it] 98%|█████████▊| 3170/3250 [11:51:08<14:43, 11.05s/it]                                                      {'loss': 1.4537, 'grad_norm': 0.21847856044769287, 'learning_rate': 0.0005, 'epoch': 9.74, 'num_input_tokens_seen': 35935008}
 98%|█████████▊| 3170/3250 [11:51:08<14:43, 11.05s/it] 98%|█████████▊| 3171/3250 [11:51:19<14:34, 11.06s/it] 98%|█████████▊| 3172/3250 [11:51:30<14:22, 11.05s/it] 98%|█████████▊| 3173/3250 [11:51:41<13:54, 10.84s/it] 98%|█████████▊| 3174/3250 [11:51:52<13:47, 10.89s/it] 98%|█████████▊| 3175/3250 [11:52:03<13:39, 10.93s/it]                                                      {'loss': 1.5322, 'grad_norm': 0.36837929487228394, 'learning_rate': 0.0005, 'epoch': 9.75, 'num_input_tokens_seen': 35991872}
 98%|█████████▊| 3175/3250 [11:52:03<13:39, 10.93s/it] 98%|█████████▊| 3176/3250 [11:52:14<13:39, 11.07s/it] 98%|█████████▊| 3177/3250 [11:52:25<13:28, 11.08s/it] 98%|█████████▊| 3178/3250 [11:52:36<13:13, 11.02s/it] 98%|█████████▊| 3179/3250 [11:52:47<13:03, 11.03s/it] 98%|█████████▊| 3180/3250 [11:52:58<12:53, 11.04s/it]                                                      {'loss': 1.5075, 'grad_norm': 0.19690091907978058, 'learning_rate': 0.0005, 'epoch': 9.77, 'num_input_tokens_seen': 36049984}
 98%|█████████▊| 3180/3250 [11:52:58<12:53, 11.04s/it] 98%|█████████▊| 3181/3250 [11:53:09<12:38, 10.99s/it] 98%|█████████▊| 3182/3250 [11:53:20<12:30, 11.03s/it] 98%|█████████▊| 3183/3250 [11:53:31<12:17, 11.01s/it] 98%|█████████▊| 3184/3250 [11:53:42<12:02, 10.95s/it] 98%|█████████▊| 3185/3250 [11:53:53<11:47, 10.88s/it]                                                      {'loss': 1.5837, 'grad_norm': 0.17383036017417908, 'learning_rate': 0.0005, 'epoch': 9.78, 'num_input_tokens_seen': 36106624}
 98%|█████████▊| 3185/3250 [11:53:53<11:47, 10.88s/it] 98%|█████████▊| 3186/3250 [11:54:04<11:38, 10.91s/it] 98%|█████████▊| 3187/3250 [11:54:14<11:26, 10.89s/it] 98%|█████████▊| 3188/3250 [11:54:25<11:16, 10.91s/it] 98%|█████████▊| 3189/3250 [11:54:37<11:09, 10.98s/it] 98%|█████████▊| 3190/3250 [11:54:48<10:59, 11.00s/it]                                                      {'loss': 1.4639, 'grad_norm': 0.2784857749938965, 'learning_rate': 0.0005, 'epoch': 9.8, 'num_input_tokens_seen': 36163648}
 98%|█████████▊| 3190/3250 [11:54:48<10:59, 11.00s/it] 98%|█████████▊| 3191/3250 [11:54:58<10:45, 10.94s/it] 98%|█████████▊| 3192/3250 [11:55:09<10:35, 10.95s/it] 98%|█████████▊| 3193/3250 [11:55:20<10:22, 10.93s/it] 98%|█████████▊| 3194/3250 [11:55:31<10:12, 10.94s/it] 98%|█████████▊| 3195/3250 [11:55:42<10:00, 10.93s/it]                                                      {'loss': 1.5659, 'grad_norm': 0.21687178313732147, 'learning_rate': 0.0005, 'epoch': 9.82, 'num_input_tokens_seen': 36219232}
 98%|█████████▊| 3195/3250 [11:55:42<10:00, 10.93s/it] 98%|█████████▊| 3196/3250 [11:55:53<09:51, 10.96s/it] 98%|█████████▊| 3197/3250 [11:56:04<09:42, 10.99s/it] 98%|█████████▊| 3198/3250 [11:56:15<09:35, 11.06s/it] 98%|█████████▊| 3199/3250 [11:56:27<09:28, 11.15s/it] 98%|█████████▊| 3200/3250 [11:56:38<09:15, 11.10s/it]                                                      {'loss': 1.4904, 'grad_norm': 0.23909194767475128, 'learning_rate': 0.0005, 'epoch': 9.83, 'num_input_tokens_seen': 36276960}
 98%|█████████▊| 3200/3250 [11:56:38<09:15, 11.10s/it][INFO|trainer.py:4021] 2024-10-11 16:48:41,370 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-10-11 16:48:41,370 >>   Num examples = 1157
[INFO|trainer.py:4026] 2024-10-11 16:48:41,370 >>   Batch size = 4

  0%|          | 0/145 [00:00<?, ?it/s][A
  1%|▏         | 2/145 [00:01<01:38,  1.45it/s][A
  2%|▏         | 3/145 [00:02<02:22,  1.00s/it][A
  3%|▎         | 4/145 [00:04<02:41,  1.15s/it][A
  3%|▎         | 5/145 [00:05<02:46,  1.19s/it][A
  4%|▍         | 6/145 [00:06<02:55,  1.26s/it][A
  5%|▍         | 7/145 [00:08<03:01,  1.32s/it][A
  6%|▌         | 8/145 [00:09<02:58,  1.31s/it][A
  6%|▌         | 9/145 [00:10<02:57,  1.31s/it][A
  7%|▋         | 10/145 [00:12<02:59,  1.33s/it][A
  8%|▊         | 11/145 [00:13<03:00,  1.35s/it][A
  8%|▊         | 12/145 [00:15<03:03,  1.38s/it][A
  9%|▉         | 13/145 [00:16<03:04,  1.40s/it][A
 10%|▉         | 14/145 [00:18<03:05,  1.42s/it][A
 10%|█         | 15/145 [00:19<03:02,  1.40s/it][A
 11%|█         | 16/145 [00:20<02:59,  1.39s/it][A
 12%|█▏        | 17/145 [00:22<02:59,  1.40s/it][A
 12%|█▏        | 18/145 [00:23<02:58,  1.41s/it][A
 13%|█▎        | 19/145 [00:25<02:57,  1.41s/it][A
 14%|█▍        | 20/145 [00:26<02:55,  1.40s/it][A
 14%|█▍        | 21/145 [00:27<02:51,  1.38s/it][A
 15%|█▌        | 22/145 [00:29<02:48,  1.37s/it][A
 16%|█▌        | 23/145 [00:30<02:46,  1.37s/it][A
 17%|█▋        | 24/145 [00:31<02:46,  1.37s/it][A
 17%|█▋        | 25/145 [00:33<02:44,  1.37s/it][A
 18%|█▊        | 26/145 [00:34<02:43,  1.37s/it][A
 19%|█▊        | 27/145 [00:35<02:43,  1.38s/it][A
 19%|█▉        | 28/145 [00:37<02:40,  1.38s/it][A
 20%|██        | 29/145 [00:38<02:39,  1.38s/it][A
 21%|██        | 30/145 [00:39<02:34,  1.34s/it][A
 21%|██▏       | 31/145 [00:41<02:35,  1.36s/it][A
 22%|██▏       | 32/145 [00:42<02:34,  1.37s/it][A
 23%|██▎       | 33/145 [00:44<02:34,  1.38s/it][A
 23%|██▎       | 34/145 [00:45<02:33,  1.38s/it][A
 24%|██▍       | 35/145 [00:46<02:32,  1.39s/it][A
 25%|██▍       | 36/145 [00:48<02:30,  1.38s/it][A
 26%|██▌       | 37/145 [00:49<02:32,  1.42s/it][A
 26%|██▌       | 38/145 [00:51<02:31,  1.41s/it][A
 27%|██▋       | 39/145 [00:52<02:28,  1.40s/it][A
 28%|██▊       | 40/145 [00:53<02:26,  1.40s/it][A
 28%|██▊       | 41/145 [00:55<02:27,  1.42s/it][A
 29%|██▉       | 42/145 [00:56<02:25,  1.41s/it][A
 30%|██▉       | 43/145 [00:58<02:21,  1.39s/it][A
 30%|███       | 44/145 [00:59<02:23,  1.42s/it][A
 31%|███       | 45/145 [01:01<02:24,  1.44s/it][A
 32%|███▏      | 46/145 [01:02<02:20,  1.42s/it][A
 32%|███▏      | 47/145 [01:03<02:16,  1.39s/it][A
 33%|███▎      | 48/145 [01:05<02:15,  1.40s/it][A
 34%|███▍      | 49/145 [01:06<02:15,  1.41s/it][A
 34%|███▍      | 50/145 [01:08<02:14,  1.42s/it][A
 35%|███▌      | 51/145 [01:09<02:13,  1.42s/it][A
 36%|███▌      | 52/145 [01:10<02:11,  1.41s/it][A
 37%|███▋      | 53/145 [01:12<02:09,  1.41s/it][A
 37%|███▋      | 54/145 [01:13<02:09,  1.42s/it][A
 38%|███▊      | 55/145 [01:15<02:06,  1.41s/it][A
 39%|███▊      | 56/145 [01:16<02:05,  1.41s/it][A
 39%|███▉      | 57/145 [01:17<02:02,  1.40s/it][A
 40%|████      | 58/145 [01:19<02:00,  1.38s/it][A
 41%|████      | 59/145 [01:20<02:01,  1.42s/it][A
 41%|████▏     | 60/145 [01:22<01:59,  1.41s/it][A
 42%|████▏     | 61/145 [01:23<01:57,  1.40s/it][A
 43%|████▎     | 62/145 [01:24<01:54,  1.38s/it][A
 43%|████▎     | 63/145 [01:26<01:55,  1.40s/it][A
 44%|████▍     | 64/145 [01:27<01:52,  1.39s/it][A
 45%|████▍     | 65/145 [01:29<01:52,  1.41s/it][A
 46%|████▌     | 66/145 [01:30<01:51,  1.41s/it][A
 46%|████▌     | 67/145 [01:31<01:48,  1.40s/it][A
 47%|████▋     | 68/145 [01:33<01:49,  1.42s/it][A
 48%|████▊     | 69/145 [01:34<01:48,  1.43s/it][A
 48%|████▊     | 70/145 [01:36<01:43,  1.38s/it][A
 49%|████▉     | 71/145 [01:37<01:41,  1.37s/it][A
 50%|████▉     | 72/145 [01:38<01:40,  1.38s/it][A
 50%|█████     | 73/145 [01:40<01:41,  1.41s/it][A
 51%|█████     | 74/145 [01:41<01:40,  1.42s/it][A
 52%|█████▏    | 75/145 [01:43<01:39,  1.42s/it][A
 52%|█████▏    | 76/145 [01:44<01:37,  1.41s/it][A
 53%|█████▎    | 77/145 [01:45<01:33,  1.38s/it][A
 54%|█████▍    | 78/145 [01:47<01:32,  1.38s/it][A
 54%|█████▍    | 79/145 [01:48<01:30,  1.37s/it][A
 55%|█████▌    | 80/145 [01:50<01:28,  1.36s/it][A
 56%|█████▌    | 81/145 [01:51<01:25,  1.34s/it][A
 57%|█████▋    | 82/145 [01:52<01:25,  1.36s/it][A
 57%|█████▋    | 83/145 [01:54<01:25,  1.38s/it][A
 58%|█████▊    | 84/145 [01:55<01:24,  1.39s/it][A
 59%|█████▊    | 85/145 [01:56<01:21,  1.36s/it][A
 59%|█████▉    | 86/145 [01:58<01:21,  1.38s/it][A
 60%|██████    | 87/145 [01:59<01:21,  1.40s/it][A
 61%|██████    | 88/145 [02:01<01:18,  1.37s/it][A
 61%|██████▏   | 89/145 [02:02<01:17,  1.38s/it][A
 62%|██████▏   | 90/145 [02:03<01:16,  1.40s/it][A
 63%|██████▎   | 91/145 [02:05<01:15,  1.40s/it][A
 63%|██████▎   | 92/145 [02:06<01:13,  1.40s/it][A
 64%|██████▍   | 93/145 [02:07<01:11,  1.38s/it][A
 65%|██████▍   | 94/145 [02:09<01:10,  1.37s/it][A
 66%|██████▌   | 95/145 [02:10<01:09,  1.38s/it][A
 66%|██████▌   | 96/145 [02:12<01:08,  1.39s/it][A
 67%|██████▋   | 97/145 [02:13<01:07,  1.40s/it][A
 68%|██████▊   | 98/145 [02:15<01:07,  1.43s/it][A
 68%|██████▊   | 99/145 [02:16<01:04,  1.40s/it][A
 69%|██████▉   | 100/145 [02:17<01:03,  1.41s/it][A
 70%|██████▉   | 101/145 [02:19<01:02,  1.42s/it][A
 70%|███████   | 102/145 [02:20<01:00,  1.41s/it][A
 71%|███████   | 103/145 [02:22<00:58,  1.40s/it][A
 72%|███████▏  | 104/145 [02:23<00:57,  1.40s/it][A
 72%|███████▏  | 105/145 [02:24<00:56,  1.40s/it][A
 73%|███████▎  | 106/145 [02:26<00:54,  1.40s/it][A
 74%|███████▍  | 107/145 [02:27<00:51,  1.35s/it][A
 74%|███████▍  | 108/145 [02:28<00:49,  1.33s/it][A
 75%|███████▌  | 109/145 [02:30<00:48,  1.35s/it][A
 76%|███████▌  | 110/145 [02:31<00:48,  1.38s/it][A
 77%|███████▋  | 111/145 [02:32<00:45,  1.34s/it][A
 77%|███████▋  | 112/145 [02:34<00:45,  1.38s/it][A
 78%|███████▊  | 113/145 [02:35<00:44,  1.39s/it][A
 79%|███████▊  | 114/145 [02:37<00:43,  1.41s/it][A
 79%|███████▉  | 115/145 [02:38<00:42,  1.41s/it][A
 80%|████████  | 116/145 [02:39<00:39,  1.37s/it][A
 81%|████████  | 117/145 [02:41<00:38,  1.37s/it][A
 81%|████████▏ | 118/145 [02:42<00:37,  1.38s/it][A
 82%|████████▏ | 119/145 [02:43<00:34,  1.34s/it][A
 83%|████████▎ | 120/145 [02:45<00:33,  1.32s/it][A
 83%|████████▎ | 121/145 [02:46<00:31,  1.32s/it][A
 84%|████████▍ | 122/145 [02:47<00:30,  1.33s/it][A
 85%|████████▍ | 123/145 [02:49<00:29,  1.34s/it][A
 86%|████████▌ | 124/145 [02:50<00:27,  1.33s/it][A
 86%|████████▌ | 125/145 [02:52<00:27,  1.40s/it][A
 87%|████████▋ | 126/145 [02:53<00:26,  1.38s/it][A
 88%|████████▊ | 127/145 [02:54<00:24,  1.37s/it][A
 88%|████████▊ | 128/145 [02:56<00:23,  1.40s/it][A
 89%|████████▉ | 129/145 [02:57<00:22,  1.40s/it][A
 90%|████████▉ | 130/145 [02:59<00:21,  1.42s/it][A
 90%|█████████ | 131/145 [03:00<00:19,  1.37s/it][A
 91%|█████████ | 132/145 [03:01<00:18,  1.39s/it][A
 92%|█████████▏| 133/145 [03:03<00:16,  1.37s/it][A
 92%|█████████▏| 134/145 [03:04<00:15,  1.40s/it][A
 93%|█████████▎| 135/145 [03:06<00:14,  1.40s/it][A
 94%|█████████▍| 136/145 [03:07<00:12,  1.39s/it][A
 94%|█████████▍| 137/145 [03:08<00:11,  1.38s/it][A
 95%|█████████▌| 138/145 [03:10<00:09,  1.40s/it][A
 96%|█████████▌| 139/145 [03:11<00:08,  1.40s/it][A
 97%|█████████▋| 140/145 [03:12<00:07,  1.40s/it][A
 97%|█████████▋| 141/145 [03:14<00:05,  1.40s/it][A
 98%|█████████▊| 142/145 [03:15<00:04,  1.39s/it][A
 99%|█████████▊| 143/145 [03:17<00:02,  1.38s/it][A
 99%|█████████▉| 144/145 [03:18<00:01,  1.40s/it][A
100%|██████████| 145/145 [03:19<00:00,  1.37s/it][A
                                                 [A                                                      {'eval_loss': 1.484565258026123, 'eval_runtime': 201.4134, 'eval_samples_per_second': 5.744, 'eval_steps_per_second': 0.72, 'epoch': 9.83, 'num_input_tokens_seen': 36276960}

100%|██████████| 145/145 [03:19<00:00,  1.37s/it][A 98%|█████████▊| 3200/3250 [11:59:59<09:15, 11.10s/it]
                                                 [A[INFO|trainer.py:3705] 2024-10-11 16:52:02,785 >> Saving model checkpoint to /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-3200
[INFO|configuration_utils.py:672] 2024-10-11 16:52:03,384 >> loading configuration file config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/config.json
[WARNING|modeling_rope_utils.py:379] 2024-10-11 16:52:03,384 >> Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
[INFO|configuration_utils.py:739] 2024-10-11 16:52:03,386 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 3584,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 18944,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 28,
  "num_hidden_layers": 28,
  "num_key_value_heads": 4,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.0",
  "use_cache": true,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "in_chans": 3,
    "model_type": "qwen2_vl",
    "spatial_patch_size": 14
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 152064
}

[INFO|tokenization_utils_base.py:2649] 2024-10-11 16:52:03,451 >> tokenizer config file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-3200/tokenizer_config.json
[INFO|tokenization_utils_base.py:2658] 2024-10-11 16:52:03,452 >> Special tokens file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-3200/special_tokens_map.json
[INFO|image_processing_base.py:258] 2024-10-11 16:52:03,855 >> Image processor saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-3200/preprocessor_config.json
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/torch/utils/checkpoint.py:295: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with torch.enable_grad(), device_autocast_ctx, torch.cpu.amp.autocast(**ctx.cpu_autocast_kwargs):  # type: ignore[attr-defined]
 98%|█████████▊| 3201/3250 [12:00:11<58:42, 71.88s/it] 99%|█████████▊| 3202/3250 [12:00:22<42:43, 53.40s/it] 99%|█████████▊| 3203/3250 [12:00:33<31:52, 40.69s/it] 99%|█████████▊| 3204/3250 [12:00:44<24:24, 31.83s/it] 99%|█████████▊| 3205/3250 [12:00:55<19:07, 25.50s/it]                                                      {'loss': 1.4915, 'grad_norm': 0.49735310673713684, 'learning_rate': 0.0005, 'epoch': 9.85, 'num_input_tokens_seen': 36333504}
 99%|█████████▊| 3205/3250 [12:00:55<19:07, 25.50s/it] 99%|█████████▊| 3206/3250 [12:01:06<15:29, 21.13s/it] 99%|█████████▊| 3207/3250 [12:01:17<12:57, 18.09s/it] 99%|█████████▊| 3208/3250 [12:01:28<11:10, 15.97s/it] 99%|█████████▊| 3209/3250 [12:01:39<09:54, 14.49s/it] 99%|█████████▉| 3210/3250 [12:01:49<08:51, 13.30s/it]                                                      {'loss': 1.452, 'grad_norm': 0.26858776807785034, 'learning_rate': 0.0005, 'epoch': 9.86, 'num_input_tokens_seen': 36390208}
 99%|█████████▉| 3210/3250 [12:01:49<08:51, 13.30s/it] 99%|█████████▉| 3211/3250 [12:02:00<08:07, 12.51s/it] 99%|█████████▉| 3212/3250 [12:02:10<07:34, 11.96s/it] 99%|█████████▉| 3213/3250 [12:02:21<07:06, 11.52s/it] 99%|█████████▉| 3214/3250 [12:02:32<06:48, 11.35s/it] 99%|█████████▉| 3215/3250 [12:02:43<06:34, 11.28s/it]                                                      {'loss': 1.4953, 'grad_norm': 0.19542458653450012, 'learning_rate': 0.0005, 'epoch': 9.88, 'num_input_tokens_seen': 36445952}
 99%|█████████▉| 3215/3250 [12:02:43<06:34, 11.28s/it] 99%|█████████▉| 3216/3250 [12:02:54<06:21, 11.23s/it] 99%|█████████▉| 3217/3250 [12:03:05<06:08, 11.18s/it] 99%|█████████▉| 3218/3250 [12:03:16<05:54, 11.08s/it] 99%|█████████▉| 3219/3250 [12:03:27<05:41, 11.01s/it] 99%|█████████▉| 3220/3250 [12:03:38<05:31, 11.06s/it]                                                      {'loss': 1.4672, 'grad_norm': 0.2739197015762329, 'learning_rate': 0.0005, 'epoch': 9.89, 'num_input_tokens_seen': 36502976}
 99%|█████████▉| 3220/3250 [12:03:38<05:31, 11.06s/it] 99%|█████████▉| 3221/3250 [12:03:49<05:18, 10.99s/it] 99%|█████████▉| 3222/3250 [12:04:00<05:07, 10.97s/it] 99%|█████████▉| 3223/3250 [12:04:11<04:57, 11.02s/it] 99%|█████████▉| 3224/3250 [12:04:22<04:44, 10.92s/it] 99%|█████████▉| 3225/3250 [12:04:33<04:33, 10.92s/it]                                                      {'loss': 1.5629, 'grad_norm': 0.31992432475090027, 'learning_rate': 0.0005, 'epoch': 9.91, 'num_input_tokens_seen': 36558880}
 99%|█████████▉| 3225/3250 [12:04:33<04:33, 10.92s/it] 99%|█████████▉| 3226/3250 [12:04:44<04:22, 10.96s/it] 99%|█████████▉| 3227/3250 [12:04:55<04:14, 11.08s/it] 99%|█████████▉| 3228/3250 [12:05:06<04:03, 11.07s/it] 99%|█████████▉| 3229/3250 [12:05:17<03:52, 11.09s/it] 99%|█████████▉| 3230/3250 [12:05:28<03:39, 10.99s/it]                                                      {'loss': 1.4692, 'grad_norm': 0.29594582319259644, 'learning_rate': 0.0005, 'epoch': 9.92, 'num_input_tokens_seen': 36616064}
 99%|█████████▉| 3230/3250 [12:05:28<03:39, 10.99s/it] 99%|█████████▉| 3231/3250 [12:05:39<03:29, 11.01s/it] 99%|█████████▉| 3232/3250 [12:05:50<03:17, 10.97s/it] 99%|█████████▉| 3233/3250 [12:06:01<03:06, 10.98s/it]100%|█████████▉| 3234/3250 [12:06:12<02:55, 10.97s/it]100%|█████████▉| 3235/3250 [12:06:23<02:43, 10.87s/it]                                                      {'loss': 1.4824, 'grad_norm': 0.29454436898231506, 'learning_rate': 0.0005, 'epoch': 9.94, 'num_input_tokens_seen': 36672992}
100%|█████████▉| 3235/3250 [12:06:23<02:43, 10.87s/it]100%|█████████▉| 3236/3250 [12:06:33<02:32, 10.89s/it]100%|█████████▉| 3237/3250 [12:06:44<02:21, 10.92s/it]100%|█████████▉| 3238/3250 [12:06:55<02:11, 10.96s/it]100%|█████████▉| 3239/3250 [12:07:06<02:00, 10.97s/it]100%|█████████▉| 3240/3250 [12:07:17<01:49, 10.94s/it]                                                      {'loss': 1.4672, 'grad_norm': 0.26605337858200073, 'learning_rate': 0.0005, 'epoch': 9.95, 'num_input_tokens_seen': 36729248}
100%|█████████▉| 3240/3250 [12:07:17<01:49, 10.94s/it]100%|█████████▉| 3241/3250 [12:07:29<01:39, 11.01s/it]100%|█████████▉| 3242/3250 [12:07:40<01:28, 11.02s/it]100%|█████████▉| 3243/3250 [12:07:51<01:17, 11.06s/it]100%|█████████▉| 3244/3250 [12:08:02<01:06, 11.02s/it]100%|█████████▉| 3245/3250 [12:08:13<00:55, 11.07s/it]                                                      {'loss': 1.4853, 'grad_norm': 0.37657275795936584, 'learning_rate': 0.0005, 'epoch': 9.97, 'num_input_tokens_seen': 36788352}
100%|█████████▉| 3245/3250 [12:08:13<00:55, 11.07s/it]100%|█████████▉| 3246/3250 [12:08:24<00:43, 11.00s/it]100%|█████████▉| 3247/3250 [12:08:35<00:32, 10.96s/it]100%|█████████▉| 3248/3250 [12:08:46<00:21, 10.98s/it]100%|█████████▉| 3249/3250 [12:08:56<00:10, 10.94s/it]100%|██████████| 3250/3250 [12:09:07<00:00, 10.97s/it]                                                      {'loss': 1.5004, 'grad_norm': 0.3496548533439636, 'learning_rate': 0.0005, 'epoch': 9.98, 'num_input_tokens_seen': 36844736}
100%|██████████| 3250/3250 [12:09:07<00:00, 10.97s/it][INFO|trainer.py:3705] 2024-10-11 17:01:11,069 >> Saving model checkpoint to /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-3250
[INFO|configuration_utils.py:672] 2024-10-11 17:01:11,672 >> loading configuration file config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/config.json
[WARNING|modeling_rope_utils.py:379] 2024-10-11 17:01:11,672 >> Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
[INFO|configuration_utils.py:739] 2024-10-11 17:01:11,673 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 3584,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 18944,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 28,
  "num_hidden_layers": 28,
  "num_key_value_heads": 4,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.0",
  "use_cache": true,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "in_chans": 3,
    "model_type": "qwen2_vl",
    "spatial_patch_size": 14
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 152064
}

[INFO|tokenization_utils_base.py:2649] 2024-10-11 17:01:11,739 >> tokenizer config file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-3250/tokenizer_config.json
[INFO|tokenization_utils_base.py:2658] 2024-10-11 17:01:11,739 >> Special tokens file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-3250/special_tokens_map.json
[INFO|image_processing_base.py:258] 2024-10-11 17:01:12,103 >> Image processor saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/checkpoint-3250/preprocessor_config.json
[INFO|trainer.py:2505] 2024-10-11 17:01:12,103 >> 

Training completed. Do not forget to share your model on huggingface.co/models =)


                                                      {'train_runtime': 43749.3322, 'train_samples_per_second': 2.379, 'train_steps_per_second': 0.074, 'train_loss': 2.05630024939317, 'epoch': 9.98, 'num_input_tokens_seen': 36844736}
100%|██████████| 3250/3250 [12:09:08<00:00, 10.97s/it]100%|██████████| 3250/3250 [12:09:08<00:00, 13.46s/it]
[INFO|image_processing_base.py:258] 2024-10-11 17:01:12,106 >> Image processor saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/preprocessor_config.json
[INFO|trainer.py:3705] 2024-10-11 17:01:12,106 >> Saving model checkpoint to /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs
[INFO|configuration_utils.py:672] 2024-10-11 17:01:12,658 >> loading configuration file config.json from cache at /iitjhome/m23csa016/.cache/huggingface/hub/models--Qwen--Qwen2-VL-7B-Instruct/snapshots/51c47430f97dd7c74aa1fa6825e68a813478097f/config.json
[WARNING|modeling_rope_utils.py:379] 2024-10-11 17:01:12,658 >> Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
[INFO|configuration_utils.py:739] 2024-10-11 17:01:12,660 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 3584,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 18944,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 28,
  "num_hidden_layers": 28,
  "num_key_value_heads": 4,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.45.0",
  "use_cache": true,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "in_chans": 3,
    "model_type": "qwen2_vl",
    "spatial_patch_size": 14
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 152064
}

[INFO|tokenization_utils_base.py:2649] 2024-10-11 17:01:12,724 >> tokenizer config file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/tokenizer_config.json
[INFO|tokenization_utils_base.py:2658] 2024-10-11 17:01:12,725 >> Special tokens file saved in /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/special_tokens_map.json
***** train metrics *****
  epoch                    =       9.9846
  num_input_tokens_seen    =     36844736
  total_flos               = 1599026707GF
  train_loss               =       2.0563
  train_runtime            =  12:09:09.33
  train_samples_per_second =        2.379
  train_steps_per_second   =        0.074
Figure saved at: /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/training_loss.png
Figure saved at: /scratch/data/m23csa016/meesho_data/finetuning/universal_attrs/training_eval_loss.png
10/11/2024 17:01:13 - WARNING - llamafactory.extras.ploting - No metric eval_accuracy to plot.
[INFO|trainer.py:4021] 2024-10-11 17:01:13,393 >> 
***** Running Evaluation *****
[INFO|trainer.py:4023] 2024-10-11 17:01:13,393 >>   Num examples = 1157
[INFO|trainer.py:4026] 2024-10-11 17:01:13,393 >>   Batch size = 4
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/iitjhome/m23csa016/.conda/envs/meesho/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
  0%|          | 0/145 [00:00<?, ?it/s]  1%|▏         | 2/145 [00:01<01:38,  1.45it/s]  2%|▏         | 3/145 [00:02<02:22,  1.01s/it]  3%|▎         | 4/145 [00:04<02:41,  1.15s/it]  3%|▎         | 5/145 [00:05<02:45,  1.18s/it]  4%|▍         | 6/145 [00:06<02:55,  1.26s/it]  5%|▍         | 7/145 [00:08<03:00,  1.31s/it]  6%|▌         | 8/145 [00:09<02:58,  1.30s/it]  6%|▌         | 9/145 [00:10<02:57,  1.31s/it]  7%|▋         | 10/145 [00:12<02:59,  1.33s/it]  8%|▊         | 11/145 [00:13<03:00,  1.35s/it]  8%|▊         | 12/145 [00:15<03:03,  1.38s/it]  9%|▉         | 13/145 [00:16<03:04,  1.40s/it] 10%|▉         | 14/145 [00:18<03:05,  1.42s/it] 10%|█         | 15/145 [00:19<03:02,  1.40s/it] 11%|█         | 16/145 [00:20<02:59,  1.40s/it] 12%|█▏        | 17/145 [00:22<02:59,  1.40s/it] 12%|█▏        | 18/145 [00:23<02:58,  1.40s/it] 13%|█▎        | 19/145 [00:25<02:57,  1.41s/it] 14%|█▍        | 20/145 [00:26<02:55,  1.41s/it] 14%|█▍        | 21/145 [00:27<02:51,  1.38s/it] 15%|█▌        | 22/145 [00:29<02:48,  1.37s/it] 16%|█▌        | 23/145 [00:30<02:46,  1.37s/it] 17%|█▋        | 24/145 [00:31<02:46,  1.37s/it] 17%|█▋        | 25/145 [00:33<02:45,  1.38s/it] 18%|█▊        | 26/145 [00:34<02:43,  1.37s/it] 19%|█▊        | 27/145 [00:35<02:43,  1.39s/it] 19%|█▉        | 28/145 [00:37<02:41,  1.38s/it] 20%|██        | 29/145 [00:38<02:39,  1.38s/it] 21%|██        | 30/145 [00:39<02:34,  1.34s/it] 21%|██▏       | 31/145 [00:41<02:35,  1.36s/it] 22%|██▏       | 32/145 [00:42<02:34,  1.37s/it] 23%|██▎       | 33/145 [00:44<02:33,  1.37s/it] 23%|██▎       | 34/145 [00:45<02:33,  1.38s/it] 24%|██▍       | 35/145 [00:46<02:32,  1.38s/it] 25%|██▍       | 36/145 [00:48<02:30,  1.38s/it] 26%|██▌       | 37/145 [00:49<02:33,  1.42s/it] 26%|██▌       | 38/145 [00:51<02:31,  1.41s/it] 27%|██▋       | 39/145 [00:52<02:28,  1.40s/it] 28%|██▊       | 40/145 [00:53<02:26,  1.40s/it] 28%|██▊       | 41/145 [00:55<02:27,  1.42s/it] 29%|██▉       | 42/145 [00:56<02:25,  1.42s/it] 30%|██▉       | 43/145 [00:58<02:22,  1.39s/it] 30%|███       | 44/145 [00:59<02:23,  1.42s/it] 31%|███       | 45/145 [01:01<02:24,  1.45s/it] 32%|███▏      | 46/145 [01:02<02:20,  1.42s/it] 32%|███▏      | 47/145 [01:03<02:16,  1.39s/it] 33%|███▎      | 48/145 [01:05<02:15,  1.40s/it] 34%|███▍      | 49/145 [01:06<02:14,  1.41s/it] 34%|███▍      | 50/145 [01:08<02:14,  1.42s/it] 35%|███▌      | 51/145 [01:09<02:13,  1.42s/it] 36%|███▌      | 52/145 [01:10<02:11,  1.41s/it] 37%|███▋      | 53/145 [01:12<02:09,  1.41s/it] 37%|███▋      | 54/145 [01:13<02:09,  1.42s/it] 38%|███▊      | 55/145 [01:15<02:06,  1.41s/it] 39%|███▊      | 56/145 [01:16<02:04,  1.40s/it] 39%|███▉      | 57/145 [01:17<02:02,  1.39s/it] 40%|████      | 58/145 [01:19<01:59,  1.38s/it] 41%|████      | 59/145 [01:20<02:01,  1.41s/it] 41%|████▏     | 60/145 [01:22<01:59,  1.40s/it] 42%|████▏     | 61/145 [01:23<01:57,  1.39s/it] 43%|████▎     | 62/145 [01:24<01:54,  1.38s/it] 43%|████▎     | 63/145 [01:26<01:54,  1.40s/it] 44%|████▍     | 64/145 [01:27<01:53,  1.40s/it] 45%|████▍     | 65/145 [01:29<01:52,  1.41s/it] 46%|████▌     | 66/145 [01:30<01:51,  1.41s/it] 46%|████▌     | 67/145 [01:31<01:48,  1.39s/it] 47%|████▋     | 68/145 [01:33<01:49,  1.42s/it] 48%|████▊     | 69/145 [01:34<01:48,  1.43s/it] 48%|████▊     | 70/145 [01:36<01:42,  1.37s/it] 49%|████▉     | 71/145 [01:37<01:41,  1.37s/it] 50%|████▉     | 72/145 [01:38<01:40,  1.38s/it] 50%|█████     | 73/145 [01:40<01:41,  1.41s/it] 51%|█████     | 74/145 [01:41<01:40,  1.41s/it] 52%|█████▏    | 75/145 [01:43<01:39,  1.42s/it] 52%|█████▏    | 76/145 [01:44<01:37,  1.41s/it] 53%|█████▎    | 77/145 [01:45<01:33,  1.38s/it] 54%|█████▍    | 78/145 [01:47<01:32,  1.38s/it] 54%|█████▍    | 79/145 [01:48<01:30,  1.36s/it] 55%|█████▌    | 80/145 [01:49<01:28,  1.36s/it] 56%|█████▌    | 81/145 [01:51<01:25,  1.34s/it] 57%|█████▋    | 82/145 [01:52<01:25,  1.36s/it] 57%|█████▋    | 83/145 [01:54<01:25,  1.37s/it] 58%|█████▊    | 84/145 [01:55<01:24,  1.39s/it] 59%|█████▊    | 85/145 [01:56<01:21,  1.36s/it] 59%|█████▉    | 86/145 [01:58<01:21,  1.37s/it] 60%|██████    | 87/145 [01:59<01:21,  1.40s/it] 61%|██████    | 88/145 [02:00<01:18,  1.38s/it] 61%|██████▏   | 89/145 [02:02<01:17,  1.38s/it] 62%|██████▏   | 90/145 [02:03<01:16,  1.40s/it] 63%|██████▎   | 91/145 [02:05<01:15,  1.40s/it] 63%|██████▎   | 92/145 [02:06<01:13,  1.39s/it] 64%|██████▍   | 93/145 [02:07<01:11,  1.37s/it] 65%|██████▍   | 94/145 [02:09<01:09,  1.37s/it] 66%|██████▌   | 95/145 [02:10<01:08,  1.38s/it] 66%|██████▌   | 96/145 [02:12<01:07,  1.39s/it] 67%|██████▋   | 97/145 [02:13<01:07,  1.40s/it] 68%|██████▊   | 98/145 [02:15<01:07,  1.44s/it] 68%|██████▊   | 99/145 [02:16<01:04,  1.40s/it] 69%|██████▉   | 100/145 [02:17<01:03,  1.41s/it] 70%|██████▉   | 101/145 [02:19<01:02,  1.42s/it] 70%|███████   | 102/145 [02:20<01:00,  1.41s/it] 71%|███████   | 103/145 [02:21<00:58,  1.40s/it] 72%|███████▏  | 104/145 [02:23<00:57,  1.41s/it] 72%|███████▏  | 105/145 [02:24<00:56,  1.41s/it] 73%|███████▎  | 106/145 [02:26<00:54,  1.40s/it] 74%|███████▍  | 107/145 [02:27<00:51,  1.36s/it] 74%|███████▍  | 108/145 [02:28<00:49,  1.33s/it] 75%|███████▌  | 109/145 [02:30<00:48,  1.36s/it] 76%|███████▌  | 110/145 [02:31<00:48,  1.38s/it] 77%|███████▋  | 111/145 [02:32<00:45,  1.34s/it] 77%|███████▋  | 112/145 [02:34<00:45,  1.38s/it] 78%|███████▊  | 113/145 [02:35<00:44,  1.39s/it] 79%|███████▊  | 114/145 [02:37<00:43,  1.41s/it] 79%|███████▉  | 115/145 [02:38<00:42,  1.41s/it] 80%|████████  | 116/145 [02:39<00:39,  1.37s/it] 81%|████████  | 117/145 [02:41<00:38,  1.37s/it] 81%|████████▏ | 118/145 [02:42<00:36,  1.37s/it] 82%|████████▏ | 119/145 [02:43<00:34,  1.33s/it] 83%|████████▎ | 120/145 [02:45<00:32,  1.32s/it] 83%|████████▎ | 121/145 [02:46<00:31,  1.31s/it] 84%|████████▍ | 122/145 [02:47<00:30,  1.32s/it] 85%|████████▍ | 123/145 [02:49<00:29,  1.34s/it] 86%|████████▌ | 124/145 [02:50<00:27,  1.33s/it] 86%|████████▌ | 125/145 [02:51<00:27,  1.40s/it] 87%|████████▋ | 126/145 [02:53<00:26,  1.38s/it] 88%|████████▊ | 127/145 [02:54<00:24,  1.37s/it] 88%|████████▊ | 128/145 [02:56<00:23,  1.41s/it] 89%|████████▉ | 129/145 [02:57<00:22,  1.40s/it] 90%|████████▉ | 130/145 [02:59<00:21,  1.43s/it] 90%|█████████ | 131/145 [03:00<00:19,  1.37s/it] 91%|█████████ | 132/145 [03:01<00:18,  1.39s/it] 92%|█████████▏| 133/145 [03:03<00:16,  1.36s/it] 92%|█████████▏| 134/145 [03:04<00:15,  1.40s/it] 93%|█████████▎| 135/145 [03:05<00:14,  1.40s/it] 94%|█████████▍| 136/145 [03:07<00:12,  1.39s/it] 94%|█████████▍| 137/145 [03:08<00:11,  1.39s/it] 95%|█████████▌| 138/145 [03:10<00:09,  1.40s/it] 96%|█████████▌| 139/145 [03:11<00:08,  1.40s/it] 97%|█████████▋| 140/145 [03:12<00:06,  1.40s/it] 97%|█████████▋| 141/145 [03:14<00:05,  1.40s/it] 98%|█████████▊| 142/145 [03:15<00:04,  1.39s/it] 99%|█████████▊| 143/145 [03:16<00:02,  1.38s/it] 99%|█████████▉| 144/145 [03:18<00:01,  1.40s/it]100%|██████████| 145/145 [03:19<00:00,  1.37s/it]100%|██████████| 145/145 [03:19<00:00,  1.38s/it]
***** eval metrics *****
  epoch                   =     9.9846
  eval_loss               =     1.4588
  eval_runtime            = 0:03:21.35
  eval_samples_per_second =      5.746
  eval_steps_per_second   =       0.72
  num_input_tokens_seen   =   36844736
[INFO|modelcard.py:449] 2024-10-11 17:04:34,756 >> Dropping the following result as it does not have all the necessary fields:
{'task': {'name': 'Causal Language Modeling', 'type': 'text-generation'}}

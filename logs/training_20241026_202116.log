2024-10-26 20:21:16,580 | INFO | Starting hyperparameter search
2024-10-26 20:21:16,580 | INFO | Hyperparameter search space:
2024-10-26 20:21:16,580 | INFO | {
  "clip_lr": [
    1e-05,
    0.0001,
    5e-06
  ],
  "predictor_lr": [
    5e-05,
    0.0005,
    0.001
  ],
  "weight_decay": [
    0.001,
    0.05,
    0.1
  ],
  "beta1": [
    0.9,
    0.95
  ],
  "beta2": [
    0.999,
    0.9999
  ],
  "hidden_dim": [
    256,
    768,
    1024
  ],
  "dropout_rate": [
    0.1,
    0.3,
    0.4,
    0.5
  ],
  "num_hidden_layers": [
    1,
    2,
    3
  ]
}
2024-10-26 20:21:26,233 | INFO | Dataset loaded successfully with 70213 samples
2024-10-26 20:21:26,235 | INFO | Attribute dimensions:
2024-10-26 20:21:26,235 | INFO | {
  "Kurtis_color": 13,
  "Kurtis_fit_shape": 2,
  "Kurtis_length": 2,
  "Kurtis_occasion": 2,
  "Kurtis_ornamentation": 2,
  "Kurtis_pattern": 2,
  "Kurtis_print_or_pattern_type": 2,
  "Kurtis_sleeve_length": 3,
  "Kurtis_sleeve_styling": 2,
  "Men Tshirts_color": 4,
  "Men Tshirts_neck": 2,
  "Men Tshirts_pattern": 2,
  "Men Tshirts_print_or_pattern_type": 3,
  "Men Tshirts_sleeve_length": 2,
  "Sarees_blouse_pattern": 4,
  "Sarees_border": 6,
  "Sarees_border_width": 3,
  "Sarees_color": 8,
  "Sarees_occasion": 4,
  "Sarees_ornamentation": 3,
  "Sarees_pallu_details": 4,
  "Sarees_pattern": 5,
  "Sarees_print_or_pattern_type": 9,
  "Sarees_transparency": 2,
  "Women Tops & Tunics_color": 12,
  "Women Tops & Tunics_fit_shape": 4,
  "Women Tops & Tunics_length": 2,
  "Women Tops & Tunics_neck_collar": 7,
  "Women Tops & Tunics_occasion": 2,
  "Women Tops & Tunics_pattern": 3,
  "Women Tops & Tunics_print_or_pattern_type": 6,
  "Women Tops & Tunics_sleeve_length": 4,
  "Women Tops & Tunics_sleeve_styling": 4,
  "Women Tops & Tunics_surface_styling": 6,
  "Women Tshirts_color": 7,
  "Women Tshirts_fit_shape": 3,
  "Women Tshirts_length": 3,
  "Women Tshirts_pattern": 3,
  "Women Tshirts_print_or_pattern_type": 6,
  "Women Tshirts_sleeve_length": 3,
  "Women Tshirts_sleeve_styling": 2,
  "Women Tshirts_surface_styling": 2
}
2024-10-26 20:21:26,318 | INFO | 
Initialized model with architecture parameters:
2024-10-26 20:21:26,318 | INFO | Hidden Dim: 256, Dropout: 0.1, Layers: 1
2024-10-26 20:21:26,318 | INFO | 
Starting training with optimizer parameters:
2024-10-26 20:21:26,318 | INFO | CLIP LR: 1e-05, Predictor LR: 5e-05, Weight Decay: 0.001, Beta1: 0.9, Beta2: 0.999
2024-10-26 20:21:26,318 | INFO | Starting new training run
2024-10-26 20:21:26,320 | INFO | Training hyperparameters:
2024-10-26 20:21:26,321 | INFO | {
  "clip_lr": 1e-05,
  "predictor_lr": 5e-05,
  "weight_decay": 0.001,
  "beta1": 0.9,
  "beta2": 0.999,
  "num_epochs": 20,
  "device": "cuda",
  "model_architecture": "CategoryAwareAttributePredictor(\n  (attribute_predictors): ModuleDict(\n    (Kurtis_color): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=13, bias=True)\n    )\n    (Kurtis_fit_shape): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Kurtis_length): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Kurtis_occasion): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Kurtis_ornamentation): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Kurtis_pattern): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Kurtis_print_or_pattern_type): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Kurtis_sleeve_length): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Kurtis_sleeve_styling): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Men Tshirts_color): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=4, bias=True)\n    )\n    (Men Tshirts_neck): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Men Tshirts_pattern): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Men Tshirts_print_or_pattern_type): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Men Tshirts_sleeve_length): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Sarees_blouse_pattern): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=4, bias=True)\n    )\n    (Sarees_border): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=6, bias=True)\n    )\n    (Sarees_border_width): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Sarees_color): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=8, bias=True)\n    )\n    (Sarees_occasion): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=4, bias=True)\n    )\n    (Sarees_ornamentation): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Sarees_pallu_details): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=4, bias=True)\n    )\n    (Sarees_pattern): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=5, bias=True)\n    )\n    (Sarees_print_or_pattern_type): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=9, bias=True)\n    )\n    (Sarees_transparency): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Women Tops & Tunics_color): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=12, bias=True)\n    )\n    (Women Tops & Tunics_fit_shape): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=4, bias=True)\n    )\n    (Women Tops & Tunics_length): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Women Tops & Tunics_neck_collar): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=7, bias=True)\n    )\n    (Women Tops & Tunics_occasion): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Women Tops & Tunics_pattern): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Women Tops & Tunics_print_or_pattern_type): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=6, bias=True)\n    )\n    (Women Tops & Tunics_sleeve_length): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=4, bias=True)\n    )\n    (Women Tops & Tunics_sleeve_styling): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=4, bias=True)\n    )\n    (Women Tops & Tunics_surface_styling): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=6, bias=True)\n    )\n    (Women Tshirts_color): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=7, bias=True)\n    )\n    (Women Tshirts_fit_shape): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Women Tshirts_length): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Women Tshirts_pattern): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Women Tshirts_print_or_pattern_type): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=6, bias=True)\n    )\n    (Women Tshirts_sleeve_length): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Women Tshirts_sleeve_styling): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Women Tshirts_surface_styling): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n  )\n)"
}
2024-10-26 20:21:35,388 | INFO | CLIP model loaded successfully
2024-10-26 20:21:35,398 | INFO | Starting epoch 1/20
2024-10-26 20:21:44,149 | INFO | Epoch 1, Batch 0: Loss = 1.3396, Accuracy = 32.3383%
2024-10-26 20:22:25,292 | INFO | Epoch 1, Batch 100: Loss = 0.8551, Accuracy = 69.4915%
2024-10-26 20:23:06,278 | INFO | Epoch 1, Batch 200: Loss = 0.6602, Accuracy = 78.1726%
2024-10-26 20:23:49,819 | INFO | Epoch 1, Batch 300: Loss = 0.6649, Accuracy = 73.9336%
2024-10-26 20:24:33,754 | INFO | Epoch 1, Batch 400: Loss = 0.5018, Accuracy = 82.9146%
2024-10-26 20:25:18,593 | INFO | Epoch 1, Batch 500: Loss = 0.4185, Accuracy = 85.5814%
2024-10-26 20:26:02,953 | INFO | Epoch 1, Batch 600: Loss = 0.4358, Accuracy = 84.1837%
2024-10-26 20:26:48,046 | INFO | Epoch 1, Batch 700: Loss = 0.4159, Accuracy = 86.0104%
2024-10-26 20:27:33,298 | INFO | Epoch 1, Batch 800: Loss = 0.5752, Accuracy = 78.8136%
2024-10-26 20:28:18,028 | INFO | Epoch 1, Batch 900: Loss = 0.4283, Accuracy = 80.6306%
2024-10-26 20:29:01,487 | INFO | Epoch 1, Batch 1000: Loss = 0.4065, Accuracy = 85.5000%
2024-10-26 20:29:47,931 | INFO | Epoch 1, Batch 1100: Loss = 0.3944, Accuracy = 88.3495%
2024-10-26 20:30:33,279 | INFO | Epoch 1, Batch 1200: Loss = 0.5389, Accuracy = 78.1250%
2024-10-26 20:31:16,576 | INFO | Epoch 1, Batch 1300: Loss = 0.5186, Accuracy = 77.6699%
2024-10-26 20:32:02,429 | INFO | Epoch 1, Batch 1400: Loss = 0.5009, Accuracy = 81.5315%
2024-10-26 20:32:48,368 | INFO | Epoch 1, Batch 1500: Loss = 0.4570, Accuracy = 79.7872%
2024-10-26 20:33:32,773 | INFO | Epoch 1, Batch 1600: Loss = 0.4011, Accuracy = 86.7580%
2024-10-26 20:34:16,535 | INFO | Epoch 1, Batch 1700: Loss = 0.4776, Accuracy = 81.3725%
2024-10-26 20:35:03,181 | INFO | Epoch 1, Batch 1800: Loss = 0.4015, Accuracy = 84.8039%
2024-10-26 20:35:50,540 | INFO | Epoch 1, Batch 1900: Loss = 0.3259, Accuracy = 89.2019%
2024-10-26 20:36:39,756 | INFO | Epoch 1, Batch 2000: Loss = 0.4409, Accuracy = 82.5112%
2024-10-26 20:37:25,647 | INFO | Epoch 1, Batch 2100: Loss = 0.3331, Accuracy = 88.1773%
2024-10-26 20:38:07,159 | INFO | Epoch 1 Summary:
Average Loss: 0.5189
Overall Accuracy: 80.6567%
Attribute Accuracies: {
  "Sarees_border": 0.6687029809378359,
  "Sarees_border_width": 0.8922514343357922,
  "Sarees_color": 0.5346446133214126,
  "Sarees_occasion": 0.6892175194061987,
  "Sarees_pattern": 0.8431217734588521,
  "Sarees_print_or_pattern_type": 0.6338530378242326,
  "Sarees_transparency": 0.8321921652261758,
  "Men Tshirts_color": 0.6715474209650583,
  "Men Tshirts_neck": 0.9871419270833334,
  "Men Tshirts_pattern": 0.9697806941806251,
  "Men Tshirts_print_or_pattern_type": 0.8804841149773072,
  "Men Tshirts_sleeve_length": 0.9866153588756902,
  "Women Tshirts_color": 0.7722302574486549,
  "Women Tshirts_fit_shape": 0.856833997702858,
  "Women Tshirts_length": 0.8525331724969843,
  "Women Tshirts_pattern": 0.9546438957985273,
  "Women Tshirts_print_or_pattern_type": 0.6950804273805331,
  "Women Tshirts_sleeve_length": 0.9405273985412381,
  "Women Tshirts_sleeve_styling": 0.9738033635187581,
  "Women Tops & Tunics_color": 0.6818181818181818,
  "Women Tops & Tunics_fit_shape": 0.7170278173502287,
  "Women Tops & Tunics_length": 0.8758610133170059,
  "Women Tops & Tunics_neck_collar": 0.7066389116050851,
  "Women Tops & Tunics_occasion": 0.9831304209437416,
  "Women Tops & Tunics_pattern": 0.9195732768404328,
  "Women Tops & Tunics_print_or_pattern_type": 0.8432203389830508,
  "Women Tops & Tunics_sleeve_length": 0.8675074291512648,
  "Women Tops & Tunics_sleeve_styling": 0.8276191233792061,
  "Sarees_blouse_pattern": 0.6984147114774889,
  "Sarees_ornamentation": 0.8578842315369262,
  "Sarees_pallu_details": 0.6257868705035972,
  "Kurtis_color": 0.6903001961080103,
  "Kurtis_fit_shape": 0.7845868152274837,
  "Kurtis_length": 0.7391176470588235,
  "Kurtis_occasion": 0.9387342559477531,
  "Kurtis_ornamentation": 0.9246785058175138,
  "Kurtis_pattern": 0.8393970893970893,
  "Kurtis_print_or_pattern_type": 0.8282591725214676,
  "Kurtis_sleeve_length": 0.9216651745747538,
  "Kurtis_sleeve_styling": 0.9866985502914363,
  "Women Tops & Tunics_surface_styling": 0.5833449380309149,
  "Women Tshirts_surface_styling": 0.9392156862745098
}
2024-10-26 20:38:07,166 | ERROR | Training interrupted: module 'clip' has no attribute '__version__'
Traceback (most recent call last):
  File "/iitjhome/m23csa016/meesho_code/clipvit_uf_hyper_tune.py", line 455, in train_model_with_params
    'clip_version': clip.__version__,
AttributeError: module 'clip' has no attribute '__version__'
2024-10-26 20:38:07,166 | ERROR | Error in training run: module 'clip' has no attribute '__version__'
Traceback (most recent call last):
  File "/iitjhome/m23csa016/meesho_code/clipvit_uf_hyper_tune.py", line 569, in main
    _, _, metrics = train_model_with_params(
  File "/iitjhome/m23csa016/meesho_code/clipvit_uf_hyper_tune.py", line 455, in train_model_with_params
    'clip_version': clip.__version__,
AttributeError: module 'clip' has no attribute '__version__'
2024-10-26 20:38:07,403 | INFO | 
Starting training with optimizer parameters:
2024-10-26 20:38:07,404 | INFO | CLIP LR: 1e-05, Predictor LR: 5e-05, Weight Decay: 0.001, Beta1: 0.9, Beta2: 0.9999
2024-10-26 20:38:07,405 | INFO | Starting new training run
2024-10-26 20:38:07,406 | INFO | Training hyperparameters:
2024-10-26 20:38:07,406 | INFO | {
  "clip_lr": 1e-05,
  "predictor_lr": 5e-05,
  "weight_decay": 0.001,
  "beta1": 0.9,
  "beta2": 0.9999,
  "num_epochs": 20,
  "device": "cuda",
  "model_architecture": "CategoryAwareAttributePredictor(\n  (attribute_predictors): ModuleDict(\n    (Kurtis_color): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=13, bias=True)\n    )\n    (Kurtis_fit_shape): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Kurtis_length): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Kurtis_occasion): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Kurtis_ornamentation): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Kurtis_pattern): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Kurtis_print_or_pattern_type): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Kurtis_sleeve_length): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Kurtis_sleeve_styling): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Men Tshirts_color): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=4, bias=True)\n    )\n    (Men Tshirts_neck): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Men Tshirts_pattern): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Men Tshirts_print_or_pattern_type): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Men Tshirts_sleeve_length): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Sarees_blouse_pattern): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=4, bias=True)\n    )\n    (Sarees_border): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=6, bias=True)\n    )\n    (Sarees_border_width): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Sarees_color): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=8, bias=True)\n    )\n    (Sarees_occasion): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=4, bias=True)\n    )\n    (Sarees_ornamentation): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Sarees_pallu_details): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=4, bias=True)\n    )\n    (Sarees_pattern): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=5, bias=True)\n    )\n    (Sarees_print_or_pattern_type): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=9, bias=True)\n    )\n    (Sarees_transparency): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Women Tops & Tunics_color): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=12, bias=True)\n    )\n    (Women Tops & Tunics_fit_shape): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=4, bias=True)\n    )\n    (Women Tops & Tunics_length): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Women Tops & Tunics_neck_collar): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=7, bias=True)\n    )\n    (Women Tops & Tunics_occasion): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Women Tops & Tunics_pattern): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Women Tops & Tunics_print_or_pattern_type): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=6, bias=True)\n    )\n    (Women Tops & Tunics_sleeve_length): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=4, bias=True)\n    )\n    (Women Tops & Tunics_sleeve_styling): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=4, bias=True)\n    )\n    (Women Tops & Tunics_surface_styling): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=6, bias=True)\n    )\n    (Women Tshirts_color): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=7, bias=True)\n    )\n    (Women Tshirts_fit_shape): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Women Tshirts_length): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Women Tshirts_pattern): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Women Tshirts_print_or_pattern_type): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=6, bias=True)\n    )\n    (Women Tshirts_sleeve_length): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Women Tshirts_sleeve_styling): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Women Tshirts_surface_styling): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n  )\n)"
}
2024-10-26 20:38:18,418 | INFO | CLIP model loaded successfully
2024-10-26 20:38:18,426 | INFO | Starting epoch 1/20
2024-10-26 20:38:24,172 | INFO | Epoch 1, Batch 0: Loss = 0.6904, Accuracy = 76.4706%
2024-10-26 20:39:13,307 | INFO | Epoch 1, Batch 100: Loss = 0.5439, Accuracy = 80.9045%
2024-10-26 20:40:01,833 | INFO | Epoch 1, Batch 200: Loss = 0.5456, Accuracy = 78.8546%
2024-10-26 20:40:50,395 | INFO | Epoch 1, Batch 300: Loss = 0.5191, Accuracy = 82.2430%
2024-10-26 20:41:40,390 | INFO | Epoch 1, Batch 400: Loss = 0.4155, Accuracy = 82.6840%
2024-10-26 20:42:27,735 | INFO | Epoch 1, Batch 500: Loss = 0.5843, Accuracy = 78.2609%
2024-10-26 20:43:17,034 | INFO | Epoch 1, Batch 600: Loss = 0.3899, Accuracy = 84.7368%
2024-10-26 20:44:07,253 | INFO | Epoch 1, Batch 700: Loss = 0.2967, Accuracy = 90.4255%
2024-10-26 20:44:56,747 | INFO | Epoch 1, Batch 800: Loss = 0.6347, Accuracy = 79.7980%
2024-10-26 20:45:44,457 | INFO | Epoch 1, Batch 900: Loss = 0.4578, Accuracy = 81.8627%
2024-10-26 20:46:30,846 | INFO | Epoch 1, Batch 1000: Loss = 0.4701, Accuracy = 81.6901%
2024-10-26 20:47:16,885 | INFO | Epoch 1, Batch 1100: Loss = 0.4055, Accuracy = 83.0275%
2024-10-26 20:48:02,524 | INFO | Epoch 1, Batch 1200: Loss = 0.4562, Accuracy = 83.3333%
2024-10-26 20:48:47,150 | INFO | Epoch 1, Batch 1300: Loss = 0.7543, Accuracy = 69.4836%
2024-10-26 20:49:32,348 | INFO | Epoch 1, Batch 1400: Loss = 0.4973, Accuracy = 80.8889%
2024-10-26 20:50:16,912 | INFO | Epoch 1, Batch 1500: Loss = 0.4320, Accuracy = 80.2691%
2024-10-26 20:51:02,180 | INFO | Epoch 1, Batch 1600: Loss = 0.4043, Accuracy = 83.1818%
2024-10-26 20:51:48,179 | INFO | Epoch 1, Batch 1700: Loss = 0.6060, Accuracy = 78.5388%
2024-10-26 20:52:31,796 | INFO | Epoch 1, Batch 1800: Loss = 0.5563, Accuracy = 79.7170%
2024-10-26 20:53:14,008 | INFO | Epoch 1, Batch 1900: Loss = 0.4165, Accuracy = 81.6754%
2024-10-26 20:53:56,747 | INFO | Epoch 1, Batch 2000: Loss = 0.3607, Accuracy = 87.5740%
2024-10-26 20:54:38,304 | INFO | Epoch 1, Batch 2100: Loss = 0.4511, Accuracy = 78.2178%
2024-10-26 20:55:18,119 | INFO | Epoch 1 Summary:
Average Loss: 0.4583
Overall Accuracy: 82.4792%
Attribute Accuracies: {
  "Women Tshirts_color": 0.8195545270465722,
  "Women Tshirts_fit_shape": 0.8652793730153368,
  "Women Tshirts_length": 0.8600120627261761,
  "Women Tshirts_pattern": 0.9641111317368974,
  "Women Tshirts_print_or_pattern_type": 0.7274274979452859,
  "Women Tshirts_sleeve_length": 0.9536188516925379,
  "Women Tshirts_sleeve_styling": 0.9784605433376455,
  "Women Tshirts_surface_styling": 0.9470588235294117,
  "Men Tshirts_pattern": 0.9728889656363322,
  "Sarees_blouse_pattern": 0.701712111604312,
  "Sarees_border": 0.6806946094236099,
  "Sarees_border_width": 0.8972952525061472,
  "Sarees_color": 0.5464908359409923,
  "Sarees_occasion": 0.6940903167318262,
  "Sarees_ornamentation": 0.8616766467065868,
  "Sarees_pallu_details": 0.6294964028776978,
  "Sarees_pattern": 0.8450652900091102,
  "Sarees_transparency": 0.8329217645078011,
  "Sarees_print_or_pattern_type": 0.6706285394672447,
  "Kurtis_color": 0.7735706743098506,
  "Kurtis_fit_shape": 0.8047044258743423,
  "Kurtis_length": 0.7694117647058824,
  "Kurtis_occasion": 0.9419996890063753,
  "Kurtis_ornamentation": 0.934476423759951,
  "Kurtis_pattern": 0.8497920997920998,
  "Kurtis_print_or_pattern_type": 0.8495966692688004,
  "Kurtis_sleeve_length": 0.9370337212772307,
  "Kurtis_sleeve_styling": 0.9908832760424451,
  "Women Tops & Tunics_color": 0.7660406885758998,
  "Women Tops & Tunics_fit_shape": 0.7346479718077529,
  "Women Tops & Tunics_length": 0.8789989285167611,
  "Women Tops & Tunics_pattern": 0.9304683362336384,
  "Women Tops & Tunics_print_or_pattern_type": 0.8620611380145279,
  "Women Tops & Tunics_sleeve_styling": 0.8587224564473789,
  "Women Tops & Tunics_neck_collar": 0.7645528213515723,
  "Women Tops & Tunics_occasion": 0.9833691414020849,
  "Women Tops & Tunics_sleeve_length": 0.8978763499311444,
  "Men Tshirts_color": 0.6981697171381032,
  "Men Tshirts_neck": 0.9894205729166666,
  "Men Tshirts_sleeve_length": 0.9939769114940605,
  "Women Tops & Tunics_surface_styling": 0.6100821612588776,
  "Men Tshirts_print_or_pattern_type": 0.8929231803664481
}
2024-10-26 20:55:18,126 | ERROR | Training interrupted: module 'clip' has no attribute '__version__'
Traceback (most recent call last):
  File "/iitjhome/m23csa016/meesho_code/clipvit_uf_hyper_tune.py", line 455, in train_model_with_params
    'clip_version': clip.__version__,
AttributeError: module 'clip' has no attribute '__version__'
2024-10-26 20:55:18,126 | ERROR | Error in training run: module 'clip' has no attribute '__version__'
Traceback (most recent call last):
  File "/iitjhome/m23csa016/meesho_code/clipvit_uf_hyper_tune.py", line 569, in main
    _, _, metrics = train_model_with_params(
  File "/iitjhome/m23csa016/meesho_code/clipvit_uf_hyper_tune.py", line 455, in train_model_with_params
    'clip_version': clip.__version__,
AttributeError: module 'clip' has no attribute '__version__'
2024-10-26 20:55:18,482 | INFO | 
Starting training with optimizer parameters:
2024-10-26 20:55:18,483 | INFO | CLIP LR: 1e-05, Predictor LR: 5e-05, Weight Decay: 0.001, Beta1: 0.95, Beta2: 0.999
2024-10-26 20:55:18,483 | INFO | Starting new training run
2024-10-26 20:55:18,484 | INFO | Training hyperparameters:
2024-10-26 20:55:18,484 | INFO | {
  "clip_lr": 1e-05,
  "predictor_lr": 5e-05,
  "weight_decay": 0.001,
  "beta1": 0.95,
  "beta2": 0.999,
  "num_epochs": 20,
  "device": "cuda",
  "model_architecture": "CategoryAwareAttributePredictor(\n  (attribute_predictors): ModuleDict(\n    (Kurtis_color): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=13, bias=True)\n    )\n    (Kurtis_fit_shape): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Kurtis_length): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Kurtis_occasion): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Kurtis_ornamentation): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Kurtis_pattern): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Kurtis_print_or_pattern_type): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Kurtis_sleeve_length): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Kurtis_sleeve_styling): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Men Tshirts_color): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=4, bias=True)\n    )\n    (Men Tshirts_neck): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Men Tshirts_pattern): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Men Tshirts_print_or_pattern_type): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Men Tshirts_sleeve_length): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Sarees_blouse_pattern): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=4, bias=True)\n    )\n    (Sarees_border): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=6, bias=True)\n    )\n    (Sarees_border_width): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Sarees_color): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=8, bias=True)\n    )\n    (Sarees_occasion): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=4, bias=True)\n    )\n    (Sarees_ornamentation): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Sarees_pallu_details): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=4, bias=True)\n    )\n    (Sarees_pattern): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=5, bias=True)\n    )\n    (Sarees_print_or_pattern_type): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=9, bias=True)\n    )\n    (Sarees_transparency): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Women Tops & Tunics_color): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=12, bias=True)\n    )\n    (Women Tops & Tunics_fit_shape): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=4, bias=True)\n    )\n    (Women Tops & Tunics_length): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Women Tops & Tunics_neck_collar): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=7, bias=True)\n    )\n    (Women Tops & Tunics_occasion): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Women Tops & Tunics_pattern): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Women Tops & Tunics_print_or_pattern_type): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=6, bias=True)\n    )\n    (Women Tops & Tunics_sleeve_length): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=4, bias=True)\n    )\n    (Women Tops & Tunics_sleeve_styling): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=4, bias=True)\n    )\n    (Women Tops & Tunics_surface_styling): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=6, bias=True)\n    )\n    (Women Tshirts_color): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=7, bias=True)\n    )\n    (Women Tshirts_fit_shape): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Women Tshirts_length): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Women Tshirts_pattern): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Women Tshirts_print_or_pattern_type): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=6, bias=True)\n    )\n    (Women Tshirts_sleeve_length): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Women Tshirts_sleeve_styling): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Women Tshirts_surface_styling): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n  )\n)"
}
2024-10-26 20:55:26,275 | INFO | CLIP model loaded successfully
2024-10-26 20:55:26,280 | INFO | Starting epoch 1/20
2024-10-26 20:55:32,133 | INFO | Epoch 1, Batch 0: Loss = 0.7168, Accuracy = 74.3455%
2024-10-26 20:56:16,743 | INFO | Epoch 1, Batch 100: Loss = 0.5433, Accuracy = 77.1429%
2024-10-26 20:57:00,932 | INFO | Epoch 1, Batch 200: Loss = 0.5313, Accuracy = 81.1927%
2024-10-26 20:57:42,673 | INFO | Epoch 1, Batch 300: Loss = 0.4540, Accuracy = 83.4951%
2024-10-26 20:58:24,765 | INFO | Epoch 1, Batch 400: Loss = 0.4250, Accuracy = 86.2559%
2024-10-26 20:59:06,784 | INFO | Epoch 1, Batch 500: Loss = 0.4425, Accuracy = 79.9020%
2024-10-26 20:59:49,756 | INFO | Epoch 1, Batch 600: Loss = 0.3323, Accuracy = 85.3801%
2024-10-26 21:00:31,842 | INFO | Epoch 1, Batch 700: Loss = 0.4318, Accuracy = 81.2500%
2024-10-26 21:01:15,188 | INFO | Epoch 1, Batch 800: Loss = 0.5005, Accuracy = 81.6964%
2024-10-26 21:01:57,029 | INFO | Epoch 1, Batch 900: Loss = 0.3116, Accuracy = 88.6792%
2024-10-26 21:02:38,426 | INFO | Epoch 1, Batch 1000: Loss = 0.4150, Accuracy = 81.6964%
2024-10-26 21:03:20,082 | INFO | Epoch 1, Batch 1100: Loss = 0.4394, Accuracy = 79.9107%
2024-10-26 21:04:03,803 | INFO | Epoch 1, Batch 1200: Loss = 0.4729, Accuracy = 80.7292%
2024-10-26 21:04:45,891 | INFO | Epoch 1, Batch 1300: Loss = 0.4165, Accuracy = 86.1751%
2024-10-26 21:05:28,651 | INFO | Epoch 1, Batch 1400: Loss = 0.3507, Accuracy = 85.0220%
2024-10-26 21:06:10,419 | INFO | Epoch 1, Batch 1500: Loss = 0.4095, Accuracy = 85.5140%
2024-10-26 21:06:52,965 | INFO | Epoch 1, Batch 1600: Loss = 0.4826, Accuracy = 80.7175%
2024-10-26 21:07:35,999 | INFO | Epoch 1, Batch 1700: Loss = 0.3720, Accuracy = 86.5672%
2024-10-26 21:08:18,506 | INFO | Epoch 1, Batch 1800: Loss = 0.6155, Accuracy = 77.4038%
2024-10-26 21:09:02,684 | INFO | Epoch 1, Batch 1900: Loss = 0.2948, Accuracy = 89.1509%
2024-10-26 21:09:47,064 | INFO | Epoch 1, Batch 2000: Loss = 0.3588, Accuracy = 85.1163%
2024-10-26 21:10:29,115 | INFO | Epoch 1, Batch 2100: Loss = 0.4648, Accuracy = 83.4906%
2024-10-26 21:11:08,388 | INFO | Epoch 1 Summary:
Average Loss: 0.4346
Overall Accuracy: 83.2905%
Attribute Accuracies: {
  "Women Tops & Tunics_print_or_pattern_type": 0.8681900726392252,
  "Women Tops & Tunics_sleeve_length": 0.9101253895774444,
  "Women Tops & Tunics_fit_shape": 0.7560920746794632,
  "Sarees_blouse_pattern": 0.7126188966391883,
  "Sarees_border": 0.6877651450873918,
  "Sarees_border_width": 0.9005737343168779,
  "Sarees_color": 0.5545932051855164,
  "Sarees_occasion": 0.6998696810017565,
  "Sarees_pattern": 0.8487701184330397,
  "Sarees_print_or_pattern_type": 0.6728658323428651,
  "Sarees_transparency": 0.8340442249410708,
  "Men Tshirts_pattern": 0.9766879640821965,
  "Men Tshirts_sleeve_length": 0.9956499916345993,
  "Women Tshirts_color": 0.8260919872722013,
  "Women Tshirts_fit_shape": 0.8685223971353286,
  "Women Tshirts_length": 0.8689384800965018,
  "Women Tshirts_pattern": 0.9645442732504177,
  "Women Tshirts_print_or_pattern_type": 0.7443935658095574,
  "Women Tshirts_sleeve_length": 0.9566111838414064,
  "Women Tshirts_sleeve_styling": 0.9779430789133247,
  "Kurtis_color": 0.795142555438226,
  "Kurtis_length": 0.7805882352941177,
  "Kurtis_occasion": 0.9457316125019437,
  "Kurtis_ornamentation": 0.9384568279240662,
  "Kurtis_pattern": 0.8666839916839917,
  "Kurtis_sleeve_length": 0.943002088928678,
  "Kurtis_sleeve_styling": 0.992826184426842,
  "Sarees_ornamentation": 0.872255489021956,
  "Sarees_pallu_details": 0.6409622302158273,
  "Men Tshirts_color": 0.7138103161397671,
  "Men Tshirts_neck": 0.99462890625,
  "Men Tshirts_print_or_pattern_type": 0.9014960497562615,
  "Kurtis_fit_shape": 0.8307025688641287,
  "Kurtis_print_or_pattern_type": 0.8649492583918813,
  "Women Tops & Tunics_pattern": 0.9369751078156919,
  "Women Tops & Tunics_sleeve_styling": 0.8749502823959908,
  "Women Tops & Tunics_color": 0.7718736662398634,
  "Women Tops & Tunics_length": 0.8924690035205878,
  "Women Tops & Tunics_neck_collar": 0.7841796148985205,
  "Women Tops & Tunics_occasion": 0.9839261558048858,
  "Women Tops & Tunics_surface_styling": 0.6400222810193567,
  "Women Tshirts_surface_styling": 0.9470588235294117
}
2024-10-26 21:11:08,395 | ERROR | Training interrupted: module 'clip' has no attribute '__version__'
Traceback (most recent call last):
  File "/iitjhome/m23csa016/meesho_code/clipvit_uf_hyper_tune.py", line 455, in train_model_with_params
    'clip_version': clip.__version__,
AttributeError: module 'clip' has no attribute '__version__'
2024-10-26 21:11:08,396 | ERROR | Error in training run: module 'clip' has no attribute '__version__'
Traceback (most recent call last):
  File "/iitjhome/m23csa016/meesho_code/clipvit_uf_hyper_tune.py", line 569, in main
    _, _, metrics = train_model_with_params(
  File "/iitjhome/m23csa016/meesho_code/clipvit_uf_hyper_tune.py", line 455, in train_model_with_params
    'clip_version': clip.__version__,
AttributeError: module 'clip' has no attribute '__version__'
2024-10-26 21:11:08,708 | INFO | 
Starting training with optimizer parameters:
2024-10-26 21:11:08,708 | INFO | CLIP LR: 1e-05, Predictor LR: 5e-05, Weight Decay: 0.001, Beta1: 0.95, Beta2: 0.9999
2024-10-26 21:11:08,708 | INFO | Starting new training run
2024-10-26 21:11:08,710 | INFO | Training hyperparameters:
2024-10-26 21:11:08,710 | INFO | {
  "clip_lr": 1e-05,
  "predictor_lr": 5e-05,
  "weight_decay": 0.001,
  "beta1": 0.95,
  "beta2": 0.9999,
  "num_epochs": 20,
  "device": "cuda",
  "model_architecture": "CategoryAwareAttributePredictor(\n  (attribute_predictors): ModuleDict(\n    (Kurtis_color): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=13, bias=True)\n    )\n    (Kurtis_fit_shape): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Kurtis_length): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Kurtis_occasion): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Kurtis_ornamentation): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Kurtis_pattern): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Kurtis_print_or_pattern_type): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Kurtis_sleeve_length): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Kurtis_sleeve_styling): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Men Tshirts_color): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=4, bias=True)\n    )\n    (Men Tshirts_neck): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Men Tshirts_pattern): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Men Tshirts_print_or_pattern_type): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Men Tshirts_sleeve_length): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Sarees_blouse_pattern): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=4, bias=True)\n    )\n    (Sarees_border): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=6, bias=True)\n    )\n    (Sarees_border_width): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Sarees_color): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=8, bias=True)\n    )\n    (Sarees_occasion): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=4, bias=True)\n    )\n    (Sarees_ornamentation): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Sarees_pallu_details): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=4, bias=True)\n    )\n    (Sarees_pattern): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=5, bias=True)\n    )\n    (Sarees_print_or_pattern_type): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=9, bias=True)\n    )\n    (Sarees_transparency): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Women Tops & Tunics_color): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=12, bias=True)\n    )\n    (Women Tops & Tunics_fit_shape): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=4, bias=True)\n    )\n    (Women Tops & Tunics_length): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Women Tops & Tunics_neck_collar): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=7, bias=True)\n    )\n    (Women Tops & Tunics_occasion): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Women Tops & Tunics_pattern): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Women Tops & Tunics_print_or_pattern_type): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=6, bias=True)\n    )\n    (Women Tops & Tunics_sleeve_length): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=4, bias=True)\n    )\n    (Women Tops & Tunics_sleeve_styling): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=4, bias=True)\n    )\n    (Women Tops & Tunics_surface_styling): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=6, bias=True)\n    )\n    (Women Tshirts_color): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=7, bias=True)\n    )\n    (Women Tshirts_fit_shape): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Women Tshirts_length): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Women Tshirts_pattern): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Women Tshirts_print_or_pattern_type): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=6, bias=True)\n    )\n    (Women Tshirts_sleeve_length): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Women Tshirts_sleeve_styling): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Women Tshirts_surface_styling): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n  )\n)"
}
2024-10-26 21:11:16,784 | INFO | CLIP model loaded successfully
2024-10-26 21:11:16,789 | INFO | Starting epoch 1/20
2024-10-26 21:11:21,359 | INFO | Epoch 1, Batch 0: Loss = 0.8061, Accuracy = 69.7917%
2024-10-26 21:12:03,394 | INFO | Epoch 1, Batch 100: Loss = 0.4651, Accuracy = 81.6327%
2024-10-26 21:12:46,849 | INFO | Epoch 1, Batch 200: Loss = 0.5025, Accuracy = 83.5897%
2024-10-26 21:13:28,070 | INFO | Epoch 1, Batch 300: Loss = 0.5167, Accuracy = 79.4258%
2024-10-26 21:14:10,904 | INFO | Epoch 1, Batch 400: Loss = 0.3395, Accuracy = 87.6147%
2024-10-26 21:14:52,027 | INFO | Epoch 1, Batch 500: Loss = 0.4340, Accuracy = 83.0000%
2024-10-26 21:15:33,286 | INFO | Epoch 1, Batch 600: Loss = 0.4295, Accuracy = 83.5000%
2024-10-26 21:16:14,324 | INFO | Epoch 1, Batch 700: Loss = 0.4026, Accuracy = 85.0962%
2024-10-26 21:16:57,272 | INFO | Epoch 1, Batch 800: Loss = 0.3385, Accuracy = 87.0536%
2024-10-26 21:17:40,902 | INFO | Epoch 1, Batch 900: Loss = 0.4293, Accuracy = 82.6484%
2024-10-26 21:18:22,254 | INFO | Epoch 1, Batch 1000: Loss = 0.3579, Accuracy = 84.5745%
2024-10-26 21:19:04,727 | INFO | Epoch 1, Batch 1100: Loss = 0.4334, Accuracy = 83.2599%
2024-10-26 21:19:45,306 | INFO | Epoch 1, Batch 1200: Loss = 0.4672, Accuracy = 80.0995%
2024-10-26 21:20:25,798 | INFO | Epoch 1, Batch 1300: Loss = 0.4154, Accuracy = 82.9384%
2024-10-26 21:21:08,300 | INFO | Epoch 1, Batch 1400: Loss = 0.4276, Accuracy = 83.4171%
2024-10-26 21:21:49,963 | INFO | Epoch 1, Batch 1500: Loss = 0.3825, Accuracy = 86.0360%
2024-10-26 21:22:34,154 | INFO | Epoch 1, Batch 1600: Loss = 0.3566, Accuracy = 88.4393%
2024-10-26 21:23:14,913 | INFO | Epoch 1, Batch 1700: Loss = 0.3968, Accuracy = 86.6029%
2024-10-26 21:23:57,696 | INFO | Epoch 1, Batch 1800: Loss = 0.3457, Accuracy = 85.2792%
2024-10-26 21:24:41,192 | INFO | Epoch 1, Batch 1900: Loss = 0.4283, Accuracy = 83.7963%
2024-10-26 21:25:26,049 | INFO | Epoch 1, Batch 2000: Loss = 0.4035, Accuracy = 86.3014%
2024-10-26 21:26:10,114 | INFO | Epoch 1, Batch 2100: Loss = 0.4787, Accuracy = 80.0000%
2024-10-26 21:26:48,838 | INFO | Epoch 1 Summary:
Average Loss: 0.4232
Overall Accuracy: 83.6438%
Attribute Accuracies: {
  "Sarees_border": 0.6921771593415917,
  "Sarees_border_width": 0.9036630729462203,
  "Sarees_color": 0.5595663835493965,
  "Sarees_occasion": 0.704742478327384,
  "Sarees_pattern": 0.8514424536896447,
  "Sarees_print_or_pattern_type": 0.6803467803957212,
  "Sarees_transparency": 0.8346615781793691,
  "Sarees_blouse_pattern": 0.7180722891566265,
  "Sarees_pallu_details": 0.645908273381295,
  "Men Tshirts_color": 0.7254575707154742,
  "Men Tshirts_neck": 0.9954427083333334,
  "Men Tshirts_pattern": 0.9773786910723536,
  "Men Tshirts_print_or_pattern_type": 0.9025046226256513,
  "Men Tshirts_sleeve_length": 0.9949807595783838,
  "Women Tops & Tunics_color": 0.7804097311139565,
  "Women Tops & Tunics_fit_shape": 0.7633650746044838,
  "Women Tops & Tunics_length": 0.8940762283789989,
  "Women Tops & Tunics_neck_collar": 0.7957772656308081,
  "Women Tops & Tunics_occasion": 0.9839261558048858,
  "Women Tops & Tunics_pattern": 0.9372020882197171,
  "Women Tops & Tunics_print_or_pattern_type": 0.8730326876513317,
  "Women Tops & Tunics_sleeve_length": 0.9125896934116112,
  "Women Tops & Tunics_sleeve_styling": 0.8766207938907008,
  "Kurtis_color": 0.8002715341680495,
  "Kurtis_occasion": 0.94853055512362,
  "Kurtis_pattern": 0.856029106029106,
  "Kurtis_sleeve_length": 0.9476275738585497,
  "Kurtis_sleeve_styling": 0.9932745479001645,
  "Women Tshirts_surface_styling": 0.9470588235294117,
  "Women Tshirts_color": 0.8350592999710732,
  "Women Tshirts_print_or_pattern_type": 0.7487378184806857,
  "Women Tops & Tunics_surface_styling": 0.6492132015039688,
  "Women Tshirts_fit_shape": 0.8713600432403216,
  "Women Tshirts_length": 0.8665862484921593,
  "Women Tshirts_pattern": 0.9675762638450591,
  "Women Tshirts_sleeve_length": 0.9575462876379278,
  "Women Tshirts_sleeve_styling": 0.9802069857697283,
  "Kurtis_length": 0.7917647058823529,
  "Kurtis_print_or_pattern_type": 0.8558417902680198,
  "Sarees_ornamentation": 0.8754491017964072,
  "Kurtis_fit_shape": 0.8238935314144228,
  "Kurtis_ornamentation": 0.9433557868952848
}
2024-10-26 21:26:48,849 | ERROR | Training interrupted: module 'clip' has no attribute '__version__'
Traceback (most recent call last):
  File "/iitjhome/m23csa016/meesho_code/clipvit_uf_hyper_tune.py", line 455, in train_model_with_params
    'clip_version': clip.__version__,
AttributeError: module 'clip' has no attribute '__version__'
2024-10-26 21:26:48,850 | ERROR | Error in training run: module 'clip' has no attribute '__version__'
Traceback (most recent call last):
  File "/iitjhome/m23csa016/meesho_code/clipvit_uf_hyper_tune.py", line 569, in main
    _, _, metrics = train_model_with_params(
  File "/iitjhome/m23csa016/meesho_code/clipvit_uf_hyper_tune.py", line 455, in train_model_with_params
    'clip_version': clip.__version__,
AttributeError: module 'clip' has no attribute '__version__'
2024-10-26 21:26:49,348 | INFO | 
Starting training with optimizer parameters:
2024-10-26 21:26:49,348 | INFO | CLIP LR: 1e-05, Predictor LR: 5e-05, Weight Decay: 0.05, Beta1: 0.9, Beta2: 0.999
2024-10-26 21:26:49,348 | INFO | Starting new training run
2024-10-26 21:26:49,350 | INFO | Training hyperparameters:
2024-10-26 21:26:49,350 | INFO | {
  "clip_lr": 1e-05,
  "predictor_lr": 5e-05,
  "weight_decay": 0.05,
  "beta1": 0.9,
  "beta2": 0.999,
  "num_epochs": 20,
  "device": "cuda",
  "model_architecture": "CategoryAwareAttributePredictor(\n  (attribute_predictors): ModuleDict(\n    (Kurtis_color): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=13, bias=True)\n    )\n    (Kurtis_fit_shape): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Kurtis_length): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Kurtis_occasion): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Kurtis_ornamentation): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Kurtis_pattern): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Kurtis_print_or_pattern_type): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Kurtis_sleeve_length): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Kurtis_sleeve_styling): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Men Tshirts_color): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=4, bias=True)\n    )\n    (Men Tshirts_neck): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Men Tshirts_pattern): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Men Tshirts_print_or_pattern_type): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Men Tshirts_sleeve_length): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Sarees_blouse_pattern): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=4, bias=True)\n    )\n    (Sarees_border): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=6, bias=True)\n    )\n    (Sarees_border_width): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Sarees_color): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=8, bias=True)\n    )\n    (Sarees_occasion): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=4, bias=True)\n    )\n    (Sarees_ornamentation): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Sarees_pallu_details): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=4, bias=True)\n    )\n    (Sarees_pattern): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=5, bias=True)\n    )\n    (Sarees_print_or_pattern_type): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=9, bias=True)\n    )\n    (Sarees_transparency): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Women Tops & Tunics_color): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=12, bias=True)\n    )\n    (Women Tops & Tunics_fit_shape): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=4, bias=True)\n    )\n    (Women Tops & Tunics_length): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Women Tops & Tunics_neck_collar): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=7, bias=True)\n    )\n    (Women Tops & Tunics_occasion): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Women Tops & Tunics_pattern): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Women Tops & Tunics_print_or_pattern_type): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=6, bias=True)\n    )\n    (Women Tops & Tunics_sleeve_length): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=4, bias=True)\n    )\n    (Women Tops & Tunics_sleeve_styling): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=4, bias=True)\n    )\n    (Women Tops & Tunics_surface_styling): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=6, bias=True)\n    )\n    (Women Tshirts_color): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=7, bias=True)\n    )\n    (Women Tshirts_fit_shape): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Women Tshirts_length): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Women Tshirts_pattern): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Women Tshirts_print_or_pattern_type): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=6, bias=True)\n    )\n    (Women Tshirts_sleeve_length): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=3, bias=True)\n    )\n    (Women Tshirts_sleeve_styling): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n    (Women Tshirts_surface_styling): Sequential(\n      (0): Linear(in_features=768, out_features=256, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=256, out_features=2, bias=True)\n    )\n  )\n)"
}
2024-10-26 21:26:56,864 | INFO | CLIP model loaded successfully
2024-10-26 21:26:56,871 | INFO | Starting epoch 1/20
2024-10-26 21:27:01,633 | INFO | Epoch 1, Batch 0: Loss = 0.6301, Accuracy = 76.6497%
2024-10-26 21:27:44,092 | INFO | Epoch 1, Batch 100: Loss = 0.4353, Accuracy = 82.5243%
2024-10-26 21:28:25,885 | INFO | Epoch 1, Batch 200: Loss = 0.4519, Accuracy = 83.7321%
2024-10-26 21:29:09,485 | INFO | Epoch 1, Batch 300: Loss = 0.4427, Accuracy = 82.8402%
2024-10-26 21:29:53,693 | INFO | Epoch 1, Batch 400: Loss = 0.3247, Accuracy = 86.9792%
2024-10-26 21:30:36,065 | INFO | Epoch 1, Batch 500: Loss = 0.3489, Accuracy = 85.5263%
2024-10-26 21:31:21,090 | INFO | Epoch 1, Batch 600: Loss = 0.4435, Accuracy = 81.9588%
2024-10-26 21:32:03,262 | INFO | Epoch 1, Batch 700: Loss = 0.4132, Accuracy = 85.8491%
2024-10-26 21:32:45,553 | INFO | Epoch 1, Batch 800: Loss = 0.3249, Accuracy = 84.6535%
